#--------------------------------------------
#@# Hippocampal Subfields processing Tue Sep 27 09:33:29 CDT 2016
Doing left side
meshFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/CurrentMeshCollection30.gz
compressionLookupTableFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/compressionLookupTable_left.txt
boundingBoxFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/imageDump.mgz
subjectName: HYGLY28_VISIT_2
side: left
inputDirectory: /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED
outputDirectory: /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/tmp/subfieldResults
mkdir -p /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/tmp/subfieldResults/HYGLY28_VISIT_2
mkdir -p /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/tmp/subfieldResults/HYGLY28_VISIT_2/left
cd /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/tmp/subfieldResults/HYGLY28_VISIT_2/left
cp -f /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/mri/nu.mgz .
cp -f /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/mri/aseg.mgz .
cp -f /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/mri/transforms/talairach.xfm .
cp /nrgpackages/tools/freesurfer53-patch/data/GEMS/imageDump.mgz .
kvlApplyTransform imageDump.mgz -0.9991 -0.0328 0.0258 144.0010 -0.0330 0.9994 -0.0086 2.6560 0.0255 0.0094 0.9996 -3.1939
transform: Affine3DTransform (0x12f4100)
  RTTI typeinfo:   itk::Affine3DTransform<double>
  Reference Count: 2
  Modified Time: 192
  Debug: Off
  Observers: 
    none
  Offset: [144.001, 2.656, -3.1939]
  Matrix: -0.9991 -0.0328 0.0258
-0.033 0.9994 -0.0086
0.0255 0.0094 0.9996


Wrote out imageDump_transformed.mgz
rm -f imageDump.mgz
mv imageDump_transformed.mgz imageDump.mgz
kvlApplyTransform imageDump.mgz 1.0932 0.0097 -0.0146 -76.4657 -0.0027 1.0489 0.1291 -121.4683 0.0153 -0.1434 1.1143 -62.7038
transform: Affine3DTransform (0x2326100)
  RTTI typeinfo:   itk::Affine3DTransform<double>
  Reference Count: 2
  Modified Time: 192
  Debug: Off
  Observers: 
    none
  Offset: [-76.4657, -121.468, -62.7038]
  Matrix: 1.0932 0.0097 -0.0146
-0.0027 1.0489 0.1291
0.0153 -0.1434 1.1143


Wrote out imageDump_transformed.mgz
kvlApplyTransform imageDump_transformed.mgz 1.046531 0.043269 -0.017670 -2.095993 -0.059733 0.987705 0.208602 -44.012466 -0.000135 -0.157595 1.075790 12.002991 1
transform: Affine3DTransform (0xfc58b0)
  RTTI typeinfo:   itk::Affine3DTransform<double>
  Reference Count: 2
  Modified Time: 193
  Debug: Off
  Observers: 
    none
  Offset: [0.0453077, 45.5114, -4.49029]
  Matrix: 0.953367 -0.0380878 0.0230446
0.0559015 0.979831 -0.189077
0.00830879 0.143533 0.901854


Wrote out imageDump_transformed_transformed.mgz
rm -f imageDump.mgz
mv imageDump_transformed_transformed.mgz imageDump.mgz
kvlBinaryThresholdImage aseg.mgz 17
imageFileName: aseg.mgz
lowerThreshold: 17
upperThreshold: 17
insideValue: 255
outsideValue: 0
Thresholding: 
  0%
  0.999975%
  1.99995%
  2.99993%
  3.9999%
  4.99988%
  5.99985%
  6.99983%
  7.9998%
  8.99978%
  9.99975%
  10.9997%
  11.9997%
  12.9997%
  13.9997%
  14.9996%
  15.9996%
  16.9996%
  17.9996%
  18.9995%
  19.9995%
  20.9995%
  21.9995%
  22.9994%
  23.9994%
  24.9994%
  25.9994%
  26.9993%
  27.9993%
  28.9993%
  29.9993%
  30.9992%
  31.9992%
  32.9992%
  33.9992%
  34.9991%
  35.9991%
  36.9991%
  37.9991%
  38.999%
  39.999%
  40.999%
  41.999%
  42.9989%
  43.9989%
  44.9989%
  45.9989%
  46.9988%
  47.9988%
  48.9988%
  49.9988%
  50.9987%
  51.9987%
  52.9987%
  53.9987%
  54.9986%
  55.9986%
  56.9986%
  57.9986%
  58.9985%
  59.9985%
  60.9985%
  61.9985%
  62.9984%
  63.9984%
  64.9984%
  65.9984%
  66.9983%
  67.9983%
  68.9983%
  69.9983%
  70.9982%
  71.9982%
  72.9982%
  73.9982%
  74.9981%
  75.9981%
  76.9981%
  77.9981%
  78.998%
  79.998%
  80.998%
  81.998%
  82.9979%
  83.9979%
  84.9979%
  85.9979%
  86.9978%
  87.9978%
  88.9978%
  89.9978%
  90.9977%
  91.9977%
  92.9977%
  93.9977%
  94.9976%
  95.9976%
  96.9976%
  97.9976%
  98.9975%
  99.9975%
  100%
  100%
Wrote out aseg_thresholded.mgz
kvlRegister imageDump.mgz aseg_thresholded.mgz 12 2
fixedImageFileName: imageDump.mgz
movingImageFileName: aseg_thresholded.mgz
degreesOfFreedom: 12
numberOfBins: 20
useDefaultSchedule: 1
initialTranslationMode: 2
extraInputImageFileNames: 
Initializing the parameters as follows: [0, -0, 0, -0.219744, 1.078, -0.582065, 1, 1, 1, 0, 0, 0]
Using fixedShrinkFactors: [3, 3, 2]
Shrinking fixed image: 
  0%
  0.999355%
  1.99871%
  2.99807%
  3.99742%
  4.99678%
  5.99613%
  6.99549%
  7.99484%
  8.9942%
  9.99355%
  10.9929%
  11.9923%
  12.9916%
  13.991%
  14.9903%
  15.9897%
  16.989%
  17.9884%
  18.9878%
  19.9871%
  20.9865%
  21.9858%
  22.9852%
  23.9845%
  24.9839%
  25.9832%
  26.9826%
  27.9819%
  28.9813%
  29.9807%
  30.98%
  31.9794%
  32.9787%
  33.9781%
  34.9774%
  35.9768%
  36.9761%
  37.9755%
  38.9749%
  39.9742%
  40.9736%
  41.9729%
  42.9723%
  43.9716%
  44.971%
  45.9703%
  46.9697%
  47.9691%
  48.9684%
  49.9678%
  50.9671%
  51.9665%
  52.9658%
  53.9652%
  54.9645%
  55.9639%
  56.9633%
  57.9626%
  58.962%
  59.9613%
  60.9607%
  61.96%
  62.9594%
  63.9587%
  64.9581%
  65.9575%
  66.9568%
  67.9562%
  68.9555%
  69.9549%
  70.9542%
  71.9536%
  72.9529%
  73.9523%
  74.9516%
  75.951%
  76.9504%
  77.9497%
  78.9491%
  79.9484%
  80.9478%
  81.9471%
  82.9465%
  83.9458%
  84.9452%
  85.9446%
  86.9439%
  87.9433%
  88.9426%
  89.942%
  90.9413%
  91.9407%
  92.94%
  93.9394%
  94.9388%
  95.9381%
  96.9375%
  97.9368%
  98.9362%
  99.9355%
  100%
  100%
Using movingShrinkFactors: [1, 1, 1]
Shrinking moving image: 
  0%
  0.999975%
  1.99995%
  2.99993%
  3.9999%
  4.99988%
  5.99985%
  6.99983%
  7.9998%
  8.99978%
  9.99975%
  10.9997%
  11.9997%
  12.9997%
  13.9997%
  14.9996%
  15.9996%
  16.9996%
  17.9996%
  18.9995%
  19.9995%
  20.9995%
  21.9995%
  22.9994%
  23.9994%
  24.9994%
  25.9994%
  26.9993%
  27.9993%
  28.9993%
  29.9993%
  30.9992%
  31.9992%
  32.9992%
  33.9992%
  34.9991%
  35.9991%
  36.9991%
  37.9991%
  38.999%
  39.999%
  40.999%
  41.999%
  42.9989%
  43.9989%
  44.9989%
  45.9989%
  46.9988%
  47.9988%
  48.9988%
  49.9988%
  50.9987%
  51.9987%
  52.9987%
  53.9987%
  54.9986%
  55.9986%
  56.9986%
  57.9986%
  58.9985%
  59.9985%
  60.9985%
  61.9985%
  62.9984%
  63.9984%
  64.9984%
  65.9984%
  66.9983%
  67.9983%
  68.9983%
  69.9983%
  70.9982%
  71.9982%
  72.9982%
  73.9982%
  74.9981%
  75.9981%
  76.9981%
  77.9981%
  78.998%
  79.998%
  80.998%
  81.998%
  82.9979%
  83.9979%
  84.9979%
  85.9979%
  86.9978%
  87.9978%
  88.9978%
  89.9978%
  90.9977%
  91.9977%
  92.9977%
  93.9977%
  94.9976%
  95.9976%
  96.9976%
  97.9976%
  98.9975%
  99.9975%
  100%
  100%
Using fixedSchedule: [3, 3, 5]
[1, 1, 1]

Using movingSchedule: [4, 4, 4]
[1, 1, 1]

Using scales: [57.1429, 57.1429, 57.1429, 1, 1, 1, 100, 100, 100, 100, 100, 100]
Using parameterOrder: [4, 5, 6, 1, 2, 3, 7, 8, 9, 10, 11, 12]
Calculating fixed image pyramid: 
  0%
  50%
  100%
Calculating moving image pyramid: 
  0%
  50%
  100%
Doing registration at level 0 of 2
       Iteration 0: value = -0.348923
            Current position: 
                    Rotation: 0.465459  -0.206631  0.185601  
                 Translation: 0.0342354  0.846879  -0.256609  
                     Scaling: 1.00172  0.986618  0.996323  
                     Skewing: -0.000492434  0.00566987  0.00284914  
       Iteration 1: value = -0.354803
            Current position: 
                    Rotation: 1.13612  -0.394415  1.02989  
                 Translation: -0.435351  0.834119  0.0108084  
                     Scaling: 1.00691  0.971346  0.997305  
                     Skewing: -0.00225315  0.0145955  0.0089138  
       Iteration 2: value = -0.357584
            Current position: 
                    Rotation: 1.53879  -0.228728  1.76395  
                 Translation: -0.717296  1.02831  0.171369  
                     Scaling: 1.01275  0.971884  1.00647  
                     Skewing: -0.00633356  0.0241624  0.0193253  
       Iteration 3: value = -0.359414
            Current position: 
                    Rotation: 1.69058  -0.145225  2.0126  
                 Translation: -0.838375  1.12286  0.202824  
                     Scaling: 1.01414  0.977292  1.00973  
                     Skewing: -0.0102984  0.0335903  0.025307  
       Iteration 4: value = -0.364991
            Current position: 
                    Rotation: 2.41608  0.220262  3.02843  
                 Translation: -1.65792  1.65026  0.188883  
                     Scaling: 1.02138  1.01531  1.02644  
                     Skewing: -0.0377332  0.0858415  0.0532247  
       Iteration 5: value = -0.366186
            Current position: 
                    Rotation: 2.48801  0.2721  3.1598  
                 Translation: -1.61299  1.82484  0.187219  
                     Scaling: 1.02108  1.01655  1.02725  
                     Skewing: -0.0381767  0.0890211  0.0526267  
       Iteration 6: value = -0.366798
            Current position: 
                    Rotation: 2.68997  0.356033  3.43465  
                 Translation: -1.7782  2.1217  0.298957  
                     Scaling: 1.01762  1.01602  1.02875  
                     Skewing: -0.0360096  0.0980306  0.0532521  
       Iteration 7: value = -0.367457
            Current position: 
                    Rotation: 2.93495  0.439305  3.40921  
                 Translation: -1.93567  2.50065  0.430142  
                     Scaling: 1.00796  1.02022  1.03157  
                     Skewing: -0.0329693  0.114744  0.0562177  
       Iteration 8: value = -0.36767
            Current position: 
                    Rotation: 2.9211  0.381781  3.23947  
                 Translation: -1.8736  2.49907  0.440939  
                     Scaling: 1.00644  1.0186  1.03105  
                     Skewing: -0.0316119  0.114029  0.0549991  
       Iteration 9: value = -0.368005
            Current position: 
                    Rotation: 2.93254  0.250852  2.92169  
                 Translation: -1.76095  2.7127  0.464392  
                     Scaling: 1.00027  1.02364  1.03241  
                     Skewing: -0.028693  0.124321  0.0533782  
       Iteration 10: value = -0.368071
            Current position: 
                    Rotation: 2.92328  0.226459  2.95462  
                 Translation: -1.74558  2.69355  0.459173  
                     Scaling: 1.00091  1.02354  1.03225  
                     Skewing: -0.0275789  0.123034  0.0527807  
PowellOptimizer: Maximum number of iterations exceeded. Number of iterations is 10
Doing registration at level 1 of 2
       Iteration 0: value = -0.201666
            Current position: 
                    Rotation: 2.92328  0.226459  2.95462  
                 Translation: -2.09004  2.69355  0.459173  
                     Scaling: 1.00091  1.02426  1.03225  
                     Skewing: -0.0275789  0.123034  0.0527807  
PowellOptimizer: Cost function values at the current parameter (-0.201666) and at the local extrema (-0.201666) are within Value Tolerance (0)
Wrote out imageDump_coregistered.mgz
kvlBinaryThresholdImage aseg.mgz 17 17 255 1
imageFileName: aseg.mgz
lowerThreshold: 17
upperThreshold: 17
insideValue: 255
outsideValue: 1
Thresholding: 
  0%
  0.999975%
  1.99995%
  2.99993%
  3.9999%
  4.99988%
  5.99985%
  6.99983%
  7.9998%
  8.99978%
  9.99975%
  10.9997%
  11.9997%
  12.9997%
  13.9997%
  14.9996%
  15.9996%
  16.9996%
  17.9996%
  18.9995%
  19.9995%
  20.9995%
  21.9995%
  22.9994%
  23.9994%
  24.9994%
  25.9994%
  26.9993%
  27.9993%
  28.9993%
  29.9993%
  30.9992%
  31.9992%
  32.9992%
  33.9992%
  34.9991%
  35.9991%
  36.9991%
  37.9991%
  38.999%
  39.999%
  40.999%
  41.999%
  42.9989%
  43.9989%
  44.9989%
  45.9989%
  46.9988%
  47.9988%
  48.9988%
  49.9988%
  50.9987%
  51.9987%
  52.9987%
  53.9987%
  54.9986%
  55.9986%
  56.9986%
  57.9986%
  58.9985%
  59.9985%
  60.9985%
  61.9985%
  62.9984%
  63.9984%
  64.9984%
  65.9984%
  66.9983%
  67.9983%
  68.9983%
  69.9983%
  70.9982%
  71.9982%
  72.9982%
  73.9982%
  74.9981%
  75.9981%
  76.9981%
  77.9981%
  78.998%
  79.998%
  80.998%
  81.998%
  82.9979%
  83.9979%
  84.9979%
  85.9979%
  86.9978%
  87.9978%
  88.9978%
  89.9978%
  90.9977%
  91.9977%
  92.9977%
  93.9977%
  94.9976%
  95.9976%
  96.9976%
  97.9976%
  98.9975%
  99.9975%
  100%
  100%
Wrote out aseg_thresholded.mgz
echo \# Configuration for deforming toward aseg > configurationFileDeformableRegistration.txt
echo logDirectory: deformableRegistrationLog >> configurationFileDeformableRegistration.txt
echo imageFileName: aseg_thresholded.mgz >> configurationFileDeformableRegistration.txt
echo meshCollectionFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/CurrentMeshCollection30.gz >> configurationFileDeformableRegistration.txt
echo K: 0.01 >> configurationFileDeformableRegistration.txt
echo compressionLookupTableFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/compressionLookupTable_left.txt >> configurationFileDeformableRegistration.txt
echo boundingFileName: imageDump_coregistered.mgz >> configurationFileDeformableRegistration.txt
echo sameGaussianParameters: 17 550 552 553 554 555 556 557 >> configurationFileDeformableRegistration.txt
echo sameGaussianParameters: 24 2 3 >> configurationFileDeformableRegistration.txt
echo imageSmoothingSigmas: 0 >> configurationFileDeformableRegistration.txt
echo meshSmoothingSigmas: 3 >> configurationFileDeformableRegistration.txt
kvlSegmentWithoutGUI configurationFileDeformableRegistration.txt
m_LogDirectory: deformableRegistrationLog
m_ImageFileName: aseg_thresholded.mgz
m_MeshCollectionFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/CurrentMeshCollection30.gz
m_K: 0.01
m_CompressionLookupTableFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/compressionLookupTable_left.txt
m_BoundingFileName: imageDump_coregistered.mgz
m_SameGaussianParameters[ 0 ]:  17 550 552 553 554 555 556 557
m_SameGaussianParameters[ 1 ]:  24 2 3
m_ImageSmoothingSigmas:  0
m_MeshSmoothingSigmas:  3
Having m_LogDirectorydeformableRegistrationLog/
Having downSamplingFactor of 1
Constructing image-to-world transform from MGH header information (aseg_thresholded.mgz)
Returning the following transform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 224
  Debug: Off
  Observers: 
    none
  Matrix: 
    -1 1.30385e-08 0 
    0 0 1 
    5.96046e-08 -1 0 
  Offset: [127.5, -86.3535, 119.607]
  Center: [0, 0, 0]
  Translation: [127.5, -86.3535, 119.607]
  Inverse: 
    -1 0 5.96046e-08 
    -5.96046e-08 0 -1 
    0 1 0 
  Singular: 0
Constructing image-to-world transform from MGH header information (imageDump_coregistered.mgz)
Returning the following transform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 244
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.398971 0.00449514 -0.00461907 
    0.064218 -0.158981 0.375753 
    -0.000232494 -0.368215 -0.157222 
  Offset: [-39.5683, -5.37696, 4.53862]
  Center: [0, 0, 0]
  Translation: [-39.5683, -5.37696, 4.53862]
  Inverse: 
    2.50053 0.0368533 0.0146143 
    0.153215 -0.96021 -2.29935 
    -0.362527 2.24876 -0.975355 
  Singular: 0
Transform before cropping: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 246
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [167.069, 115.069, 80.9766]
  Center: [0, 0, 0]
  Translation: [167.069, 115.069, 80.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
WorldToImageTransform before cropping: 
AffineTransform (0x232c4e0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 248
  Debug: Off
  Observers: 
    none
  Matrix: 
    -1 0 5.96046e-08 
    -5.96046e-08 0 -1 
    0 1 0 
  Offset: [127.5, 119.607, 86.3535]
  Center: [0, 0, 0]
  Translation: [127.5, 119.607, 86.3535]
  Inverse: 
    -1 -5.96046e-08 0 
    0 0 1 
    5.96046e-08 -1 0 
  Singular: 0
 m_BoundingBoxSize: [94, 66,144]
 minimalMappedCoordinate: [129.672, 115.069,70.6428]
 maximalMappedCoordinate: [167.729, 161.507,140.682]
Cropping with min [126  111  63]
          and max [171  166  148]
m_OriginalImageRegion before checking margins: ImageRegion (0x232c1a0)
  Dimension: 3
  Index: [126, 111, 63]
  Size: [46, 56, 86]

m_CroppedImageRegion before checking margins: ImageRegion (0x232c168)
  Dimension: 3
  Index: [0, 0, 0]
  Size: [46, 56, 86]


m_OriginalImageRegion after checking margins: ImageRegion (0x232c1a0)
  Dimension: 3
  Index: [126, 111, 63]
  Size: [46, 56, 86]

m_CroppedImageRegion after checking margins: ImageRegion (0x232c168)
  Dimension: 3
  Index: [0, 0, 0]
  Size: [46, 56, 86]

Transform after cropping: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
WorldToImageTransform after cropping: 
AffineTransform (0x232c4e0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 390
  Debug: Off
  Observers: 
    none
  Matrix: 
    -1 0 5.96046e-08 
    -5.96046e-08 0 -1 
    0 1 0 
  Offset: [1.50021, 8.60744, 23.3535]
  Center: [0, 0, 0]
  Translation: [1.50021, 8.60744, 23.3535]
  Inverse: 
    -1 -5.96046e-08 0 
    0 0 1 
    5.96046e-08 -1 0 
  Singular: 0
Setting K of mesh collection to: 0.01
Applying transform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Careful here: the applied transformation will turn positive tetrahedra into negative ones.
-0.398971 -0.00449516 0.00461907
0.00023247 0.368215 0.157222
0.064218 -0.158981 0.375753

 determinant: -0.0653276
Starting to swap the point assignments of each tetrahedron...
...done!
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 1
maximum: 255
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
Original class 2 is distributed over 1 classes
Original class 3 is distributed over 1 classes
Original class 4 is distributed over 1 classes
Original class 5 is distributed over 1 classes
Original class 6 is distributed over 1 classes
Original class 7 is distributed over 1 classes
Original class 8 is distributed over 1 classes
Original class 9 is distributed over 1 classes
Original class 10 is distributed over 1 classes
OK
Setting coregisterToPosteriorProbabilities to 0
Setting biasFieldOrder to 0
Building labels...
...done! (m_Labels.size(): 11)
m_InternalToExternalLookupTable: 
    0  -> 0 (Left-Cerebral-White-Matter)
    1  -> 1 (Left-Cerebral-Cortex)
    2  -> 3 (Left-Hippocampus)
    3  -> 2 (CSF)
    4  -> 5 (left_CA2_3)
    5  -> 9 (left_CA1)
    6  -> 4 (left_fimbria)
    7  -> 7 (left_presubiculum)
    8  -> 10 (left_hippocampal_fissure)
    9  -> 6 (left_CA4_DG)
    10  -> 8 (left_subiculum)
m_InternalToReducedLookupTable: 
     0 (Left-Cerebral-White-Matter) -> 1
     1 (Left-Cerebral-Cortex) -> 1
     2 (Left-Hippocampus) -> 0
     3 (CSF) -> 1
     4 (left_CA2_3) -> 0
     5 (left_CA1) -> 0
     6 (left_fimbria) -> 0
     7 (left_presubiculum) -> 0
     8 (left_hippocampal_fissure) -> 0
     9 (left_CA4_DG) -> 0
     10 (left_subiculum) -> 0
original label 0 is distributed over 1 distributed labels
original label 1 is distributed over 1 distributed labels
original label 2 is distributed over 1 distributed labels
original label 3 is distributed over 1 distributed labels
original label 4 is distributed over 1 distributed labels
original label 5 is distributed over 1 distributed labels
original label 6 is distributed over 1 distributed labels
original label 7 is distributed over 1 distributed labels
original label 8 is distributed over 1 distributed labels
original label 9 is distributed over 1 distributed labels
original label 10 is distributed over 1 distributed labels
numberOfReducedLabels: 2
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
OK
Smoothing mesh collection...done!
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 1
maximum: 255
Running for smoothing sigma 3
Starting EM: 
Updating mixture model parameters
Readjusting weight of shared classes
m_Means: [  112.78 14.3645 ]
Splitting shared classes
EM Iteration: 0  ->  295248
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
Setting up m_BiasFieldResidueSmoother
Initalizing
numberOfBasisFunctions: 1
numberOfVoxelsInMask: 221536
indexWhereUnityIsReached [45, 55, 85]
Successfully put up x, y, and z
Constructing basis functions
      (xOrder, yOrder, zOrder): (0, 0, 0)
done!
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  209.977 1.02512 ]
EM Iteration: 1  ->  130418
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  254.514 1.00001 ]
EM Iteration: 2  ->  71437.4
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 3  ->  59595.2
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 4  ->  59595.2
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 4
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 0 was 59595.3
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x623d4a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 1318287
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79756
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221053
...done!
maximalDeformation: 4.38733
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 196364 has managed to turn bad (detJ: -0.496972)
Time taken to rasterize Levenberg-Marquardt: 0.00838399
...done!
=======================
Bad trial move (maximal deformation: 4.38733, lambda: 1)
        Cost going from 59591.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191636
...done!
maximalDeformation: 3.00701
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 289700 has managed to turn bad (detJ: -0.558666)
Time taken to rasterize Levenberg-Marquardt: 0.0135238
...done!
=======================
Bad trial move (maximal deformation: 3.00701, lambda: 2)
        Cost going from 59591.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183349
...done!
maximalDeformation: 1.86288
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 374944 has managed to turn bad (detJ: -0.265966)
Time taken to rasterize Levenberg-Marquardt: 0.024591
...done!
=======================
Bad trial move (maximal deformation: 1.86288, lambda: 4)
        Cost going from 59591.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.203135
...done!
maximalDeformation: 1.05945
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1548879 has managed to turn bad (detJ: -0.0973576)
Time taken to rasterize Levenberg-Marquardt: 0.451927
...done!
=======================
Bad trial move (maximal deformation: 1.05945, lambda: 8)
        Cost going from 59591.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195068
...done!
maximalDeformation: 0.569867
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.80649
...done!
=======================
Good trial move (maximal deformation: 0.569867, lambda: 16)
        Cost going from 59591.8 to 59398.7
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.183739
...done!
maximalDeformation: 0.481059
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62781
...done!
=======================
Good trial move (maximal deformation: 0.481059, lambda: 14.5455)
        Cost going from 59398.7 to 59307.9
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192666
...done!
maximalDeformation: 0.380217
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5646
...done!
=======================
Good trial move (maximal deformation: 0.380217, lambda: 13.2231)
        Cost going from 59307.9 to 59225.1
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.191839
...done!
maximalDeformation: 0.2618
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56566
...done!
=======================
Good trial move (maximal deformation: 0.2618, lambda: 12.021)
        Cost going from 59225.1 to 59149.5
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199291
...done!
maximalDeformation: 0.385372
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57111
...done!
=======================
Good trial move (maximal deformation: 0.385372, lambda: 10.9282)
        Cost going from 59149.5 to 59078.6
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205412
...done!
maximalDeformation: 0.277021
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60584
...done!
=======================
Good trial move (maximal deformation: 0.277021, lambda: 9.93474)
        Cost going from 59078.6 to 59010.7
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217054
...done!
maximalDeformation: 0.331201
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59291
...done!
=======================
Good trial move (maximal deformation: 0.331201, lambda: 9.03158)
        Cost going from 59010.7 to 58946.2
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222191
...done!
maximalDeformation: 2.50959
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1753383 has managed to turn bad (detJ: -0.630158)
Time taken to rasterize Levenberg-Marquardt: 0.549487
...done!
=======================
Bad trial move (maximal deformation: 2.50959, lambda: 8.21053)
        Cost going from 58946.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8.21053 to 16.4211 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Time taken to solve the Levenberg-Marquardt system of equations: 0.20962
...done!
maximalDeformation: 1.34254
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60523
...done!
=======================
Good trial move (maximal deformation: 1.34254, lambda: 16.4211)
        Cost going from 58946.2 to 58915
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228976
...done!
maximalDeformation: 0.27504
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63317
...done!
=======================
Good trial move (maximal deformation: 0.27504, lambda: 14.9282)
        Cost going from 58915 to 58881.6
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222523
...done!
maximalDeformation: 0.225055
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61114
...done!
=======================
Good trial move (maximal deformation: 0.225055, lambda: 13.5711)
        Cost going from 58881.6 to 58848.1
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240808
...done!
maximalDeformation: 0.285936
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63907
...done!
=======================
Good trial move (maximal deformation: 0.285936, lambda: 12.3374)
        Cost going from 58848.1 to 58814.2
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  58636.5
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58636.5
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 1 was 58817.5
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc8b4e40)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 4061786
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49906
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.185389
...done!
maximalDeformation: 4.62079
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 284292 has managed to turn bad (detJ: -0.161292)
Time taken to rasterize Levenberg-Marquardt: 0.0131249
...done!
=======================
Bad trial move (maximal deformation: 4.62079, lambda: 1)
        Cost going from 58814.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180471
...done!
maximalDeformation: 3.03683
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1016806 has managed to turn bad (detJ: -0.403452)
Time taken to rasterize Levenberg-Marquardt: 0.159012
...done!
=======================
Bad trial move (maximal deformation: 3.03683, lambda: 2)
        Cost going from 58814.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182686
...done!
maximalDeformation: 1.81509
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1892168 has managed to turn bad (detJ: -0.0542245)
Time taken to rasterize Levenberg-Marquardt: 0.593132
...done!
=======================
Bad trial move (maximal deformation: 1.81509, lambda: 4)
        Cost going from 58814.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.17535
...done!
maximalDeformation: 1.00696
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50439
...done!
=======================
Good trial move (maximal deformation: 1.00696, lambda: 8)
        Cost going from 58814.2 to 58769.2
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.189354
...done!
maximalDeformation: 0.640149
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52779
...done!
=======================
Good trial move (maximal deformation: 0.640149, lambda: 7.27273)
        Cost going from 58769.2 to 58724.8
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193935
...done!
maximalDeformation: 0.341229
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2405446 has managed to turn bad (detJ: -0.155758)
Time taken to rasterize Levenberg-Marquardt: 1.06649
...done!
=======================
Bad trial move (maximal deformation: 0.341229, lambda: 6.61157)
        Cost going from 58724.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.61157 to 13.2231 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190155
...done!
maximalDeformation: 0.18321
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5264
...done!
=======================
Good trial move (maximal deformation: 0.18321, lambda: 13.2231)
        Cost going from 58724.8 to 58698.4
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.203709
...done!
maximalDeformation: 0.54412
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1426688 has managed to turn bad (detJ: -0.0905737)
Time taken to rasterize Levenberg-Marquardt: 0.335812
...done!
=======================
Bad trial move (maximal deformation: 0.54412, lambda: 12.021)
        Cost going from 58698.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 12.021 to 24.0421 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Time taken to solve the Levenberg-Marquardt system of equations: 0.201859
...done!
maximalDeformation: 0.28166
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54911
...done!
=======================
Good trial move (maximal deformation: 0.28166, lambda: 24.0421)
        Cost going from 58698.4 to 58685
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192025
...done!
maximalDeformation: 0.12933
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54932
...done!
=======================
Good trial move (maximal deformation: 0.12933, lambda: 21.8564)
        Cost going from 58685 to 58671.5
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198055
...done!
maximalDeformation: 0.227873
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55522
...done!
=======================
Good trial move (maximal deformation: 0.227873, lambda: 19.8695)
        Cost going from 58671.5 to 58657.6
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193087
...done!
maximalDeformation: 0.22307
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5393
...done!
=======================
Good trial move (maximal deformation: 0.22307, lambda: 18.0632)
        Cost going from 58657.6 to 58643
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19828
...done!
maximalDeformation: 0.338099
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54874
...done!
=======================
Good trial move (maximal deformation: 0.338099, lambda: 16.4211)
        Cost going from 58643 to 58627.8
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.191076
...done!
maximalDeformation: 0.19135
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5417
...done!
=======================
Good trial move (maximal deformation: 0.19135, lambda: 14.9282)
        Cost going from 58627.8 to 58612.1
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19686
...done!
maximalDeformation: 0.309803
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55122
...done!
=======================
Good trial move (maximal deformation: 0.309803, lambda: 13.5711)
        Cost going from 58612.1 to 58596.2
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195735
...done!
maximalDeformation: 0.57185
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53954
...done!
=======================
Good trial move (maximal deformation: 0.57185, lambda: 12.3374)
        Cost going from 58596.2 to 58579.7
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  58275.8
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58275.8
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 2 was 58583
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xebb9700)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 6805285
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.4752
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.181936
...done!
maximalDeformation: 3.10573
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 255894 has managed to turn bad (detJ: -0.492043)
Time taken to rasterize Levenberg-Marquardt: 0.010427
...done!
=======================
Bad trial move (maximal deformation: 3.10573, lambda: 1)
        Cost going from 58579.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.179129
...done!
maximalDeformation: 1.89351
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 255894 has managed to turn bad (detJ: -0.204295)
Time taken to rasterize Levenberg-Marquardt: 0.0102041
...done!
=======================
Bad trial move (maximal deformation: 1.89351, lambda: 2)
        Cost going from 58579.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.177299
...done!
maximalDeformation: 1.10344
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1016806 has managed to turn bad (detJ: -0.169451)
Time taken to rasterize Levenberg-Marquardt: 0.158039
...done!
=======================
Bad trial move (maximal deformation: 1.10344, lambda: 4)
        Cost going from 58579.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.173473
...done!
maximalDeformation: 0.613268
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48871
...done!
=======================
Good trial move (maximal deformation: 0.613268, lambda: 8)
        Cost going from 58579.7 to 58558.4
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.184109
...done!
maximalDeformation: 0.59868
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1426688 has managed to turn bad (detJ: -0.394402)
Time taken to rasterize Levenberg-Marquardt: 0.320186
...done!
=======================
Bad trial move (maximal deformation: 0.59868, lambda: 7.27273)
        Cost going from 58558.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.27273 to 14.5455 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182581
...done!
maximalDeformation: 0.319593
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49047
...done!
=======================
Good trial move (maximal deformation: 0.319593, lambda: 14.5455)
        Cost going from 58558.4 to 58542.4
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.190077
...done!
maximalDeformation: 0.214421
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53476
...done!
=======================
Good trial move (maximal deformation: 0.214421, lambda: 13.2231)
        Cost going from 58542.4 to 58528.3
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197518
...done!
maximalDeformation: 0.452498
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52051
...done!
=======================
Good trial move (maximal deformation: 0.452498, lambda: 12.021)
        Cost going from 58528.3 to 58515.5
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196357
...done!
maximalDeformation: 0.728708
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5277
...done!
=======================
Good trial move (maximal deformation: 0.728708, lambda: 10.9282)
        Cost going from 58515.5 to 58502.1
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211379
...done!
maximalDeformation: 0.448992
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55177
...done!
=======================
Good trial move (maximal deformation: 0.448992, lambda: 9.93474)
        Cost going from 58502.1 to 58488.6
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212913
...done!
maximalDeformation: 1.05134
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5581
...done!
=======================
Good trial move (maximal deformation: 1.05134, lambda: 9.03158)
        Cost going from 58488.6 to 58474.2
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.227028
...done!
maximalDeformation: 0.672553
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57527
...done!
=======================
Good trial move (maximal deformation: 0.672553, lambda: 8.21053)
        Cost going from 58474.2 to 58461.4
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241027
...done!
maximalDeformation: 0.528664
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57496
...done!
=======================
Good trial move (maximal deformation: 0.528664, lambda: 7.46412)
        Cost going from 58461.4 to 58446.1
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238428
...done!
maximalDeformation: 1.42985
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58515
...done!
=======================
Good trial move (maximal deformation: 1.42985, lambda: 6.78556)
        Cost going from 58446.1 to 58434.7
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23895
...done!
maximalDeformation: 0.660578
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58647
...done!
=======================
Good trial move (maximal deformation: 0.660578, lambda: 6.16869)
        Cost going from 58434.7 to 58423.1
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  57975.4
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57975.4
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 3 was 58426.4
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x259c430)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 9355878
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51602
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.176586
...done!
maximalDeformation: 0.522877
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5012
...done!
=======================
Good trial move (maximal deformation: 0.522877, lambda: 1)
        Cost going from 58423.1 to 58404.9
        Decreasing lambda from 1 to 0.909091
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 0.909091...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199116
...done!
maximalDeformation: 3.22905
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 192803 has managed to turn bad (detJ: -0.0437676)
Time taken to rasterize Levenberg-Marquardt: 0.00819206
...done!
=======================
Bad trial move (maximal deformation: 3.22905, lambda: 0.909091)
        Cost going from 58404.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 0.909091 to 1.81818 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1.81818...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195786
...done!
maximalDeformation: 1.65766
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 284292 has managed to turn bad (detJ: -0.405835)
Time taken to rasterize Levenberg-Marquardt: 0.0130658
...done!
=======================
Bad trial move (maximal deformation: 1.65766, lambda: 1.81818)
        Cost going from 58404.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1.81818 to 3.63636 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 3.63636...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192759
...done!
maximalDeformation: 0.880188
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 864285 has managed to turn bad (detJ: -0.364825)
Time taken to rasterize Levenberg-Marquardt: 0.116744
...done!
=======================
Bad trial move (maximal deformation: 0.880188, lambda: 3.63636)
        Cost going from 58404.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 3.63636 to 7.27273 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191784
...done!
maximalDeformation: 0.481986
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51038
...done!
=======================
Good trial move (maximal deformation: 0.481986, lambda: 7.27273)
        Cost going from 58404.9 to 58395.4
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197585
...done!
maximalDeformation: 0.75925
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52873
...done!
=======================
Good trial move (maximal deformation: 0.75925, lambda: 6.61157)
        Cost going from 58395.4 to 58390.2
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204184
...done!
maximalDeformation: 0.743465
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2514106 has managed to turn bad (detJ: -0.126045)
Time taken to rasterize Levenberg-Marquardt: 1.19045
...done!
=======================
Bad trial move (maximal deformation: 0.743465, lambda: 6.01052)
        Cost going from 58390.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.01052 to 12.021 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196131
...done!
maximalDeformation: 0.426572
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51139
...done!
=======================
Good trial move (maximal deformation: 0.426572, lambda: 12.021)
        Cost going from 58390.2 to 58372.7
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.188733
...done!
maximalDeformation: 0.327414
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51167
...done!
=======================
Good trial move (maximal deformation: 0.327414, lambda: 10.9282)
        Cost going from 58372.7 to 58363.4
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205854
...done!
maximalDeformation: 0.658316
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53725
...done!
=======================
Good trial move (maximal deformation: 0.658316, lambda: 9.93474)
        Cost going from 58363.4 to 58358.9
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199853
...done!
maximalDeformation: 0.541716
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5238
...done!
=======================
Good trial move (maximal deformation: 0.541716, lambda: 9.03158)
        Cost going from 58358.9 to 58352.9
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219444
...done!
maximalDeformation: 0.547131
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5566
...done!
=======================
Good trial move (maximal deformation: 0.547131, lambda: 8.21053)
        Cost going from 58352.9 to 58346.9
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214727
...done!
maximalDeformation: 0.592768
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55339
...done!
=======================
Good trial move (maximal deformation: 0.592768, lambda: 7.46412)
        Cost going from 58346.9 to 58341.6
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234595
...done!
maximalDeformation: 0.549436
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58596
...done!
=======================
Good trial move (maximal deformation: 0.549436, lambda: 6.78556)
        Cost going from 58341.6 to 58335.7
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228036
...done!
maximalDeformation: 0.90128
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2347341 has managed to turn bad (detJ: -0.13797)
Time taken to rasterize Levenberg-Marquardt: 1.02836
...done!
=======================
Bad trial move (maximal deformation: 0.90128, lambda: 6.16869)
        Cost going from 58335.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.16869 to 12.3374 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Time taken to solve the Levenberg-Marquardt system of equations: 0.216281
...done!
maximalDeformation: 0.512403
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54788
...done!
=======================
Good trial move (maximal deformation: 0.512403, lambda: 12.3374)
        Cost going from 58335.7 to 58321.9
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  57809.2
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57809.2
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 4 was 58325.1
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x946ecf0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 12099377
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53531
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19338
...done!
maximalDeformation: 4.2541
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 255894 has managed to turn bad (detJ: -0.315943)
Time taken to rasterize Levenberg-Marquardt: 0.0110109
...done!
=======================
Bad trial move (maximal deformation: 4.2541, lambda: 1)
        Cost going from 58321.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189901
...done!
maximalDeformation: 2.54427
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 255894 has managed to turn bad (detJ: -0.186369)
Time taken to rasterize Levenberg-Marquardt: 0.010474
...done!
=======================
Bad trial move (maximal deformation: 2.54427, lambda: 2)
        Cost going from 58321.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183186
...done!
maximalDeformation: 1.61456
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 960779 has managed to turn bad (detJ: -0.125315)
Time taken to rasterize Levenberg-Marquardt: 0.141251
...done!
=======================
Bad trial move (maximal deformation: 1.61456, lambda: 4)
        Cost going from 58321.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181116
...done!
maximalDeformation: 0.96653
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48617
...done!
=======================
Bad trial move (maximal deformation: 0.96653, lambda: 8)
        Cost going from 58321.9 to 58325.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.178162
...done!
maximalDeformation: 0.543357
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.4855
...done!
=======================
Good trial move (maximal deformation: 0.543357, lambda: 16)
        Cost going from 58321.9 to 58315.6
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198502
...done!
maximalDeformation: 0.500333
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5323
...done!
=======================
Good trial move (maximal deformation: 0.500333, lambda: 14.5455)
        Cost going from 58315.6 to 58312.2
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193868
...done!
maximalDeformation: 0.487824
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51491
...done!
=======================
Good trial move (maximal deformation: 0.487824, lambda: 13.2231)
        Cost going from 58312.2 to 58308.1
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207693
...done!
maximalDeformation: 0.383062
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54864
...done!
=======================
Good trial move (maximal deformation: 0.383062, lambda: 12.021)
        Cost going from 58308.1 to 58305
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205056
...done!
maximalDeformation: 0.731643
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54935
...done!
=======================
Good trial move (maximal deformation: 0.731643, lambda: 10.9282)
        Cost going from 58305 to 58302.7
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222272
...done!
maximalDeformation: 0.690599
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56072
...done!
=======================
Good trial move (maximal deformation: 0.690599, lambda: 9.93474)
        Cost going from 58302.7 to 58299.7
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221456
...done!
maximalDeformation: 0.450925
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56589
...done!
=======================
Good trial move (maximal deformation: 0.450925, lambda: 9.03158)
        Cost going from 58299.7 to 58295.1
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235376
...done!
maximalDeformation: 0.725159
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58989
...done!
=======================
Good trial move (maximal deformation: 0.725159, lambda: 8.21053)
        Cost going from 58295.1 to 58293.9
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234958
...done!
maximalDeformation: 0.943392
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5823
...done!
=======================
Good trial move (maximal deformation: 0.943392, lambda: 7.46412)
        Cost going from 58293.9 to 58291.1
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24293
...done!
maximalDeformation: 0.91715
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59798
...done!
=======================
Bad trial move (maximal deformation: 0.91715, lambda: 6.78556)
        Cost going from 58291.1 to 58292.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.78556 to 13.5711 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Time taken to solve the Levenberg-Marquardt system of equations: 0.243747
...done!
maximalDeformation: 0.53501
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66234
...done!
=======================
Good trial move (maximal deformation: 0.53501, lambda: 13.5711)
        Cost going from 58291.1 to 58280
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240355
...done!
maximalDeformation: 0.494114
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58957
...done!
=======================
Good trial move (maximal deformation: 0.494114, lambda: 12.3374)
        Cost going from 58280 to 58275.1
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  57723.7
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57723.7
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 5 was 58278.4
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x7fb8160)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 14842876
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55439
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195239
...done!
maximalDeformation: 3.68217
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 284292 has managed to turn bad (detJ: -0.400818)
Time taken to rasterize Levenberg-Marquardt: 0.0136399
...done!
=======================
Bad trial move (maximal deformation: 3.68217, lambda: 1)
        Cost going from 58275.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189934
...done!
maximalDeformation: 2.41995
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 284292 has managed to turn bad (detJ: -0.0399329)
Time taken to rasterize Levenberg-Marquardt: 0.0127599
...done!
=======================
Bad trial move (maximal deformation: 2.41995, lambda: 2)
        Cost going from 58275.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18752
...done!
maximalDeformation: 1.41854
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1000534 has managed to turn bad (detJ: -0.0902782)
Time taken to rasterize Levenberg-Marquardt: 0.155629
...done!
=======================
Bad trial move (maximal deformation: 1.41854, lambda: 4)
        Cost going from 58275.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187506
...done!
maximalDeformation: 0.799906
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49928
...done!
=======================
Bad trial move (maximal deformation: 0.799906, lambda: 8)
        Cost going from 58275.1 to 58278.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185433
...done!
maximalDeformation: 0.430054
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49367
...done!
=======================
Good trial move (maximal deformation: 0.430054, lambda: 16)
        Cost going from 58275.1 to 58271.3
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201315
...done!
maximalDeformation: 0.527557
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55256
...done!
=======================
Good trial move (maximal deformation: 0.527557, lambda: 14.5455)
        Cost going from 58271.3 to 58269.2
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200399
...done!
maximalDeformation: 0.380642
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52859
...done!
=======================
Good trial move (maximal deformation: 0.380642, lambda: 13.2231)
        Cost going from 58269.2 to 58267.4
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21237
...done!
maximalDeformation: 0.650559
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56273
...done!
=======================
Good trial move (maximal deformation: 0.650559, lambda: 12.021)
        Cost going from 58267.4 to 58266.7
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210274
...done!
maximalDeformation: 0.629732
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5531
...done!
=======================
Good trial move (maximal deformation: 0.629732, lambda: 10.9282)
        Cost going from 58266.7 to 58264.5
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224519
...done!
maximalDeformation: 0.545435
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57121
...done!
=======================
Good trial move (maximal deformation: 0.545435, lambda: 9.93474)
        Cost going from 58264.5 to 58261.5
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226026
...done!
maximalDeformation: 0.682177
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57485
...done!
=======================
Bad trial move (maximal deformation: 0.682177, lambda: 9.03158)
        Cost going from 58261.5 to 58262.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 9.03158 to 18.0632 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Time taken to solve the Levenberg-Marquardt system of equations: 0.23238
...done!
maximalDeformation: 0.362273
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5761
...done!
=======================
Good trial move (maximal deformation: 0.362273, lambda: 18.0632)
        Cost going from 58261.5 to 58255.2
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236002
...done!
maximalDeformation: 0.583601
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58963
...done!
=======================
Good trial move (maximal deformation: 0.583601, lambda: 16.4211)
        Cost going from 58255.2 to 58252.4
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240714
...done!
maximalDeformation: 0.352006
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59398
...done!
=======================
Good trial move (maximal deformation: 0.352006, lambda: 14.9282)
        Cost going from 58252.4 to 58251.2
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245787
...done!
maximalDeformation: 1.10587
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60278
...done!
=======================
Good trial move (maximal deformation: 1.10587, lambda: 13.5711)
        Cost going from 58251.2 to 58250.8
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249822
...done!
maximalDeformation: 0.605766
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6296
...done!
=======================
Good trial move (maximal deformation: 0.605766, lambda: 12.3374)
        Cost going from 58250.8 to 58250.4
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  57673.5
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57673.5
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 6 was 58253.6
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x90d7800)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 17586375
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58343
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196393
...done!
maximalDeformation: 4.95126
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -0.000985082)
Time taken to rasterize Levenberg-Marquardt: 0.00816703
...done!
=======================
Bad trial move (maximal deformation: 4.95126, lambda: 1)
        Cost going from 58250.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191857
...done!
maximalDeformation: 3.29981
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 255894 has managed to turn bad (detJ: -0.176154)
Time taken to rasterize Levenberg-Marquardt: 0.010798
...done!
=======================
Bad trial move (maximal deformation: 3.29981, lambda: 2)
        Cost going from 58250.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187562
...done!
maximalDeformation: 2.04851
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 594812 has managed to turn bad (detJ: -0.0450441)
Time taken to rasterize Levenberg-Marquardt: 0.0523891
...done!
=======================
Bad trial move (maximal deformation: 2.04851, lambda: 4)
        Cost going from 58250.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185203
...done!
maximalDeformation: 1.17632
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49207
...done!
=======================
Bad trial move (maximal deformation: 1.17632, lambda: 8)
        Cost going from 58250.4 to 58255.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183753
...done!
maximalDeformation: 0.63945
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49299
...done!
=======================
Good trial move (maximal deformation: 0.63945, lambda: 16)
        Cost going from 58250.4 to 58245.6
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201171
...done!
maximalDeformation: 0.289741
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54492
...done!
=======================
Good trial move (maximal deformation: 0.289741, lambda: 14.5455)
        Cost going from 58245.6 to 58243.1
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196577
...done!
maximalDeformation: 0.418601
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52497
...done!
=======================
Bad trial move (maximal deformation: 0.418601, lambda: 13.2231)
        Cost going from 58243.1 to 58243.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.2231 to 26.4463 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Time taken to solve the Levenberg-Marquardt system of equations: 0.199574
...done!
maximalDeformation: 0.219997
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52506
...done!
=======================
Good trial move (maximal deformation: 0.219997, lambda: 26.4463)
        Cost going from 58243.1 to 58240.3
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208091
...done!
maximalDeformation: 0.258593
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55792
...done!
=======================
Good trial move (maximal deformation: 0.258593, lambda: 24.0421)
        Cost going from 58240.3 to 58238.9
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206185
...done!
maximalDeformation: 0.360094
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5478
...done!
=======================
Good trial move (maximal deformation: 0.360094, lambda: 21.8564)
        Cost going from 58238.9 to 58238.4
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222591
...done!
maximalDeformation: 0.28904
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58036
...done!
=======================
Good trial move (maximal deformation: 0.28904, lambda: 19.8695)
        Cost going from 58238.4 to 58237
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221259
...done!
maximalDeformation: 0.437643
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5753
...done!
=======================
Good trial move (maximal deformation: 0.437643, lambda: 18.0632)
        Cost going from 58237 to 58236.7
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234464
...done!
maximalDeformation: 0.319378
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59945
...done!
=======================
Good trial move (maximal deformation: 0.319378, lambda: 16.4211)
        Cost going from 58236.7 to 58234.9
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23332
...done!
maximalDeformation: 0.505452
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58979
...done!
=======================
Bad trial move (maximal deformation: 0.505452, lambda: 14.9282)
        Cost going from 58234.9 to 58235
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.9282 to 29.8565 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Time taken to solve the Levenberg-Marquardt system of equations: 0.234463
...done!
maximalDeformation: 0.266799
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57195
...done!
=======================
Good trial move (maximal deformation: 0.266799, lambda: 29.8565)
        Cost going from 58234.9 to 58232.6
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242588
...done!
maximalDeformation: 0.350843
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60536
...done!
=======================
Good trial move (maximal deformation: 0.350843, lambda: 27.1422)
        Cost going from 58232.6 to 58231.6
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240443
...done!
maximalDeformation: 0.343921
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60507
...done!
=======================
Good trial move (maximal deformation: 0.343921, lambda: 24.6748)
        Cost going from 58231.6 to 58230.9
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  57647.6
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57647.6
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 7 was 58234.2
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xe3308a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 20522780
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55037
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195843
...done!
maximalDeformation: 4.89445
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 336581 has managed to turn bad (detJ: -0.162748)
Time taken to rasterize Levenberg-Marquardt: 0.017987
...done!
=======================
Bad trial move (maximal deformation: 4.89445, lambda: 1)
        Cost going from 58230.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190865
...done!
maximalDeformation: 3.0005
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 697719 has managed to turn bad (detJ: -0.668926)
Time taken to rasterize Levenberg-Marquardt: 0.0749092
...done!
=======================
Bad trial move (maximal deformation: 3.0005, lambda: 2)
        Cost going from 58230.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18674
...done!
maximalDeformation: 1.73147
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 697719 has managed to turn bad (detJ: -0.146025)
Time taken to rasterize Levenberg-Marquardt: 0.0741749
...done!
=======================
Bad trial move (maximal deformation: 1.73147, lambda: 4)
        Cost going from 58230.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184594
...done!
maximalDeformation: 0.945369
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2347341 has managed to turn bad (detJ: -0.144587)
Time taken to rasterize Levenberg-Marquardt: 0.976429
...done!
=======================
Bad trial move (maximal deformation: 0.945369, lambda: 8)
        Cost going from 58230.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184962
...done!
maximalDeformation: 0.495557
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51267
...done!
=======================
Bad trial move (maximal deformation: 0.495557, lambda: 16)
        Cost going from 58230.9 to 58231.1
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.197424
...done!
maximalDeformation: 0.254579
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53903
...done!
=======================
Good trial move (maximal deformation: 0.254579, lambda: 32)
        Cost going from 58230.9 to 58229.5
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207397
...done!
maximalDeformation: 0.207611
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55459
...done!
=======================
Good trial move (maximal deformation: 0.207611, lambda: 29.0909)
        Cost going from 58229.5 to 58228.8
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207846
...done!
maximalDeformation: 0.462954
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57086
...done!
=======================
Good trial move (maximal deformation: 0.462954, lambda: 26.4463)
        Cost going from 58228.8 to 58228.5
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.216472
...done!
maximalDeformation: 0.301041
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57219
...done!
=======================
Good trial move (maximal deformation: 0.301041, lambda: 24.0421)
        Cost going from 58228.5 to 58227.6
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22203
...done!
maximalDeformation: 0.399954
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5979
...done!
=======================
Good trial move (maximal deformation: 0.399954, lambda: 21.8564)
        Cost going from 58227.6 to 58227
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230044
...done!
maximalDeformation: 0.420794
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59326
...done!
=======================
Good trial move (maximal deformation: 0.420794, lambda: 19.8695)
        Cost going from 58227 to 58226.5
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236371
...done!
maximalDeformation: 0.345423
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61546
...done!
=======================
Good trial move (maximal deformation: 0.345423, lambda: 18.0632)
        Cost going from 58226.5 to 58225.6
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241201
...done!
maximalDeformation: 0.323347
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60996
...done!
=======================
Good trial move (maximal deformation: 0.323347, lambda: 16.4211)
        Cost going from 58225.6 to 58225.3
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247211
...done!
maximalDeformation: 0.386758
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61867
...done!
=======================
Good trial move (maximal deformation: 0.386758, lambda: 14.9282)
        Cost going from 58225.3 to 58223.7
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251916
...done!
maximalDeformation: 0.528282
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61992
...done!
=======================
Bad trial move (maximal deformation: 0.528282, lambda: 13.5711)
        Cost going from 58223.7 to 58224.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.5711 to 27.1422 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Time taken to solve the Levenberg-Marquardt system of equations: 0.254831
...done!
maximalDeformation: 0.281618
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61382
...done!
=======================
Good trial move (maximal deformation: 0.281618, lambda: 27.1422)
        Cost going from 58223.7 to 58220.9
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.255981
...done!
maximalDeformation: 0.413214
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62999
...done!
=======================
Good trial move (maximal deformation: 0.413214, lambda: 24.6748)
        Cost going from 58220.9 to 58220.1
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  57626.3
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57626.3
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 8 was 58223.3
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x24a9f90)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 23459185
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56125
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198062
...done!
maximalDeformation: 3.80406
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.812396)
Time taken to rasterize Levenberg-Marquardt: 0.0372751
...done!
=======================
Bad trial move (maximal deformation: 3.80406, lambda: 1)
        Cost going from 58220.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192609
...done!
maximalDeformation: 2.44867
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 572105 has managed to turn bad (detJ: -0.00556126)
Time taken to rasterize Levenberg-Marquardt: 0.0483432
...done!
=======================
Bad trial move (maximal deformation: 2.44867, lambda: 2)
        Cost going from 58220.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190173
...done!
maximalDeformation: 1.51612
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 594812 has managed to turn bad (detJ: -0.00792059)
Time taken to rasterize Levenberg-Marquardt: 0.0523589
...done!
=======================
Bad trial move (maximal deformation: 1.51612, lambda: 4)
        Cost going from 58220.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186263
...done!
maximalDeformation: 0.872602
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2317342 has managed to turn bad (detJ: -0.0140556)
Time taken to rasterize Levenberg-Marquardt: 0.944941
...done!
=======================
Bad trial move (maximal deformation: 0.872602, lambda: 8)
        Cost going from 58220.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186375
...done!
maximalDeformation: 0.47537
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2402914 has managed to turn bad (detJ: -0.14479)
Time taken to rasterize Levenberg-Marquardt: 1.03133
...done!
=======================
Bad trial move (maximal deformation: 0.47537, lambda: 16)
        Cost going from 58220.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184156
...done!
maximalDeformation: 0.259185
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49412
...done!
=======================
Good trial move (maximal deformation: 0.259185, lambda: 32)
        Cost going from 58220.1 to 58218.9
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20111
...done!
maximalDeformation: 0.282982
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53112
...done!
=======================
Good trial move (maximal deformation: 0.282982, lambda: 29.0909)
        Cost going from 58218.9 to 58218.2
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196554
...done!
maximalDeformation: 0.342199
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52743
...done!
=======================
Good trial move (maximal deformation: 0.342199, lambda: 26.4463)
        Cost going from 58218.2 to 58218.1
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210687
...done!
maximalDeformation: 0.385396
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58383
...done!
=======================
Good trial move (maximal deformation: 0.385396, lambda: 24.0421)
        Cost going from 58218.1 to 58217.4
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209517
...done!
maximalDeformation: 0.349435
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55128
...done!
=======================
Good trial move (maximal deformation: 0.349435, lambda: 21.8564)
        Cost going from 58217.4 to 58217
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225412
...done!
maximalDeformation: 0.411754
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57712
...done!
=======================
Good trial move (maximal deformation: 0.411754, lambda: 19.8695)
        Cost going from 58217 to 58216.1
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225039
...done!
maximalDeformation: 0.400325
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57925
...done!
=======================
Bad trial move (maximal deformation: 0.400325, lambda: 18.0632)
        Cost going from 58216.1 to 58216.1
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.231783
...done!
maximalDeformation: 0.217682
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56721
...done!
=======================
Good trial move (maximal deformation: 0.217682, lambda: 36.1263)
        Cost going from 58216.1 to 58214.3
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23733
...done!
maximalDeformation: 0.190377
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59574
...done!
=======================
Good trial move (maximal deformation: 0.190377, lambda: 32.8421)
        Cost going from 58214.3 to 58213.5
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238685
...done!
maximalDeformation: 0.29712
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59928
...done!
=======================
Good trial move (maximal deformation: 0.29712, lambda: 29.8565)
        Cost going from 58213.5 to 58213.4
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246961
...done!
maximalDeformation: 0.274731
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6053
...done!
=======================
Good trial move (maximal deformation: 0.274731, lambda: 27.1422)
        Cost going from 58213.4 to 58212.9
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251987
...done!
maximalDeformation: 0.356778
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61404
...done!
=======================
Good trial move (maximal deformation: 0.356778, lambda: 24.6748)
        Cost going from 58212.9 to 58212.6
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  57611.3
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57611.3
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 9 was 58215.9
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xcaa6b00)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 26395590
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57059
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199831
...done!
maximalDeformation: 4.14264
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 276946 has managed to turn bad (detJ: -0.246186)
Time taken to rasterize Levenberg-Marquardt: 0.01299
...done!
=======================
Bad trial move (maximal deformation: 4.14264, lambda: 1)
        Cost going from 58212.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.197182
...done!
maximalDeformation: 2.59032
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 549406 has managed to turn bad (detJ: -0.768997)
Time taken to rasterize Levenberg-Marquardt: 0.044821
...done!
=======================
Bad trial move (maximal deformation: 2.59032, lambda: 2)
        Cost going from 58212.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191476
...done!
maximalDeformation: 1.53439
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 549406 has managed to turn bad (detJ: -0.0759072)
Time taken to rasterize Levenberg-Marquardt: 0.0446539
...done!
=======================
Bad trial move (maximal deformation: 1.53439, lambda: 4)
        Cost going from 58212.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189148
...done!
maximalDeformation: 0.858445
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 960779 has managed to turn bad (detJ: -0.0916207)
Time taken to rasterize Levenberg-Marquardt: 0.1435
...done!
=======================
Bad trial move (maximal deformation: 0.858445, lambda: 8)
        Cost going from 58212.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18905
...done!
maximalDeformation: 0.458332
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50181
...done!
=======================
Bad trial move (maximal deformation: 0.458332, lambda: 16)
        Cost going from 58212.6 to 58213.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187066
...done!
maximalDeformation: 0.238038
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49332
...done!
=======================
Good trial move (maximal deformation: 0.238038, lambda: 32)
        Cost going from 58212.6 to 58211.1
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202616
...done!
maximalDeformation: 0.3107
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54104
...done!
=======================
Good trial move (maximal deformation: 0.3107, lambda: 29.0909)
        Cost going from 58211.1 to 58210.7
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198331
...done!
maximalDeformation: 0.317248
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53166
...done!
=======================
Good trial move (maximal deformation: 0.317248, lambda: 26.4463)
        Cost going from 58210.7 to 58210.4
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211818
...done!
maximalDeformation: 0.389835
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56265
...done!
=======================
Good trial move (maximal deformation: 0.389835, lambda: 24.0421)
        Cost going from 58210.4 to 58210
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213323
...done!
maximalDeformation: 0.4961
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56052
...done!
=======================
Bad trial move (maximal deformation: 0.4961, lambda: 21.8564)
        Cost going from 58210 to 58210.1
Transforming mesh
Done transforming mesh
        Increasing lambda from 21.8564 to 43.7129 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Time taken to solve the Levenberg-Marquardt system of equations: 0.216972
...done!
maximalDeformation: 0.265418
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55337
...done!
=======================
Good trial move (maximal deformation: 0.265418, lambda: 43.7129)
        Cost going from 58210 to 58208.7
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225364
...done!
maximalDeformation: 0.258262
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57617
...done!
=======================
Good trial move (maximal deformation: 0.258262, lambda: 39.739)
        Cost going from 58208.7 to 58208.1
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225134
...done!
maximalDeformation: 0.224306
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58421
...done!
=======================
Good trial move (maximal deformation: 0.224306, lambda: 36.1263)
        Cost going from 58208.1 to 58207.7
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236227
...done!
maximalDeformation: 0.31026
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59779
...done!
=======================
Good trial move (maximal deformation: 0.31026, lambda: 32.8421)
        Cost going from 58207.7 to 58207.4
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232628
...done!
maximalDeformation: 0.347242
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60407
...done!
=======================
Good trial move (maximal deformation: 0.347242, lambda: 29.8565)
        Cost going from 58207.4 to 58207.1
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246188
...done!
maximalDeformation: 0.380529
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61594
...done!
=======================
Good trial move (maximal deformation: 0.380529, lambda: 27.1422)
        Cost going from 58207.1 to 58206.8
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246162
...done!
maximalDeformation: 0.331522
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60721
...done!
=======================
Good trial move (maximal deformation: 0.331522, lambda: 24.6748)
        Cost going from 58206.8 to 58206.4
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  57598.9
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57598.9
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 10 was 58209.7
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xe4473a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 29331995
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5616
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200358
...done!
maximalDeformation: 4.00599
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -3.04531)
Time taken to rasterize Levenberg-Marquardt: 0.022933
...done!
=======================
Bad trial move (maximal deformation: 4.00599, lambda: 1)
        Cost going from 58206.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19476
...done!
maximalDeformation: 2.57871
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -1.85779)
Time taken to rasterize Levenberg-Marquardt: 0.0222092
...done!
=======================
Bad trial move (maximal deformation: 2.57871, lambda: 2)
        Cost going from 58206.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190244
...done!
maximalDeformation: 1.55826
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -0.762189)
Time taken to rasterize Levenberg-Marquardt: 0.0221691
...done!
=======================
Bad trial move (maximal deformation: 1.55826, lambda: 4)
        Cost going from 58206.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187855
...done!
maximalDeformation: 0.88757
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49432
...done!
=======================
Bad trial move (maximal deformation: 0.88757, lambda: 8)
        Cost going from 58206.4 to 58226.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187126
...done!
maximalDeformation: 0.482827
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48941
...done!
=======================
Bad trial move (maximal deformation: 0.482827, lambda: 16)
        Cost going from 58206.4 to 58208.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184881
...done!
maximalDeformation: 0.261296
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49756
...done!
=======================
Good trial move (maximal deformation: 0.261296, lambda: 32)
        Cost going from 58206.4 to 58205.2
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199905
...done!
maximalDeformation: 0.346418
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53845
...done!
=======================
Good trial move (maximal deformation: 0.346418, lambda: 29.0909)
        Cost going from 58205.2 to 58204.8
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196256
...done!
maximalDeformation: 0.362278
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52754
...done!
=======================
Good trial move (maximal deformation: 0.362278, lambda: 26.4463)
        Cost going from 58204.8 to 58204.4
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210325
...done!
maximalDeformation: 0.391311
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56588
...done!
=======================
Good trial move (maximal deformation: 0.391311, lambda: 24.0421)
        Cost going from 58204.4 to 58204.2
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211105
...done!
maximalDeformation: 0.403832
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55743
...done!
=======================
Good trial move (maximal deformation: 0.403832, lambda: 21.8564)
        Cost going from 58204.2 to 58204.1
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225497
...done!
maximalDeformation: 0.43213
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57385
...done!
=======================
Good trial move (maximal deformation: 0.43213, lambda: 19.8695)
        Cost going from 58204.1 to 58203.7
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224778
...done!
maximalDeformation: 0.725471
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2347341 has managed to turn bad (detJ: -0.581524)
Time taken to rasterize Levenberg-Marquardt: 1.03422
...done!
=======================
Bad trial move (maximal deformation: 0.725471, lambda: 18.0632)
        Cost going from 58203.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.217599
...done!
maximalDeformation: 0.376052
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57176
...done!
=======================
Good trial move (maximal deformation: 0.376052, lambda: 36.1263)
        Cost going from 58203.7 to 58201.7
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235922
...done!
maximalDeformation: 0.245929
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59276
...done!
=======================
Good trial move (maximal deformation: 0.245929, lambda: 32.8421)
        Cost going from 58201.7 to 58200.9
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232823
...done!
maximalDeformation: 0.240318
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5913
...done!
=======================
Bad trial move (maximal deformation: 0.240318, lambda: 29.8565)
        Cost going from 58200.9 to 58201
Transforming mesh
Done transforming mesh
        Increasing lambda from 29.8565 to 59.7129 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Time taken to solve the Levenberg-Marquardt system of equations: 0.2205
...done!
maximalDeformation: 0.123911
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5663
...done!
=======================
Good trial move (maximal deformation: 0.123911, lambda: 59.7129)
        Cost going from 58200.9 to 58200.4
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242833
...done!
maximalDeformation: 0.255824
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60561
...done!
=======================
Good trial move (maximal deformation: 0.255824, lambda: 54.2845)
        Cost going from 58200.4 to 58200
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231776
...done!
maximalDeformation: 0.180855
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58755
...done!
=======================
Good trial move (maximal deformation: 0.180855, lambda: 49.3495)
        Cost going from 58200 to 58199.7
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57587.5
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57587.5
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 11 was 58203
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xe96dd00)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 32461306
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56353
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198426
...done!
maximalDeformation: 3.14506
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 336581 has managed to turn bad (detJ: -0.206475)
Time taken to rasterize Levenberg-Marquardt: 0.0178449
...done!
=======================
Bad trial move (maximal deformation: 3.14506, lambda: 1)
        Cost going from 58199.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192266
...done!
maximalDeformation: 2.08634
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -1.99097)
Time taken to rasterize Levenberg-Marquardt: 0.0222878
...done!
=======================
Bad trial move (maximal deformation: 2.08634, lambda: 2)
        Cost going from 58199.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.199405
...done!
maximalDeformation: 1.26262
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -0.585105)
Time taken to rasterize Levenberg-Marquardt: 0.0229568
...done!
=======================
Bad trial move (maximal deformation: 1.26262, lambda: 4)
        Cost going from 58199.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208649
...done!
maximalDeformation: 0.712849
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5469
...done!
=======================
Bad trial move (maximal deformation: 0.712849, lambda: 8)
        Cost going from 58199.7 to 58216.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.211174
...done!
maximalDeformation: 0.380249
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53627
...done!
=======================
Bad trial move (maximal deformation: 0.380249, lambda: 16)
        Cost going from 58199.7 to 58203.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.209119
...done!
maximalDeformation: 0.197404
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54229
...done!
=======================
Bad trial move (maximal deformation: 0.197404, lambda: 32)
        Cost going from 58199.7 to 58200
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195144
...done!
maximalDeformation: 0.100618
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52247
...done!
=======================
Good trial move (maximal deformation: 0.100618, lambda: 64)
        Cost going from 58199.7 to 58199.4
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206184
...done!
maximalDeformation: 0.25707
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55867
...done!
=======================
Good trial move (maximal deformation: 0.25707, lambda: 58.1818)
        Cost going from 58199.4 to 58199.2
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206711
...done!
maximalDeformation: 0.156017
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55154
...done!
=======================
Good trial move (maximal deformation: 0.156017, lambda: 52.8926)
        Cost going from 58199.2 to 58198.9
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218673
...done!
maximalDeformation: 0.216148
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5737
...done!
=======================
Good trial move (maximal deformation: 0.216148, lambda: 48.0841)
        Cost going from 58198.9 to 58198.7
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220229
...done!
maximalDeformation: 0.231852
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56875
...done!
=======================
Good trial move (maximal deformation: 0.231852, lambda: 43.7129)
        Cost going from 58198.7 to 58198.6
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230343
...done!
maximalDeformation: 0.258468
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59016
...done!
=======================
Good trial move (maximal deformation: 0.258468, lambda: 39.739)
        Cost going from 58198.6 to 58198.3
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232043
...done!
maximalDeformation: 0.315525
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5921
...done!
=======================
Good trial move (maximal deformation: 0.315525, lambda: 36.1263)
        Cost going from 58198.3 to 58198
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241227
...done!
maximalDeformation: 0.330631
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61295
...done!
=======================
Good trial move (maximal deformation: 0.330631, lambda: 32.8421)
        Cost going from 58198 to 58197.8
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242375
...done!
maximalDeformation: 0.286605
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60435
...done!
=======================
Good trial move (maximal deformation: 0.286605, lambda: 29.8565)
        Cost going from 58197.8 to 58197.6
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249385
...done!
maximalDeformation: 0.352536
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61042
...done!
=======================
Good trial move (maximal deformation: 0.352536, lambda: 27.1422)
        Cost going from 58197.6 to 58197.4
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251322
...done!
maximalDeformation: 0.405536
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6134
...done!
=======================
Good trial move (maximal deformation: 0.405536, lambda: 24.6748)
        Cost going from 58197.4 to 58196.9
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  57579.1
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57579.1
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 12 was 58200.2
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x7beebf0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 35397711
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55818
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198859
...done!
maximalDeformation: 4.29226
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 213265 has managed to turn bad (detJ: -0.0764589)
Time taken to rasterize Levenberg-Marquardt: 0.00945902
...done!
=======================
Bad trial move (maximal deformation: 4.29226, lambda: 1)
        Cost going from 58196.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195495
...done!
maximalDeformation: 2.59017
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 549406 has managed to turn bad (detJ: -0.565254)
Time taken to rasterize Levenberg-Marquardt: 0.044781
...done!
=======================
Bad trial move (maximal deformation: 2.59017, lambda: 2)
        Cost going from 58196.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190835
...done!
maximalDeformation: 1.49205
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 697719 has managed to turn bad (detJ: -0.39602)
Time taken to rasterize Levenberg-Marquardt: 0.0745549
...done!
=======================
Bad trial move (maximal deformation: 1.49205, lambda: 4)
        Cost going from 58196.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189145
...done!
maximalDeformation: 0.876049
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1904048 has managed to turn bad (detJ: -1.85767)
Time taken to rasterize Levenberg-Marquardt: 0.602192
...done!
=======================
Bad trial move (maximal deformation: 0.876049, lambda: 8)
        Cost going from 58196.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187733
...done!
maximalDeformation: 0.484046
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1904048 has managed to turn bad (detJ: -0.224839)
Time taken to rasterize Levenberg-Marquardt: 0.601071
...done!
=======================
Bad trial move (maximal deformation: 0.484046, lambda: 16)
        Cost going from 58196.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187553
...done!
maximalDeformation: 0.255273
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49522
...done!
=======================
Good trial move (maximal deformation: 0.255273, lambda: 32)
        Cost going from 58196.9 to 58195.9
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20273
...done!
maximalDeformation: 0.345404
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53338
...done!
=======================
Good trial move (maximal deformation: 0.345404, lambda: 29.0909)
        Cost going from 58195.9 to 58195.4
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196819
...done!
maximalDeformation: 0.454221
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52662
...done!
=======================
Bad trial move (maximal deformation: 0.454221, lambda: 26.4463)
        Cost going from 58195.4 to 58195.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 26.4463 to 52.8926 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Time taken to solve the Levenberg-Marquardt system of equations: 0.20835
...done!
maximalDeformation: 0.236909
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54617
...done!
=======================
Good trial move (maximal deformation: 0.236909, lambda: 52.8926)
        Cost going from 58195.4 to 58194.5
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217792
...done!
maximalDeformation: 0.248762
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55324
...done!
=======================
Good trial move (maximal deformation: 0.248762, lambda: 48.0841)
        Cost going from 58194.5 to 58194.3
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218809
...done!
maximalDeformation: 0.20649
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57778
...done!
=======================
Good trial move (maximal deformation: 0.20649, lambda: 43.7129)
        Cost going from 58194.3 to 58194.1
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226774
...done!
maximalDeformation: 0.238933
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58131
...done!
=======================
Good trial move (maximal deformation: 0.238933, lambda: 39.739)
        Cost going from 58194.1 to 58193.8
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232035
...done!
maximalDeformation: 0.228633
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59759
...done!
=======================
Bad trial move (maximal deformation: 0.228633, lambda: 36.1263)
        Cost going from 58193.8 to 58193.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 36.1263 to 72.2527 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Time taken to solve the Levenberg-Marquardt system of equations: 0.222021
...done!
maximalDeformation: 0.11757
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57365
...done!
=======================
Good trial move (maximal deformation: 0.11757, lambda: 72.2527)
        Cost going from 58193.8 to 58193.3
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235621
...done!
maximalDeformation: 0.160411
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59819
...done!
=======================
Good trial move (maximal deformation: 0.160411, lambda: 65.6842)
        Cost going from 58193.3 to 58193
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233616
...done!
maximalDeformation: 0.164006
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59378
...done!
=======================
Good trial move (maximal deformation: 0.164006, lambda: 59.7129)
        Cost going from 58193 to 58192.9
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245916
...done!
maximalDeformation: 0.274288
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60769
...done!
=======================
Good trial move (maximal deformation: 0.274288, lambda: 54.2845)
        Cost going from 58192.9 to 58192.6
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243417
...done!
maximalDeformation: 0.169917
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60684
...done!
=======================
Good trial move (maximal deformation: 0.169917, lambda: 49.3495)
        Cost going from 58192.6 to 58192.5
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57572.7
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57572.7
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 13 was 58195.8
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x9f94460)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 38527022
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55938
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198192
...done!
maximalDeformation: 6.02445
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 268815 has managed to turn bad (detJ: -0.0446304)
Time taken to rasterize Levenberg-Marquardt: 0.0122252
...done!
=======================
Bad trial move (maximal deformation: 6.02445, lambda: 1)
        Cost going from 58192.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193762
...done!
maximalDeformation: 3.74718
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 695534 has managed to turn bad (detJ: -0.085528)
Time taken to rasterize Levenberg-Marquardt: 0.0744829
...done!
=======================
Bad trial move (maximal deformation: 3.74718, lambda: 2)
        Cost going from 58192.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188565
...done!
maximalDeformation: 2.16233
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -1.56929)
Time taken to rasterize Levenberg-Marquardt: 0.0755279
...done!
=======================
Bad trial move (maximal deformation: 2.16233, lambda: 4)
        Cost going from 58192.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18704
...done!
maximalDeformation: 1.17514
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.241865)
Time taken to rasterize Levenberg-Marquardt: 0.07726
...done!
=======================
Bad trial move (maximal deformation: 1.17514, lambda: 8)
        Cost going from 58192.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191644
...done!
maximalDeformation: 0.614965
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49704
...done!
=======================
Bad trial move (maximal deformation: 0.614965, lambda: 16)
        Cost going from 58192.5 to 58196.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185364
...done!
maximalDeformation: 0.315703
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.4987
...done!
=======================
Bad trial move (maximal deformation: 0.315703, lambda: 32)
        Cost going from 58192.5 to 58192.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185964
...done!
maximalDeformation: 0.159876
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49663
...done!
=======================
Good trial move (maximal deformation: 0.159876, lambda: 64)
        Cost going from 58192.5 to 58192.1
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201529
...done!
maximalDeformation: 0.153874
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54203
...done!
=======================
Good trial move (maximal deformation: 0.153874, lambda: 58.1818)
        Cost going from 58192.1 to 58191.8
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196987
...done!
maximalDeformation: 0.222657
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53373
...done!
=======================
Good trial move (maximal deformation: 0.222657, lambda: 52.8926)
        Cost going from 58191.8 to 58191.7
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209037
...done!
maximalDeformation: 0.206885
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55042
...done!
=======================
Good trial move (maximal deformation: 0.206885, lambda: 48.0841)
        Cost going from 58191.7 to 58191.5
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208994
...done!
maximalDeformation: 0.199599
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55267
...done!
=======================
Good trial move (maximal deformation: 0.199599, lambda: 43.7129)
        Cost going from 58191.5 to 58191.3
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221063
...done!
maximalDeformation: 0.256569
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57211
...done!
=======================
Good trial move (maximal deformation: 0.256569, lambda: 39.739)
        Cost going from 58191.3 to 58191.2
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222486
...done!
maximalDeformation: 0.34889
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58774
...done!
=======================
Good trial move (maximal deformation: 0.34889, lambda: 36.1263)
        Cost going from 58191.2 to 58191
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232863
...done!
maximalDeformation: 0.265235
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59241
...done!
=======================
Good trial move (maximal deformation: 0.265235, lambda: 32.8421)
        Cost going from 58191 to 58190.8
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234053
...done!
maximalDeformation: 0.319834
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59576
...done!
=======================
Good trial move (maximal deformation: 0.319834, lambda: 29.8565)
        Cost going from 58190.8 to 58190.5
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243088
...done!
maximalDeformation: 0.326961
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60544
...done!
=======================
Good trial move (maximal deformation: 0.326961, lambda: 27.1422)
        Cost going from 58190.5 to 58190.4
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243498
...done!
maximalDeformation: 0.453047
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60549
...done!
=======================
Good trial move (maximal deformation: 0.453047, lambda: 24.6748)
        Cost going from 58190.4 to 58190.2
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  57564.9
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57564.9
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 14 was 58193.4
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa673900)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 41463427
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54591
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196309
...done!
maximalDeformation: 3.85882
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 276946 has managed to turn bad (detJ: -0.588848)
Time taken to rasterize Levenberg-Marquardt: 0.012912
...done!
=======================
Bad trial move (maximal deformation: 3.85882, lambda: 1)
        Cost going from 58190.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.205741
...done!
maximalDeformation: 2.51376
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 618048 has managed to turn bad (detJ: -0.00265249)
Time taken to rasterize Levenberg-Marquardt: 0.0603731
...done!
=======================
Bad trial move (maximal deformation: 2.51376, lambda: 2)
        Cost going from 58190.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210106
...done!
maximalDeformation: 1.51338
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 697719 has managed to turn bad (detJ: -0.0262425)
Time taken to rasterize Levenberg-Marquardt: 0.0806251
...done!
=======================
Bad trial move (maximal deformation: 1.51338, lambda: 4)
        Cost going from 58190.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.207686
...done!
maximalDeformation: 0.853789
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54287
...done!
=======================
Bad trial move (maximal deformation: 0.853789, lambda: 8)
        Cost going from 58190.2 to 58213.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.209002
...done!
maximalDeformation: 0.456676
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55361
...done!
=======================
Bad trial move (maximal deformation: 0.456676, lambda: 16)
        Cost going from 58190.2 to 58192.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.20729
...done!
maximalDeformation: 0.242003
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54411
...done!
=======================
Good trial move (maximal deformation: 0.242003, lambda: 32)
        Cost going from 58190.2 to 58189
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2071
...done!
maximalDeformation: 0.389708
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5444
...done!
=======================
Good trial move (maximal deformation: 0.389708, lambda: 29.0909)
        Cost going from 58189 to 58188.5
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.216098
...done!
maximalDeformation: 0.294481
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57518
...done!
=======================
Bad trial move (maximal deformation: 0.294481, lambda: 26.4463)
        Cost going from 58188.5 to 58188.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 26.4463 to 52.8926 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Time taken to solve the Levenberg-Marquardt system of equations: 0.22826
...done!
maximalDeformation: 0.152675
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58242
...done!
=======================
Good trial move (maximal deformation: 0.152675, lambda: 52.8926)
        Cost going from 58188.5 to 58187.7
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221859
...done!
maximalDeformation: 0.179354
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57467
...done!
=======================
Good trial move (maximal deformation: 0.179354, lambda: 48.0841)
        Cost going from 58187.7 to 58187.3
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236931
...done!
maximalDeformation: 0.240345
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60383
...done!
=======================
Bad trial move (maximal deformation: 0.240345, lambda: 43.7129)
        Cost going from 58187.3 to 58187.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 43.7129 to 87.4257 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Time taken to solve the Levenberg-Marquardt system of equations: 0.240004
...done!
maximalDeformation: 0.12256
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59694
...done!
=======================
Good trial move (maximal deformation: 0.12256, lambda: 87.4257)
        Cost going from 58187.3 to 58187
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232216
...done!
maximalDeformation: 0.118193
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59118
...done!
=======================
Good trial move (maximal deformation: 0.118193, lambda: 79.4779)
        Cost going from 58187 to 58186.8
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24672
...done!
maximalDeformation: 0.127842
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61239
...done!
=======================
Good trial move (maximal deformation: 0.127842, lambda: 72.2527)
        Cost going from 58186.8 to 58186.7
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242312
...done!
maximalDeformation: 0.195058
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60071
...done!
=======================
Good trial move (maximal deformation: 0.195058, lambda: 65.6842)
        Cost going from 58186.7 to 58186.5
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.255902
...done!
maximalDeformation: 0.214059
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62238
...done!
=======================
Good trial move (maximal deformation: 0.214059, lambda: 59.7129)
        Cost going from 58186.5 to 58186.4
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.250633
...done!
maximalDeformation: 0.227849
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62223
...done!
=======================
Good trial move (maximal deformation: 0.227849, lambda: 54.2845)
        Cost going from 58186.4 to 58186.2
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.263834
...done!
maximalDeformation: 0.257029
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63401
...done!
=======================
Good trial move (maximal deformation: 0.257029, lambda: 49.3495)
        Cost going from 58186.2 to 58186.1
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57559.4
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57559.4
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 15 was 58189.3
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x63d94a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 44592738
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56975
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197019
...done!
maximalDeformation: 6.64663
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -1.43709)
Time taken to rasterize Levenberg-Marquardt: 0.0230381
...done!
=======================
Bad trial move (maximal deformation: 6.64663, lambda: 1)
        Cost going from 58186.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191705
...done!
maximalDeformation: 4.29585
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -0.168992)
Time taken to rasterize Levenberg-Marquardt: 0.0222669
...done!
=======================
Bad trial move (maximal deformation: 4.29585, lambda: 2)
        Cost going from 58186.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187231
...done!
maximalDeformation: 2.5542
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 549406 has managed to turn bad (detJ: -0.0762833)
Time taken to rasterize Levenberg-Marquardt: 0.044086
...done!
=======================
Bad trial move (maximal deformation: 2.5542, lambda: 4)
        Cost going from 58186.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18657
...done!
maximalDeformation: 1.42021
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1949804 has managed to turn bad (detJ: -0.0567411)
Time taken to rasterize Levenberg-Marquardt: 0.632436
...done!
=======================
Bad trial move (maximal deformation: 1.42021, lambda: 8)
        Cost going from 58186.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186127
...done!
maximalDeformation: 0.752731
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2347341 has managed to turn bad (detJ: -0.674253)
Time taken to rasterize Levenberg-Marquardt: 0.974009
...done!
=======================
Bad trial move (maximal deformation: 0.752731, lambda: 16)
        Cost going from 58186.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183438
...done!
maximalDeformation: 0.389346
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49293
...done!
=======================
Bad trial move (maximal deformation: 0.389346, lambda: 32)
        Cost going from 58186.1 to 58187
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183553
...done!
maximalDeformation: 0.199713
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49388
...done!
=======================
Good trial move (maximal deformation: 0.199713, lambda: 64)
        Cost going from 58186.1 to 58185.7
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200994
...done!
maximalDeformation: 0.212435
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54522
...done!
=======================
Good trial move (maximal deformation: 0.212435, lambda: 58.1818)
        Cost going from 58185.7 to 58185.5
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196355
...done!
maximalDeformation: 0.218787
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52387
...done!
=======================
Good trial move (maximal deformation: 0.218787, lambda: 52.8926)
        Cost going from 58185.5 to 58185.4
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209427
...done!
maximalDeformation: 0.230569
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55048
...done!
=======================
Good trial move (maximal deformation: 0.230569, lambda: 48.0841)
        Cost going from 58185.4 to 58185.2
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20803
...done!
maximalDeformation: 0.269406
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54995
...done!
=======================
Good trial move (maximal deformation: 0.269406, lambda: 43.7129)
        Cost going from 58185.2 to 58185.1
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221027
...done!
maximalDeformation: 0.291924
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56946
...done!
=======================
Good trial move (maximal deformation: 0.291924, lambda: 39.739)
        Cost going from 58185.1 to 58184.8
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220897
...done!
maximalDeformation: 0.236482
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5732
...done!
=======================
Good trial move (maximal deformation: 0.236482, lambda: 36.1263)
        Cost going from 58184.8 to 58184.6
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233631
...done!
maximalDeformation: 0.326405
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59178
...done!
=======================
Good trial move (maximal deformation: 0.326405, lambda: 32.8421)
        Cost going from 58184.6 to 58184.6
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233595
...done!
maximalDeformation: 0.325079
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59558
...done!
=======================
Good trial move (maximal deformation: 0.325079, lambda: 29.8565)
        Cost going from 58184.6 to 58184.4
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243543
...done!
maximalDeformation: 0.253318
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60334
...done!
=======================
Good trial move (maximal deformation: 0.253318, lambda: 27.1422)
        Cost going from 58184.4 to 58184.2
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243355
...done!
maximalDeformation: 0.421274
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60711
...done!
=======================
Bad trial move (maximal deformation: 0.421274, lambda: 24.6748)
        Cost going from 58184.2 to 58184.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 24.6748 to 49.3495 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Time taken to solve the Levenberg-Marquardt system of equations: 0.246505
...done!
maximalDeformation: 0.220609
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59969
...done!
=======================
Good trial move (maximal deformation: 0.220609, lambda: 49.3495)
        Cost going from 58184.2 to 58183.1
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57552.6
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57552.6
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 16 was 58186.4
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xda08af0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 47722049
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55221
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196755
...done!
maximalDeformation: 4.30422
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -1.17848)
Time taken to rasterize Levenberg-Marquardt: 0.0365379
...done!
=======================
Bad trial move (maximal deformation: 4.30422, lambda: 1)
        Cost going from 58183.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.20607
...done!
maximalDeformation: 2.6224
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.197331)
Time taken to rasterize Levenberg-Marquardt: 0.0383999
...done!
=======================
Bad trial move (maximal deformation: 2.6224, lambda: 2)
        Cost going from 58183.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.198481
...done!
maximalDeformation: 1.53031
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 820823 has managed to turn bad (detJ: -0.283326)
Time taken to rasterize Levenberg-Marquardt: 0.106676
...done!
=======================
Bad trial move (maximal deformation: 1.53031, lambda: 4)
        Cost going from 58183.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185375
...done!
maximalDeformation: 0.850402
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1832116 has managed to turn bad (detJ: -0.052827)
Time taken to rasterize Levenberg-Marquardt: 0.5521
...done!
=======================
Bad trial move (maximal deformation: 0.850402, lambda: 8)
        Cost going from 58183.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185855
...done!
maximalDeformation: 0.453196
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50339
...done!
=======================
Bad trial move (maximal deformation: 0.453196, lambda: 16)
        Cost going from 58183.1 to 58185.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183744
...done!
maximalDeformation: 0.235279
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48539
...done!
=======================
Good trial move (maximal deformation: 0.235279, lambda: 32)
        Cost going from 58183.1 to 58182.9
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200869
...done!
maximalDeformation: 0.340454
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53896
...done!
=======================
Bad trial move (maximal deformation: 0.340454, lambda: 29.0909)
        Cost going from 58182.9 to 58183.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 29.0909 to 58.1818 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189956
...done!
maximalDeformation: 0.175579
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.534
...done!
=======================
Good trial move (maximal deformation: 0.175579, lambda: 58.1818)
        Cost going from 58182.9 to 58182.4
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194393
...done!
maximalDeformation: 0.149185
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52646
...done!
=======================
Good trial move (maximal deformation: 0.149185, lambda: 52.8926)
        Cost going from 58182.4 to 58182
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206048
...done!
maximalDeformation: 0.184579
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54382
...done!
=======================
Good trial move (maximal deformation: 0.184579, lambda: 48.0841)
        Cost going from 58182 to 58182
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200451
...done!
maximalDeformation: 0.219263
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53639
...done!
=======================
Good trial move (maximal deformation: 0.219263, lambda: 43.7129)
        Cost going from 58182 to 58181.8
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215472
...done!
maximalDeformation: 0.3152
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56548
...done!
=======================
Good trial move (maximal deformation: 0.3152, lambda: 39.739)
        Cost going from 58181.8 to 58181.7
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213404
...done!
maximalDeformation: 0.310158
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5622
...done!
=======================
Good trial move (maximal deformation: 0.310158, lambda: 36.1263)
        Cost going from 58181.7 to 58181.6
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228643
...done!
maximalDeformation: 0.237449
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58866
...done!
=======================
Good trial move (maximal deformation: 0.237449, lambda: 32.8421)
        Cost going from 58181.6 to 58181.5
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225669
...done!
maximalDeformation: 0.237546
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58403
...done!
=======================
Good trial move (maximal deformation: 0.237546, lambda: 29.8565)
        Cost going from 58181.5 to 58181.1
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240138
...done!
maximalDeformation: 0.36164
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60104
...done!
=======================
Bad trial move (maximal deformation: 0.36164, lambda: 27.1422)
        Cost going from 58181.1 to 58181.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 27.1422 to 54.2845 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Time taken to solve the Levenberg-Marquardt system of equations: 0.230514
...done!
maximalDeformation: 0.184422
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57845
...done!
=======================
Good trial move (maximal deformation: 0.184422, lambda: 54.2845)
        Cost going from 58181.1 to 58180.3
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234859
...done!
maximalDeformation: 0.150637
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59399
...done!
=======================
Good trial move (maximal deformation: 0.150637, lambda: 49.3495)
        Cost going from 58180.3 to 58180
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57546.6
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57546.6
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 17 was 58183.2
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x6813580)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 50851360
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55239
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196381
...done!
maximalDeformation: 6.38482
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 158952 has managed to turn bad (detJ: -0.158359)
Time taken to rasterize Levenberg-Marquardt: 0.00767112
...done!
=======================
Bad trial move (maximal deformation: 6.38482, lambda: 1)
        Cost going from 58180 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191376
...done!
maximalDeformation: 3.93312
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 623943 has managed to turn bad (detJ: -0.153624)
Time taken to rasterize Levenberg-Marquardt: 0.059516
...done!
=======================
Bad trial move (maximal deformation: 3.93312, lambda: 2)
        Cost going from 58180 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186594
...done!
maximalDeformation: 2.27736
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1057157 has managed to turn bad (detJ: -0.646896)
Time taken to rasterize Levenberg-Marquardt: 0.173075
...done!
=======================
Bad trial move (maximal deformation: 2.27736, lambda: 4)
        Cost going from 58180 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184721
...done!
maximalDeformation: 1.2501
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48954
...done!
=======================
Bad trial move (maximal deformation: 1.2501, lambda: 8)
        Cost going from 58180 to 58199.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185112
...done!
maximalDeformation: 0.659223
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49458
...done!
=======================
Bad trial move (maximal deformation: 0.659223, lambda: 16)
        Cost going from 58180 to 58184.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182982
...done!
maximalDeformation: 0.340028
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48585
...done!
=======================
Bad trial move (maximal deformation: 0.340028, lambda: 32)
        Cost going from 58180 to 58180.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183676
...done!
maximalDeformation: 0.172666
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49271
...done!
=======================
Good trial move (maximal deformation: 0.172666, lambda: 64)
        Cost going from 58180 to 58179.7
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200718
...done!
maximalDeformation: 0.146439
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54904
...done!
=======================
Good trial move (maximal deformation: 0.146439, lambda: 58.1818)
        Cost going from 58179.7 to 58179.6
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195983
...done!
maximalDeformation: 0.250897
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52904
...done!
=======================
Good trial move (maximal deformation: 0.250897, lambda: 52.8926)
        Cost going from 58179.6 to 58179.4
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208802
...done!
maximalDeformation: 0.267509
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55397
...done!
=======================
Good trial move (maximal deformation: 0.267509, lambda: 48.0841)
        Cost going from 58179.4 to 58179.3
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207426
...done!
maximalDeformation: 0.219565
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54983
...done!
=======================
Good trial move (maximal deformation: 0.219565, lambda: 43.7129)
        Cost going from 58179.3 to 58179.2
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220419
...done!
maximalDeformation: 0.262118
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57102
...done!
=======================
Good trial move (maximal deformation: 0.262118, lambda: 39.739)
        Cost going from 58179.2 to 58179.1
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221367
...done!
maximalDeformation: 0.357381
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58149
...done!
=======================
Bad trial move (maximal deformation: 0.357381, lambda: 36.1263)
        Cost going from 58179.1 to 58179.1
Transforming mesh
Done transforming mesh
        Increasing lambda from 36.1263 to 72.2527 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Time taken to solve the Levenberg-Marquardt system of equations: 0.217122
...done!
maximalDeformation: 0.181829
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56995
...done!
=======================
Good trial move (maximal deformation: 0.181829, lambda: 72.2527)
        Cost going from 58179.1 to 58178.6
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232083
...done!
maximalDeformation: 0.129429
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58878
...done!
=======================
Good trial move (maximal deformation: 0.129429, lambda: 65.6842)
        Cost going from 58178.6 to 58178.3
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228758
...done!
maximalDeformation: 0.132588
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59144
...done!
=======================
Good trial move (maximal deformation: 0.132588, lambda: 59.7129)
        Cost going from 58178.3 to 58178.2
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242449
...done!
maximalDeformation: 0.143737
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6014
...done!
=======================
Good trial move (maximal deformation: 0.143737, lambda: 54.2845)
        Cost going from 58178.2 to 58178
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239694
...done!
maximalDeformation: 0.208469
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5982
...done!
=======================
Good trial move (maximal deformation: 0.208469, lambda: 49.3495)
        Cost going from 58178 to 58178
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57542.3
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57542.3
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 18 was 58181.3
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x6981660)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 53980671
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53749
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196521
...done!
maximalDeformation: 9.54076
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 268815 has managed to turn bad (detJ: -0.0280438)
Time taken to rasterize Levenberg-Marquardt: 0.012054
...done!
=======================
Bad trial move (maximal deformation: 9.54076, lambda: 1)
        Cost going from 58178 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19107
...done!
maximalDeformation: 6.14987
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 549406 has managed to turn bad (detJ: -0.428265)
Time taken to rasterize Levenberg-Marquardt: 0.0441949
...done!
=======================
Bad trial move (maximal deformation: 6.14987, lambda: 2)
        Cost going from 58178 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196896
...done!
maximalDeformation: 3.67999
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 672565 has managed to turn bad (detJ: -0.0221473)
Time taken to rasterize Levenberg-Marquardt: 0.070797
...done!
=======================
Bad trial move (maximal deformation: 3.67999, lambda: 4)
        Cost going from 58178 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.206066
...done!
maximalDeformation: 2.04747
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1618281 has managed to turn bad (detJ: -0.328785)
Time taken to rasterize Levenberg-Marquardt: 0.440049
...done!
=======================
Bad trial move (maximal deformation: 2.04747, lambda: 8)
        Cost going from 58178 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.2092
...done!
maximalDeformation: 1.08746
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2347341 has managed to turn bad (detJ: -1.46262)
Time taken to rasterize Levenberg-Marquardt: 1.00627
...done!
=======================
Bad trial move (maximal deformation: 1.08746, lambda: 16)
        Cost going from 58178 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.206615
...done!
maximalDeformation: 0.563108
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2347341 has managed to turn bad (detJ: -0.176513)
Time taken to rasterize Levenberg-Marquardt: 1.00954
...done!
=======================
Bad trial move (maximal deformation: 0.563108, lambda: 32)
        Cost going from 58178 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192603
...done!
maximalDeformation: 0.286507
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51404
...done!
=======================
Good trial move (maximal deformation: 0.286507, lambda: 64)
        Cost going from 58178 to 58177.7
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201847
...done!
maximalDeformation: 0.177933
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5375
...done!
=======================
Good trial move (maximal deformation: 0.177933, lambda: 58.1818)
        Cost going from 58177.7 to 58177.5
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.203977
...done!
maximalDeformation: 0.173357
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54592
...done!
=======================
Good trial move (maximal deformation: 0.173357, lambda: 52.8926)
        Cost going from 58177.5 to 58177.4
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214932
...done!
maximalDeformation: 0.297995
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56617
...done!
=======================
Bad trial move (maximal deformation: 0.297995, lambda: 48.0841)
        Cost going from 58177.4 to 58177.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 48.0841 to 96.1683 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Time taken to solve the Levenberg-Marquardt system of equations: 0.217342
...done!
maximalDeformation: 0.150824
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56911
...done!
=======================
Good trial move (maximal deformation: 0.150824, lambda: 96.1683)
        Cost going from 58177.4 to 58177.1
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21847
...done!
maximalDeformation: 0.106648
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56466
...done!
=======================
Good trial move (maximal deformation: 0.106648, lambda: 87.4257)
        Cost going from 58177.1 to 58177
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.227056
...done!
maximalDeformation: 0.143566
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58725
...done!
=======================
Good trial move (maximal deformation: 0.143566, lambda: 79.4779)
        Cost going from 58177 to 58176.9
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222313
...done!
maximalDeformation: 0.173725
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56947
...done!
=======================
Good trial move (maximal deformation: 0.173725, lambda: 72.2527)
        Cost going from 58176.9 to 58176.8
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235418
...done!
maximalDeformation: 0.179146
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59895
...done!
=======================
Good trial move (maximal deformation: 0.179146, lambda: 65.6842)
        Cost going from 58176.8 to 58176.7
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23225
...done!
maximalDeformation: 0.215339
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58977
...done!
=======================
Good trial move (maximal deformation: 0.215339, lambda: 59.7129)
        Cost going from 58176.7 to 58176.6
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246062
...done!
maximalDeformation: 0.243853
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61135
...done!
=======================
Good trial move (maximal deformation: 0.243853, lambda: 54.2845)
        Cost going from 58176.6 to 58176.4
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242176
...done!
maximalDeformation: 0.265839
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59906
...done!
=======================
Good trial move (maximal deformation: 0.265839, lambda: 49.3495)
        Cost going from 58176.4 to 58176.3
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57538.8
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57538.8
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 19 was 58179.6
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x966de30)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 57109982
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55799
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200887
...done!
maximalDeformation: 4.38406
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 288533 has managed to turn bad (detJ: -0.0356064)
Time taken to rasterize Levenberg-Marquardt: 0.013963
...done!
=======================
Bad trial move (maximal deformation: 4.38406, lambda: 1)
        Cost going from 58176.3 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195318
...done!
maximalDeformation: 2.88782
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -0.724982)
Time taken to rasterize Levenberg-Marquardt: 0.0224209
...done!
=======================
Bad trial move (maximal deformation: 2.88782, lambda: 2)
        Cost going from 58176.3 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188742
...done!
maximalDeformation: 1.92773
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -0.110813)
Time taken to rasterize Levenberg-Marquardt: 0.022166
...done!
=======================
Bad trial move (maximal deformation: 1.92773, lambda: 4)
        Cost going from 58176.3 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187757
...done!
maximalDeformation: 1.1936
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1255922 has managed to turn bad (detJ: -0.0859187)
Time taken to rasterize Levenberg-Marquardt: 0.246214
...done!
=======================
Bad trial move (maximal deformation: 1.1936, lambda: 8)
        Cost going from 58176.3 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18725
...done!
maximalDeformation: 0.683262
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49216
...done!
=======================
Bad trial move (maximal deformation: 0.683262, lambda: 16)
        Cost going from 58176.3 to 58182
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18512
...done!
maximalDeformation: 0.369338
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48579
...done!
=======================
Bad trial move (maximal deformation: 0.369338, lambda: 32)
        Cost going from 58176.3 to 58177
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185344
...done!
maximalDeformation: 0.192685
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49371
...done!
=======================
Good trial move (maximal deformation: 0.192685, lambda: 64)
        Cost going from 58176.3 to 58176
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202183
...done!
maximalDeformation: 0.275419
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55755
...done!
=======================
Good trial move (maximal deformation: 0.275419, lambda: 58.1818)
        Cost going from 58176 to 58175.9
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19742
...done!
maximalDeformation: 0.209891
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52741
...done!
=======================
Bad trial move (maximal deformation: 0.209891, lambda: 52.8926)
        Cost going from 58175.9 to 58175.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 52.8926 to 105.785 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196332
...done!
maximalDeformation: 0.107114
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51716
...done!
=======================
Good trial move (maximal deformation: 0.107114, lambda: 105.785)
        Cost going from 58175.9 to 58175.7
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210419
...done!
maximalDeformation: 0.100022
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54933
...done!
=======================
Good trial move (maximal deformation: 0.100022, lambda: 96.1683)
        Cost going from 58175.7 to 58175.5
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207565
...done!
maximalDeformation: 0.098946
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55417
...done!
=======================
Good trial move (maximal deformation: 0.098946, lambda: 87.4257)
        Cost going from 58175.5 to 58175.4
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221073
...done!
maximalDeformation: 0.139026
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57441
...done!
=======================
Good trial move (maximal deformation: 0.139026, lambda: 79.4779)
        Cost going from 58175.4 to 58175.3
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220369
...done!
maximalDeformation: 0.146668
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56656
...done!
=======================
Good trial move (maximal deformation: 0.146668, lambda: 72.2527)
        Cost going from 58175.3 to 58175.2
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234709
...done!
maximalDeformation: 0.164781
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59342
...done!
=======================
Good trial move (maximal deformation: 0.164781, lambda: 65.6842)
        Cost going from 58175.2 to 58175.1
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232693
...done!
maximalDeformation: 0.192163
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5898
...done!
=======================
Good trial move (maximal deformation: 0.192163, lambda: 59.7129)
        Cost going from 58175.1 to 58175
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243818
...done!
maximalDeformation: 0.196472
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60614
...done!
=======================
Good trial move (maximal deformation: 0.196472, lambda: 54.2845)
        Cost going from 58175 to 58175
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242696
...done!
maximalDeformation: 0.264947
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60675
...done!
=======================
Good trial move (maximal deformation: 0.264947, lambda: 49.3495)
        Cost going from 58175 to 58174.8
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57535.6
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57535.6
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 20 was 58178.1
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x91ef6e0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 60239293
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53506
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19463
...done!
maximalDeformation: 5.38144
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 158952 has managed to turn bad (detJ: -0.427828)
Time taken to rasterize Levenberg-Marquardt: 0.00762391
...done!
=======================
Bad trial move (maximal deformation: 5.38144, lambda: 1)
        Cost going from 58174.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189919
...done!
maximalDeformation: 3.63506
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 248957 has managed to turn bad (detJ: -1.1791)
Time taken to rasterize Levenberg-Marquardt: 0.010272
...done!
=======================
Bad trial move (maximal deformation: 3.63506, lambda: 2)
        Cost going from 58174.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187357
...done!
maximalDeformation: 2.24801
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 248957 has managed to turn bad (detJ: -0.548144)
Time taken to rasterize Levenberg-Marquardt: 0.0103021
...done!
=======================
Bad trial move (maximal deformation: 2.24801, lambda: 4)
        Cost going from 58174.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182095
...done!
maximalDeformation: 1.28862
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49912
...done!
=======================
Bad trial move (maximal deformation: 1.28862, lambda: 8)
        Cost going from 58174.8 to 58233.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182227
...done!
maximalDeformation: 0.693622
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49456
...done!
=======================
Bad trial move (maximal deformation: 0.693622, lambda: 16)
        Cost going from 58174.8 to 58180.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18011
...done!
maximalDeformation: 0.362035
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48778
...done!
=======================
Bad trial move (maximal deformation: 0.362035, lambda: 32)
        Cost going from 58174.8 to 58175.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.179722
...done!
maximalDeformation: 0.18487
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49697
...done!
=======================
Good trial move (maximal deformation: 0.18487, lambda: 64)
        Cost going from 58174.8 to 58174.5
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196551
...done!
maximalDeformation: 0.201168
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53843
...done!
=======================
Good trial move (maximal deformation: 0.201168, lambda: 58.1818)
        Cost going from 58174.5 to 58174.4
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.181163
...done!
maximalDeformation: 0.29315
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49394
...done!
=======================
Good trial move (maximal deformation: 0.29315, lambda: 52.8926)
        Cost going from 58174.4 to 58174.3
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202838
...done!
maximalDeformation: 0.260572
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54825
...done!
=======================
Good trial move (maximal deformation: 0.260572, lambda: 48.0841)
        Cost going from 58174.3 to 58174.2
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196298
...done!
maximalDeformation: 0.303244
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52258
...done!
=======================
Bad trial move (maximal deformation: 0.303244, lambda: 43.7129)
        Cost going from 58174.2 to 58174.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 43.7129 to 87.4257 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18834
...done!
maximalDeformation: 0.155216
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50846
...done!
=======================
Good trial move (maximal deformation: 0.155216, lambda: 87.4257)
        Cost going from 58174.2 to 58173.8
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213644
...done!
maximalDeformation: 0.156631
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56805
...done!
=======================
Good trial move (maximal deformation: 0.156631, lambda: 79.4779)
        Cost going from 58173.8 to 58173.7
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202589
...done!
maximalDeformation: 0.139884
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.534
...done!
=======================
Good trial move (maximal deformation: 0.139884, lambda: 72.2527)
        Cost going from 58173.7 to 58173.6
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219148
...done!
maximalDeformation: 0.22136
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57078
...done!
=======================
Good trial move (maximal deformation: 0.22136, lambda: 65.6842)
        Cost going from 58173.6 to 58173.5
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213012
...done!
maximalDeformation: 0.216181
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55694
...done!
=======================
Good trial move (maximal deformation: 0.216181, lambda: 59.7129)
        Cost going from 58173.5 to 58173.4
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230502
...done!
maximalDeformation: 0.205888
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.589
...done!
=======================
Good trial move (maximal deformation: 0.205888, lambda: 54.2845)
        Cost going from 58173.4 to 58173.3
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225571
...done!
maximalDeformation: 0.256814
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58114
...done!
=======================
Good trial move (maximal deformation: 0.256814, lambda: 49.3495)
        Cost going from 58173.3 to 58173.2
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57532.2
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57532.2
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 21 was 58176.4
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa018890)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 63368604
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54285
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198149
...done!
maximalDeformation: 5.68944
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 330248 has managed to turn bad (detJ: -0.377641)
Time taken to rasterize Levenberg-Marquardt: 0.017134
...done!
=======================
Bad trial move (maximal deformation: 5.68944, lambda: 1)
        Cost going from 58173.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190669
...done!
maximalDeformation: 3.58728
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 371833 has managed to turn bad (detJ: -0.0467845)
Time taken to rasterize Levenberg-Marquardt: 0.020453
...done!
=======================
Bad trial move (maximal deformation: 3.58728, lambda: 2)
        Cost going from 58173.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186681
...done!
maximalDeformation: 2.1089
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 618048 has managed to turn bad (detJ: -0.00204835)
Time taken to rasterize Levenberg-Marquardt: 0.0569749
...done!
=======================
Bad trial move (maximal deformation: 2.1089, lambda: 4)
        Cost going from 58173.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182647
...done!
maximalDeformation: 1.18582
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48943
...done!
=======================
Bad trial move (maximal deformation: 1.18582, lambda: 8)
        Cost going from 58173.2 to 58206.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182172
...done!
maximalDeformation: 0.663999
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49053
...done!
=======================
Bad trial move (maximal deformation: 0.663999, lambda: 16)
        Cost going from 58173.2 to 58179.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181027
...done!
maximalDeformation: 0.354498
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49084
...done!
=======================
Bad trial move (maximal deformation: 0.354498, lambda: 32)
        Cost going from 58173.2 to 58173.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180482
...done!
maximalDeformation: 0.183253
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49206
...done!
=======================
Good trial move (maximal deformation: 0.183253, lambda: 64)
        Cost going from 58173.2 to 58172.9
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197469
...done!
maximalDeformation: 0.193772
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53812
...done!
=======================
Good trial move (maximal deformation: 0.193772, lambda: 58.1818)
        Cost going from 58172.9 to 58172.7
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193249
...done!
maximalDeformation: 0.273586
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52079
...done!
=======================
Bad trial move (maximal deformation: 0.273586, lambda: 52.8926)
        Cost going from 58172.7 to 58172.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 52.8926 to 105.785 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191874
...done!
maximalDeformation: 0.138705
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51831
...done!
=======================
Good trial move (maximal deformation: 0.138705, lambda: 105.785)
        Cost going from 58172.7 to 58172.5
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207493
...done!
maximalDeformation: 0.121158
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55211
...done!
=======================
Good trial move (maximal deformation: 0.121158, lambda: 96.1683)
        Cost going from 58172.5 to 58172.4
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204894
...done!
maximalDeformation: 0.1367
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5762
...done!
=======================
Good trial move (maximal deformation: 0.1367, lambda: 87.4257)
        Cost going from 58172.4 to 58172.3
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219257
...done!
maximalDeformation: 0.161038
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57488
...done!
=======================
Good trial move (maximal deformation: 0.161038, lambda: 79.4779)
        Cost going from 58172.3 to 58172.2
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219524
...done!
maximalDeformation: 0.196337
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58161
...done!
=======================
Good trial move (maximal deformation: 0.196337, lambda: 72.2527)
        Cost going from 58172.2 to 58172.1
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235489
...done!
maximalDeformation: 0.209722
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59988
...done!
=======================
Good trial move (maximal deformation: 0.209722, lambda: 65.6842)
        Cost going from 58172.1 to 58172.1
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231298
...done!
maximalDeformation: 0.214335
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6032
...done!
=======================
Good trial move (maximal deformation: 0.214335, lambda: 59.7129)
        Cost going from 58172.1 to 58171.9
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244927
...done!
maximalDeformation: 0.24362
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61893
...done!
=======================
Bad trial move (maximal deformation: 0.24362, lambda: 54.2845)
        Cost going from 58171.9 to 58172
Transforming mesh
Done transforming mesh
        Increasing lambda from 54.2845 to 108.569 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 108.569...
Time taken to solve the Levenberg-Marquardt system of equations: 0.247491
...done!
maximalDeformation: 0.123307
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60116
...done!
=======================
Good trial move (maximal deformation: 0.123307, lambda: 108.569)
        Cost going from 58171.9 to 58171.7
        Decreasing lambda from 108.569 to 98.6991
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242119
...done!
maximalDeformation: 0.0633395
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61071
...done!
=======================
Good trial move (maximal deformation: 0.0633395, lambda: 98.6991)
        Cost going from 58171.7 to 58171.6
        Decreasing lambda from 98.6991 to 89.7264
Starting EM: 
EM Iteration: 0  ->  57529.6
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57529.6
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 22 was 58174.8
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x91a7df0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 66690821
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55028
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196917
...done!
maximalDeformation: 7.57219
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 248957 has managed to turn bad (detJ: -1.07359)
Time taken to rasterize Levenberg-Marquardt: 0.0110819
...done!
=======================
Bad trial move (maximal deformation: 7.57219, lambda: 1)
        Cost going from 58171.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19041
...done!
maximalDeformation: 4.63647
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 248957 has managed to turn bad (detJ: -0.390427)
Time taken to rasterize Levenberg-Marquardt: 0.0102479
...done!
=======================
Bad trial move (maximal deformation: 4.63647, lambda: 2)
        Cost going from 58171.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185518
...done!
maximalDeformation: 2.65587
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.579107)
Time taken to rasterize Levenberg-Marquardt: 0.0357542
...done!
=======================
Bad trial move (maximal deformation: 2.65587, lambda: 4)
        Cost going from 58171.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18496
...done!
maximalDeformation: 1.44461
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2634454 has managed to turn bad (detJ: -0.55708)
Time taken to rasterize Levenberg-Marquardt: 1.31644
...done!
=======================
Bad trial move (maximal deformation: 1.44461, lambda: 8)
        Cost going from 58171.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181995
...done!
maximalDeformation: 0.759488
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49464
...done!
=======================
Bad trial move (maximal deformation: 0.759488, lambda: 16)
        Cost going from 58171.6 to 58175.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194901
...done!
maximalDeformation: 0.389153
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52031
...done!
=======================
Bad trial move (maximal deformation: 0.389153, lambda: 32)
        Cost going from 58171.6 to 58172.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193453
...done!
maximalDeformation: 0.197239
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52223
...done!
=======================
Bad trial move (maximal deformation: 0.197239, lambda: 64)
        Cost going from 58171.6 to 58171.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 64 to 128 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 128...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195483
...done!
maximalDeformation: 0.0993305
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52131
...done!
=======================
Good trial move (maximal deformation: 0.0993305, lambda: 128)
        Cost going from 58171.6 to 58171.5
        Decreasing lambda from 128 to 116.364
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 116.364...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204499
...done!
maximalDeformation: 0.0848228
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53793
...done!
=======================
Good trial move (maximal deformation: 0.0848228, lambda: 116.364)
        Cost going from 58171.5 to 58171.4
        Decreasing lambda from 116.364 to 105.785
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204311
...done!
maximalDeformation: 0.114492
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53825
...done!
=======================
Good trial move (maximal deformation: 0.114492, lambda: 105.785)
        Cost going from 58171.4 to 58171.3
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210976
...done!
maximalDeformation: 0.120918
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54654
...done!
=======================
Good trial move (maximal deformation: 0.120918, lambda: 96.1683)
        Cost going from 58171.3 to 58171.3
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.216353
...done!
maximalDeformation: 0.124914
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5656
...done!
=======================
Good trial move (maximal deformation: 0.124914, lambda: 87.4257)
        Cost going from 58171.3 to 58171.2
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223349
...done!
maximalDeformation: 0.156078
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5634
...done!
=======================
Good trial move (maximal deformation: 0.156078, lambda: 79.4779)
        Cost going from 58171.2 to 58171.1
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23074
...done!
maximalDeformation: 0.200072
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59059
...done!
=======================
Good trial move (maximal deformation: 0.200072, lambda: 72.2527)
        Cost going from 58171.1 to 58171
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234614
...done!
maximalDeformation: 0.200901
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59431
...done!
=======================
Good trial move (maximal deformation: 0.200901, lambda: 65.6842)
        Cost going from 58171 to 58171
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241046
...done!
maximalDeformation: 0.197761
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60426
...done!
=======================
Good trial move (maximal deformation: 0.197761, lambda: 59.7129)
        Cost going from 58171 to 58170.9
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244458
...done!
maximalDeformation: 0.247348
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60408
...done!
=======================
Good trial move (maximal deformation: 0.247348, lambda: 54.2845)
        Cost going from 58170.9 to 58170.8
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.250503
...done!
maximalDeformation: 0.277044
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62098
...done!
=======================
Good trial move (maximal deformation: 0.277044, lambda: 49.3495)
        Cost going from 58170.8 to 58170.8
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57527
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57527
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 23 was 58174
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x66eec10)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 69820132
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56062
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194677
...done!
maximalDeformation: 6.05906
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -0.00247483)
Time taken to rasterize Levenberg-Marquardt: 0.00820804
...done!
=======================
Bad trial move (maximal deformation: 6.05906, lambda: 1)
        Cost going from 58170.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194705
...done!
maximalDeformation: 3.71962
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.175992)
Time taken to rasterize Levenberg-Marquardt: 0.035944
...done!
=======================
Bad trial move (maximal deformation: 3.71962, lambda: 2)
        Cost going from 58170.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187814
...done!
maximalDeformation: 2.16023
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 697719 has managed to turn bad (detJ: -0.398543)
Time taken to rasterize Levenberg-Marquardt: 0.073801
...done!
=======================
Bad trial move (maximal deformation: 2.16023, lambda: 4)
        Cost going from 58170.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183956
...done!
maximalDeformation: 1.2161
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2140064 has managed to turn bad (detJ: -0.07297)
Time taken to rasterize Levenberg-Marquardt: 0.779305
...done!
=======================
Bad trial move (maximal deformation: 1.2161, lambda: 8)
        Cost going from 58170.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183866
...done!
maximalDeformation: 0.699366
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49319
...done!
=======================
Bad trial move (maximal deformation: 0.699366, lambda: 16)
        Cost going from 58170.8 to 58176.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182081
...done!
maximalDeformation: 0.37891
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49081
...done!
=======================
Bad trial move (maximal deformation: 0.37891, lambda: 32)
        Cost going from 58170.8 to 58171.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182223
...done!
maximalDeformation: 0.197849
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48172
...done!
=======================
Good trial move (maximal deformation: 0.197849, lambda: 64)
        Cost going from 58170.8 to 58170.4
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19984
...done!
maximalDeformation: 0.206798
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54614
...done!
=======================
Good trial move (maximal deformation: 0.206798, lambda: 58.1818)
        Cost going from 58170.4 to 58170.2
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194187
...done!
maximalDeformation: 0.228964
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52689
...done!
=======================
Good trial move (maximal deformation: 0.228964, lambda: 52.8926)
        Cost going from 58170.2 to 58170.1
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207606
...done!
maximalDeformation: 0.301703
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55514
...done!
=======================
Bad trial move (maximal deformation: 0.301703, lambda: 48.0841)
        Cost going from 58170.1 to 58170.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 48.0841 to 96.1683 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Time taken to solve the Levenberg-Marquardt system of equations: 0.209419
...done!
maximalDeformation: 0.154868
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54403
...done!
=======================
Good trial move (maximal deformation: 0.154868, lambda: 96.1683)
        Cost going from 58170.1 to 58169.9
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205371
...done!
maximalDeformation: 0.138166
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54045
...done!
=======================
Good trial move (maximal deformation: 0.138166, lambda: 87.4257)
        Cost going from 58169.9 to 58169.8
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218776
...done!
maximalDeformation: 0.171822
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56225
...done!
=======================
Good trial move (maximal deformation: 0.171822, lambda: 79.4779)
        Cost going from 58169.8 to 58169.7
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210408
...done!
maximalDeformation: 0.183683
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54315
...done!
=======================
Good trial move (maximal deformation: 0.183683, lambda: 72.2527)
        Cost going from 58169.7 to 58169.6
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229431
...done!
maximalDeformation: 0.184642
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5834
...done!
=======================
Good trial move (maximal deformation: 0.184642, lambda: 65.6842)
        Cost going from 58169.6 to 58169.5
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221596
...done!
maximalDeformation: 0.179884
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56314
...done!
=======================
Good trial move (maximal deformation: 0.179884, lambda: 59.7129)
        Cost going from 58169.5 to 58169.4
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24036
...done!
maximalDeformation: 0.231607
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59965
...done!
=======================
Good trial move (maximal deformation: 0.231607, lambda: 54.2845)
        Cost going from 58169.4 to 58169.3
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232265
...done!
maximalDeformation: 0.284991
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58784
...done!
=======================
Bad trial move (maximal deformation: 0.284991, lambda: 49.3495)
        Cost going from 58169.3 to 58169.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 49.3495 to 98.6991 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Time taken to solve the Levenberg-Marquardt system of equations: 0.222696
...done!
maximalDeformation: 0.145579
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55131
...done!
=======================
Good trial move (maximal deformation: 0.145579, lambda: 98.6991)
        Cost going from 58169.3 to 58169
        Decreasing lambda from 98.6991 to 89.7264
Starting EM: 
EM Iteration: 0  ->  57524.1
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57524.1
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 24 was 58172.3
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa3c6be0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 73142349
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55031
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193754
...done!
maximalDeformation: 5.72944
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 363888 has managed to turn bad (detJ: -0.0660288)
Time taken to rasterize Levenberg-Marquardt: 0.0202398
...done!
=======================
Bad trial move (maximal deformation: 5.72944, lambda: 1)
        Cost going from 58169 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190721
...done!
maximalDeformation: 3.67764
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -1.37913)
Time taken to rasterize Levenberg-Marquardt: 0.035955
...done!
=======================
Bad trial move (maximal deformation: 3.67764, lambda: 2)
        Cost going from 58169 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187228
...done!
maximalDeformation: 2.21217
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.257063)
Time taken to rasterize Levenberg-Marquardt: 0.035656
...done!
=======================
Bad trial move (maximal deformation: 2.21217, lambda: 4)
        Cost going from 58169 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184131
...done!
maximalDeformation: 1.25037
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2579644 has managed to turn bad (detJ: -0.0806612)
Time taken to rasterize Levenberg-Marquardt: 1.24656
...done!
=======================
Bad trial move (maximal deformation: 1.25037, lambda: 8)
        Cost going from 58169 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183419
...done!
maximalDeformation: 0.674781
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.4847
...done!
=======================
Bad trial move (maximal deformation: 0.674781, lambda: 16)
        Cost going from 58169 to 58173.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18185
...done!
maximalDeformation: 0.35098
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.4947
...done!
=======================
Bad trial move (maximal deformation: 0.35098, lambda: 32)
        Cost going from 58169 to 58169.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182028
...done!
maximalDeformation: 0.179355
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50089
...done!
=======================
Good trial move (maximal deformation: 0.179355, lambda: 64)
        Cost going from 58169 to 58169
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20165
...done!
maximalDeformation: 0.201687
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54578
...done!
=======================
Good trial move (maximal deformation: 0.201687, lambda: 58.1818)
        Cost going from 58169 to 58168.9
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195184
...done!
maximalDeformation: 0.278079
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.524
...done!
=======================
Good trial move (maximal deformation: 0.278079, lambda: 52.8926)
        Cost going from 58168.9 to 58168.8
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209336
...done!
maximalDeformation: 0.237017
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55108
...done!
=======================
Good trial move (maximal deformation: 0.237017, lambda: 48.0841)
        Cost going from 58168.8 to 58168.8
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206966
...done!
maximalDeformation: 0.271628
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55403
...done!
=======================
Good trial move (maximal deformation: 0.271628, lambda: 43.7129)
        Cost going from 58168.8 to 58168.5
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222268
...done!
maximalDeformation: 0.337851
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56799
...done!
=======================
Bad trial move (maximal deformation: 0.337851, lambda: 39.739)
        Cost going from 58168.5 to 58168.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 39.739 to 79.4779 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Time taken to solve the Levenberg-Marquardt system of equations: 0.22502
...done!
maximalDeformation: 0.172832
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57584
...done!
=======================
Good trial move (maximal deformation: 0.172832, lambda: 79.4779)
        Cost going from 58168.5 to 58168.2
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221447
...done!
maximalDeformation: 0.172383
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57304
...done!
=======================
Good trial move (maximal deformation: 0.172383, lambda: 72.2527)
        Cost going from 58168.2 to 58168.1
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233403
...done!
maximalDeformation: 0.191312
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58952
...done!
=======================
Good trial move (maximal deformation: 0.191312, lambda: 65.6842)
        Cost going from 58168.1 to 58168
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224991
...done!
maximalDeformation: 0.225993
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58489
...done!
=======================
Good trial move (maximal deformation: 0.225993, lambda: 59.7129)
        Cost going from 58168 to 58167.9
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242089
...done!
maximalDeformation: 0.227524
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60188
...done!
=======================
Good trial move (maximal deformation: 0.227524, lambda: 54.2845)
        Cost going from 58167.9 to 58167.9
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234002
...done!
maximalDeformation: 0.220759
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59649
...done!
=======================
Good trial move (maximal deformation: 0.220759, lambda: 49.3495)
        Cost going from 58167.9 to 58167.8
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57520.9
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57520.9
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 25 was 58171
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x8aa9920)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 76271660
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55564
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19891
...done!
maximalDeformation: 5.8753
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 330248 has managed to turn bad (detJ: -0.214279)
Time taken to rasterize Levenberg-Marquardt: 0.0174789
...done!
=======================
Bad trial move (maximal deformation: 5.8753, lambda: 1)
        Cost going from 58167.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194654
...done!
maximalDeformation: 3.95146
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 618048 has managed to turn bad (detJ: -0.349273)
Time taken to rasterize Levenberg-Marquardt: 0.0576911
...done!
=======================
Bad trial move (maximal deformation: 3.95146, lambda: 2)
        Cost going from 58167.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18941
...done!
maximalDeformation: 2.49675
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 697719 has managed to turn bad (detJ: -0.400647)
Time taken to rasterize Levenberg-Marquardt: 0.074131
...done!
=======================
Bad trial move (maximal deformation: 2.49675, lambda: 4)
        Cost going from 58167.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185651
...done!
maximalDeformation: 1.46853
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49349
...done!
=======================
Bad trial move (maximal deformation: 1.46853, lambda: 8)
        Cost going from 58167.8 to 58198.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185491
...done!
maximalDeformation: 0.809169
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49828
...done!
=======================
Bad trial move (maximal deformation: 0.809169, lambda: 16)
        Cost going from 58167.8 to 58174.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18396
...done!
maximalDeformation: 0.42783
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48746
...done!
=======================
Bad trial move (maximal deformation: 0.42783, lambda: 32)
        Cost going from 58167.8 to 58168.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184346
...done!
maximalDeformation: 0.220187
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49477
...done!
=======================
Good trial move (maximal deformation: 0.220187, lambda: 64)
        Cost going from 58167.8 to 58167.5
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201302
...done!
maximalDeformation: 0.210967
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53951
...done!
=======================
Good trial move (maximal deformation: 0.210967, lambda: 58.1818)
        Cost going from 58167.5 to 58167.3
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196346
...done!
maximalDeformation: 0.25684
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52573
...done!
=======================
Bad trial move (maximal deformation: 0.25684, lambda: 52.8926)
        Cost going from 58167.3 to 58167.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 52.8926 to 105.785 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195375
...done!
maximalDeformation: 0.130633
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51338
...done!
=======================
Good trial move (maximal deformation: 0.130633, lambda: 105.785)
        Cost going from 58167.3 to 58167.1
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210325
...done!
maximalDeformation: 0.0943098
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55209
...done!
=======================
Good trial move (maximal deformation: 0.0943098, lambda: 96.1683)
        Cost going from 58167.1 to 58167
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207105
...done!
maximalDeformation: 0.13505
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54064
...done!
=======================
Good trial move (maximal deformation: 0.13505, lambda: 87.4257)
        Cost going from 58167 to 58167
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22087
...done!
maximalDeformation: 0.168125
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57492
...done!
=======================
Good trial move (maximal deformation: 0.168125, lambda: 79.4779)
        Cost going from 58167 to 58166.9
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220196
...done!
maximalDeformation: 0.176076
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56533
...done!
=======================
Good trial move (maximal deformation: 0.176076, lambda: 72.2527)
        Cost going from 58166.9 to 58166.8
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23292
...done!
maximalDeformation: 0.173889
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.593
...done!
=======================
Good trial move (maximal deformation: 0.173889, lambda: 65.6842)
        Cost going from 58166.8 to 58166.8
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.227395
...done!
maximalDeformation: 0.213001
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5855
...done!
=======================
Good trial move (maximal deformation: 0.213001, lambda: 59.7129)
        Cost going from 58166.8 to 58166.7
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243446
...done!
maximalDeformation: 0.288858
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60649
...done!
=======================
Good trial move (maximal deformation: 0.288858, lambda: 54.2845)
        Cost going from 58166.7 to 58166.6
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24247
...done!
maximalDeformation: 0.274005
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60472
...done!
=======================
Good trial move (maximal deformation: 0.274005, lambda: 49.3495)
        Cost going from 58166.6 to 58166.6
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57518.2
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57518.2
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 26 was 58169.9
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xdca7820)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 79400971
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54149
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194892
...done!
maximalDeformation: 4.53137
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 158952 has managed to turn bad (detJ: -0.308796)
Time taken to rasterize Levenberg-Marquardt: 0.00772381
...done!
=======================
Bad trial move (maximal deformation: 4.53137, lambda: 1)
        Cost going from 58166.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190457
...done!
maximalDeformation: 2.95423
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.809387)
Time taken to rasterize Levenberg-Marquardt: 0.0359631
...done!
=======================
Bad trial move (maximal deformation: 2.95423, lambda: 2)
        Cost going from 58166.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186457
...done!
maximalDeformation: 1.78981
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 613057 has managed to turn bad (detJ: -0.0152817)
Time taken to rasterize Levenberg-Marquardt: 0.0561628
...done!
=======================
Bad trial move (maximal deformation: 1.78981, lambda: 4)
        Cost going from 58166.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182087
...done!
maximalDeformation: 1.01525
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1652151 has managed to turn bad (detJ: -0.0916878)
Time taken to rasterize Levenberg-Marquardt: 0.437713
...done!
=======================
Bad trial move (maximal deformation: 1.01525, lambda: 8)
        Cost going from 58166.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181949
...done!
maximalDeformation: 0.543879
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48633
...done!
=======================
Bad trial move (maximal deformation: 0.543879, lambda: 16)
        Cost going from 58166.6 to 58171
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18134
...done!
maximalDeformation: 0.283027
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49426
...done!
=======================
Bad trial move (maximal deformation: 0.283027, lambda: 32)
        Cost going from 58166.6 to 58166.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180467
...done!
maximalDeformation: 0.144397
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48882
...done!
=======================
Good trial move (maximal deformation: 0.144397, lambda: 64)
        Cost going from 58166.6 to 58166.2
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196817
...done!
maximalDeformation: 0.189742
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53904
...done!
=======================
Good trial move (maximal deformation: 0.189742, lambda: 58.1818)
        Cost going from 58166.2 to 58166.1
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193455
...done!
maximalDeformation: 0.153677
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5252
...done!
=======================
Good trial move (maximal deformation: 0.153677, lambda: 52.8926)
        Cost going from 58166.1 to 58166
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207556
...done!
maximalDeformation: 0.290887
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55757
...done!
=======================
Bad trial move (maximal deformation: 0.290887, lambda: 48.0841)
        Cost going from 58166 to 58166.1
Transforming mesh
Done transforming mesh
        Increasing lambda from 48.0841 to 96.1683 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195089
...done!
maximalDeformation: 0.148325
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51726
...done!
=======================
Good trial move (maximal deformation: 0.148325, lambda: 96.1683)
        Cost going from 58166 to 58165.8
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202797
...done!
maximalDeformation: 0.147004
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54516
...done!
=======================
Good trial move (maximal deformation: 0.147004, lambda: 87.4257)
        Cost going from 58165.8 to 58165.6
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208435
...done!
maximalDeformation: 0.152287
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55857
...done!
=======================
Good trial move (maximal deformation: 0.152287, lambda: 79.4779)
        Cost going from 58165.6 to 58165.6
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208541
...done!
maximalDeformation: 0.169933
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55145
...done!
=======================
Good trial move (maximal deformation: 0.169933, lambda: 72.2527)
        Cost going from 58165.6 to 58165.5
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219184
...done!
maximalDeformation: 0.205146
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57649
...done!
=======================
Good trial move (maximal deformation: 0.205146, lambda: 65.6842)
        Cost going from 58165.5 to 58165.4
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220986
...done!
maximalDeformation: 0.230956
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5759
...done!
=======================
Good trial move (maximal deformation: 0.230956, lambda: 59.7129)
        Cost going from 58165.4 to 58165.4
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231369
...done!
maximalDeformation: 0.247104
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5977
...done!
=======================
Good trial move (maximal deformation: 0.247104, lambda: 54.2845)
        Cost going from 58165.4 to 58165.4
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232141
...done!
maximalDeformation: 0.238622
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59554
...done!
=======================
Good trial move (maximal deformation: 0.238622, lambda: 49.3495)
        Cost going from 58165.4 to 58165.2
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57515.4
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57515.4
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 27 was 58168.5
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc8143d0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 82530282
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54093
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195848
...done!
maximalDeformation: 6.05209
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 371833 has managed to turn bad (detJ: -0.749193)
Time taken to rasterize Levenberg-Marquardt: 0.0211179
...done!
=======================
Bad trial move (maximal deformation: 6.05209, lambda: 1)
        Cost going from 58165.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192727
...done!
maximalDeformation: 3.69957
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 371833 has managed to turn bad (detJ: -0.160608)
Time taken to rasterize Levenberg-Marquardt: 0.020709
...done!
=======================
Bad trial move (maximal deformation: 3.69957, lambda: 2)
        Cost going from 58165.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187132
...done!
maximalDeformation: 2.16406
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 549406 has managed to turn bad (detJ: -0.241622)
Time taken to rasterize Levenberg-Marquardt: 0.0440431
...done!
=======================
Bad trial move (maximal deformation: 2.16406, lambda: 4)
        Cost going from 58165.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183546
...done!
maximalDeformation: 1.30934
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 672565 has managed to turn bad (detJ: -0.742054)
Time taken to rasterize Levenberg-Marquardt: 0.068485
...done!
=======================
Bad trial move (maximal deformation: 1.30934, lambda: 8)
        Cost going from 58165.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184533
...done!
maximalDeformation: 0.736235
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49195
...done!
=======================
Bad trial move (maximal deformation: 0.736235, lambda: 16)
        Cost going from 58165.2 to 58171.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18165
...done!
maximalDeformation: 0.393962
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48143
...done!
=======================
Bad trial move (maximal deformation: 0.393962, lambda: 32)
        Cost going from 58165.2 to 58165.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181479
...done!
maximalDeformation: 0.204178
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49279
...done!
=======================
Good trial move (maximal deformation: 0.204178, lambda: 64)
        Cost going from 58165.2 to 58164.9
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197189
...done!
maximalDeformation: 0.215881
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54068
...done!
=======================
Good trial move (maximal deformation: 0.215881, lambda: 58.1818)
        Cost going from 58164.9 to 58164.8
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194113
...done!
maximalDeformation: 0.205892
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52597
...done!
=======================
Good trial move (maximal deformation: 0.205892, lambda: 52.8926)
        Cost going from 58164.8 to 58164.8
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207742
...done!
maximalDeformation: 0.261754
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55707
...done!
=======================
Good trial move (maximal deformation: 0.261754, lambda: 48.0841)
        Cost going from 58164.8 to 58164.7
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207004
...done!
maximalDeformation: 0.269938
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5512
...done!
=======================
Bad trial move (maximal deformation: 0.269938, lambda: 43.7129)
        Cost going from 58164.7 to 58164.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 43.7129 to 87.4257 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Time taken to solve the Levenberg-Marquardt system of equations: 0.214891
...done!
maximalDeformation: 0.136861
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55777
...done!
=======================
Good trial move (maximal deformation: 0.136861, lambda: 87.4257)
        Cost going from 58164.7 to 58164.4
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221202
...done!
maximalDeformation: 0.148562
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57109
...done!
=======================
Good trial move (maximal deformation: 0.148562, lambda: 79.4779)
        Cost going from 58164.4 to 58164.2
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225344
...done!
maximalDeformation: 0.160339
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58999
...done!
=======================
Good trial move (maximal deformation: 0.160339, lambda: 72.2527)
        Cost going from 58164.2 to 58164.1
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233391
...done!
maximalDeformation: 0.183316
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59468
...done!
=======================
Good trial move (maximal deformation: 0.183316, lambda: 65.6842)
        Cost going from 58164.1 to 58164.1
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237228
...done!
maximalDeformation: 0.202675
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60429
...done!
=======================
Good trial move (maximal deformation: 0.202675, lambda: 59.7129)
        Cost going from 58164.1 to 58164.1
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243429
...done!
maximalDeformation: 0.230889
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61325
...done!
=======================
Good trial move (maximal deformation: 0.230889, lambda: 54.2845)
        Cost going from 58164.1 to 58163.9
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246589
...done!
maximalDeformation: 0.246027
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60775
...done!
=======================
Good trial move (maximal deformation: 0.246027, lambda: 49.3495)
        Cost going from 58163.9 to 58163.9
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  57512.6
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57512.6
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 28 was 58167.2
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xb254a20)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 85659593
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54895
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199066
...done!
maximalDeformation: 4.78567
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 400427 has managed to turn bad (detJ: -0.121163)
Time taken to rasterize Levenberg-Marquardt: 0.025245
...done!
=======================
Bad trial move (maximal deformation: 4.78567, lambda: 1)
        Cost going from 58163.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19288
...done!
maximalDeformation: 3.24614
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 498473 has managed to turn bad (detJ: -2.17848)
Time taken to rasterize Levenberg-Marquardt: 0.036763
...done!
=======================
Bad trial move (maximal deformation: 3.24614, lambda: 2)
        Cost going from 58163.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188151
...done!
maximalDeformation: 2.07019
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 498473 has managed to turn bad (detJ: -0.953324)
Time taken to rasterize Levenberg-Marquardt: 0.0366862
...done!
=======================
Bad trial move (maximal deformation: 2.07019, lambda: 4)
        Cost going from 58163.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18487
...done!
maximalDeformation: 1.22742
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1358066 has managed to turn bad (detJ: -0.0905806)
Time taken to rasterize Levenberg-Marquardt: 0.291078
...done!
=======================
Bad trial move (maximal deformation: 1.22742, lambda: 8)
        Cost going from 58163.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184196
...done!
maximalDeformation: 0.679578
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.494
...done!
=======================
Bad trial move (maximal deformation: 0.679578, lambda: 16)
        Cost going from 58163.9 to 58171
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18293
...done!
maximalDeformation: 0.360474
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48117
...done!
=======================
Bad trial move (maximal deformation: 0.360474, lambda: 32)
        Cost going from 58163.9 to 58164.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182668
...done!
maximalDeformation: 0.185854
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49443
...done!
=======================
Good trial move (maximal deformation: 0.185854, lambda: 64)
        Cost going from 58163.9 to 58163.6
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2014
...done!
maximalDeformation: 0.182108
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54037
...done!
=======================
Good trial move (maximal deformation: 0.182108, lambda: 58.1818)
        Cost going from 58163.6 to 58163.5
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19681
...done!
maximalDeformation: 0.233675
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52454
...done!
=======================
Bad trial move (maximal deformation: 0.233675, lambda: 52.8926)
        Cost going from 58163.5 to 58163.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 52.8926 to 105.785 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194174
...done!
maximalDeformation: 0.118611
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51638
...done!
=======================
Good trial move (maximal deformation: 0.118611, lambda: 105.785)
        Cost going from 58163.5 to 58163.3
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207847
...done!
maximalDeformation: 0.0999293
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55093
...done!
=======================
Good trial move (maximal deformation: 0.0999293, lambda: 96.1683)
        Cost going from 58163.3 to 58163.2
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206218
...done!
maximalDeformation: 0.127584
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55231
...done!
=======================
Good trial move (maximal deformation: 0.127584, lambda: 87.4257)
        Cost going from 58163.2 to 58163.2
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219842
...done!
maximalDeformation: 0.150867
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57453
...done!
=======================
Good trial move (maximal deformation: 0.150867, lambda: 79.4779)
        Cost going from 58163.2 to 58163.1
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218879
...done!
maximalDeformation: 0.166013
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57468
...done!
=======================
Good trial move (maximal deformation: 0.166013, lambda: 72.2527)
        Cost going from 58163.1 to 58163
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23262
...done!
maximalDeformation: 0.176533
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59547
...done!
=======================
Good trial move (maximal deformation: 0.176533, lambda: 65.6842)
        Cost going from 58163 to 58162.9
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231078
...done!
maximalDeformation: 0.195931
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59139
...done!
=======================
Bad trial move (maximal deformation: 0.195931, lambda: 59.7129)
        Cost going from 58162.9 to 58163
Transforming mesh
Done transforming mesh
        Increasing lambda from 59.7129 to 119.426 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 119.426...
Time taken to solve the Levenberg-Marquardt system of equations: 0.220895
...done!
maximalDeformation: 0.0991206
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57144
...done!
=======================
Good trial move (maximal deformation: 0.0991206, lambda: 119.426)
        Cost going from 58162.9 to 58162.7
        Decreasing lambda from 119.426 to 108.569
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 108.569...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240435
...done!
maximalDeformation: 0.11094
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60294
...done!
=======================
Good trial move (maximal deformation: 0.11094, lambda: 108.569)
        Cost going from 58162.7 to 58162.7
        Decreasing lambda from 108.569 to 98.6991
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232522
...done!
maximalDeformation: 0.143022
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59138
...done!
=======================
Bad trial move (maximal deformation: 0.143022, lambda: 98.6991)
        Cost going from 58162.7 to 58162.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 98.6991 to 197.398 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 197.398...
Time taken to solve the Levenberg-Marquardt system of equations: 0.223363
...done!
maximalDeformation: 0.072102
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56439
...done!
=======================
Good trial move (maximal deformation: 0.072102, lambda: 197.398)
        Cost going from 58162.7 to 58162.6
        Decreasing lambda from 197.398 to 179.453
Starting EM: 
EM Iteration: 0  ->  57510.6
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  57510.6
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 29 was 58165.9
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x2333ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xcc8a640)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 89174716
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.398971 -0.00449516 0.00461907 
    0.00023247 0.368215 0.157222 
    0.064218 -0.158981 0.375753 
  Offset: [41.0685, 4.06882, 17.9766]
  Center: [0, 0, 0]
  Translation: [41.0685, 4.06882, 17.9766]
  Inverse: 
    -2.50053 -0.0146145 0.0368532 
    -0.153215 2.29935 -0.960211 
    0.362527 0.975355 2.24876 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55553
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195008
...done!
maximalDeformation: 3.27756
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 286608 has managed to turn bad (detJ: -0.206137)
Time taken to rasterize Levenberg-Marquardt: 0.0139101
...done!
=======================
Bad trial move (maximal deformation: 3.27756, lambda: 1)
        Cost going from 58162.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190466
...done!
maximalDeformation: 2.08841
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.861055)
Time taken to rasterize Levenberg-Marquardt: 0.0364189
...done!
=======================
Bad trial move (maximal deformation: 2.08841, lambda: 2)
        Cost going from 58162.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185729
...done!
maximalDeformation: 1.23208
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.0710281)
Time taken to rasterize Levenberg-Marquardt: 0.0356131
...done!
=======================
Bad trial move (maximal deformation: 1.23208, lambda: 4)
        Cost going from 58162.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184129
...done!
maximalDeformation: 0.676904
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2718824 has managed to turn bad (detJ: -0.432019)
Time taken to rasterize Levenberg-Marquardt: 1.44842
...done!
=======================
Bad trial move (maximal deformation: 0.676904, lambda: 8)
        Cost going from 58162.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184308
...done!
maximalDeformation: 0.357606
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48771
...done!
=======================
Bad trial move (maximal deformation: 0.357606, lambda: 16)
        Cost going from 58162.6 to 58164.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182354
...done!
maximalDeformation: 0.183337
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48037
...done!
=======================
Bad trial move (maximal deformation: 0.183337, lambda: 32)
        Cost going from 58162.6 to 58162.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182494
...done!
maximalDeformation: 0.0929471
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48996
...done!
=======================
Good trial move (maximal deformation: 0.0929471, lambda: 64)
        Cost going from 58162.6 to 58162.6
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202188
...done!
maximalDeformation: 0.248952
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54475
...done!
=======================
Bad trial move (maximal deformation: 0.248952, lambda: 58.1818)
        Cost going from 58162.6 to 58162.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 58.1818 to 116.364 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 116.364...
Time taken to solve the Levenberg-Marquardt system of equations: 0.20616
...done!
maximalDeformation: 0.12578
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53265
...done!
=======================
Good trial move (maximal deformation: 0.12578, lambda: 116.364)
        Cost going from 58162.6 to 58162.5
        Decreasing lambda from 116.364 to 105.785
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196714
...done!
maximalDeformation: 0.094659
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52718
...done!
=======================
Good trial move (maximal deformation: 0.094659, lambda: 105.785)
        Cost going from 58162.5 to 58162.4
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.216168
...done!
maximalDeformation: 0.176869
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56064
...done!
=======================
Good trial move (maximal deformation: 0.176869, lambda: 96.1683)
        Cost going from 58162.4 to 58162.4
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202023
...done!
maximalDeformation: 0.150405
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5324
...done!
=======================
Good trial move (maximal deformation: 0.150405, lambda: 87.4257)
        Cost going from 58162.4 to 58162.4
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22641
...done!
maximalDeformation: 0.19501
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57809
...done!
=======================
Good trial move (maximal deformation: 0.19501, lambda: 79.4779)
        Cost going from 58162.4 to 58162.3
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214752
...done!
maximalDeformation: 0.192555
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56399
...done!
=======================
Good trial move (maximal deformation: 0.192555, lambda: 72.2527)
        Cost going from 58162.3 to 58162.2
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238371
...done!
maximalDeformation: 0.191202
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60001
...done!
=======================
Good trial move (maximal deformation: 0.191202, lambda: 65.6842)
        Cost going from 58162.2 to 58162.2
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226629
...done!
maximalDeformation: 0.212132
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58535
...done!
=======================
Good trial move (maximal deformation: 0.212132, lambda: 59.7129)
        Cost going from 58162.2 to 58162.1
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247283
...done!
maximalDeformation: 0.24759
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60288
...done!
=======================
Bad trial move (maximal deformation: 0.24759, lambda: 54.2845)
        Cost going from 58162.1 to 58162.1
Transforming mesh
Done transforming mesh
        Increasing lambda from 54.2845 to 108.569 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 108.569...
Time taken to solve the Levenberg-Marquardt system of equations: 0.249583
...done!
maximalDeformation: 0.126394
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58283
...done!
=======================
Good trial move (maximal deformation: 0.126394, lambda: 108.569)
        Cost going from 58162.1 to 58161.8
        Decreasing lambda from 108.569 to 98.6991
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235513
...done!
maximalDeformation: 0.0914217
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59161
...done!
=======================
Good trial move (maximal deformation: 0.0914217, lambda: 98.6991)
        Cost going from 58161.8 to 58161.7
        Decreasing lambda from 98.6991 to 89.7264
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
numberOfBasisFunctions: 1
numberOfVoxelsInMask: 221536
indexWhereUnityIsReached [45, 55, 85]
Successfully put up x, y, and z
Constructing basis functions
      (xOrder, yOrder, zOrder): (0, 0, 0)
Transforming points
Transforming points
Mapping warped mesh back to original space
Transforming points
Abusing EM segmenter now...
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
Original class 2 is distributed over 1 classes
Original class 3 is distributed over 1 classes
Original class 4 is distributed over 1 classes
Original class 5 is distributed over 1 classes
Original class 6 is distributed over 1 classes
Original class 7 is distributed over 1 classes
Original class 8 is distributed over 1 classes
Original class 9 is distributed over 1 classes
Original class 10 is distributed over 1 classes
OK
myAbusedEMSegmenter->GetMeans(): [ 1 1 255 1 255 255 255 255 255 255 255]
myAbusedEMSegmenter->GetVariances(): [ 1 1 1 1 1 1 1 1 1 1 1]
myAbusedEMSegmenter->GetPriorWeights(): [ 1 1 1 1 1 1 1 1 1 1 1]
-- Starting
-- Initializing
-- Doing the rest
-- Starting to update posteriors
-- done
Still here...
Splitting affine matrix up into spacing, origin, and direction components
AffineTransform (0xba99b80)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 92570526
  Debug: Off
  Observers: 
    none
  Matrix: 
    -1 -5.96046e-08 0 
    0 0 1 
    5.96046e-08 -1 0 
  Offset: [1.50021, -23.3535, 8.60744]
  Center: [0, 0, 0]
  Translation: [1.50021, -23.3535, 8.60744]
  Inverse: 
    -1 0 5.96046e-08 
    -5.96046e-08 0 -1 
    0 1 0 
  Singular: 0
spacing: [1, 1, 1]
origin: [1.50021, -23.3535, 8.60744]
direction: -1 -5.96046e-08 0
0 0 1
5.96046e-08 -1 0

done!
kvlBinaryThresholdImage aseg.mgz 17
imageFileName: aseg.mgz
lowerThreshold: 17
upperThreshold: 17
insideValue: 255
outsideValue: 0
Thresholding: 
  0%
  0.999975%
  1.99995%
  2.99993%
  3.9999%
  4.99988%
  5.99985%
  6.99983%
  7.9998%
  8.99978%
  9.99975%
  10.9997%
  11.9997%
  12.9997%
  13.9997%
  14.9996%
  15.9996%
  16.9996%
  17.9996%
  18.9995%
  19.9995%
  20.9995%
  21.9995%
  22.9994%
  23.9994%
  24.9994%
  25.9994%
  26.9993%
  27.9993%
  28.9993%
  29.9993%
  30.9992%
  31.9992%
  32.9992%
  33.9992%
  34.9991%
  35.9991%
  36.9991%
  37.9991%
  38.999%
  39.999%
  40.999%
  41.999%
  42.9989%
  43.9989%
  44.9989%
  45.9989%
  46.9988%
  47.9988%
  48.9988%
  49.9988%
  50.9987%
  51.9987%
  52.9987%
  53.9987%
  54.9986%
  55.9986%
  56.9986%
  57.9986%
  58.9985%
  59.9985%
  60.9985%
  61.9985%
  62.9984%
  63.9984%
  64.9984%
  65.9984%
  66.9983%
  67.9983%
  68.9983%
  69.9983%
  70.9982%
  71.9982%
  72.9982%
  73.9982%
  74.9981%
  75.9981%
  76.9981%
  77.9981%
  78.998%
  79.998%
  80.998%
  81.998%
  82.9979%
  83.9979%
  84.9979%
  85.9979%
  86.9978%
  87.9978%
  88.9978%
  89.9978%
  90.9977%
  91.9977%
  92.9977%
  93.9977%
  94.9976%
  95.9976%
  96.9976%
  97.9976%
  98.9975%
  99.9975%
  100%
  100%
Wrote out aseg_thresholded.mgz
kvlMathematicalMorphology aseg_thresholded.mgz dilate 3
imageFileName: aseg_thresholded.mgz
radius: 3
Using dilating filter
dilate: 
  0%
  0.999999%
  2%
  3%
  4%
  5%
  5.99999%
  6.99999%
  7.99999%
  8.99999%
  9.99999%
  11%
  12%
  13%
  14%
  15%
  16%
  17%
  18%
  19%
  20%
  21%
  22%
  23%
  24%
  25%
  26%
  27%
  28%
  29%
  30%
  31%
  32%
  33%
  34%
  35%
  36%
  37%
  38%
  39%
  40%
  41%
  42%
  43%
  44%
  45%
  46%
  47%
  48%
  49%
  50%
  51%
  52%
  53%
  53.9999%
  55%
  56%
  57%
  58%
  59%
  60%
  60.9999%
  61.9999%
  62.9999%
  63.9999%
  64.9999%
  65.9999%
  66.9999%
  67.9999%
  68.9999%
  69.9999%
  70.9999%
  71.9999%
  72.9999%
  73.9999%
  74.9999%
  75.9999%
  76.9999%
  77.9999%
  78.9999%
  79.9999%
  80.9999%
  81.9999%
  82.9999%
  83.9999%
  84.9999%
  85.9999%
  86.9999%
  87.9999%
  88.9999%
  89.9999%
  90.9999%
  91.9999%
  92.9999%
  93.9999%
  94.9999%
  95.9999%
  96.9999%
  97.9999%
  98.9999%
  99.9999%
  100%

Wrote output to aseg_thresholded_dilate_radius3.mgz
kvlMaskImage nu.mgz aseg_thresholded_dilate_radius3.mgz
Masking: 
  0%
  0.999975%
  1.99995%
  2.99993%
  3.9999%
  4.99988%
  5.99985%
  6.99983%
  7.9998%
  8.99978%
  9.99975%
  10.9997%
  11.9997%
  12.9997%
  13.9997%
  14.9996%
  15.9996%
  16.9996%
  17.9996%
  18.9995%
  19.9995%
  20.9995%
  21.9995%
  22.9994%
  23.9994%
  24.9994%
  25.9994%
  26.9993%
  27.9993%
  28.9993%
  29.9993%
  30.9992%
  31.9992%
  32.9992%
  33.9992%
  34.9991%
  35.9991%
  36.9991%
  37.9991%
  38.999%
  39.999%
  40.999%
  41.999%
  42.9989%
  43.9989%
  44.9989%
  45.9989%
  46.9988%
  47.9988%
  48.9988%
  49.9988%
  50.9987%
  51.9987%
  52.9987%
  53.9987%
  54.9986%
  55.9986%
  56.9986%
  57.9986%
  58.9985%
  59.9985%
  60.9985%
  61.9985%
  62.9984%
  63.9984%
  64.9984%
  65.9984%
  66.9983%
  67.9983%
  68.9983%
  69.9983%
  70.9982%
  71.9982%
  72.9982%
  73.9982%
  74.9981%
  75.9981%
  76.9981%
  77.9981%
  78.998%
  79.998%
  80.998%
  81.998%
  82.9979%
  83.9979%
  84.9979%
  85.9979%
  86.9978%
  87.9978%
  88.9978%
  89.9978%
  90.9977%
  91.9977%
  92.9977%
  93.9977%
  94.9976%
  95.9976%
  96.9976%
  97.9976%
  98.9975%
  99.9975%
  100%
  100%
Wrote masked image to file nu_masked.mgz
Using nu_masked.mgz
kvlUpsample nu_masked.mgz 2 2 2
inputImage: nu_masked.mgz
upsamplingFactorX: 2
upsamplingFactorY: 2
upsamplingFactorZ: 2
Resampling: 
  0%
  0.999999%
  2%
  3%
  4%
  5%
  5.99999%
  6.99999%
  7.99999%
  8.99999%
  9.99999%
  11%
  12%
  13%
  14%
  15%
  16%
  17%
  18%
  19%
  20%
  21%
  22%
  23%
  24%
  25%
  26%
  27%
  28%
  29%
  30%
  31%
  32%
  33%
  34%
  35%
  36%
  37%
  38%
  39%
  40%
  41%
  42%
  43%
  44%
  45%
  46%
  47%
  48%
  49%
  50%
  51%
  52%
  53%
  53.9999%
  54.9999%
  55.9999%
  56.9999%
  57.9999%
  58.9999%
  59.9999%
  60.9999%
  61.9999%
  62.9999%
  63.9999%
  64.9999%
  65.9999%
  66.9999%
  67.9999%
  68.9999%
  69.9999%
  70.9999%
  71.9999%
  72.9999%
  73.9999%
  74.9999%
  75.9999%
  76.9999%
  77.9999%
  78.9999%
  79.9999%
  80.9999%
  81.9999%
  82.9999%
  83.9999%
  84.9999%
  85.9999%
  86.9999%
  87.9999%
  88.9999%
  89.9999%
  90.9999%
  91.9999%
  92.9999%
  93.9999%
  94.9999%
  95.9999%
  96.9999%
  97.9999%
  98.9999%
  99.9999%
  100%
  100%
Wrote to file nu_masked_upsampled_2_2_2.mgz
echo \# Configuration without partial voluming > configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo logDirectory: segmentationWithoutPartialVolumingLog >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo imageFileName: nu_masked_upsampled_2_2_2.mgz >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo meshCollectionFileName: deformableRegistrationLog/warpedOriginalMesh.txt.gz >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo startingMeshNumber: 0 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo K: 0.01 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo compressionLookupTableFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/compressionLookupTable_left.txt >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo boundingFileName: imageDump_coregistered.mgz >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo sameGaussianParameters: 2 553 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo sameGaussianParameters: 3 17 550 552 554 556 557 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo sameGaussianParameters: 24 555 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo imageSmoothingSigmas: 0 0 0 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo meshSmoothingSigmas: 1 0.5 0 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
kvlSegmentWithoutGUI configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
m_LogDirectory: segmentationWithoutPartialVolumingLog
m_ImageFileName: nu_masked_upsampled_2_2_2.mgz
m_MeshCollectionFileName: deformableRegistrationLog/warpedOriginalMesh.txt.gz
m_StartingMeshNumber: 0
m_K: 0.01
m_CompressionLookupTableFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/compressionLookupTable_left.txt
m_BoundingFileName: imageDump_coregistered.mgz
m_SameGaussianParameters[ 0 ]:  2 553
m_SameGaussianParameters[ 1 ]:  3 17 550 552 554 556 557
m_SameGaussianParameters[ 2 ]:  24 555
m_ImageSmoothingSigmas:  0 0 0
m_MeshSmoothingSigmas:  1 0.5 0
Having m_LogDirectorysegmentationWithoutPartialVolumingLog/
Having downSamplingFactor of 1
Constructing image-to-world transform from MGH header information (nu_masked_upsampled_2_2_2.mgz)
Returning the following transform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 226
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.5 6.51926e-09 0 
    0 0 0.5 
    2.98023e-08 -0.5 0 
  Offset: [127.75, -86.6035, 119.857]
  Center: [0, 0, 0]
  Translation: [127.75, -86.6035, 119.857]
  Inverse: 
    -2 0 1.19209e-07 
    -1.19209e-07 0 -2 
    0 2 0 
  Singular: 0
Constructing image-to-world transform from MGH header information (imageDump_coregistered.mgz)
Returning the following transform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 246
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.398971 0.00449514 -0.00461907 
    0.064218 -0.158981 0.375753 
    -0.000232494 -0.368215 -0.157222 
  Offset: [-39.5683, -5.37696, 4.53862]
  Center: [0, 0, 0]
  Translation: [-39.5683, -5.37696, 4.53862]
  Inverse: 
    2.50053 0.0368533 0.0146143 
    0.153215 -0.96021 -2.29935 
    -0.362527 2.24876 -0.975355 
  Singular: 0
Transform before cropping: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 248
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [334.637, 230.638, 162.453]
  Center: [0, 0, 0]
  Translation: [334.637, 230.638, 162.453]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
WorldToImageTransform before cropping: 
AffineTransform (0x23e45e0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 250
  Debug: Off
  Observers: 
    none
  Matrix: 
    -2 0 1.19209e-07 
    -1.19209e-07 0 -2 
    0 2 0 
  Offset: [255.5, 239.715, 173.207]
  Center: [0, 0, 0]
  Translation: [255.5, 239.715, 173.207]
  Inverse: 
    -0.5 -2.98023e-08 0 
    0 0 0.5 
    2.98023e-08 -0.5 0 
  Singular: 0
 m_BoundingBoxSize: [94, 66,144]
 minimalMappedCoordinate: [259.844, 230.638,141.786]
 maximalMappedCoordinate: [335.958, 323.514,281.863]
Cropping with min [252  221  127]
          and max [343  333  296]
m_OriginalImageRegion before checking margins: ImageRegion (0x23e4230)
  Dimension: 3
  Index: [252, 221, 127]
  Size: [92, 113, 170]

m_CroppedImageRegion before checking margins: ImageRegion (0x23e41f8)
  Dimension: 3
  Index: [0, 0, 0]
  Size: [92, 113, 170]


m_OriginalImageRegion after checking margins: ImageRegion (0x23e4230)
  Dimension: 3
  Index: [252, 221, 127]
  Size: [92, 113, 170]

m_CroppedImageRegion after checking margins: ImageRegion (0x23e41f8)
  Dimension: 3
  Index: [0, 0, 0]
  Size: [92, 113, 170]

Transform after cropping: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
WorldToImageTransform after cropping: 
AffineTransform (0x23e45e0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 392
  Debug: Off
  Observers: 
    none
  Matrix: 
    -2 0 1.19209e-07 
    -1.19209e-07 0 -2 
    0 2 0 
  Offset: [3.50041, 18.7149, 46.207]
  Center: [0, 0, 0]
  Translation: [3.50041, 18.7149, 46.207]
  Inverse: 
    -0.5 -2.98023e-08 0 
    0 0 0.5 
    2.98023e-08 -0.5 0 
  Singular: 0
Setting K of mesh collection to: 0.01
Applying transform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Transforming points
Transforming points
Careful here: the applied transformation will turn positive tetrahedra into negative ones.
-0.797941 -0.00899033 0.00923813
0.00046494 0.73643 0.314445
0.128436 -0.317963 0.751506

 determinant: -0.522621
Starting to swap the point assignments of each tetrahedron...
...done!
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 0
maximum: 147
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
Original class 2 is distributed over 1 classes
Original class 3 is distributed over 1 classes
Original class 4 is distributed over 1 classes
Original class 5 is distributed over 1 classes
Original class 6 is distributed over 1 classes
Original class 7 is distributed over 1 classes
Original class 8 is distributed over 1 classes
Original class 9 is distributed over 1 classes
Original class 10 is distributed over 1 classes
OK
Setting coregisterToPosteriorProbabilities to 0
Setting biasFieldOrder to 0
Building labels...
...done! (m_Labels.size(): 11)
m_InternalToExternalLookupTable: 
    0  -> 0 (Left-Cerebral-White-Matter)
    1  -> 1 (Left-Cerebral-Cortex)
    2  -> 3 (Left-Hippocampus)
    3  -> 2 (CSF)
    4  -> 5 (left_CA2_3)
    5  -> 9 (left_CA1)
    6  -> 4 (left_fimbria)
    7  -> 7 (left_presubiculum)
    8  -> 10 (left_hippocampal_fissure)
    9  -> 6 (left_CA4_DG)
    10  -> 8 (left_subiculum)
m_InternalToReducedLookupTable: 
     0 (Left-Cerebral-White-Matter) -> 0
     1 (Left-Cerebral-Cortex) -> 1
     2 (Left-Hippocampus) -> 1
     3 (CSF) -> 2
     4 (left_CA2_3) -> 1
     5 (left_CA1) -> 1
     6 (left_fimbria) -> 0
     7 (left_presubiculum) -> 1
     8 (left_hippocampal_fissure) -> 2
     9 (left_CA4_DG) -> 1
     10 (left_subiculum) -> 1
original label 0 is distributed over 1 distributed labels
original label 1 is distributed over 1 distributed labels
original label 2 is distributed over 1 distributed labels
original label 3 is distributed over 1 distributed labels
original label 4 is distributed over 1 distributed labels
original label 5 is distributed over 1 distributed labels
original label 6 is distributed over 1 distributed labels
original label 7 is distributed over 1 distributed labels
original label 8 is distributed over 1 distributed labels
original label 9 is distributed over 1 distributed labels
original label 10 is distributed over 1 distributed labels
numberOfReducedLabels: 3
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
Original class 2 is distributed over 1 classes
OK
Smoothing mesh collection...done!
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 0
maximum: 147
Running for smoothing sigma 1
Starting EM: 
Updating mixture model parameters
Readjusting weight of shared classes
m_Means: [  101.1 81.8288 65.1543 ]
Splitting shared classes
EM Iteration: 0  ->  575572
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
Setting up m_BiasFieldResidueSmoother
Initalizing
numberOfBasisFunctions: 1
numberOfVoxelsInMask: 134360
indexWhereUnityIsReached [91, 112, 169]
Successfully put up x, y, and z
Constructing basis functions
      (xOrder, yOrder, zOrder): (0, 0, 0)
done!
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  104.855 81.4731 58.3243 ]
EM Iteration: 1  ->  565484
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  106.352 81.227 55.8276 ]
EM Iteration: 2  ->  562854
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.105 81.1556 54.701 ]
EM Iteration: 3  ->  562116
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.493 81.1571 54.1158 ]
EM Iteration: 4  ->  561903
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.693 81.1764 53.7916 ]
EM Iteration: 5  ->  561839
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.8 81.1966 53.6058 ]
EM Iteration: 6  ->  561821
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.856 81.2115 53.4953 ]
EM Iteration: 7  ->  561814
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.89 81.2215 53.4295 ]
EM Iteration: 8  ->  561813
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.908 81.2284 53.3905 ]
EM Iteration: 9  ->  561812
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.916 81.2325 53.367 ]
EM Iteration: 10  ->  561812
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.919 81.235 53.3528 ]
EM Iteration: 11  ->  561812
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 11
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 0 was 567063
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x98e82b0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 1241417
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53814
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213496
...done!
maximalDeformation: 12.0282
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 161401 has managed to turn bad (detJ: -0.08012)
Time taken to rasterize Levenberg-Marquardt: 0.00679398
...done!
=======================
Bad trial move (maximal deformation: 12.0282, lambda: 1)
        Cost going from 566437 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.178537
...done!
maximalDeformation: 7.90776
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 249821 has managed to turn bad (detJ: -0.030912)
Time taken to rasterize Levenberg-Marquardt: 0.010309
...done!
=======================
Bad trial move (maximal deformation: 7.90776, lambda: 2)
        Cost going from 566437 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.172863
...done!
maximalDeformation: 4.7633
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 381015 has managed to turn bad (detJ: -0.152454)
Time taken to rasterize Levenberg-Marquardt: 0.0219619
...done!
=======================
Bad trial move (maximal deformation: 4.7633, lambda: 4)
        Cost going from 566437 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.171025
...done!
maximalDeformation: 2.68584
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1468842 has managed to turn bad (detJ: -0.39192)
Time taken to rasterize Levenberg-Marquardt: 0.366978
...done!
=======================
Bad trial move (maximal deformation: 2.68584, lambda: 8)
        Cost going from 566437 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.171169
...done!
maximalDeformation: 1.44093
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62774
...done!
=======================
Good trial move (maximal deformation: 1.44093, lambda: 16)
        Cost going from 566437 to 563950
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.173135
...done!
maximalDeformation: 0.72228
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51215
...done!
=======================
Good trial move (maximal deformation: 0.72228, lambda: 14.5455)
        Cost going from 563950 to 561696
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.191129
...done!
maximalDeformation: 0.808975
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67089
...done!
=======================
Good trial move (maximal deformation: 0.808975, lambda: 13.2231)
        Cost going from 561696 to 559657
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192483
...done!
maximalDeformation: 0.916739
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55427
...done!
=======================
Good trial move (maximal deformation: 0.916739, lambda: 12.021)
        Cost going from 559657 to 557756
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.191766
...done!
maximalDeformation: 1.37513
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67598
...done!
=======================
Good trial move (maximal deformation: 1.37513, lambda: 10.9282)
        Cost going from 557756 to 556002
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206435
...done!
maximalDeformation: 1.13025
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -0.0453247)
Time taken to rasterize Levenberg-Marquardt: 0.0260549
...done!
=======================
Bad trial move (maximal deformation: 1.13025, lambda: 9.93474)
        Cost going from 556002 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 9.93474 to 19.8695 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Time taken to solve the Levenberg-Marquardt system of equations: 0.205453
...done!
maximalDeformation: 0.633185
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58068
...done!
=======================
Good trial move (maximal deformation: 0.633185, lambda: 19.8695)
        Cost going from 556002 to 555057
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212431
...done!
maximalDeformation: 0.701666
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72982
...done!
=======================
Good trial move (maximal deformation: 0.701666, lambda: 18.0632)
        Cost going from 555057 to 554118
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221403
...done!
maximalDeformation: 0.6912
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62922
...done!
=======================
Good trial move (maximal deformation: 0.6912, lambda: 16.4211)
        Cost going from 554118 to 553194
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228383
...done!
maximalDeformation: 0.846571
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76686
...done!
=======================
Good trial move (maximal deformation: 0.846571, lambda: 14.9282)
        Cost going from 553194 to 552269
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235798
...done!
maximalDeformation: 0.904677
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63417
...done!
=======================
Good trial move (maximal deformation: 0.904677, lambda: 13.5711)
        Cost going from 552269 to 551329
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238648
...done!
maximalDeformation: 0.90694
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77546
...done!
=======================
Good trial move (maximal deformation: 0.90694, lambda: 12.3374)
        Cost going from 551329 to 550386
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  546310
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.025 80.6653 51.8824 ]
EM Iteration: 1  ->  545326
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.122 80.5736 51.1077 ]
EM Iteration: 2  ->  545140
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.171 80.5663 50.7209 ]
EM Iteration: 3  ->  545099
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.195 80.5745 50.5169 ]
EM Iteration: 4  ->  545089
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.205 80.5812 50.405 ]
EM Iteration: 5  ->  545087
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.212 80.5859 50.3424 ]
EM Iteration: 6  ->  545086
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.214 80.5884 50.3068 ]
EM Iteration: 7  ->  545086
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.216 80.5899 50.2876 ]
EM Iteration: 8  ->  545086
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 8
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 1 was 549641
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xecf5b30)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 3985068
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66832
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199594
...done!
maximalDeformation: 5.94164
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.0561559)
Time taken to rasterize Levenberg-Marquardt: 0.00537777
...done!
=======================
Bad trial move (maximal deformation: 5.94164, lambda: 1)
        Cost going from 549015 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192625
...done!
maximalDeformation: 4.01963
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 248957 has managed to turn bad (detJ: -0.135039)
Time taken to rasterize Levenberg-Marquardt: 0.0104749
...done!
=======================
Bad trial move (maximal deformation: 4.01963, lambda: 2)
        Cost going from 549015 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188271
...done!
maximalDeformation: 2.48553
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2694153 has managed to turn bad (detJ: -0.704306)
Time taken to rasterize Levenberg-Marquardt: 1.44565
...done!
=======================
Bad trial move (maximal deformation: 2.48553, lambda: 4)
        Cost going from 549015 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184848
...done!
maximalDeformation: 1.52904
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52625
...done!
=======================
Good trial move (maximal deformation: 1.52904, lambda: 8)
        Cost going from 549015 to 547700
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207441
...done!
maximalDeformation: 1.45015
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69176
...done!
=======================
Good trial move (maximal deformation: 1.45015, lambda: 7.27273)
        Cost going from 547700 to 546388
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.189786
...done!
maximalDeformation: 1.19103
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 394905 has managed to turn bad (detJ: -0.19927)
Time taken to rasterize Levenberg-Marquardt: 0.0242169
...done!
=======================
Bad trial move (maximal deformation: 1.19103, lambda: 6.61157)
        Cost going from 546388 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.61157 to 13.2231 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189014
...done!
maximalDeformation: 0.667449
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52069
...done!
=======================
Good trial move (maximal deformation: 0.667449, lambda: 13.2231)
        Cost going from 546388 to 545633
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218866
...done!
maximalDeformation: 1.02729
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68161
...done!
=======================
Good trial move (maximal deformation: 1.02729, lambda: 12.021)
        Cost going from 545633 to 544926
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200866
...done!
maximalDeformation: 0.836535
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5804
...done!
=======================
Good trial move (maximal deformation: 0.836535, lambda: 10.9282)
        Cost going from 544926 to 544217
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219721
...done!
maximalDeformation: 0.906087
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70685
...done!
=======================
Good trial move (maximal deformation: 0.906087, lambda: 9.93474)
        Cost going from 544217 to 543501
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21317
...done!
maximalDeformation: 1.09093
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62635
...done!
=======================
Good trial move (maximal deformation: 1.09093, lambda: 9.03158)
        Cost going from 543501 to 542795
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232906
...done!
maximalDeformation: 1.35028
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74108
...done!
=======================
Good trial move (maximal deformation: 1.35028, lambda: 8.21053)
        Cost going from 542795 to 542081
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230316
...done!
maximalDeformation: 1.16402
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66962
...done!
=======================
Good trial move (maximal deformation: 1.16402, lambda: 7.46412)
        Cost going from 542081 to 541382
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247617
...done!
maximalDeformation: 1.1819
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7664
...done!
=======================
Good trial move (maximal deformation: 1.1819, lambda: 6.78556)
        Cost going from 541382 to 540658
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244671
...done!
maximalDeformation: 1.00504
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69662
...done!
=======================
Good trial move (maximal deformation: 1.00504, lambda: 6.16869)
        Cost going from 540658 to 539970
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  535556
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.208 80.3184 49.9139 ]
EM Iteration: 1  ->  535273
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.215 80.263 49.6731 ]
EM Iteration: 2  ->  535236
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.219 80.2506 49.5516 ]
EM Iteration: 3  ->  535231
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.221 80.2479 49.4898 ]
EM Iteration: 4  ->  535230
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.221 80.2474 49.4566 ]
EM Iteration: 5  ->  535231
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 5
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 2 was 540168
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xe477f90)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 6535753
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67606
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204504
...done!
maximalDeformation: 3.1407
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 213265 has managed to turn bad (detJ: -0.192916)
Time taken to rasterize Levenberg-Marquardt: 0.00956511
...done!
=======================
Bad trial move (maximal deformation: 3.1407, lambda: 1)
        Cost going from 539566 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.202549
...done!
maximalDeformation: 2.15633
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1116880 has managed to turn bad (detJ: -0.22022)
Time taken to rasterize Levenberg-Marquardt: 0.209595
...done!
=======================
Bad trial move (maximal deformation: 2.15633, lambda: 2)
        Cost going from 539566 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196982
...done!
maximalDeformation: 1.42802
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2677518 has managed to turn bad (detJ: -0.316538)
Time taken to rasterize Levenberg-Marquardt: 1.46619
...done!
=======================
Bad trial move (maximal deformation: 1.42802, lambda: 4)
        Cost going from 539566 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196285
...done!
maximalDeformation: 0.864349
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59441
...done!
=======================
Good trial move (maximal deformation: 0.864349, lambda: 8)
        Cost going from 539566 to 538968
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21255
...done!
maximalDeformation: 1.24995
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65531
...done!
=======================
Good trial move (maximal deformation: 1.24995, lambda: 7.27273)
        Cost going from 538968 to 538416
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209116
...done!
maximalDeformation: 1.23678
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63981
...done!
=======================
Good trial move (maximal deformation: 1.23678, lambda: 6.61157)
        Cost going from 538416 to 537876
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223721
...done!
maximalDeformation: 1.16881
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68345
...done!
=======================
Good trial move (maximal deformation: 1.16881, lambda: 6.01052)
        Cost going from 537876 to 537346
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222052
...done!
maximalDeformation: 1.27159
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70155
...done!
=======================
Good trial move (maximal deformation: 1.27159, lambda: 5.46411)
        Cost going from 537346 to 536841
        Decreasing lambda from 5.46411 to 4.96737
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.96737...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239715
...done!
maximalDeformation: 1.23786
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 960471 has managed to turn bad (detJ: -0.0199587)
Time taken to rasterize Levenberg-Marquardt: 0.170582
...done!
=======================
Bad trial move (maximal deformation: 1.23786, lambda: 4.96737)
        Cost going from 536841 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4.96737 to 9.93474 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Time taken to solve the Levenberg-Marquardt system of equations: 0.243292
...done!
maximalDeformation: 0.68253
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73346
...done!
=======================
Good trial move (maximal deformation: 0.68253, lambda: 9.93474)
        Cost going from 536841 to 536443
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237014
...done!
maximalDeformation: 0.757359
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73119
...done!
=======================
Good trial move (maximal deformation: 0.757359, lambda: 9.03158)
        Cost going from 536443 to 536113
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249964
...done!
maximalDeformation: 0.94374
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76619
...done!
=======================
Good trial move (maximal deformation: 0.94374, lambda: 8.21053)
        Cost going from 536113 to 535806
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240491
...done!
maximalDeformation: 1.00226
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74291
...done!
=======================
Good trial move (maximal deformation: 1.00226, lambda: 7.46412)
        Cost going from 535806 to 535503
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.262096
...done!
maximalDeformation: 0.87763
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7827
...done!
=======================
Good trial move (maximal deformation: 0.87763, lambda: 6.78556)
        Cost going from 535503 to 535207
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.254669
...done!
maximalDeformation: 0.832761
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7621
...done!
=======================
Good trial move (maximal deformation: 0.832761, lambda: 6.16869)
        Cost going from 535207 to 534897
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  530331
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.203 80.1376 49.4037 ]
EM Iteration: 1  ->  530263
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.19 80.1189 49.3432 ]
EM Iteration: 2  ->  530257
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.183 80.1134 49.311 ]
EM Iteration: 3  ->  530257
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.18 80.1105 49.2926 ]
EM Iteration: 4  ->  530257
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 4
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 3 was 535360
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xd1a19a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 9086418
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67898
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213581
...done!
maximalDeformation: 3.21441
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 571496 has managed to turn bad (detJ: -0.273121)
Time taken to rasterize Levenberg-Marquardt: 0.0539551
...done!
=======================
Bad trial move (maximal deformation: 3.21441, lambda: 1)
        Cost going from 534791 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.22111
...done!
maximalDeformation: 2.11636
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 708879 has managed to turn bad (detJ: -0.254089)
Time taken to rasterize Levenberg-Marquardt: 0.087203
...done!
=======================
Bad trial move (maximal deformation: 2.11636, lambda: 2)
        Cost going from 534791 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.227023
...done!
maximalDeformation: 1.26773
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2514106 has managed to turn bad (detJ: -0.0437846)
Time taken to rasterize Levenberg-Marquardt: 1.31006
...done!
=======================
Bad trial move (maximal deformation: 1.26773, lambda: 4)
        Cost going from 534791 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.227073
...done!
maximalDeformation: 0.758764
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68676
...done!
=======================
Good trial move (maximal deformation: 0.758764, lambda: 8)
        Cost going from 534791 to 534518
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225861
...done!
maximalDeformation: 1.04514
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67284
...done!
=======================
Good trial move (maximal deformation: 1.04514, lambda: 7.27273)
        Cost going from 534518 to 534270
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236761
...done!
maximalDeformation: 1.24441
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72906
...done!
=======================
Good trial move (maximal deformation: 1.24441, lambda: 6.61157)
        Cost going from 534270 to 534048
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240216
...done!
maximalDeformation: 0.872071
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71333
...done!
=======================
Good trial move (maximal deformation: 0.872071, lambda: 6.01052)
        Cost going from 534048 to 533786
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.248979
...done!
maximalDeformation: 0.933601
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2514106 has managed to turn bad (detJ: -0.0879532)
Time taken to rasterize Levenberg-Marquardt: 1.36979
...done!
=======================
Bad trial move (maximal deformation: 0.933601, lambda: 5.46411)
        Cost going from 533786 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 5.46411 to 10.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.251741
...done!
maximalDeformation: 0.55694
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74141
...done!
=======================
Good trial move (maximal deformation: 0.55694, lambda: 10.9282)
        Cost going from 533786 to 533583
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.248403
...done!
maximalDeformation: 0.702102
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73823
...done!
=======================
Good trial move (maximal deformation: 0.702102, lambda: 9.93474)
        Cost going from 533583 to 533414
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.25938
...done!
maximalDeformation: 1.1119
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76871
...done!
=======================
Good trial move (maximal deformation: 1.1119, lambda: 9.03158)
        Cost going from 533414 to 533261
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.257924
...done!
maximalDeformation: 0.760772
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7491
...done!
=======================
Good trial move (maximal deformation: 0.760772, lambda: 8.21053)
        Cost going from 533261 to 533097
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.268353
...done!
maximalDeformation: 0.823254
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.78311
...done!
=======================
Good trial move (maximal deformation: 0.823254, lambda: 7.46412)
        Cost going from 533097 to 532941
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.270333
...done!
maximalDeformation: 0.864188
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76199
...done!
=======================
Good trial move (maximal deformation: 0.864188, lambda: 6.78556)
        Cost going from 532941 to 532766
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.28095
...done!
maximalDeformation: 1.02141
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7884
...done!
=======================
Good trial move (maximal deformation: 1.02141, lambda: 6.16869)
        Cost going from 532766 to 532584
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  527953
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.155 80.0705 49.3048 ]
EM Iteration: 1  ->  527940
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.144 80.0628 49.296 ]
EM Iteration: 2  ->  527940
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.14 80.0607 49.2885 ]
EM Iteration: 3  ->  527940
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 4 was 533105
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xb8d20b0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 11637063
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70826
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212111
...done!
maximalDeformation: 3.84281
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 284292 has managed to turn bad (detJ: -0.237)
Time taken to rasterize Levenberg-Marquardt: 0.0142138
...done!
=======================
Bad trial move (maximal deformation: 3.84281, lambda: 1)
        Cost going from 532558 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.206767
...done!
maximalDeformation: 2.94418
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1866927 has managed to turn bad (detJ: -0.454232)
Time taken to rasterize Levenberg-Marquardt: 0.620038
...done!
=======================
Bad trial move (maximal deformation: 2.94418, lambda: 2)
        Cost going from 532558 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.201488
...done!
maximalDeformation: 2.01001
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1866927 has managed to turn bad (detJ: -0.0412209)
Time taken to rasterize Levenberg-Marquardt: 0.615484
...done!
=======================
Bad trial move (maximal deformation: 2.01001, lambda: 4)
        Cost going from 532558 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.199285
...done!
maximalDeformation: 1.23448
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59037
...done!
=======================
Good trial move (maximal deformation: 1.23448, lambda: 8)
        Cost going from 532558 to 532374
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22192
...done!
maximalDeformation: 0.967942
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67352
...done!
=======================
Good trial move (maximal deformation: 0.967942, lambda: 7.27273)
        Cost going from 532374 to 532228
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209855
...done!
maximalDeformation: 1.17256
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64121
...done!
=======================
Good trial move (maximal deformation: 1.17256, lambda: 6.61157)
        Cost going from 532228 to 532090
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231365
...done!
maximalDeformation: 1.18418
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70709
...done!
=======================
Good trial move (maximal deformation: 1.18418, lambda: 6.01052)
        Cost going from 532090 to 531937
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225221
...done!
maximalDeformation: 0.848407
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2699453 has managed to turn bad (detJ: -0.196658)
Time taken to rasterize Levenberg-Marquardt: 1.59578
...done!
=======================
Bad trial move (maximal deformation: 0.848407, lambda: 5.46411)
        Cost going from 531937 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 5.46411 to 10.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.213639
...done!
maximalDeformation: 0.481897
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.649
...done!
=======================
Good trial move (maximal deformation: 0.481897, lambda: 10.9282)
        Cost going from 531937 to 531786
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241596
...done!
maximalDeformation: 0.551789
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7288
...done!
=======================
Good trial move (maximal deformation: 0.551789, lambda: 9.93474)
        Cost going from 531786 to 531675
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226592
...done!
maximalDeformation: 0.67636
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69538
...done!
=======================
Good trial move (maximal deformation: 0.67636, lambda: 9.03158)
        Cost going from 531675 to 531576
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.253381
...done!
maximalDeformation: 0.681299
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76037
...done!
=======================
Good trial move (maximal deformation: 0.681299, lambda: 8.21053)
        Cost going from 531576 to 531459
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240474
...done!
maximalDeformation: 0.821714
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73099
...done!
=======================
Good trial move (maximal deformation: 0.821714, lambda: 7.46412)
        Cost going from 531459 to 531359
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.262284
...done!
maximalDeformation: 0.987552
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77397
...done!
=======================
Good trial move (maximal deformation: 0.987552, lambda: 6.78556)
        Cost going from 531359 to 531242
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.250882
...done!
maximalDeformation: 0.885649
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75202
...done!
=======================
Good trial move (maximal deformation: 0.885649, lambda: 6.16869)
        Cost going from 531242 to 531135
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  526483
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.11 80.0265 49.3204 ]
EM Iteration: 1  ->  526477
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.097 80.0186 49.3221 ]
EM Iteration: 2  ->  526477
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.092 80.0156 49.3197 ]
EM Iteration: 3  ->  526477
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.088 80.0136 49.3171 ]
EM Iteration: 4  ->  526477
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 4
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 5 was 531653
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa22a2a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 14187728
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71195
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211264
...done!
maximalDeformation: 2.41068
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 398548 has managed to turn bad (detJ: -0.388562)
Time taken to rasterize Levenberg-Marquardt: 0.026196
...done!
=======================
Bad trial move (maximal deformation: 2.41068, lambda: 1)
        Cost going from 531120 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.22277
...done!
maximalDeformation: 1.66984
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 827464 has managed to turn bad (detJ: -0.110623)
Time taken to rasterize Levenberg-Marquardt: 0.119257
...done!
=======================
Bad trial move (maximal deformation: 1.66984, lambda: 2)
        Cost going from 531120 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.229025
...done!
maximalDeformation: 1.06307
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1770112 has managed to turn bad (detJ: -0.00578627)
Time taken to rasterize Levenberg-Marquardt: 0.57882
...done!
=======================
Bad trial move (maximal deformation: 1.06307, lambda: 4)
        Cost going from 531120 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.228587
...done!
maximalDeformation: 0.623325
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68899
...done!
=======================
Good trial move (maximal deformation: 0.623325, lambda: 8)
        Cost going from 531120 to 530983
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230083
...done!
maximalDeformation: 0.617018
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68593
...done!
=======================
Good trial move (maximal deformation: 0.617018, lambda: 7.27273)
        Cost going from 530983 to 530877
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238421
...done!
maximalDeformation: 0.917492
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71928
...done!
=======================
Good trial move (maximal deformation: 0.917492, lambda: 6.61157)
        Cost going from 530877 to 530786
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241251
...done!
maximalDeformation: 0.76142
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71215
...done!
=======================
Good trial move (maximal deformation: 0.76142, lambda: 6.01052)
        Cost going from 530786 to 530690
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249519
...done!
maximalDeformation: 1.09542
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73896
...done!
=======================
Good trial move (maximal deformation: 1.09542, lambda: 5.46411)
        Cost going from 530690 to 530653
        Decreasing lambda from 5.46411 to 4.96737
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.96737...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24503
...done!
maximalDeformation: 0.568364
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73705
...done!
=======================
Good trial move (maximal deformation: 0.568364, lambda: 4.96737)
        Cost going from 530653 to 530493
        Decreasing lambda from 4.96737 to 4.51579
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.51579...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.258623
...done!
maximalDeformation: 0.970056
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75428
...done!
=======================
Good trial move (maximal deformation: 0.970056, lambda: 4.51579)
        Cost going from 530493 to 530394
        Decreasing lambda from 4.51579 to 4.10526
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.10526...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.26387
...done!
maximalDeformation: 1.26424
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1602422 has managed to turn bad (detJ: -0.289611)
Time taken to rasterize Levenberg-Marquardt: 0.492765
...done!
=======================
Bad trial move (maximal deformation: 1.26424, lambda: 4.10526)
        Cost going from 530394 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4.10526 to 8.21053 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Time taken to solve the Levenberg-Marquardt system of equations: 0.263894
...done!
maximalDeformation: 0.721193
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73319
...done!
=======================
Good trial move (maximal deformation: 0.721193, lambda: 8.21053)
        Cost going from 530394 to 530291
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.270099
...done!
maximalDeformation: 1.11494
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76116
...done!
=======================
Good trial move (maximal deformation: 1.11494, lambda: 7.46412)
        Cost going from 530291 to 530202
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.271903
...done!
maximalDeformation: 0.65348
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76265
...done!
=======================
Good trial move (maximal deformation: 0.65348, lambda: 6.78556)
        Cost going from 530202 to 530130
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.275223
...done!
maximalDeformation: 0.781666
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76244
...done!
=======================
Good trial move (maximal deformation: 0.781666, lambda: 6.16869)
        Cost going from 530130 to 530042
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  525378
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.056 79.9815 49.3391 ]
EM Iteration: 1  ->  525374
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.041 79.9709 49.3393 ]
EM Iteration: 2  ->  525374
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.035 79.9673 49.3363 ]
EM Iteration: 3  ->  525374
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 6 was 530552
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc8ea270)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 16738373
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69638
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212418
...done!
maximalDeformation: 4.65041
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 241683 has managed to turn bad (detJ: -0.310876)
Time taken to rasterize Levenberg-Marquardt: 0.0111618
...done!
=======================
Bad trial move (maximal deformation: 4.65041, lambda: 1)
        Cost going from 530031 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.223108
...done!
maximalDeformation: 3.03517
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 398548 has managed to turn bad (detJ: -0.0274663)
Time taken to rasterize Levenberg-Marquardt: 0.0272858
...done!
=======================
Bad trial move (maximal deformation: 3.03517, lambda: 2)
        Cost going from 530031 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.228875
...done!
maximalDeformation: 1.83365
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1372139 has managed to turn bad (detJ: -0.139848)
Time taken to rasterize Levenberg-Marquardt: 0.33599
...done!
=======================
Bad trial move (maximal deformation: 1.83365, lambda: 4)
        Cost going from 530031 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.227979
...done!
maximalDeformation: 1.03192
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67249
...done!
=======================
Bad trial move (maximal deformation: 1.03192, lambda: 8)
        Cost going from 530031 to 530424
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.227446
...done!
maximalDeformation: 0.553234
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66079
...done!
=======================
Good trial move (maximal deformation: 0.553234, lambda: 16)
        Cost going from 530031 to 529951
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22577
...done!
maximalDeformation: 0.396079
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67242
...done!
=======================
Good trial move (maximal deformation: 0.396079, lambda: 14.5455)
        Cost going from 529951 to 529902
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234166
...done!
maximalDeformation: 0.583369
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70974
...done!
=======================
Good trial move (maximal deformation: 0.583369, lambda: 13.2231)
        Cost going from 529902 to 529864
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238493
...done!
maximalDeformation: 0.608922
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70467
...done!
=======================
Good trial move (maximal deformation: 0.608922, lambda: 12.021)
        Cost going from 529864 to 529825
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24679
...done!
maximalDeformation: 0.57984
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73047
...done!
=======================
Good trial move (maximal deformation: 0.57984, lambda: 10.9282)
        Cost going from 529825 to 529786
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247379
...done!
maximalDeformation: 0.60664
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72689
...done!
=======================
Good trial move (maximal deformation: 0.60664, lambda: 9.93474)
        Cost going from 529786 to 529743
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.260194
...done!
maximalDeformation: 0.876565
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75645
...done!
=======================
Good trial move (maximal deformation: 0.876565, lambda: 9.03158)
        Cost going from 529743 to 529702
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.260982
...done!
maximalDeformation: 0.694985
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74893
...done!
=======================
Good trial move (maximal deformation: 0.694985, lambda: 8.21053)
        Cost going from 529702 to 529654
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.271795
...done!
maximalDeformation: 0.674197
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76875
...done!
=======================
Good trial move (maximal deformation: 0.674197, lambda: 7.46412)
        Cost going from 529654 to 529623
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.271747
...done!
maximalDeformation: 0.70678
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2583990 has managed to turn bad (detJ: -0.176454)
Time taken to rasterize Levenberg-Marquardt: 1.4749
...done!
=======================
Bad trial move (maximal deformation: 0.70678, lambda: 6.78556)
        Cost going from 529623 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.78556 to 13.5711 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Time taken to solve the Levenberg-Marquardt system of equations: 0.27356
...done!
maximalDeformation: 0.400481
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73805
...done!
=======================
Good trial move (maximal deformation: 0.400481, lambda: 13.5711)
        Cost going from 529623 to 529557
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.279758
...done!
maximalDeformation: 0.434833
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76364
...done!
=======================
Good trial move (maximal deformation: 0.434833, lambda: 12.3374)
        Cost going from 529557 to 529520
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  524871
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.01 79.9471 49.3492 ]
EM Iteration: 1  ->  524870
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108 79.9402 49.3478 ]
EM Iteration: 2  ->  524870
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 7 was 530034
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xd06cc10)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 19481904
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69156
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212612
...done!
maximalDeformation: 3.88272
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 482886 has managed to turn bad (detJ: -0.296611)
Time taken to rasterize Levenberg-Marquardt: 0.03791
...done!
=======================
Bad trial move (maximal deformation: 3.88272, lambda: 1)
        Cost going from 529516 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.207297
...done!
maximalDeformation: 2.62194
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1010876 has managed to turn bad (detJ: -0.291931)
Time taken to rasterize Levenberg-Marquardt: 0.170838
...done!
=======================
Bad trial move (maximal deformation: 2.62194, lambda: 2)
        Cost going from 529516 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.200873
...done!
maximalDeformation: 1.61133
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59524
...done!
=======================
Bad trial move (maximal deformation: 1.61133, lambda: 4)
        Cost going from 529516 to 529548
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.199017
...done!
maximalDeformation: 0.9149
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58593
...done!
=======================
Good trial move (maximal deformation: 0.9149, lambda: 8)
        Cost going from 529516 to 529492
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219323
...done!
maximalDeformation: 0.672589
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64689
...done!
=======================
Good trial move (maximal deformation: 0.672589, lambda: 7.27273)
        Cost going from 529492 to 529448
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213281
...done!
maximalDeformation: 0.676136
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63547
...done!
=======================
Good trial move (maximal deformation: 0.676136, lambda: 6.61157)
        Cost going from 529448 to 529416
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230393
...done!
maximalDeformation: 1.19874
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67584
...done!
=======================
Good trial move (maximal deformation: 1.19874, lambda: 6.01052)
        Cost going from 529416 to 529366
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224271
...done!
maximalDeformation: 1.56864
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1753383 has managed to turn bad (detJ: -0.0175947)
Time taken to rasterize Levenberg-Marquardt: 0.560169
...done!
=======================
Bad trial move (maximal deformation: 1.56864, lambda: 5.46411)
        Cost going from 529366 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 5.46411 to 10.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.212643
...done!
maximalDeformation: 0.881646
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62681
...done!
=======================
Good trial move (maximal deformation: 0.881646, lambda: 10.9282)
        Cost going from 529366 to 529293
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237179
...done!
maximalDeformation: 0.698419
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68115
...done!
=======================
Good trial move (maximal deformation: 0.698419, lambda: 9.93474)
        Cost going from 529293 to 529251
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22343
...done!
maximalDeformation: 0.872607
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66029
...done!
=======================
Good trial move (maximal deformation: 0.872607, lambda: 9.03158)
        Cost going from 529251 to 529226
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.250811
...done!
maximalDeformation: 0.577375
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70452
...done!
=======================
Good trial move (maximal deformation: 0.577375, lambda: 8.21053)
        Cost going from 529226 to 529185
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236596
...done!
maximalDeformation: 0.779248
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2583990 has managed to turn bad (detJ: -0.0769576)
Time taken to rasterize Levenberg-Marquardt: 1.40143
...done!
=======================
Bad trial move (maximal deformation: 0.779248, lambda: 7.46412)
        Cost going from 529185 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.46412 to 14.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.237031
...done!
maximalDeformation: 0.427963
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66884
...done!
=======================
Good trial move (maximal deformation: 0.427963, lambda: 14.9282)
        Cost going from 529185 to 529146
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.255538
...done!
maximalDeformation: 0.467857
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70265
...done!
=======================
Good trial move (maximal deformation: 0.467857, lambda: 13.5711)
        Cost going from 529146 to 529120
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243466
...done!
maximalDeformation: 0.781426
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69576
...done!
=======================
Good trial move (maximal deformation: 0.781426, lambda: 12.3374)
        Cost going from 529120 to 529099
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  524434
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.981 79.9191 49.3567 ]
EM Iteration: 1  ->  524434
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.973 79.913 49.3558 ]
EM Iteration: 2  ->  524433
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.968 79.9102 49.3539 ]
EM Iteration: 3  ->  524433
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 8 was 529612
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x11ec8e00)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 22225455
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64796
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204556
...done!
maximalDeformation: 3.56342
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 394905 has managed to turn bad (detJ: -1.6384)
Time taken to rasterize Levenberg-Marquardt: 0.02475
...done!
=======================
Bad trial move (maximal deformation: 3.56342, lambda: 1)
        Cost going from 529095 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.200281
...done!
maximalDeformation: 2.33929
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 394905 has managed to turn bad (detJ: -0.410263)
Time taken to rasterize Levenberg-Marquardt: 0.0243158
...done!
=======================
Bad trial move (maximal deformation: 2.33929, lambda: 2)
        Cost going from 529095 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.197707
...done!
maximalDeformation: 1.48617
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1852336 has managed to turn bad (detJ: -0.0584087)
Time taken to rasterize Levenberg-Marquardt: 0.597242
...done!
=======================
Bad trial move (maximal deformation: 1.48617, lambda: 4)
        Cost going from 529095 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192606
...done!
maximalDeformation: 0.880471
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57509
...done!
=======================
Good trial move (maximal deformation: 0.880471, lambda: 8)
        Cost going from 529095 to 529079
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211353
...done!
maximalDeformation: 0.886194
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2699453 has managed to turn bad (detJ: -0.150018)
Time taken to rasterize Levenberg-Marquardt: 1.54283
...done!
=======================
Bad trial move (maximal deformation: 0.886194, lambda: 7.27273)
        Cost going from 529079 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.27273 to 14.5455 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Time taken to solve the Levenberg-Marquardt system of equations: 0.216513
...done!
maximalDeformation: 0.485391
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62952
...done!
=======================
Good trial move (maximal deformation: 0.485391, lambda: 14.5455)
        Cost going from 529079 to 529040
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207421
...done!
maximalDeformation: 0.531798
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6113
...done!
=======================
Good trial move (maximal deformation: 0.531798, lambda: 13.2231)
        Cost going from 529040 to 529014
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225247
...done!
maximalDeformation: 0.841516
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64831
...done!
=======================
Good trial move (maximal deformation: 0.841516, lambda: 12.021)
        Cost going from 529014 to 528998
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212605
...done!
maximalDeformation: 0.406487
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62115
...done!
=======================
Good trial move (maximal deformation: 0.406487, lambda: 10.9282)
        Cost going from 528998 to 528974
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235341
...done!
maximalDeformation: 0.686422
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67128
...done!
=======================
Good trial move (maximal deformation: 0.686422, lambda: 9.93474)
        Cost going from 528974 to 528961
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222288
...done!
maximalDeformation: 0.661515
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66244
...done!
=======================
Good trial move (maximal deformation: 0.661515, lambda: 9.03158)
        Cost going from 528961 to 528931
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24991
...done!
maximalDeformation: 1.11776
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68127
...done!
=======================
Good trial move (maximal deformation: 1.11776, lambda: 8.21053)
        Cost going from 528931 to 528917
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234899
...done!
maximalDeformation: 0.749063
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6648
...done!
=======================
Good trial move (maximal deformation: 0.749063, lambda: 7.46412)
        Cost going from 528917 to 528884
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.255493
...done!
maximalDeformation: 0.914306
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69103
...done!
=======================
Good trial move (maximal deformation: 0.914306, lambda: 6.78556)
        Cost going from 528884 to 528878
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24506
...done!
maximalDeformation: 1.21299
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2405235 has managed to turn bad (detJ: -0.0787507)
Time taken to rasterize Levenberg-Marquardt: 1.16472
...done!
=======================
Bad trial move (maximal deformation: 1.21299, lambda: 6.16869)
        Cost going from 528878 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.16869 to 12.3374 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Time taken to solve the Levenberg-Marquardt system of equations: 0.236979
...done!
maximalDeformation: 0.654764
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65235
...done!
=======================
Good trial move (maximal deformation: 0.654764, lambda: 12.3374)
        Cost going from 528878 to 528814
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  524129
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.958 79.8999 49.3614 ]
EM Iteration: 1  ->  524129
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 9 was 529328
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xe95b0b0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 24968966
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64003
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19741
...done!
maximalDeformation: 3.69799
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.202168)
Time taken to rasterize Levenberg-Marquardt: 0.088536
...done!
=======================
Bad trial move (maximal deformation: 3.69799, lambda: 1)
        Cost going from 528812 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193078
...done!
maximalDeformation: 2.16754
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 938075 has managed to turn bad (detJ: -0.325877)
Time taken to rasterize Levenberg-Marquardt: 0.143015
...done!
=======================
Bad trial move (maximal deformation: 2.16754, lambda: 2)
        Cost going from 528812 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188662
...done!
maximalDeformation: 1.24449
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2699453 has managed to turn bad (detJ: -0.039417)
Time taken to rasterize Levenberg-Marquardt: 1.48459
...done!
=======================
Bad trial move (maximal deformation: 1.24449, lambda: 4)
        Cost going from 528812 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186314
...done!
maximalDeformation: 0.690539
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57394
...done!
=======================
Good trial move (maximal deformation: 0.690539, lambda: 8)
        Cost going from 528812 to 528789
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205653
...done!
maximalDeformation: 0.96084
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61649
...done!
=======================
Good trial move (maximal deformation: 0.96084, lambda: 7.27273)
        Cost going from 528789 to 528786
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197368
...done!
maximalDeformation: 0.705552
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60077
...done!
=======================
Good trial move (maximal deformation: 0.705552, lambda: 6.61157)
        Cost going from 528786 to 528750
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214978
...done!
maximalDeformation: 1.37155
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63534
...done!
=======================
Bad trial move (maximal deformation: 1.37155, lambda: 6.01052)
        Cost going from 528750 to 528763
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.01052 to 12.021 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Time taken to solve the Levenberg-Marquardt system of equations: 0.215504
...done!
maximalDeformation: 0.725011
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63238
...done!
=======================
Good trial move (maximal deformation: 0.725011, lambda: 12.021)
        Cost going from 528750 to 528707
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21016
...done!
maximalDeformation: 0.399054
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6313
...done!
=======================
Good trial move (maximal deformation: 0.399054, lambda: 10.9282)
        Cost going from 528707 to 528682
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223598
...done!
maximalDeformation: 0.753848
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65861
...done!
=======================
Good trial move (maximal deformation: 0.753848, lambda: 9.93474)
        Cost going from 528682 to 528670
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212637
...done!
maximalDeformation: 0.583189
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62734
...done!
=======================
Good trial move (maximal deformation: 0.583189, lambda: 9.03158)
        Cost going from 528670 to 528653
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236293
...done!
maximalDeformation: 0.720301
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67853
...done!
=======================
Good trial move (maximal deformation: 0.720301, lambda: 8.21053)
        Cost going from 528653 to 528639
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225842
...done!
maximalDeformation: 0.703242
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65381
...done!
=======================
Good trial move (maximal deformation: 0.703242, lambda: 7.46412)
        Cost going from 528639 to 528623
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247932
...done!
maximalDeformation: 0.891433
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68181
...done!
=======================
Good trial move (maximal deformation: 0.891433, lambda: 6.78556)
        Cost going from 528623 to 528614
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237844
...done!
maximalDeformation: 1.09249
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67116
...done!
=======================
Bad trial move (maximal deformation: 1.09249, lambda: 6.16869)
        Cost going from 528614 to 528615
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.16869 to 12.3374 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Time taken to solve the Levenberg-Marquardt system of equations: 0.240279
...done!
maximalDeformation: 0.583686
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66483
...done!
=======================
Good trial move (maximal deformation: 0.583686, lambda: 12.3374)
        Cost going from 528614 to 528560
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  523864
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.949 79.8929 49.3744 ]
EM Iteration: 1  ->  523863
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.943 79.8907 49.376 ]
EM Iteration: 2  ->  523864
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 10 was 529074
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa078080)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 27712497
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63815
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201913
...done!
maximalDeformation: 3.89916
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.813056)
Time taken to rasterize Levenberg-Marquardt: 0.00563598
...done!
=======================
Bad trial move (maximal deformation: 3.89916, lambda: 1)
        Cost going from 528558 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196262
...done!
maximalDeformation: 2.43892
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.175655)
Time taken to rasterize Levenberg-Marquardt: 0.00513387
...done!
=======================
Bad trial move (maximal deformation: 2.43892, lambda: 2)
        Cost going from 528558 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191989
...done!
maximalDeformation: 1.4304
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57516
...done!
=======================
Bad trial move (maximal deformation: 1.4304, lambda: 4)
        Cost going from 528558 to 528624
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188146
...done!
maximalDeformation: 0.792201
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58453
...done!
=======================
Good trial move (maximal deformation: 0.792201, lambda: 8)
        Cost going from 528558 to 528546
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205786
...done!
maximalDeformation: 0.906407
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62329
...done!
=======================
Bad trial move (maximal deformation: 0.906407, lambda: 7.27273)
        Cost going from 528546 to 528552
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.27273 to 14.5455 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196762
...done!
maximalDeformation: 0.497638
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61174
...done!
=======================
Good trial move (maximal deformation: 0.497638, lambda: 14.5455)
        Cost going from 528546 to 528521
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197283
...done!
maximalDeformation: 0.785882
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61228
...done!
=======================
Good trial move (maximal deformation: 0.785882, lambda: 13.2231)
        Cost going from 528521 to 528507
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211272
...done!
maximalDeformation: 0.622145
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63363
...done!
=======================
Good trial move (maximal deformation: 0.622145, lambda: 12.021)
        Cost going from 528507 to 528501
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205413
...done!
maximalDeformation: 0.690831
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61221
...done!
=======================
Good trial move (maximal deformation: 0.690831, lambda: 10.9282)
        Cost going from 528501 to 528491
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221175
...done!
maximalDeformation: 0.824948
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65874
...done!
=======================
Good trial move (maximal deformation: 0.824948, lambda: 9.93474)
        Cost going from 528491 to 528488
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217923
...done!
maximalDeformation: 0.738593
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64492
...done!
=======================
Good trial move (maximal deformation: 0.738593, lambda: 9.03158)
        Cost going from 528488 to 528475
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235498
...done!
maximalDeformation: 0.801799
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67444
...done!
=======================
Good trial move (maximal deformation: 0.801799, lambda: 8.21053)
        Cost going from 528475 to 528474
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232688
...done!
maximalDeformation: 1.1031
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67453
...done!
=======================
Good trial move (maximal deformation: 1.1031, lambda: 7.46412)
        Cost going from 528474 to 528465
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246681
...done!
maximalDeformation: 0.948165
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2583990 has managed to turn bad (detJ: -0.00818215)
Time taken to rasterize Levenberg-Marquardt: 1.41838
...done!
=======================
Bad trial move (maximal deformation: 0.948165, lambda: 6.78556)
        Cost going from 528465 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.78556 to 13.5711 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Time taken to solve the Levenberg-Marquardt system of equations: 0.246832
...done!
maximalDeformation: 0.507718
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67926
...done!
=======================
Good trial move (maximal deformation: 0.507718, lambda: 13.5711)
        Cost going from 528465 to 528428
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239277
...done!
maximalDeformation: 0.448956
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67405
...done!
=======================
Good trial move (maximal deformation: 0.448956, lambda: 12.3374)
        Cost going from 528428 to 528413
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  523720
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.939 79.8884 49.3851 ]
EM Iteration: 1  ->  523720
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.937 79.8879 49.3879 ]
EM Iteration: 2  ->  523720
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 11 was 528928
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa0b8550)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 30456028
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64402
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199515
...done!
maximalDeformation: 5.6728
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.306299)
Time taken to rasterize Levenberg-Marquardt: 0.0895119
...done!
=======================
Bad trial move (maximal deformation: 5.6728, lambda: 1)
        Cost going from 528412 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194096
...done!
maximalDeformation: 3.73285
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1047281 has managed to turn bad (detJ: -0.403362)
Time taken to rasterize Levenberg-Marquardt: 0.180236
...done!
=======================
Bad trial move (maximal deformation: 3.73285, lambda: 2)
        Cost going from 528412 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190301
...done!
maximalDeformation: 2.29657
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1866927 has managed to turn bad (detJ: -0.00745323)
Time taken to rasterize Levenberg-Marquardt: 0.606374
...done!
=======================
Bad trial move (maximal deformation: 2.29657, lambda: 4)
        Cost going from 528412 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188649
...done!
maximalDeformation: 1.31484
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5723
...done!
=======================
Bad trial move (maximal deformation: 1.31484, lambda: 8)
        Cost going from 528412 to 528428
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187146
...done!
maximalDeformation: 0.713249
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57822
...done!
=======================
Good trial move (maximal deformation: 0.713249, lambda: 16)
        Cost going from 528412 to 528404
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204596
...done!
maximalDeformation: 0.459838
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62203
...done!
=======================
Good trial move (maximal deformation: 0.459838, lambda: 14.5455)
        Cost going from 528404 to 528397
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199448
...done!
maximalDeformation: 0.486901
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60502
...done!
=======================
Good trial move (maximal deformation: 0.486901, lambda: 13.2231)
        Cost going from 528397 to 528394
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210812
...done!
maximalDeformation: 0.416963
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63105
...done!
=======================
Good trial move (maximal deformation: 0.416963, lambda: 12.021)
        Cost going from 528394 to 528386
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210559
...done!
maximalDeformation: 0.55701
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63681
...done!
=======================
Good trial move (maximal deformation: 0.55701, lambda: 10.9282)
        Cost going from 528386 to 528386
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225309
...done!
maximalDeformation: 0.805336
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65056
...done!
=======================
Good trial move (maximal deformation: 0.805336, lambda: 9.93474)
        Cost going from 528386 to 528380
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225736
...done!
maximalDeformation: 0.762101
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66245
...done!
=======================
Good trial move (maximal deformation: 0.762101, lambda: 9.03158)
        Cost going from 528380 to 528379
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235758
...done!
maximalDeformation: 0.863874
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67522
...done!
=======================
Good trial move (maximal deformation: 0.863874, lambda: 8.21053)
        Cost going from 528379 to 528376
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237913
...done!
maximalDeformation: 0.975562
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67711
...done!
=======================
Bad trial move (maximal deformation: 0.975562, lambda: 7.46412)
        Cost going from 528376 to 528384
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.46412 to 14.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.238391
...done!
maximalDeformation: 0.519073
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66182
...done!
=======================
Good trial move (maximal deformation: 0.519073, lambda: 14.9282)
        Cost going from 528376 to 528347
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24594
...done!
maximalDeformation: 0.438742
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67777
...done!
=======================
Good trial move (maximal deformation: 0.438742, lambda: 13.5711)
        Cost going from 528347 to 528336
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244854
...done!
maximalDeformation: 0.781805
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69141
...done!
=======================
Good trial move (maximal deformation: 0.781805, lambda: 12.3374)
        Cost going from 528336 to 528336
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  523644
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.931 79.8848 49.3941 ]
EM Iteration: 1  ->  523644
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 12 was 528852
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xee3bf80)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 33199539
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62496
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194418
...done!
maximalDeformation: 2.99917
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 394905 has managed to turn bad (detJ: -0.412268)
Time taken to rasterize Levenberg-Marquardt: 0.024961
...done!
=======================
Bad trial move (maximal deformation: 2.99917, lambda: 1)
        Cost going from 528336 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190019
...done!
maximalDeformation: 1.96667
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 887505 has managed to turn bad (detJ: -0.119033)
Time taken to rasterize Levenberg-Marquardt: 0.127693
...done!
=======================
Bad trial move (maximal deformation: 1.96667, lambda: 2)
        Cost going from 528336 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185545
...done!
maximalDeformation: 1.17837
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56949
...done!
=======================
Bad trial move (maximal deformation: 1.17837, lambda: 4)
        Cost going from 528336 to 528433
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182693
...done!
maximalDeformation: 0.655941
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57445
...done!
=======================
Bad trial move (maximal deformation: 0.655941, lambda: 8)
        Cost going from 528336 to 528346
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182999
...done!
maximalDeformation: 0.347836
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5806
...done!
=======================
Good trial move (maximal deformation: 0.347836, lambda: 16)
        Cost going from 528336 to 528324
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199579
...done!
maximalDeformation: 0.362088
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62786
...done!
=======================
Good trial move (maximal deformation: 0.362088, lambda: 14.5455)
        Cost going from 528324 to 528320
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196618
...done!
maximalDeformation: 0.445092
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61264
...done!
=======================
Good trial move (maximal deformation: 0.445092, lambda: 13.2231)
        Cost going from 528320 to 528319
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208722
...done!
maximalDeformation: 0.579041
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63865
...done!
=======================
Good trial move (maximal deformation: 0.579041, lambda: 12.021)
        Cost going from 528319 to 528317
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21015
...done!
maximalDeformation: 0.594259
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64128
...done!
=======================
Good trial move (maximal deformation: 0.594259, lambda: 10.9282)
        Cost going from 528317 to 528313
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221151
...done!
maximalDeformation: 0.602099
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65554
...done!
=======================
Good trial move (maximal deformation: 0.602099, lambda: 9.93474)
        Cost going from 528313 to 528312
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22179
...done!
maximalDeformation: 1.13613
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66986
...done!
=======================
Good trial move (maximal deformation: 1.13613, lambda: 9.03158)
        Cost going from 528312 to 528309
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236508
...done!
maximalDeformation: 0.681477
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6823
...done!
=======================
Bad trial move (maximal deformation: 0.681477, lambda: 8.21053)
        Cost going from 528309 to 528316
Transforming mesh
Done transforming mesh
        Increasing lambda from 8.21053 to 16.4211 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Time taken to solve the Levenberg-Marquardt system of equations: 0.236325
...done!
maximalDeformation: 0.367414
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66761
...done!
=======================
Good trial move (maximal deformation: 0.367414, lambda: 16.4211)
        Cost going from 528309 to 528287
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233436
...done!
maximalDeformation: 0.334468
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68006
...done!
=======================
Good trial move (maximal deformation: 0.334468, lambda: 14.9282)
        Cost going from 528287 to 528278
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242842
...done!
maximalDeformation: 0.485029
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69426
...done!
=======================
Bad trial move (maximal deformation: 0.485029, lambda: 13.5711)
        Cost going from 528278 to 528279
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.5711 to 27.1422 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Time taken to solve the Levenberg-Marquardt system of equations: 0.243406
...done!
maximalDeformation: 0.257244
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67089
...done!
=======================
Good trial move (maximal deformation: 0.257244, lambda: 27.1422)
        Cost going from 528278 to 528272
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234983
...done!
maximalDeformation: 0.203119
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68438
...done!
=======================
Good trial move (maximal deformation: 0.203119, lambda: 24.6748)
        Cost going from 528272 to 528269
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  523586
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.927 79.8814 49.3947 ]
EM Iteration: 1  ->  523585
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.925 79.8798 49.3942 ]
EM Iteration: 2  ->  523585
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.924 79.879 49.3935 ]
EM Iteration: 3  ->  523586
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 13 was 528785
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc0c4250)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 36135996
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65474
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20053
...done!
maximalDeformation: 4.1628
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 482886 has managed to turn bad (detJ: -0.164063)
Time taken to rasterize Levenberg-Marquardt: 0.0372469
...done!
=======================
Bad trial move (maximal deformation: 4.1628, lambda: 1)
        Cost going from 528268 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191564
...done!
maximalDeformation: 2.69297
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2576774 has managed to turn bad (detJ: -0.294871)
Time taken to rasterize Levenberg-Marquardt: 1.3275
...done!
=======================
Bad trial move (maximal deformation: 2.69297, lambda: 2)
        Cost going from 528268 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187601
...done!
maximalDeformation: 1.64387
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2583990 has managed to turn bad (detJ: -0.00630181)
Time taken to rasterize Levenberg-Marquardt: 1.33371
...done!
=======================
Bad trial move (maximal deformation: 1.64387, lambda: 4)
        Cost going from 528268 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185343
...done!
maximalDeformation: 0.943365
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57967
...done!
=======================
Bad trial move (maximal deformation: 0.943365, lambda: 8)
        Cost going from 528268 to 528290
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183832
...done!
maximalDeformation: 0.513324
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5834
...done!
=======================
Bad trial move (maximal deformation: 0.513324, lambda: 16)
        Cost going from 528268 to 528270
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181864
...done!
maximalDeformation: 0.269209
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57959
...done!
=======================
Good trial move (maximal deformation: 0.269209, lambda: 32)
        Cost going from 528268 to 528266
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20047
...done!
maximalDeformation: 0.280058
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62192
...done!
=======================
Good trial move (maximal deformation: 0.280058, lambda: 29.0909)
        Cost going from 528266 to 528263
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196537
...done!
maximalDeformation: 0.435711
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60605
...done!
=======================
Good trial move (maximal deformation: 0.435711, lambda: 26.4463)
        Cost going from 528263 to 528262
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211515
...done!
maximalDeformation: 0.258314
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63564
...done!
=======================
Good trial move (maximal deformation: 0.258314, lambda: 24.0421)
        Cost going from 528262 to 528260
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208751
...done!
maximalDeformation: 0.391084
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64304
...done!
=======================
Good trial move (maximal deformation: 0.391084, lambda: 21.8564)
        Cost going from 528260 to 528259
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225204
...done!
maximalDeformation: 0.510607
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66438
...done!
=======================
Good trial move (maximal deformation: 0.510607, lambda: 19.8695)
        Cost going from 528259 to 528257
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223747
...done!
maximalDeformation: 0.408274
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66529
...done!
=======================
Good trial move (maximal deformation: 0.408274, lambda: 18.0632)
        Cost going from 528257 to 528256
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23762
...done!
maximalDeformation: 0.406017
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68418
...done!
=======================
Good trial move (maximal deformation: 0.406017, lambda: 16.4211)
        Cost going from 528256 to 528252
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236778
...done!
maximalDeformation: 0.814485
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68665
...done!
=======================
Bad trial move (maximal deformation: 0.814485, lambda: 14.9282)
        Cost going from 528252 to 528252
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.9282 to 29.8565 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Time taken to solve the Levenberg-Marquardt system of equations: 0.235774
...done!
maximalDeformation: 0.423923
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67933
...done!
=======================
Good trial move (maximal deformation: 0.423923, lambda: 29.8565)
        Cost going from 528252 to 528246
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245596
...done!
maximalDeformation: 0.440015
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68588
...done!
=======================
Good trial move (maximal deformation: 0.440015, lambda: 27.1422)
        Cost going from 528246 to 528243
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242853
...done!
maximalDeformation: 0.419702
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69243
...done!
=======================
Good trial move (maximal deformation: 0.419702, lambda: 24.6748)
        Cost going from 528243 to 528242
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  523559
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.924 79.8779 49.393 ]
EM Iteration: 1  ->  523559
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.921 79.877 49.3936 ]
EM Iteration: 2  ->  523559
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.919 79.8759 49.3929 ]
EM Iteration: 3  ->  523559
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 14 was 528757
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x11b19fa0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 39072453
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65285
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200445
...done!
maximalDeformation: 5.39877
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.237876)
Time taken to rasterize Levenberg-Marquardt: 0.00573206
...done!
=======================
Bad trial move (maximal deformation: 5.39877, lambda: 1)
        Cost going from 528241 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195736
...done!
maximalDeformation: 3.44127
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.243291)
Time taken to rasterize Levenberg-Marquardt: 0.0890419
...done!
=======================
Bad trial move (maximal deformation: 3.44127, lambda: 2)
        Cost going from 528241 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190967
...done!
maximalDeformation: 2.02548
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58859
...done!
=======================
Bad trial move (maximal deformation: 2.02548, lambda: 4)
        Cost going from 528241 to 528395
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189082
...done!
maximalDeformation: 1.11852
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58618
...done!
=======================
Bad trial move (maximal deformation: 1.11852, lambda: 8)
        Cost going from 528241 to 528264
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186914
...done!
maximalDeformation: 0.592501
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59308
...done!
=======================
Bad trial move (maximal deformation: 0.592501, lambda: 16)
        Cost going from 528241 to 528243
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18527
...done!
maximalDeformation: 0.305322
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58571
...done!
=======================
Good trial move (maximal deformation: 0.305322, lambda: 32)
        Cost going from 528241 to 528238
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200263
...done!
maximalDeformation: 0.272157
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62464
...done!
=======================
Good trial move (maximal deformation: 0.272157, lambda: 29.0909)
        Cost going from 528238 to 528237
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196928
...done!
maximalDeformation: 0.25108
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61373
...done!
=======================
Good trial move (maximal deformation: 0.25108, lambda: 26.4463)
        Cost going from 528237 to 528235
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210667
...done!
maximalDeformation: 0.548083
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64697
...done!
=======================
Good trial move (maximal deformation: 0.548083, lambda: 24.0421)
        Cost going from 528235 to 528234
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211548
...done!
maximalDeformation: 0.352406
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64954
...done!
=======================
Good trial move (maximal deformation: 0.352406, lambda: 21.8564)
        Cost going from 528234 to 528232
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225357
...done!
maximalDeformation: 0.359132
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6625
...done!
=======================
Good trial move (maximal deformation: 0.359132, lambda: 19.8695)
        Cost going from 528232 to 528230
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224963
...done!
maximalDeformation: 0.456836
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66768
...done!
=======================
Good trial move (maximal deformation: 0.456836, lambda: 18.0632)
        Cost going from 528230 to 528228
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237206
...done!
maximalDeformation: 0.680149
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6866
...done!
=======================
Good trial move (maximal deformation: 0.680149, lambda: 16.4211)
        Cost going from 528228 to 528227
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236498
...done!
maximalDeformation: 0.423842
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68535
...done!
=======================
Good trial move (maximal deformation: 0.423842, lambda: 14.9282)
        Cost going from 528227 to 528225
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246694
...done!
maximalDeformation: 0.361156
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69613
...done!
=======================
Good trial move (maximal deformation: 0.361156, lambda: 13.5711)
        Cost going from 528225 to 528223
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246818
...done!
maximalDeformation: 0.580171
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.697
...done!
=======================
Good trial move (maximal deformation: 0.580171, lambda: 12.3374)
        Cost going from 528223 to 528222
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  523528
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.918 79.8732 49.3937 ]
EM Iteration: 1  ->  523529
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 15 was 528739
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x987aaa0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 41815964
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64117
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197933
...done!
maximalDeformation: 3.35182
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 529477 has managed to turn bad (detJ: -0.14707)
Time taken to rasterize Levenberg-Marquardt: 0.044806
...done!
=======================
Bad trial move (maximal deformation: 3.35182, lambda: 1)
        Cost going from 528222 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195308
...done!
maximalDeformation: 2.19966
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 938075 has managed to turn bad (detJ: -0.0447606)
Time taken to rasterize Levenberg-Marquardt: 0.144842
...done!
=======================
Bad trial move (maximal deformation: 2.19966, lambda: 2)
        Cost going from 528222 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189268
...done!
maximalDeformation: 1.33751
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58533
...done!
=======================
Bad trial move (maximal deformation: 1.33751, lambda: 4)
        Cost going from 528222 to 528349
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187618
...done!
maximalDeformation: 0.760173
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58424
...done!
=======================
Bad trial move (maximal deformation: 0.760173, lambda: 8)
        Cost going from 528222 to 528241
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186549
...done!
maximalDeformation: 0.410762
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58428
...done!
=======================
Good trial move (maximal deformation: 0.410762, lambda: 16)
        Cost going from 528222 to 528213
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201888
...done!
maximalDeformation: 0.384086
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64259
...done!
=======================
Good trial move (maximal deformation: 0.384086, lambda: 14.5455)
        Cost going from 528213 to 528209
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197526
...done!
maximalDeformation: 1.07029
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61543
...done!
=======================
Bad trial move (maximal deformation: 1.07029, lambda: 13.2231)
        Cost going from 528209 to 528213
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.2231 to 26.4463 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Time taken to solve the Levenberg-Marquardt system of equations: 0.209538
...done!
maximalDeformation: 0.559681
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6397
...done!
=======================
Good trial move (maximal deformation: 0.559681, lambda: 26.4463)
        Cost going from 528209 to 528203
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212756
...done!
maximalDeformation: 0.244636
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63985
...done!
=======================
Good trial move (maximal deformation: 0.244636, lambda: 24.0421)
        Cost going from 528203 to 528199
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217472
...done!
maximalDeformation: 0.461912
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65856
...done!
=======================
Good trial move (maximal deformation: 0.461912, lambda: 21.8564)
        Cost going from 528199 to 528199
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224287
...done!
maximalDeformation: 0.290177
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66572
...done!
=======================
Good trial move (maximal deformation: 0.290177, lambda: 19.8695)
        Cost going from 528199 to 528197
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231786
...done!
maximalDeformation: 0.590745
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68222
...done!
=======================
Good trial move (maximal deformation: 0.590745, lambda: 18.0632)
        Cost going from 528197 to 528196
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236071
...done!
maximalDeformation: 0.73655
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68114
...done!
=======================
Good trial move (maximal deformation: 0.73655, lambda: 16.4211)
        Cost going from 528196 to 528194
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243399
...done!
maximalDeformation: 0.398495
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69117
...done!
=======================
Bad trial move (maximal deformation: 0.398495, lambda: 14.9282)
        Cost going from 528194 to 528194
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.9282 to 29.8565 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Time taken to solve the Levenberg-Marquardt system of equations: 0.244429
...done!
maximalDeformation: 0.218652
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67692
...done!
=======================
Good trial move (maximal deformation: 0.218652, lambda: 29.8565)
        Cost going from 528194 to 528188
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244506
...done!
maximalDeformation: 0.336046
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6956
...done!
=======================
Good trial move (maximal deformation: 0.336046, lambda: 27.1422)
        Cost going from 528188 to 528186
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251625
...done!
maximalDeformation: 0.557657
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.705
...done!
=======================
Good trial move (maximal deformation: 0.557657, lambda: 24.6748)
        Cost going from 528186 to 528186
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  523495
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.92 79.8734 49.3944 ]
EM Iteration: 1  ->  523495
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 16 was 528702
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xdb4ed50)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 44752381
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63914
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195393
...done!
maximalDeformation: 3.41591
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 588616 has managed to turn bad (detJ: -0.162536)
Time taken to rasterize Levenberg-Marquardt: 0.0556669
...done!
=======================
Bad trial move (maximal deformation: 3.41591, lambda: 1)
        Cost going from 528186 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190762
...done!
maximalDeformation: 2.10069
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.300051)
Time taken to rasterize Levenberg-Marquardt: 0.0882239
...done!
=======================
Bad trial move (maximal deformation: 2.10069, lambda: 2)
        Cost going from 528186 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187366
...done!
maximalDeformation: 1.27868
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1276717 has managed to turn bad (detJ: -0.137191)
Time taken to rasterize Levenberg-Marquardt: 0.27073
...done!
=======================
Bad trial move (maximal deformation: 1.27868, lambda: 4)
        Cost going from 528186 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185729
...done!
maximalDeformation: 0.750476
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57781
...done!
=======================
Bad trial move (maximal deformation: 0.750476, lambda: 8)
        Cost going from 528186 to 528207
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184467
...done!
maximalDeformation: 0.420049
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57953
...done!
=======================
Bad trial move (maximal deformation: 0.420049, lambda: 16)
        Cost going from 528186 to 528186
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18226
...done!
maximalDeformation: 0.224362
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57952
...done!
=======================
Good trial move (maximal deformation: 0.224362, lambda: 32)
        Cost going from 528186 to 528182
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199754
...done!
maximalDeformation: 0.332432
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62633
...done!
=======================
Good trial move (maximal deformation: 0.332432, lambda: 29.0909)
        Cost going from 528182 to 528181
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195307
...done!
maximalDeformation: 0.248092
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61173
...done!
=======================
Good trial move (maximal deformation: 0.248092, lambda: 26.4463)
        Cost going from 528181 to 528180
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21227
...done!
maximalDeformation: 0.273149
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64557
...done!
=======================
Good trial move (maximal deformation: 0.273149, lambda: 24.0421)
        Cost going from 528180 to 528179
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208033
...done!
maximalDeformation: 0.509944
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64027
...done!
=======================
Good trial move (maximal deformation: 0.509944, lambda: 21.8564)
        Cost going from 528179 to 528178
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224914
...done!
maximalDeformation: 0.358269
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65994
...done!
=======================
Good trial move (maximal deformation: 0.358269, lambda: 19.8695)
        Cost going from 528178 to 528177
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223687
...done!
maximalDeformation: 0.429781
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66619
...done!
=======================
Good trial move (maximal deformation: 0.429781, lambda: 18.0632)
        Cost going from 528177 to 528176
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236955
...done!
maximalDeformation: 0.452421
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68094
...done!
=======================
Good trial move (maximal deformation: 0.452421, lambda: 16.4211)
        Cost going from 528176 to 528175
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235247
...done!
maximalDeformation: 0.373836
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68035
...done!
=======================
Good trial move (maximal deformation: 0.373836, lambda: 14.9282)
        Cost going from 528175 to 528172
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247112
...done!
maximalDeformation: 0.647704
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69185
...done!
=======================
Bad trial move (maximal deformation: 0.647704, lambda: 13.5711)
        Cost going from 528172 to 528175
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.5711 to 27.1422 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Time taken to solve the Levenberg-Marquardt system of equations: 0.24743
...done!
maximalDeformation: 0.35311
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67627
...done!
=======================
Good trial move (maximal deformation: 0.35311, lambda: 27.1422)
        Cost going from 528172 to 528166
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243002
...done!
maximalDeformation: 0.474494
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70352
...done!
=======================
Good trial move (maximal deformation: 0.474494, lambda: 24.6748)
        Cost going from 528166 to 528163
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  523469
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.919 79.874 49.3963 ]
EM Iteration: 1  ->  523469
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.917 79.8736 49.3967 ]
EM Iteration: 2  ->  523469
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 17 was 528680
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x11e6b510)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 47688818
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65025
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200074
...done!
maximalDeformation: 4.49602
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1426688 has managed to turn bad (detJ: -0.198298)
Time taken to rasterize Levenberg-Marquardt: 0.344398
...done!
=======================
Bad trial move (maximal deformation: 4.49602, lambda: 1)
        Cost going from 528163 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192432
...done!
maximalDeformation: 2.77789
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1833661 has managed to turn bad (detJ: -0.0221595)
Time taken to rasterize Levenberg-Marquardt: 0.593
...done!
=======================
Bad trial move (maximal deformation: 2.77789, lambda: 2)
        Cost going from 528163 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189704
...done!
maximalDeformation: 1.6035
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57652
...done!
=======================
Bad trial move (maximal deformation: 1.6035, lambda: 4)
        Cost going from 528163 to 528238
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18677
...done!
maximalDeformation: 0.878876
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57922
...done!
=======================
Bad trial move (maximal deformation: 0.878876, lambda: 8)
        Cost going from 528163 to 528182
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185376
...done!
maximalDeformation: 0.462033
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56578
...done!
=======================
Bad trial move (maximal deformation: 0.462033, lambda: 16)
        Cost going from 528163 to 528165
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183187
...done!
maximalDeformation: 0.237029
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58302
...done!
=======================
Good trial move (maximal deformation: 0.237029, lambda: 32)
        Cost going from 528163 to 528161
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200768
...done!
maximalDeformation: 0.25468
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61679
...done!
=======================
Good trial move (maximal deformation: 0.25468, lambda: 29.0909)
        Cost going from 528161 to 528159
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194782
...done!
maximalDeformation: 0.282423
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60864
...done!
=======================
Good trial move (maximal deformation: 0.282423, lambda: 26.4463)
        Cost going from 528159 to 528159
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210536
...done!
maximalDeformation: 0.463512
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63835
...done!
=======================
Good trial move (maximal deformation: 0.463512, lambda: 24.0421)
        Cost going from 528159 to 528158
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209845
...done!
maximalDeformation: 0.240737
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63666
...done!
=======================
Good trial move (maximal deformation: 0.240737, lambda: 21.8564)
        Cost going from 528158 to 528157
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226278
...done!
maximalDeformation: 0.349001
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65367
...done!
=======================
Good trial move (maximal deformation: 0.349001, lambda: 19.8695)
        Cost going from 528157 to 528155
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224346
...done!
maximalDeformation: 0.550448
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65665
...done!
=======================
Bad trial move (maximal deformation: 0.550448, lambda: 18.0632)
        Cost going from 528155 to 528156
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.231904
...done!
maximalDeformation: 0.283445
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65794
...done!
=======================
Good trial move (maximal deformation: 0.283445, lambda: 36.1263)
        Cost going from 528155 to 528151
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236846
...done!
maximalDeformation: 0.25253
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67032
...done!
=======================
Good trial move (maximal deformation: 0.25253, lambda: 32.8421)
        Cost going from 528151 to 528150
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23817
...done!
maximalDeformation: 0.238735
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67796
...done!
=======================
Good trial move (maximal deformation: 0.238735, lambda: 29.8565)
        Cost going from 528150 to 528149
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2462
...done!
maximalDeformation: 0.304689
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68904
...done!
=======================
Good trial move (maximal deformation: 0.304689, lambda: 27.1422)
        Cost going from 528149 to 528148
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249417
...done!
maximalDeformation: 0.530652
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69312
...done!
=======================
Bad trial move (maximal deformation: 0.530652, lambda: 24.6748)
        Cost going from 528148 to 528148
Transforming mesh
Done transforming mesh
        Increasing lambda from 24.6748 to 49.3495 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Time taken to solve the Levenberg-Marquardt system of equations: 0.250477
...done!
maximalDeformation: 0.270673
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67135
...done!
=======================
Good trial move (maximal deformation: 0.270673, lambda: 49.3495)
        Cost going from 528148 to 528146
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  523451
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.917 79.8742 49.3991 ]
EM Iteration: 1  ->  523451
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 18 was 528663
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x10181a40)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 50818141
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6437
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200492
...done!
maximalDeformation: 3.15627
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.961035)
Time taken to rasterize Levenberg-Marquardt: 0.0893738
...done!
=======================
Bad trial move (maximal deformation: 3.15627, lambda: 1)
        Cost going from 528146 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193264
...done!
maximalDeformation: 1.96543
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.291094)
Time taken to rasterize Levenberg-Marquardt: 0.0889421
...done!
=======================
Bad trial move (maximal deformation: 1.96543, lambda: 2)
        Cost going from 528146 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191355
...done!
maximalDeformation: 1.13544
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1866927 has managed to turn bad (detJ: -0.0285474)
Time taken to rasterize Levenberg-Marquardt: 0.606464
...done!
=======================
Bad trial move (maximal deformation: 1.13544, lambda: 4)
        Cost going from 528146 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187463
...done!
maximalDeformation: 0.62193
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57756
...done!
=======================
Bad trial move (maximal deformation: 0.62193, lambda: 8)
        Cost going from 528146 to 528164
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187463
...done!
maximalDeformation: 0.349664
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57927
...done!
=======================
Bad trial move (maximal deformation: 0.349664, lambda: 16)
        Cost going from 528146 to 528150
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19849
...done!
maximalDeformation: 0.189649
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59955
...done!
=======================
Good trial move (maximal deformation: 0.189649, lambda: 32)
        Cost going from 528146 to 528145
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206647
...done!
maximalDeformation: 0.334704
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6172
...done!
=======================
Good trial move (maximal deformation: 0.334704, lambda: 29.0909)
        Cost going from 528145 to 528145
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207495
...done!
maximalDeformation: 0.275658
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63551
...done!
=======================
Good trial move (maximal deformation: 0.275658, lambda: 26.4463)
        Cost going from 528145 to 528144
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214878
...done!
maximalDeformation: 0.476685
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63679
...done!
=======================
Bad trial move (maximal deformation: 0.476685, lambda: 24.0421)
        Cost going from 528144 to 528144
Transforming mesh
Done transforming mesh
        Increasing lambda from 24.0421 to 48.0841 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Time taken to solve the Levenberg-Marquardt system of equations: 0.217284
...done!
maximalDeformation: 0.24649
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62979
...done!
=======================
Good trial move (maximal deformation: 0.24649, lambda: 48.0841)
        Cost going from 528144 to 528142
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220972
...done!
maximalDeformation: 0.176871
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66104
...done!
=======================
Good trial move (maximal deformation: 0.176871, lambda: 43.7129)
        Cost going from 528142 to 528140
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226013
...done!
maximalDeformation: 0.225411
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66042
...done!
=======================
Good trial move (maximal deformation: 0.225411, lambda: 39.739)
        Cost going from 528140 to 528140
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223819
...done!
maximalDeformation: 0.399838
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67699
...done!
=======================
Good trial move (maximal deformation: 0.399838, lambda: 36.1263)
        Cost going from 528140 to 528139
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239959
...done!
maximalDeformation: 0.344497
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68062
...done!
=======================
Good trial move (maximal deformation: 0.344497, lambda: 32.8421)
        Cost going from 528139 to 528139
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234282
...done!
maximalDeformation: 0.187621
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67726
...done!
=======================
Good trial move (maximal deformation: 0.187621, lambda: 29.8565)
        Cost going from 528139 to 528138
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24644
...done!
maximalDeformation: 0.248788
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68448
...done!
=======================
Good trial move (maximal deformation: 0.248788, lambda: 27.1422)
        Cost going from 528138 to 528137
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244609
...done!
maximalDeformation: 0.329817
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69112
...done!
=======================
Good trial move (maximal deformation: 0.329817, lambda: 24.6748)
        Cost going from 528137 to 528136
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  523436
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.918 79.8752 49.4007 ]
EM Iteration: 1  ->  523436
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 19 was 528653
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa4d1670)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 53754558
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64664
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197801
...done!
maximalDeformation: 10.6595
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -1.03979)
Time taken to rasterize Levenberg-Marquardt: 0.00569415
...done!
=======================
Bad trial move (maximal deformation: 10.6595, lambda: 1)
        Cost going from 528136 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192237
...done!
maximalDeformation: 6.70977
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.243341)
Time taken to rasterize Levenberg-Marquardt: 0.00504613
...done!
=======================
Bad trial move (maximal deformation: 6.70977, lambda: 2)
        Cost going from 528136 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189603
...done!
maximalDeformation: 3.91193
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1276717 has managed to turn bad (detJ: -0.19149)
Time taken to rasterize Levenberg-Marquardt: 0.271206
...done!
=======================
Bad trial move (maximal deformation: 3.91193, lambda: 4)
        Cost going from 528136 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186334
...done!
maximalDeformation: 2.15621
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58605
...done!
=======================
Bad trial move (maximal deformation: 2.15621, lambda: 8)
        Cost going from 528136 to 528179
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18631
...done!
maximalDeformation: 1.13822
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58772
...done!
=======================
Bad trial move (maximal deformation: 1.13822, lambda: 16)
        Cost going from 528136 to 528143
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196857
...done!
maximalDeformation: 0.585125
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61558
...done!
=======================
Good trial move (maximal deformation: 0.585125, lambda: 32)
        Cost going from 528136 to 528134
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206319
...done!
maximalDeformation: 0.252437
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62673
...done!
=======================
Good trial move (maximal deformation: 0.252437, lambda: 29.0909)
        Cost going from 528134 to 528133
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206163
...done!
maximalDeformation: 0.769749
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64546
...done!
=======================
Good trial move (maximal deformation: 0.769749, lambda: 26.4463)
        Cost going from 528133 to 528132
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217158
...done!
maximalDeformation: 0.237615
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65422
...done!
=======================
Good trial move (maximal deformation: 0.237615, lambda: 24.0421)
        Cost going from 528132 to 528132
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222441
...done!
maximalDeformation: 0.376744
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66861
...done!
=======================
Good trial move (maximal deformation: 0.376744, lambda: 21.8564)
        Cost going from 528132 to 528131
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229711
...done!
maximalDeformation: 0.512746
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66148
...done!
=======================
Good trial move (maximal deformation: 0.512746, lambda: 19.8695)
        Cost going from 528131 to 528130
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235861
...done!
maximalDeformation: 0.314925
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68822
...done!
=======================
Bad trial move (maximal deformation: 0.314925, lambda: 18.0632)
        Cost going from 528130 to 528130
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.229229
...done!
maximalDeformation: 0.169756
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67328
...done!
=======================
Good trial move (maximal deformation: 0.169756, lambda: 36.1263)
        Cost going from 528130 to 528126
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237201
...done!
maximalDeformation: 0.234524
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68579
...done!
=======================
Good trial move (maximal deformation: 0.234524, lambda: 32.8421)
        Cost going from 528126 to 528124
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239954
...done!
maximalDeformation: 0.541896
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6956
...done!
=======================
Bad trial move (maximal deformation: 0.541896, lambda: 29.8565)
        Cost going from 528124 to 528125
Transforming mesh
Done transforming mesh
        Increasing lambda from 29.8565 to 59.7129 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Time taken to solve the Levenberg-Marquardt system of equations: 0.229708
...done!
maximalDeformation: 0.275673
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67518
...done!
=======================
Good trial move (maximal deformation: 0.275673, lambda: 59.7129)
        Cost going from 528124 to 528123
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244721
...done!
maximalDeformation: 0.174267
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69421
...done!
=======================
Good trial move (maximal deformation: 0.174267, lambda: 54.2845)
        Cost going from 528123 to 528122
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241482
...done!
maximalDeformation: 0.133639
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69723
...done!
=======================
Good trial move (maximal deformation: 0.133639, lambda: 49.3495)
        Cost going from 528122 to 528122
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  523416
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.917 79.8761 49.4018 ]
EM Iteration: 1  ->  523416
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.915 79.8755 49.4029 ]
EM Iteration: 2  ->  523416
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 20 was 528638
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x11f3a700)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 56883901
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64989
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199262
...done!
maximalDeformation: 4.54759
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 588616 has managed to turn bad (detJ: -0.235773)
Time taken to rasterize Levenberg-Marquardt: 0.0558338
...done!
=======================
Bad trial move (maximal deformation: 4.54759, lambda: 1)
        Cost going from 528122 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192292
...done!
maximalDeformation: 2.82041
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2353358 has managed to turn bad (detJ: -0.0139026)
Time taken to rasterize Levenberg-Marquardt: 1.04849
...done!
=======================
Bad trial move (maximal deformation: 2.82041, lambda: 2)
        Cost going from 528122 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18982
...done!
maximalDeformation: 1.66389
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58583
...done!
=======================
Bad trial move (maximal deformation: 1.66389, lambda: 4)
        Cost going from 528122 to 528179
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186154
...done!
maximalDeformation: 0.934735
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57888
...done!
=======================
Bad trial move (maximal deformation: 0.934735, lambda: 8)
        Cost going from 528122 to 528141
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185586
...done!
maximalDeformation: 0.503582
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58118
...done!
=======================
Bad trial move (maximal deformation: 0.503582, lambda: 16)
        Cost going from 528122 to 528126
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184259
...done!
maximalDeformation: 0.262353
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57941
...done!
=======================
Bad trial move (maximal deformation: 0.262353, lambda: 32)
        Cost going from 528122 to 528122
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184132
...done!
maximalDeformation: 0.134436
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57613
...done!
=======================
Good trial move (maximal deformation: 0.134436, lambda: 64)
        Cost going from 528122 to 528121
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200293
...done!
maximalDeformation: 0.19558
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62725
...done!
=======================
Good trial move (maximal deformation: 0.19558, lambda: 58.1818)
        Cost going from 528121 to 528120
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195327
...done!
maximalDeformation: 0.167636
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60807
...done!
=======================
Good trial move (maximal deformation: 0.167636, lambda: 52.8926)
        Cost going from 528120 to 528120
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20737
...done!
maximalDeformation: 0.137385
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63543
...done!
=======================
Good trial move (maximal deformation: 0.137385, lambda: 48.0841)
        Cost going from 528120 to 528119
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207187
...done!
maximalDeformation: 0.167602
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63584
...done!
=======================
Good trial move (maximal deformation: 0.167602, lambda: 43.7129)
        Cost going from 528119 to 528119
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219641
...done!
maximalDeformation: 0.248042
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65055
...done!
=======================
Good trial move (maximal deformation: 0.248042, lambda: 39.739)
        Cost going from 528119 to 528118
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220791
...done!
maximalDeformation: 0.191013
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65885
...done!
=======================
Good trial move (maximal deformation: 0.191013, lambda: 36.1263)
        Cost going from 528118 to 528118
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232473
...done!
maximalDeformation: 0.187115
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67301
...done!
=======================
Good trial move (maximal deformation: 0.187115, lambda: 32.8421)
        Cost going from 528118 to 528117
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233588
...done!
maximalDeformation: 0.18213
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67825
...done!
=======================
Good trial move (maximal deformation: 0.18213, lambda: 29.8565)
        Cost going from 528117 to 528116
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241926
...done!
maximalDeformation: 0.274813
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68465
...done!
=======================
Bad trial move (maximal deformation: 0.274813, lambda: 27.1422)
        Cost going from 528116 to 528117
Transforming mesh
Done transforming mesh
        Increasing lambda from 27.1422 to 54.2845 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Time taken to solve the Levenberg-Marquardt system of equations: 0.243704
...done!
maximalDeformation: 0.141806
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67383
...done!
=======================
Good trial move (maximal deformation: 0.141806, lambda: 54.2845)
        Cost going from 528116 to 528115
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241885
...done!
maximalDeformation: 0.137175
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68124
...done!
=======================
Good trial move (maximal deformation: 0.137175, lambda: 49.3495)
        Cost going from 528115 to 528114
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  523404
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.914 79.8753 49.4032 ]
EM Iteration: 1  ->  523404
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 21 was 528630
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xe37d8f0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 60013224
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62246
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196018
...done!
maximalDeformation: 6.98916
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -1.23117)
Time taken to rasterize Levenberg-Marquardt: 0.00572491
...done!
=======================
Bad trial move (maximal deformation: 6.98916, lambda: 1)
        Cost going from 528114 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190552
...done!
maximalDeformation: 4.43262
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.300648)
Time taken to rasterize Levenberg-Marquardt: 0.00506091
...done!
=======================
Bad trial move (maximal deformation: 4.43262, lambda: 2)
        Cost going from 528114 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.197876
...done!
maximalDeformation: 2.5912
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60177
...done!
=======================
Bad trial move (maximal deformation: 2.5912, lambda: 4)
        Cost going from 528114 to 528311
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208015
...done!
maximalDeformation: 1.42241
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62361
...done!
=======================
Bad trial move (maximal deformation: 1.42241, lambda: 8)
        Cost going from 528114 to 528139
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193778
...done!
maximalDeformation: 0.750534
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60381
...done!
=======================
Bad trial move (maximal deformation: 0.750534, lambda: 16)
        Cost going from 528114 to 528120
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19425
...done!
maximalDeformation: 0.385384
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59564
...done!
=======================
Bad trial move (maximal deformation: 0.385384, lambda: 32)
        Cost going from 528114 to 528114
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.204779
...done!
maximalDeformation: 0.195927
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63218
...done!
=======================
Good trial move (maximal deformation: 0.195927, lambda: 64)
        Cost going from 528114 to 528113
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206682
...done!
maximalDeformation: 0.21836
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62829
...done!
=======================
Good trial move (maximal deformation: 0.21836, lambda: 58.1818)
        Cost going from 528113 to 528113
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21464
...done!
maximalDeformation: 0.184079
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65445
...done!
=======================
Good trial move (maximal deformation: 0.184079, lambda: 52.8926)
        Cost going from 528113 to 528112
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218673
...done!
maximalDeformation: 0.188879
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65387
...done!
=======================
Good trial move (maximal deformation: 0.188879, lambda: 48.0841)
        Cost going from 528112 to 528112
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228121
...done!
maximalDeformation: 0.26211
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67401
...done!
=======================
Good trial move (maximal deformation: 0.26211, lambda: 43.7129)
        Cost going from 528112 to 528111
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230512
...done!
maximalDeformation: 0.239731
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66547
...done!
=======================
Good trial move (maximal deformation: 0.239731, lambda: 39.739)
        Cost going from 528111 to 528111
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239563
...done!
maximalDeformation: 0.179661
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68664
...done!
=======================
Good trial move (maximal deformation: 0.179661, lambda: 36.1263)
        Cost going from 528111 to 528111
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239413
...done!
maximalDeformation: 0.203539
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68074
...done!
=======================
Good trial move (maximal deformation: 0.203539, lambda: 32.8421)
        Cost going from 528111 to 528110
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24879
...done!
maximalDeformation: 0.196417
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70041
...done!
=======================
Good trial move (maximal deformation: 0.196417, lambda: 29.8565)
        Cost going from 528110 to 528110
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.248645
...done!
maximalDeformation: 0.273228
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69375
...done!
=======================
Good trial move (maximal deformation: 0.273228, lambda: 27.1422)
        Cost going from 528110 to 528109
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.258812
...done!
maximalDeformation: 0.351027
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71176
...done!
=======================
Good trial move (maximal deformation: 0.351027, lambda: 24.6748)
        Cost going from 528109 to 528109
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  523395
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.914 79.876 49.4043 ]
EM Iteration: 1  ->  523395
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.913 79.8761 49.4052 ]
EM Iteration: 2  ->  523395
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.913 79.8759 49.4052 ]
EM Iteration: 3  ->  523395
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 22 was 528626
============================================
Converged!
Smoothing mesh collection...done!
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 0
maximum: 147
Running for smoothing sigma 0.5
Starting EM: 
EM Iteration: 0  ->  520092
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.817 79.8443 49.7142 ]
EM Iteration: 1  ->  520054
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.797 79.8269 49.851 ]
EM Iteration: 2  ->  520045
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.785 79.8187 49.8988 ]
EM Iteration: 3  ->  520044
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.781 79.8156 49.9148 ]
EM Iteration: 4  ->  520043
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.779 79.8142 49.9204 ]
EM Iteration: 5  ->  520043
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 5
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 0 was 525274
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xd1e2120)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 63175652
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63699
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.186713
...done!
maximalDeformation: 3.7588
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.657047)
Time taken to rasterize Levenberg-Marquardt: 0.0896459
...done!
=======================
Bad trial move (maximal deformation: 3.7588, lambda: 1)
        Cost going from 524709 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18404
...done!
maximalDeformation: 2.51643
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.175353)
Time taken to rasterize Levenberg-Marquardt: 0.0892119
...done!
=======================
Bad trial move (maximal deformation: 2.51643, lambda: 2)
        Cost going from 524709 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.17959
...done!
maximalDeformation: 1.5928
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58339
...done!
=======================
Bad trial move (maximal deformation: 1.5928, lambda: 4)
        Cost going from 524709 to 524780
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.175976
...done!
maximalDeformation: 0.937035
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59095
...done!
=======================
Good trial move (maximal deformation: 0.937035, lambda: 8)
        Cost going from 524709 to 524598
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196887
...done!
maximalDeformation: 0.969007
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2583990 has managed to turn bad (detJ: -0.128385)
Time taken to rasterize Levenberg-Marquardt: 1.36079
...done!
=======================
Bad trial move (maximal deformation: 0.969007, lambda: 7.27273)
        Cost going from 524598 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.27273 to 14.5455 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Time taken to solve the Levenberg-Marquardt system of equations: 0.204788
...done!
maximalDeformation: 0.515676
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63474
...done!
=======================
Good trial move (maximal deformation: 0.515676, lambda: 14.5455)
        Cost going from 524598 to 524524
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193996
...done!
maximalDeformation: 0.685874
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62422
...done!
=======================
Good trial move (maximal deformation: 0.685874, lambda: 13.2231)
        Cost going from 524524 to 524478
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215292
...done!
maximalDeformation: 0.455205
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65994
...done!
=======================
Good trial move (maximal deformation: 0.455205, lambda: 12.021)
        Cost going from 524478 to 524444
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200257
...done!
maximalDeformation: 0.711061
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62852
...done!
=======================
Good trial move (maximal deformation: 0.711061, lambda: 10.9282)
        Cost going from 524444 to 524417
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223038
...done!
maximalDeformation: 0.40805
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67293
...done!
=======================
Good trial move (maximal deformation: 0.40805, lambda: 9.93474)
        Cost going from 524417 to 524391
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211235
...done!
maximalDeformation: 0.714133
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65589
...done!
=======================
Good trial move (maximal deformation: 0.714133, lambda: 9.03158)
        Cost going from 524391 to 524373
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235992
...done!
maximalDeformation: 0.77431
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2583990 has managed to turn bad (detJ: -0.103056)
Time taken to rasterize Levenberg-Marquardt: 1.41763
...done!
=======================
Bad trial move (maximal deformation: 0.77431, lambda: 8.21053)
        Cost going from 524373 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8.21053 to 16.4211 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Time taken to solve the Levenberg-Marquardt system of equations: 0.228522
...done!
maximalDeformation: 0.422966
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67925
...done!
=======================
Good trial move (maximal deformation: 0.422966, lambda: 16.4211)
        Cost going from 524373 to 524340
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219562
...done!
maximalDeformation: 0.323863
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67796
...done!
=======================
Good trial move (maximal deformation: 0.323863, lambda: 14.9282)
        Cost going from 524340 to 524324
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239638
...done!
maximalDeformation: 0.927011
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69773
...done!
=======================
Good trial move (maximal deformation: 0.927011, lambda: 13.5711)
        Cost going from 524324 to 524317
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23421
...done!
maximalDeformation: 0.768717
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6904
...done!
=======================
Good trial move (maximal deformation: 0.768717, lambda: 12.3374)
        Cost going from 524317 to 524305
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  519570
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.792 79.8286 49.8874 ]
EM Iteration: 1  ->  519571
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 1 was 524872
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x1094cd20)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 65919163
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65431
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196051
...done!
maximalDeformation: 3.54853
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.19423)
Time taken to rasterize Levenberg-Marquardt: 0.0902631
...done!
=======================
Bad trial move (maximal deformation: 3.54853, lambda: 1)
        Cost going from 524301 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.205268
...done!
maximalDeformation: 2.15615
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1861332 has managed to turn bad (detJ: -0.688419)
Time taken to rasterize Levenberg-Marquardt: 0.625946
...done!
=======================
Bad trial move (maximal deformation: 2.15615, lambda: 2)
        Cost going from 524301 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.213954
...done!
maximalDeformation: 1.23407
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2583990 has managed to turn bad (detJ: -0.158471)
Time taken to rasterize Levenberg-Marquardt: 1.37541
...done!
=======================
Bad trial move (maximal deformation: 1.23407, lambda: 4)
        Cost going from 524301 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210477
...done!
maximalDeformation: 0.667039
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63493
...done!
=======================
Bad trial move (maximal deformation: 0.667039, lambda: 8)
        Cost going from 524301 to 524311
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210792
...done!
maximalDeformation: 0.347996
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63684
...done!
=======================
Good trial move (maximal deformation: 0.347996, lambda: 16)
        Cost going from 524301 to 524287
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210764
...done!
maximalDeformation: 0.419094
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64169
...done!
=======================
Good trial move (maximal deformation: 0.419094, lambda: 14.5455)
        Cost going from 524287 to 524277
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217632
...done!
maximalDeformation: 0.553524
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66929
...done!
=======================
Good trial move (maximal deformation: 0.553524, lambda: 13.2231)
        Cost going from 524277 to 524272
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222831
...done!
maximalDeformation: 0.68003
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67365
...done!
=======================
Good trial move (maximal deformation: 0.68003, lambda: 12.021)
        Cost going from 524272 to 524264
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23172
...done!
maximalDeformation: 0.434652
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70091
...done!
=======================
Good trial move (maximal deformation: 0.434652, lambda: 10.9282)
        Cost going from 524264 to 524262
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234013
...done!
maximalDeformation: 0.960079
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69235
...done!
=======================
Good trial move (maximal deformation: 0.960079, lambda: 9.93474)
        Cost going from 524262 to 524255
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245288
...done!
maximalDeformation: 0.58958
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70756
...done!
=======================
Bad trial move (maximal deformation: 0.58958, lambda: 9.03158)
        Cost going from 524255 to 524257
Transforming mesh
Done transforming mesh
        Increasing lambda from 9.03158 to 18.0632 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Time taken to solve the Levenberg-Marquardt system of equations: 0.24774
...done!
maximalDeformation: 0.320534
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70642
...done!
=======================
Good trial move (maximal deformation: 0.320534, lambda: 18.0632)
        Cost going from 524255 to 524234
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24805
...done!
maximalDeformation: 0.574763
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71311
...done!
=======================
Good trial move (maximal deformation: 0.574763, lambda: 16.4211)
        Cost going from 524234 to 524225
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.253219
...done!
maximalDeformation: 0.467727
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72056
...done!
=======================
Good trial move (maximal deformation: 0.467727, lambda: 14.9282)
        Cost going from 524225 to 524224
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.25286
...done!
maximalDeformation: 0.401648
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7203
...done!
=======================
Good trial move (maximal deformation: 0.401648, lambda: 13.5711)
        Cost going from 524224 to 524217
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.26495
...done!
maximalDeformation: 0.714424
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72481
...done!
=======================
Bad trial move (maximal deformation: 0.714424, lambda: 12.3374)
        Cost going from 524217 to 524220
Transforming mesh
Done transforming mesh
        Increasing lambda from 12.3374 to 24.6748 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Time taken to solve the Levenberg-Marquardt system of equations: 0.264377
...done!
maximalDeformation: 0.377254
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72439
...done!
=======================
Good trial move (maximal deformation: 0.377254, lambda: 24.6748)
        Cost going from 524217 to 524208
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  519453
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.804 79.8406 49.8706 ]
EM Iteration: 1  ->  519453
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 2 was 524782
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x1243f140)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 68855580
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66294
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201794
...done!
maximalDeformation: 3.36349
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1303089 has managed to turn bad (detJ: -1.00751)
Time taken to rasterize Levenberg-Marquardt: 0.287992
...done!
=======================
Bad trial move (maximal deformation: 3.36349, lambda: 1)
        Cost going from 524206 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.20857
...done!
maximalDeformation: 2.18257
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2353358 has managed to turn bad (detJ: -0.359521)
Time taken to rasterize Levenberg-Marquardt: 1.07291
...done!
=======================
Bad trial move (maximal deformation: 2.18257, lambda: 2)
        Cost going from 524206 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.214601
...done!
maximalDeformation: 1.30089
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65004
...done!
=======================
Bad trial move (maximal deformation: 1.30089, lambda: 4)
        Cost going from 524206 to 524281
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.213416
...done!
maximalDeformation: 0.728039
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65849
...done!
=======================
Bad trial move (maximal deformation: 0.728039, lambda: 8)
        Cost going from 524206 to 524222
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.213501
...done!
maximalDeformation: 0.387628
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63816
...done!
=======================
Good trial move (maximal deformation: 0.387628, lambda: 16)
        Cost going from 524206 to 524204
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213659
...done!
maximalDeformation: 1.3601
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6428
...done!
=======================
Bad trial move (maximal deformation: 1.3601, lambda: 14.5455)
        Cost going from 524204 to 524209
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.5455 to 29.0909 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Time taken to solve the Levenberg-Marquardt system of equations: 0.202232
...done!
maximalDeformation: 0.702489
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62589
...done!
=======================
Good trial move (maximal deformation: 0.702489, lambda: 29.0909)
        Cost going from 524204 to 524198
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21518
...done!
maximalDeformation: 0.361071
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67282
...done!
=======================
Good trial move (maximal deformation: 0.361071, lambda: 26.4463)
        Cost going from 524198 to 524194
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214388
...done!
maximalDeformation: 0.338378
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65353
...done!
=======================
Good trial move (maximal deformation: 0.338378, lambda: 24.0421)
        Cost going from 524194 to 524193
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222186
...done!
maximalDeformation: 0.457653
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66987
...done!
=======================
Good trial move (maximal deformation: 0.457653, lambda: 21.8564)
        Cost going from 524193 to 524190
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225925
...done!
maximalDeformation: 0.357741
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67207
...done!
=======================
Good trial move (maximal deformation: 0.357741, lambda: 19.8695)
        Cost going from 524190 to 524189
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233192
...done!
maximalDeformation: 0.701497
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69378
...done!
=======================
Good trial move (maximal deformation: 0.701497, lambda: 18.0632)
        Cost going from 524189 to 524186
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238324
...done!
maximalDeformation: 0.572998
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69273
...done!
=======================
Good trial move (maximal deformation: 0.572998, lambda: 16.4211)
        Cost going from 524186 to 524185
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244449
...done!
maximalDeformation: 0.539198
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70061
...done!
=======================
Good trial move (maximal deformation: 0.539198, lambda: 14.9282)
        Cost going from 524185 to 524183
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246814
...done!
maximalDeformation: 0.597366
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70489
...done!
=======================
Good trial move (maximal deformation: 0.597366, lambda: 13.5711)
        Cost going from 524183 to 524182
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.25211
...done!
maximalDeformation: 0.461136
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70823
...done!
=======================
Good trial move (maximal deformation: 0.461136, lambda: 12.3374)
        Cost going from 524182 to 524179
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  519408
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.81 79.8484 49.8688 ]
EM Iteration: 1  ->  519409
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 3 was 524757
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xe4c35e0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 71599091
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65642
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223559
...done!
maximalDeformation: 3.17597
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.625255)
Time taken to rasterize Levenberg-Marquardt: 0.091116
...done!
=======================
Bad trial move (maximal deformation: 3.17597, lambda: 1)
        Cost going from 524178 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192318
...done!
maximalDeformation: 2.13257
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.130778)
Time taken to rasterize Levenberg-Marquardt: 0.090193
...done!
=======================
Bad trial move (maximal deformation: 2.13257, lambda: 2)
        Cost going from 524178 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.202471
...done!
maximalDeformation: 1.39749
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1866927 has managed to turn bad (detJ: -0.050814)
Time taken to rasterize Levenberg-Marquardt: 0.622866
...done!
=======================
Bad trial move (maximal deformation: 1.39749, lambda: 4)
        Cost going from 524178 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.211602
...done!
maximalDeformation: 0.829289
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63994
...done!
=======================
Bad trial move (maximal deformation: 0.829289, lambda: 8)
        Cost going from 524178 to 524204
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.211539
...done!
maximalDeformation: 0.458353
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63392
...done!
=======================
Good trial move (maximal deformation: 0.458353, lambda: 16)
        Cost going from 524178 to 524170
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210835
...done!
maximalDeformation: 0.460463
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64216
...done!
=======================
Good trial move (maximal deformation: 0.460463, lambda: 14.5455)
        Cost going from 524170 to 524165
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218322
...done!
maximalDeformation: 0.454134
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66941
...done!
=======================
Bad trial move (maximal deformation: 0.454134, lambda: 13.2231)
        Cost going from 524165 to 524167
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.2231 to 26.4463 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Time taken to solve the Levenberg-Marquardt system of equations: 0.227908
...done!
maximalDeformation: 0.235289
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66373
...done!
=======================
Good trial move (maximal deformation: 0.235289, lambda: 26.4463)
        Cost going from 524165 to 524157
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223266
...done!
maximalDeformation: 0.484924
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66688
...done!
=======================
Good trial move (maximal deformation: 0.484924, lambda: 24.0421)
        Cost going from 524157 to 524154
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238355
...done!
maximalDeformation: 0.523254
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6988
...done!
=======================
Good trial move (maximal deformation: 0.523254, lambda: 21.8564)
        Cost going from 524154 to 524154
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234121
...done!
maximalDeformation: 0.354321
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6904
...done!
=======================
Good trial move (maximal deformation: 0.354321, lambda: 19.8695)
        Cost going from 524154 to 524152
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.248953
...done!
maximalDeformation: 0.683517
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70799
...done!
=======================
Bad trial move (maximal deformation: 0.683517, lambda: 18.0632)
        Cost going from 524152 to 524152
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.250077
...done!
maximalDeformation: 0.352871
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69291
...done!
=======================
Good trial move (maximal deformation: 0.352871, lambda: 36.1263)
        Cost going from 524152 to 524147
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242546
...done!
maximalDeformation: 0.206104
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69792
...done!
=======================
Good trial move (maximal deformation: 0.206104, lambda: 32.8421)
        Cost going from 524147 to 524145
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.254736
...done!
maximalDeformation: 0.176562
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71745
...done!
=======================
Good trial move (maximal deformation: 0.176562, lambda: 29.8565)
        Cost going from 524145 to 524144
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.253245
...done!
maximalDeformation: 0.596054
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7159
...done!
=======================
Good trial move (maximal deformation: 0.596054, lambda: 27.1422)
        Cost going from 524144 to 524144
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.265683
...done!
maximalDeformation: 0.22735
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73406
...done!
=======================
Good trial move (maximal deformation: 0.22735, lambda: 24.6748)
        Cost going from 524144 to 524144
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  519369
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.814 79.8529 49.8698 ]
EM Iteration: 1  ->  519369
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 4 was 524723
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x9be8560)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 74535508
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66897
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199813
...done!
maximalDeformation: 4.29884
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1303089 has managed to turn bad (detJ: -0.0959416)
Time taken to rasterize Levenberg-Marquardt: 0.289868
...done!
=======================
Bad trial move (maximal deformation: 4.29884, lambda: 1)
        Cost going from 524144 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.211882
...done!
maximalDeformation: 2.57085
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1833661 has managed to turn bad (detJ: -0.0550249)
Time taken to rasterize Levenberg-Marquardt: 0.610493
...done!
=======================
Bad trial move (maximal deformation: 2.57085, lambda: 2)
        Cost going from 524144 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.217583
...done!
maximalDeformation: 1.42703
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65213
...done!
=======================
Bad trial move (maximal deformation: 1.42703, lambda: 4)
        Cost going from 524144 to 524246
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.21412
...done!
maximalDeformation: 0.799226
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64217
...done!
=======================
Bad trial move (maximal deformation: 0.799226, lambda: 8)
        Cost going from 524144 to 524173
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.214105
...done!
maximalDeformation: 0.449505
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64351
...done!
=======================
Bad trial move (maximal deformation: 0.449505, lambda: 16)
        Cost going from 524144 to 524147
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.212577
...done!
maximalDeformation: 0.240121
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64798
...done!
=======================
Good trial move (maximal deformation: 0.240121, lambda: 32)
        Cost going from 524144 to 524140
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212482
...done!
maximalDeformation: 0.189454
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64883
...done!
=======================
Good trial move (maximal deformation: 0.189454, lambda: 29.0909)
        Cost going from 524140 to 524138
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220851
...done!
maximalDeformation: 0.334945
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67807
...done!
=======================
Good trial move (maximal deformation: 0.334945, lambda: 26.4463)
        Cost going from 524138 to 524138
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224801
...done!
maximalDeformation: 0.79911
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67587
...done!
=======================
Good trial move (maximal deformation: 0.79911, lambda: 24.0421)
        Cost going from 524138 to 524138
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233289
...done!
maximalDeformation: 0.387663
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69874
...done!
=======================
Good trial move (maximal deformation: 0.387663, lambda: 21.8564)
        Cost going from 524138 to 524138
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235448
...done!
maximalDeformation: 0.606984
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69371
...done!
=======================
Good trial move (maximal deformation: 0.606984, lambda: 19.8695)
        Cost going from 524138 to 524138
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244648
...done!
maximalDeformation: 0.58525
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70826
...done!
=======================
Good trial move (maximal deformation: 0.58525, lambda: 18.0632)
        Cost going from 524138 to 524137
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245563
...done!
maximalDeformation: 0.283001
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70675
...done!
=======================
Good trial move (maximal deformation: 0.283001, lambda: 16.4211)
        Cost going from 524137 to 524137
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.25295
...done!
maximalDeformation: 0.352072
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71623
...done!
=======================
Good trial move (maximal deformation: 0.352072, lambda: 14.9282)
        Cost going from 524137 to 524136
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.253899
...done!
maximalDeformation: 0.522022
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71096
...done!
=======================
Bad trial move (maximal deformation: 0.522022, lambda: 13.5711)
        Cost going from 524136 to 524138
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.5711 to 27.1422 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Time taken to solve the Levenberg-Marquardt system of equations: 0.256515
...done!
maximalDeformation: 0.275239
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70408
...done!
=======================
Good trial move (maximal deformation: 0.275239, lambda: 27.1422)
        Cost going from 524136 to 524128
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.261234
...done!
maximalDeformation: 0.43839
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72197
...done!
=======================
Good trial move (maximal deformation: 0.43839, lambda: 24.6748)
        Cost going from 524128 to 524124
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  519342
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.816 79.8558 49.8703 ]
EM Iteration: 1  ->  519343
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 5 was 524704
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xf99e710)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 77471925
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66156
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196428
...done!
maximalDeformation: 6.97027
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 588616 has managed to turn bad (detJ: -0.0618448)
Time taken to rasterize Levenberg-Marquardt: 0.0566258
...done!
=======================
Bad trial move (maximal deformation: 6.97027, lambda: 1)
        Cost going from 524124 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208253
...done!
maximalDeformation: 4.4245
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1421979 has managed to turn bad (detJ: -0.255672)
Time taken to rasterize Levenberg-Marquardt: 0.34852
...done!
=======================
Bad trial move (maximal deformation: 4.4245, lambda: 2)
        Cost going from 524124 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.201371
...done!
maximalDeformation: 2.62537
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1426688 has managed to turn bad (detJ: -0.316757)
Time taken to rasterize Levenberg-Marquardt: 0.350559
...done!
=======================
Bad trial move (maximal deformation: 2.62537, lambda: 4)
        Cost going from 524124 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188864
...done!
maximalDeformation: 1.47484
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59544
...done!
=======================
Bad trial move (maximal deformation: 1.47484, lambda: 8)
        Cost going from 524124 to 524159
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188447
...done!
maximalDeformation: 0.791795
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5844
...done!
=======================
Bad trial move (maximal deformation: 0.791795, lambda: 16)
        Cost going from 524124 to 524130
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187083
...done!
maximalDeformation: 0.410821
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59621
...done!
=======================
Good trial move (maximal deformation: 0.410821, lambda: 32)
        Cost going from 524124 to 524122
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19976
...done!
maximalDeformation: 0.738361
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64539
...done!
=======================
Good trial move (maximal deformation: 0.738361, lambda: 29.0909)
        Cost going from 524122 to 524121
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19849
...done!
maximalDeformation: 0.296931
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62956
...done!
=======================
Good trial move (maximal deformation: 0.296931, lambda: 26.4463)
        Cost going from 524121 to 524121
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213779
...done!
maximalDeformation: 0.442271
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65106
...done!
=======================
Good trial move (maximal deformation: 0.442271, lambda: 24.0421)
        Cost going from 524121 to 524119
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212062
...done!
maximalDeformation: 0.277226
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65419
...done!
=======================
Bad trial move (maximal deformation: 0.277226, lambda: 21.8564)
        Cost going from 524119 to 524119
Transforming mesh
Done transforming mesh
        Increasing lambda from 21.8564 to 43.7129 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Time taken to solve the Levenberg-Marquardt system of equations: 0.20183
...done!
maximalDeformation: 0.141193
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63279
...done!
=======================
Good trial move (maximal deformation: 0.141193, lambda: 43.7129)
        Cost going from 524119 to 524116
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221117
...done!
maximalDeformation: 0.156179
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66543
...done!
=======================
Good trial move (maximal deformation: 0.156179, lambda: 39.739)
        Cost going from 524116 to 524115
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214302
...done!
maximalDeformation: 0.223449
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65824
...done!
=======================
Good trial move (maximal deformation: 0.223449, lambda: 36.1263)
        Cost going from 524115 to 524114
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233434
...done!
maximalDeformation: 0.421995
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68763
...done!
=======================
Good trial move (maximal deformation: 0.421995, lambda: 32.8421)
        Cost going from 524114 to 524114
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228102
...done!
maximalDeformation: 0.177616
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68642
...done!
=======================
Good trial move (maximal deformation: 0.177616, lambda: 29.8565)
        Cost going from 524114 to 524113
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245828
...done!
maximalDeformation: 0.255143
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69961
...done!
=======================
Good trial move (maximal deformation: 0.255143, lambda: 27.1422)
        Cost going from 524113 to 524113
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238513
...done!
maximalDeformation: 0.630993
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.694
...done!
=======================
Bad trial move (maximal deformation: 0.630993, lambda: 24.6748)
        Cost going from 524113 to 524113
Transforming mesh
Done transforming mesh
        Increasing lambda from 24.6748 to 49.3495 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Time taken to solve the Levenberg-Marquardt system of equations: 0.228401
...done!
maximalDeformation: 0.321798
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66256
...done!
=======================
Good trial move (maximal deformation: 0.321798, lambda: 49.3495)
        Cost going from 524113 to 524110
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  519323
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.817 79.8568 49.8707 ]
EM Iteration: 1  ->  519323
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 6 was 524690
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x842b670)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 80601248
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64502
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196948
...done!
maximalDeformation: 3.37141
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.0731265)
Time taken to rasterize Levenberg-Marquardt: 0.0901871
...done!
=======================
Bad trial move (maximal deformation: 3.37141, lambda: 1)
        Cost going from 524110 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.204519
...done!
maximalDeformation: 2.13393
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1945581 has managed to turn bad (detJ: -0.0824379)
Time taken to rasterize Levenberg-Marquardt: 0.688925
...done!
=======================
Bad trial move (maximal deformation: 2.13393, lambda: 2)
        Cost going from 524110 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19939
...done!
maximalDeformation: 1.26092
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61623
...done!
=======================
Bad trial move (maximal deformation: 1.26092, lambda: 4)
        Cost going from 524110 to 524182
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184446
...done!
maximalDeformation: 0.701576
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58119
...done!
=======================
Bad trial move (maximal deformation: 0.701576, lambda: 8)
        Cost going from 524110 to 524132
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184716
...done!
maximalDeformation: 0.37251
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58467
...done!
=======================
Bad trial move (maximal deformation: 0.37251, lambda: 16)
        Cost going from 524110 to 524115
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182491
...done!
maximalDeformation: 0.191931
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58109
...done!
=======================
Good trial move (maximal deformation: 0.191931, lambda: 32)
        Cost going from 524110 to 524109
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201852
...done!
maximalDeformation: 0.356807
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64095
...done!
=======================
Bad trial move (maximal deformation: 0.356807, lambda: 29.0909)
        Cost going from 524109 to 524110
Transforming mesh
Done transforming mesh
        Increasing lambda from 29.0909 to 58.1818 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192318
...done!
maximalDeformation: 0.181742
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.611
...done!
=======================
Good trial move (maximal deformation: 0.181742, lambda: 58.1818)
        Cost going from 524109 to 524107
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192745
...done!
maximalDeformation: 0.192912
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62465
...done!
=======================
Good trial move (maximal deformation: 0.192912, lambda: 52.8926)
        Cost going from 524107 to 524107
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208149
...done!
maximalDeformation: 0.146374
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64587
...done!
=======================
Good trial move (maximal deformation: 0.146374, lambda: 48.0841)
        Cost going from 524107 to 524106
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199305
...done!
maximalDeformation: 0.181237
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62894
...done!
=======================
Good trial move (maximal deformation: 0.181237, lambda: 43.7129)
        Cost going from 524106 to 524106
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217208
...done!
maximalDeformation: 0.257211
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67759
...done!
=======================
Good trial move (maximal deformation: 0.257211, lambda: 39.739)
        Cost going from 524106 to 524106
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212441
...done!
maximalDeformation: 0.197909
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65952
...done!
=======================
Good trial move (maximal deformation: 0.197909, lambda: 36.1263)
        Cost going from 524106 to 524105
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230236
...done!
maximalDeformation: 0.404024
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68298
...done!
=======================
Bad trial move (maximal deformation: 0.404024, lambda: 32.8421)
        Cost going from 524105 to 524105
Transforming mesh
Done transforming mesh
        Increasing lambda from 32.8421 to 65.6842 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Time taken to solve the Levenberg-Marquardt system of equations: 0.233882
...done!
maximalDeformation: 0.205777
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67099
...done!
=======================
Good trial move (maximal deformation: 0.205777, lambda: 65.6842)
        Cost going from 524105 to 524103
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225089
...done!
maximalDeformation: 0.200425
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67469
...done!
=======================
Good trial move (maximal deformation: 0.200425, lambda: 59.7129)
        Cost going from 524103 to 524102
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241013
...done!
maximalDeformation: 0.12536
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69597
...done!
=======================
Good trial move (maximal deformation: 0.12536, lambda: 54.2845)
        Cost going from 524102 to 524102
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235265
...done!
maximalDeformation: 0.270719
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69319
...done!
=======================
Good trial move (maximal deformation: 0.270719, lambda: 49.3495)
        Cost going from 524102 to 524102
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  519311
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.82 79.8594 49.8704 ]
EM Iteration: 1  ->  519311
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 7 was 524682
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa0b7e40)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 83730571
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65161
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196427
...done!
maximalDeformation: 3.42389
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.663987)
Time taken to rasterize Levenberg-Marquardt: 0.00637984
...done!
=======================
Bad trial move (maximal deformation: 3.42389, lambda: 1)
        Cost going from 524102 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193277
...done!
maximalDeformation: 2.05859
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1276717 has managed to turn bad (detJ: -0.0470287)
Time taken to rasterize Levenberg-Marquardt: 0.274072
...done!
=======================
Bad trial move (maximal deformation: 2.05859, lambda: 2)
        Cost going from 524102 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190202
...done!
maximalDeformation: 1.1832
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59334
...done!
=======================
Bad trial move (maximal deformation: 1.1832, lambda: 4)
        Cost going from 524102 to 524184
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186463
...done!
maximalDeformation: 0.670037
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59146
...done!
=======================
Bad trial move (maximal deformation: 0.670037, lambda: 8)
        Cost going from 524102 to 524132
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186513
...done!
maximalDeformation: 0.366882
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59718
...done!
=======================
Bad trial move (maximal deformation: 0.366882, lambda: 16)
        Cost going from 524102 to 524111
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184608
...done!
maximalDeformation: 0.192655
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58164
...done!
=======================
Bad trial move (maximal deformation: 0.192655, lambda: 32)
        Cost going from 524102 to 524103
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185258
...done!
maximalDeformation: 0.0990921
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59519
...done!
=======================
Good trial move (maximal deformation: 0.0990921, lambda: 64)
        Cost going from 524102 to 524101
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202933
...done!
maximalDeformation: 0.194592
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64323
...done!
=======================
Good trial move (maximal deformation: 0.194592, lambda: 58.1818)
        Cost going from 524101 to 524100
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197461
...done!
maximalDeformation: 0.126627
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62881
...done!
=======================
Good trial move (maximal deformation: 0.126627, lambda: 52.8926)
        Cost going from 524100 to 524100
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210312
...done!
maximalDeformation: 0.129841
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64915
...done!
=======================
Good trial move (maximal deformation: 0.129841, lambda: 48.0841)
        Cost going from 524100 to 524100
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208438
...done!
maximalDeformation: 0.153695
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65012
...done!
=======================
Good trial move (maximal deformation: 0.153695, lambda: 43.7129)
        Cost going from 524100 to 524100
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222293
...done!
maximalDeformation: 0.410299
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66725
...done!
=======================
Good trial move (maximal deformation: 0.410299, lambda: 39.739)
        Cost going from 524100 to 524099
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222451
...done!
maximalDeformation: 0.178425
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67653
...done!
=======================
Bad trial move (maximal deformation: 0.178425, lambda: 36.1263)
        Cost going from 524099 to 524099
Transforming mesh
Done transforming mesh
        Increasing lambda from 36.1263 to 72.2527 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Time taken to solve the Levenberg-Marquardt system of equations: 0.218174
...done!
maximalDeformation: 0.0911226
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65706
...done!
=======================
Good trial move (maximal deformation: 0.0911226, lambda: 72.2527)
        Cost going from 524099 to 524098
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23416
...done!
maximalDeformation: 0.107665
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68612
...done!
=======================
Good trial move (maximal deformation: 0.107665, lambda: 65.6842)
        Cost going from 524098 to 524097
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230843
...done!
maximalDeformation: 0.108628
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68508
...done!
=======================
Bad trial move (maximal deformation: 0.108628, lambda: 59.7129)
        Cost going from 524097 to 524097
Transforming mesh
Done transforming mesh
        Increasing lambda from 59.7129 to 119.426 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 119.426...
Time taken to solve the Levenberg-Marquardt system of equations: 0.233323
...done!
maximalDeformation: 0.0548783
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66707
...done!
=======================
Good trial move (maximal deformation: 0.0548783, lambda: 119.426)
        Cost going from 524097 to 524096
        Decreasing lambda from 119.426 to 108.569
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 108.569...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242705
...done!
maximalDeformation: 0.0598228
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69811
...done!
=======================
Bad trial move (maximal deformation: 0.0598228, lambda: 108.569)
        Cost going from 524096 to 524096
Transforming mesh
Done transforming mesh
        Increasing lambda from 108.569 to 217.138 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 217.138...
Time taken to solve the Levenberg-Marquardt system of equations: 0.240667
...done!
maximalDeformation: 0.0300969
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67367
...done!
=======================
Good trial move (maximal deformation: 0.0300969, lambda: 217.138)
        Cost going from 524096 to 524096
        Decreasing lambda from 217.138 to 197.398
        maximalDeformation is too small; stopping
Starting EM: 
EM Iteration: 0  ->  519302
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.82 79.8603 49.8707 ]
EM Iteration: 1  ->  519302
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.82 79.8607 49.8706 ]
EM Iteration: 2  ->  519302
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 8 was 524676
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xdd1d9e0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 87102858
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62542
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192618
...done!
maximalDeformation: 6.18202
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2678964 has managed to turn bad (detJ: -0.365625)
Time taken to rasterize Levenberg-Marquardt: 1.48247
...done!
=======================
Bad trial move (maximal deformation: 6.18202, lambda: 1)
        Cost going from 524096 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184973
...done!
maximalDeformation: 3.76244
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57766
...done!
=======================
Bad trial move (maximal deformation: 3.76244, lambda: 2)
        Cost going from 524096 to 524219
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183568
...done!
maximalDeformation: 2.16287
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5755
...done!
=======================
Bad trial move (maximal deformation: 2.16287, lambda: 4)
        Cost going from 524096 to 524137
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180289
...done!
maximalDeformation: 1.18038
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57779
...done!
=======================
Bad trial move (maximal deformation: 1.18038, lambda: 8)
        Cost going from 524096 to 524113
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.179828
...done!
maximalDeformation: 0.620894
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57937
...done!
=======================
Bad trial move (maximal deformation: 0.620894, lambda: 16)
        Cost going from 524096 to 524102
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.177931
...done!
maximalDeformation: 0.318067
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58097
...done!
=======================
Bad trial move (maximal deformation: 0.318067, lambda: 32)
        Cost going from 524096 to 524098
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.178176
...done!
maximalDeformation: 0.161729
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57732
...done!
=======================
Bad trial move (maximal deformation: 0.161729, lambda: 64)
        Cost going from 524096 to 524096
Transforming mesh
Done transforming mesh
        Increasing lambda from 64 to 128 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 128...
Time taken to solve the Levenberg-Marquardt system of equations: 0.178783
...done!
maximalDeformation: 0.0815116
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57877
...done!
=======================
Good trial move (maximal deformation: 0.0815116, lambda: 128)
        Cost going from 524096 to 524095
        Decreasing lambda from 128 to 116.364
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 116.364...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19811
...done!
maximalDeformation: 0.0764324
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62251
...done!
=======================
Good trial move (maximal deformation: 0.0764324, lambda: 116.364)
        Cost going from 524095 to 524095
        Decreasing lambda from 116.364 to 105.785
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.180935
...done!
maximalDeformation: 0.0824081
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59305
...done!
=======================
Good trial move (maximal deformation: 0.0824081, lambda: 105.785)
        Cost going from 524095 to 524095
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20478
...done!
maximalDeformation: 0.147348
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63959
...done!
=======================
Good trial move (maximal deformation: 0.147348, lambda: 96.1683)
        Cost going from 524095 to 524095
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19738
...done!
maximalDeformation: 0.090534
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68877
...done!
=======================
Good trial move (maximal deformation: 0.090534, lambda: 87.4257)
        Cost going from 524095 to 524095
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219989
...done!
maximalDeformation: 0.0940634
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66158
...done!
=======================
Good trial move (maximal deformation: 0.0940634, lambda: 79.4779)
        Cost going from 524095 to 524094
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209197
...done!
maximalDeformation: 0.123435
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64483
...done!
=======================
Good trial move (maximal deformation: 0.123435, lambda: 72.2527)
        Cost going from 524094 to 524094
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231407
...done!
maximalDeformation: 0.146221
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68965
...done!
=======================
Good trial move (maximal deformation: 0.146221, lambda: 65.6842)
        Cost going from 524094 to 524094
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221323
...done!
maximalDeformation: 0.106873
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66925
...done!
=======================
Good trial move (maximal deformation: 0.106873, lambda: 59.7129)
        Cost going from 524094 to 524094
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241563
...done!
maximalDeformation: 0.21745
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69975
...done!
=======================
Good trial move (maximal deformation: 0.21745, lambda: 54.2845)
        Cost going from 524094 to 524093
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232778
...done!
maximalDeformation: 0.125682
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68872
...done!
=======================
Good trial move (maximal deformation: 0.125682, lambda: 49.3495)
        Cost going from 524093 to 524093
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  519297
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.82 79.8607 49.8709 ]
EM Iteration: 1  ->  519297
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.82 79.8606 49.8706 ]
EM Iteration: 2  ->  519297
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 9 was 524673
============================================
Converged!
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 0
maximum: 147
Running for smoothing sigma 0
Starting EM: 
EM Iteration: 0  ->  519133
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.809 79.8544 49.8908 ]
EM Iteration: 1  ->  519135
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 0 was 524512
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xf46a240)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 90440974
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64067
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198715
...done!
maximalDeformation: 4.70876
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 482886 has managed to turn bad (detJ: -0.061273)
Time taken to rasterize Levenberg-Marquardt: 0.0370669
...done!
=======================
Bad trial move (maximal deformation: 4.70876, lambda: 1)
        Cost going from 523930 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194173
...done!
maximalDeformation: 2.89674
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 495457 has managed to turn bad (detJ: -0.241995)
Time taken to rasterize Levenberg-Marquardt: 0.038759
...done!
=======================
Bad trial move (maximal deformation: 2.89674, lambda: 2)
        Cost going from 523930 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189818
...done!
maximalDeformation: 1.69342
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57854
...done!
=======================
Bad trial move (maximal deformation: 1.69342, lambda: 4)
        Cost going from 523930 to 524019
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188679
...done!
maximalDeformation: 0.939191
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5719
...done!
=======================
Bad trial move (maximal deformation: 0.939191, lambda: 8)
        Cost going from 523930 to 523956
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186971
...done!
maximalDeformation: 0.500333
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56788
...done!
=======================
Bad trial move (maximal deformation: 0.500333, lambda: 16)
        Cost going from 523930 to 523937
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18498
...done!
maximalDeformation: 0.258452
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56849
...done!
=======================
Good trial move (maximal deformation: 0.258452, lambda: 32)
        Cost going from 523930 to 523930
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202962
...done!
maximalDeformation: 0.505966
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61672
...done!
=======================
Good trial move (maximal deformation: 0.505966, lambda: 29.0909)
        Cost going from 523930 to 523928
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198853
...done!
maximalDeformation: 0.254998
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61579
...done!
=======================
Good trial move (maximal deformation: 0.254998, lambda: 26.4463)
        Cost going from 523928 to 523926
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21412
...done!
maximalDeformation: 0.232334
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64095
...done!
=======================
Good trial move (maximal deformation: 0.232334, lambda: 24.0421)
        Cost going from 523926 to 523924
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2114
...done!
maximalDeformation: 0.34968
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63684
...done!
=======================
Good trial move (maximal deformation: 0.34968, lambda: 21.8564)
        Cost going from 523924 to 523923
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226419
...done!
maximalDeformation: 0.332361
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65466
...done!
=======================
Good trial move (maximal deformation: 0.332361, lambda: 19.8695)
        Cost going from 523923 to 523920
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224273
...done!
maximalDeformation: 0.84188
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66151
...done!
=======================
Good trial move (maximal deformation: 0.84188, lambda: 18.0632)
        Cost going from 523920 to 523919
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237543
...done!
maximalDeformation: 0.343858
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67655
...done!
=======================
Good trial move (maximal deformation: 0.343858, lambda: 16.4211)
        Cost going from 523919 to 523917
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23506
...done!
maximalDeformation: 0.649925
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68014
...done!
=======================
Good trial move (maximal deformation: 0.649925, lambda: 14.9282)
        Cost going from 523917 to 523916
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247531
...done!
maximalDeformation: 0.780804
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70158
...done!
=======================
Bad trial move (maximal deformation: 0.780804, lambda: 13.5711)
        Cost going from 523916 to 523917
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.5711 to 27.1422 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Time taken to solve the Levenberg-Marquardt system of equations: 0.249511
...done!
maximalDeformation: 0.404635
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67643
...done!
=======================
Good trial move (maximal deformation: 0.404635, lambda: 27.1422)
        Cost going from 523916 to 523907
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244784
...done!
maximalDeformation: 0.237683
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68106
...done!
=======================
Good trial move (maximal deformation: 0.237683, lambda: 24.6748)
        Cost going from 523907 to 523903
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  519094
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.814 79.8572 49.9005 ]
EM Iteration: 1  ->  519092
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.812 79.8568 49.9039 ]
EM Iteration: 2  ->  519092
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.81 79.8566 49.9048 ]
EM Iteration: 3  ->  519091
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.809 79.8561 49.9052 ]
EM Iteration: 4  ->  519091
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.809 79.8557 49.905 ]
EM Iteration: 5  ->  519091
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 5
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 1 was 524482
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x94c90b0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 93377471
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64223
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19846
...done!
maximalDeformation: 3.79125
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 529477 has managed to turn bad (detJ: -0.0390182)
Time taken to rasterize Levenberg-Marquardt: 0.0444109
...done!
=======================
Bad trial move (maximal deformation: 3.79125, lambda: 1)
        Cost going from 523902 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191869
...done!
maximalDeformation: 2.41385
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1421979 has managed to turn bad (detJ: -0.260684)
Time taken to rasterize Levenberg-Marquardt: 0.34222
...done!
=======================
Bad trial move (maximal deformation: 2.41385, lambda: 2)
        Cost going from 523902 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189248
...done!
maximalDeformation: 1.42136
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1426688 has managed to turn bad (detJ: -0.303702)
Time taken to rasterize Levenberg-Marquardt: 0.338481
...done!
=======================
Bad trial move (maximal deformation: 1.42136, lambda: 4)
        Cost going from 523902 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188174
...done!
maximalDeformation: 0.786442
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57807
...done!
=======================
Bad trial move (maximal deformation: 0.786442, lambda: 8)
        Cost going from 523902 to 523931
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188944
...done!
maximalDeformation: 0.416992
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.572
...done!
=======================
Bad trial move (maximal deformation: 0.416992, lambda: 16)
        Cost going from 523902 to 523907
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187195
...done!
maximalDeformation: 0.215262
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5683
...done!
=======================
Good trial move (maximal deformation: 0.215262, lambda: 32)
        Cost going from 523902 to 523900
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.203362
...done!
maximalDeformation: 0.359076
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61403
...done!
=======================
Good trial move (maximal deformation: 0.359076, lambda: 29.0909)
        Cost going from 523900 to 523898
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198522
...done!
maximalDeformation: 0.197311
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60909
...done!
=======================
Good trial move (maximal deformation: 0.197311, lambda: 26.4463)
        Cost going from 523898 to 523898
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213142
...done!
maximalDeformation: 0.57256
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63667
...done!
=======================
Good trial move (maximal deformation: 0.57256, lambda: 24.0421)
        Cost going from 523898 to 523898
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211053
...done!
maximalDeformation: 0.338547
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63718
...done!
=======================
Bad trial move (maximal deformation: 0.338547, lambda: 21.8564)
        Cost going from 523898 to 523898
Transforming mesh
Done transforming mesh
        Increasing lambda from 21.8564 to 43.7129 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Time taken to solve the Levenberg-Marquardt system of equations: 0.199406
...done!
maximalDeformation: 0.172944
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59642
...done!
=======================
Good trial move (maximal deformation: 0.172944, lambda: 43.7129)
        Cost going from 523898 to 523894
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220499
...done!
maximalDeformation: 0.200008
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64932
...done!
=======================
Good trial move (maximal deformation: 0.200008, lambda: 39.739)
        Cost going from 523894 to 523893
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212054
...done!
maximalDeformation: 0.327898
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63908
...done!
=======================
Good trial move (maximal deformation: 0.327898, lambda: 36.1263)
        Cost going from 523893 to 523892
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232467
...done!
maximalDeformation: 0.218364
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6719
...done!
=======================
Good trial move (maximal deformation: 0.218364, lambda: 32.8421)
        Cost going from 523892 to 523891
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223667
...done!
maximalDeformation: 0.489061
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66143
...done!
=======================
Bad trial move (maximal deformation: 0.489061, lambda: 29.8565)
        Cost going from 523891 to 523892
Transforming mesh
Done transforming mesh
        Increasing lambda from 29.8565 to 59.7129 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Time taken to solve the Levenberg-Marquardt system of equations: 0.213682
...done!
maximalDeformation: 0.248897
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64321
...done!
=======================
Good trial move (maximal deformation: 0.248897, lambda: 59.7129)
        Cost going from 523891 to 523889
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240686
...done!
maximalDeformation: 0.220521
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6809
...done!
=======================
Good trial move (maximal deformation: 0.220521, lambda: 54.2845)
        Cost going from 523889 to 523888
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224839
...done!
maximalDeformation: 0.0768269
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65839
...done!
=======================
Good trial move (maximal deformation: 0.0768269, lambda: 49.3495)
        Cost going from 523888 to 523888
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  519070
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.81 79.8562 49.9047 ]
EM Iteration: 1  ->  519070
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 2 was 524467
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xcc5bbb0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 96506794
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64437
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19868
...done!
maximalDeformation: 3.84388
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -1.13509)
Time taken to rasterize Levenberg-Marquardt: 0.0898979
...done!
=======================
Bad trial move (maximal deformation: 3.84388, lambda: 1)
        Cost going from 523888 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193073
...done!
maximalDeformation: 2.37525
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.41424)
Time taken to rasterize Levenberg-Marquardt: 0.0884159
...done!
=======================
Bad trial move (maximal deformation: 2.37525, lambda: 2)
        Cost going from 523888 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188805
...done!
maximalDeformation: 1.38695
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1866927 has managed to turn bad (detJ: -0.0938647)
Time taken to rasterize Levenberg-Marquardt: 0.606035
...done!
=======================
Bad trial move (maximal deformation: 1.38695, lambda: 4)
        Cost going from 523888 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185102
...done!
maximalDeformation: 0.772266
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57926
...done!
=======================
Bad trial move (maximal deformation: 0.772266, lambda: 8)
        Cost going from 523888 to 523915
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184813
...done!
maximalDeformation: 0.414372
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5684
...done!
=======================
Bad trial move (maximal deformation: 0.414372, lambda: 16)
        Cost going from 523888 to 523896
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183472
...done!
maximalDeformation: 0.214935
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56874
...done!
=======================
Bad trial move (maximal deformation: 0.214935, lambda: 32)
        Cost going from 523888 to 523889
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194847
...done!
maximalDeformation: 0.109831
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59278
...done!
=======================
Good trial move (maximal deformation: 0.109831, lambda: 64)
        Cost going from 523888 to 523887
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204382
...done!
maximalDeformation: 0.1258
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62481
...done!
=======================
Good trial move (maximal deformation: 0.1258, lambda: 58.1818)
        Cost going from 523887 to 523886
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205079
...done!
maximalDeformation: 0.137093
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6333
...done!
=======================
Good trial move (maximal deformation: 0.137093, lambda: 52.8926)
        Cost going from 523886 to 523886
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2116
...done!
maximalDeformation: 0.291024
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63209
...done!
=======================
Good trial move (maximal deformation: 0.291024, lambda: 48.0841)
        Cost going from 523886 to 523886
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217668
...done!
maximalDeformation: 0.229079
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65958
...done!
=======================
Good trial move (maximal deformation: 0.229079, lambda: 43.7129)
        Cost going from 523886 to 523886
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224544
...done!
maximalDeformation: 0.182376
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65041
...done!
=======================
Good trial move (maximal deformation: 0.182376, lambda: 39.739)
        Cost going from 523886 to 523885
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231265
...done!
maximalDeformation: 0.504304
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.676
...done!
=======================
Bad trial move (maximal deformation: 0.504304, lambda: 36.1263)
        Cost going from 523885 to 523885
Transforming mesh
Done transforming mesh
        Increasing lambda from 36.1263 to 72.2527 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Time taken to solve the Levenberg-Marquardt system of equations: 0.239055
...done!
maximalDeformation: 0.255993
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66419
...done!
=======================
Good trial move (maximal deformation: 0.255993, lambda: 72.2527)
        Cost going from 523885 to 523883
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234931
...done!
maximalDeformation: 0.104758
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67481
...done!
=======================
Good trial move (maximal deformation: 0.104758, lambda: 65.6842)
        Cost going from 523883 to 523883
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245443
...done!
maximalDeformation: 0.150105
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69821
...done!
=======================
Good trial move (maximal deformation: 0.150105, lambda: 59.7129)
        Cost going from 523883 to 523882
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24774
...done!
maximalDeformation: 0.181835
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69261
...done!
=======================
Good trial move (maximal deformation: 0.181835, lambda: 54.2845)
        Cost going from 523882 to 523882
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.254933
...done!
maximalDeformation: 0.131825
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70301
...done!
=======================
Good trial move (maximal deformation: 0.131825, lambda: 49.3495)
        Cost going from 523882 to 523882
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  519059
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.81 79.857 49.9033 ]
EM Iteration: 1  ->  519059
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 3 was 524461
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc1ec0f0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 99636117
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63726
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196112
...done!
maximalDeformation: 3.77829
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1776533 has managed to turn bad (detJ: -0.206267)
Time taken to rasterize Levenberg-Marquardt: 0.549027
...done!
=======================
Bad trial move (maximal deformation: 3.77829, lambda: 1)
        Cost going from 523882 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191385
...done!
maximalDeformation: 2.4316
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58344
...done!
=======================
Bad trial move (maximal deformation: 2.4316, lambda: 2)
        Cost going from 523882 to 524230
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187121
...done!
maximalDeformation: 1.44468
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56458
...done!
=======================
Bad trial move (maximal deformation: 1.44468, lambda: 4)
        Cost going from 523882 to 523963
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18527
...done!
maximalDeformation: 0.802535
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57945
...done!
=======================
Bad trial move (maximal deformation: 0.802535, lambda: 8)
        Cost going from 523882 to 523912
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184177
...done!
maximalDeformation: 0.426606
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56785
...done!
=======================
Bad trial move (maximal deformation: 0.426606, lambda: 16)
        Cost going from 523882 to 523891
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182823
...done!
maximalDeformation: 0.220209
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58024
...done!
=======================
Bad trial move (maximal deformation: 0.220209, lambda: 32)
        Cost going from 523882 to 523883
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18255
...done!
maximalDeformation: 0.112135
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57682
...done!
=======================
Good trial move (maximal deformation: 0.112135, lambda: 64)
        Cost going from 523882 to 523881
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200111
...done!
maximalDeformation: 0.18507
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61933
...done!
=======================
Good trial move (maximal deformation: 0.18507, lambda: 58.1818)
        Cost going from 523881 to 523880
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194044
...done!
maximalDeformation: 0.16929
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6095
...done!
=======================
Good trial move (maximal deformation: 0.16929, lambda: 52.8926)
        Cost going from 523880 to 523880
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207646
...done!
maximalDeformation: 0.148007
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63506
...done!
=======================
Good trial move (maximal deformation: 0.148007, lambda: 48.0841)
        Cost going from 523880 to 523880
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205795
...done!
maximalDeformation: 0.306589
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63317
...done!
=======================
Good trial move (maximal deformation: 0.306589, lambda: 43.7129)
        Cost going from 523880 to 523880
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220774
...done!
maximalDeformation: 0.227122
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64922
...done!
=======================
Good trial move (maximal deformation: 0.227122, lambda: 39.739)
        Cost going from 523880 to 523879
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22025
...done!
maximalDeformation: 0.187132
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65064
...done!
=======================
Good trial move (maximal deformation: 0.187132, lambda: 36.1263)
        Cost going from 523879 to 523879
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230979
...done!
maximalDeformation: 0.506156
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67102
...done!
=======================
Bad trial move (maximal deformation: 0.506156, lambda: 32.8421)
        Cost going from 523879 to 523879
Transforming mesh
Done transforming mesh
        Increasing lambda from 32.8421 to 65.6842 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Time taken to solve the Levenberg-Marquardt system of equations: 0.227516
...done!
maximalDeformation: 0.256918
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65649
...done!
=======================
Good trial move (maximal deformation: 0.256918, lambda: 65.6842)
        Cost going from 523879 to 523877
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22717
...done!
maximalDeformation: 0.111972
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65834
...done!
=======================
Good trial move (maximal deformation: 0.111972, lambda: 59.7129)
        Cost going from 523877 to 523876
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233896
...done!
maximalDeformation: 0.262532
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67802
...done!
=======================
Good trial move (maximal deformation: 0.262532, lambda: 54.2845)
        Cost going from 523876 to 523876
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230074
...done!
maximalDeformation: 0.129146
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67121
...done!
=======================
Good trial move (maximal deformation: 0.129146, lambda: 49.3495)
        Cost going from 523876 to 523876
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  519050
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.811 79.8576 49.9018 ]
EM Iteration: 1  ->  519050
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 4 was 524456
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x102a51a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 102765440
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62984
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197954
...done!
maximalDeformation: 3.70089
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.2787)
Time taken to rasterize Levenberg-Marquardt: 0.00572515
...done!
=======================
Bad trial move (maximal deformation: 3.70089, lambda: 1)
        Cost going from 523876 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189921
...done!
maximalDeformation: 2.40549
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1276717 has managed to turn bad (detJ: -0.582657)
Time taken to rasterize Levenberg-Marquardt: 0.270598
...done!
=======================
Bad trial move (maximal deformation: 2.40549, lambda: 2)
        Cost going from 523876 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187866
...done!
maximalDeformation: 1.43338
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1276717 has managed to turn bad (detJ: -0.0424423)
Time taken to rasterize Levenberg-Marquardt: 0.269035
...done!
=======================
Bad trial move (maximal deformation: 1.43338, lambda: 4)
        Cost going from 523876 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183394
...done!
maximalDeformation: 0.797207
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57624
...done!
=======================
Bad trial move (maximal deformation: 0.797207, lambda: 8)
        Cost going from 523876 to 523909
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183089
...done!
maximalDeformation: 0.422283
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57756
...done!
=======================
Bad trial move (maximal deformation: 0.422283, lambda: 16)
        Cost going from 523876 to 523886
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181417
...done!
maximalDeformation: 0.217158
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.581
...done!
=======================
Bad trial move (maximal deformation: 0.217158, lambda: 32)
        Cost going from 523876 to 523877
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181478
...done!
maximalDeformation: 0.11054
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57632
...done!
=======================
Good trial move (maximal deformation: 0.11054, lambda: 64)
        Cost going from 523876 to 523875
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200249
...done!
maximalDeformation: 0.12623
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62344
...done!
=======================
Good trial move (maximal deformation: 0.12623, lambda: 58.1818)
        Cost going from 523875 to 523875
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194741
...done!
maximalDeformation: 0.158829
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6074
...done!
=======================
Good trial move (maximal deformation: 0.158829, lambda: 52.8926)
        Cost going from 523875 to 523875
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207561
...done!
maximalDeformation: 0.130992
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63028
...done!
=======================
Good trial move (maximal deformation: 0.130992, lambda: 48.0841)
        Cost going from 523875 to 523874
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206434
...done!
maximalDeformation: 0.161277
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63749
...done!
=======================
Bad trial move (maximal deformation: 0.161277, lambda: 43.7129)
        Cost going from 523874 to 523874
Transforming mesh
Done transforming mesh
        Increasing lambda from 43.7129 to 87.4257 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Time taken to solve the Levenberg-Marquardt system of equations: 0.211642
...done!
maximalDeformation: 0.0817195
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64322
...done!
=======================
Good trial move (maximal deformation: 0.0817195, lambda: 87.4257)
        Cost going from 523874 to 523873
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220101
...done!
maximalDeformation: 0.200523
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64883
...done!
=======================
Good trial move (maximal deformation: 0.200523, lambda: 79.4779)
        Cost going from 523873 to 523872
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221066
...done!
maximalDeformation: 0.137085
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66735
...done!
=======================
Good trial move (maximal deformation: 0.137085, lambda: 72.2527)
        Cost going from 523872 to 523872
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232584
...done!
maximalDeformation: 0.0933037
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66723
...done!
=======================
Good trial move (maximal deformation: 0.0933037, lambda: 65.6842)
        Cost going from 523872 to 523872
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234391
...done!
maximalDeformation: 0.165517
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68115
...done!
=======================
Good trial move (maximal deformation: 0.165517, lambda: 59.7129)
        Cost going from 523872 to 523872
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242877
...done!
maximalDeformation: 0.162194
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68106
...done!
=======================
Good trial move (maximal deformation: 0.162194, lambda: 54.2845)
        Cost going from 523872 to 523872
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243615
...done!
maximalDeformation: 0.130887
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69225
...done!
=======================
Bad trial move (maximal deformation: 0.130887, lambda: 49.3495)
        Cost going from 523872 to 523872
Transforming mesh
Done transforming mesh
        Increasing lambda from 49.3495 to 98.6991 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Time taken to solve the Levenberg-Marquardt system of equations: 0.247616
...done!
maximalDeformation: 0.0662581
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68023
...done!
=======================
Good trial move (maximal deformation: 0.0662581, lambda: 98.6991)
        Cost going from 523872 to 523871
        Decreasing lambda from 98.6991 to 89.7264
Starting EM: 
EM Iteration: 0  ->  519042
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.813 79.8588 49.9007 ]
EM Iteration: 1  ->  519042
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 5 was 524450
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x23ec010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x109ccf80)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 106087669
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.797941 -0.00899033 0.00923813 
    0.00046494 0.73643 0.314445 
    0.128436 -0.317963 0.751506 
  Offset: [82.6371, 9.63765, 35.4531]
  Center: [0, 0, 0]
  Translation: [82.6371, 9.63765, 35.4531]
  Inverse: 
    -1.25026 -0.00730724 0.0184266 
    -0.0766076 1.14968 -0.480105 
    0.181264 0.487678 1.12438 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62698
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19662
...done!
maximalDeformation: 5.35743
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1518973 has managed to turn bad (detJ: -0.371377)
Time taken to rasterize Levenberg-Marquardt: 0.390691
...done!
=======================
Bad trial move (maximal deformation: 5.35743, lambda: 1)
        Cost going from 523870 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188678
...done!
maximalDeformation: 3.33882
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1518973 has managed to turn bad (detJ: -0.0866917)
Time taken to rasterize Levenberg-Marquardt: 0.388467
...done!
=======================
Bad trial move (maximal deformation: 3.33882, lambda: 2)
        Cost going from 523870 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186474
...done!
maximalDeformation: 1.95887
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57608
...done!
=======================
Bad trial move (maximal deformation: 1.95887, lambda: 4)
        Cost going from 523870 to 523928
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182921
...done!
maximalDeformation: 1.08557
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57465
...done!
=======================
Bad trial move (maximal deformation: 1.08557, lambda: 8)
        Cost going from 523870 to 523894
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183243
...done!
maximalDeformation: 0.576501
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57592
...done!
=======================
Bad trial move (maximal deformation: 0.576501, lambda: 16)
        Cost going from 523870 to 523879
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180994
...done!
maximalDeformation: 0.297118
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57163
...done!
=======================
Bad trial move (maximal deformation: 0.297118, lambda: 32)
        Cost going from 523870 to 523873
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181219
...done!
maximalDeformation: 0.15148
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57863
...done!
=======================
Good trial move (maximal deformation: 0.15148, lambda: 64)
        Cost going from 523870 to 523870
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19873
...done!
maximalDeformation: 0.097797
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62141
...done!
=======================
Bad trial move (maximal deformation: 0.097797, lambda: 58.1818)
        Cost going from 523870 to 523871
Transforming mesh
Done transforming mesh
        Increasing lambda from 58.1818 to 116.364 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 116.364...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188306
...done!
maximalDeformation: 0.049433
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59088
...done!
=======================
Good trial move (maximal deformation: 0.049433, lambda: 116.364)
        Cost going from 523870 to 523870
        Decreasing lambda from 116.364 to 105.785
        maximalDeformation is too small; stopping
Starting EM: 
EM Iteration: 0  ->  519041
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.813 79.8591 49.9004 ]
EM Iteration: 1  ->  519041
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.812 79.8589 49.9001 ]
EM Iteration: 2  ->  519041
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.811 79.8585 49.8998 ]
EM Iteration: 3  ->  519040
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 6 was 524449
============================================
Converged!
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
numberOfBasisFunctions: 1
numberOfVoxelsInMask: 134360
indexWhereUnityIsReached [91, 112, 169]
Successfully put up x, y, and z
Constructing basis functions
      (xOrder, yOrder, zOrder): (0, 0, 0)
Transforming points
Transforming points
Mapping warped mesh back to original space
Transforming points
Abusing EM segmenter now...
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
Original class 2 is distributed over 1 classes
Original class 3 is distributed over 1 classes
Original class 4 is distributed over 1 classes
Original class 5 is distributed over 1 classes
Original class 6 is distributed over 1 classes
Original class 7 is distributed over 1 classes
Original class 8 is distributed over 1 classes
Original class 9 is distributed over 1 classes
Original class 10 is distributed over 1 classes
OK
myAbusedEMSegmenter->GetMeans(): [ 107.811 79.8585 79.8585 49.8998 79.8585 79.8585 107.811 79.8585 49.8998 79.8585 79.8585]
myAbusedEMSegmenter->GetVariances(): [ 77.8742 101.682 101.682 254.464 101.682 101.682 77.8742 101.682 254.464 101.682 101.682]
myAbusedEMSegmenter->GetPriorWeights(): [ 1 1 1 1 1 1 1 1 1 1 1]
-- Starting
-- Initializing
-- Doing the rest
-- Starting to update posteriors
-- done
Still here...
Splitting affine matrix up into spacing, origin, and direction components
AffineTransform (0xcff14f0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 108204970
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.5 -2.98023e-08 0 
    0 0 0.5 
    2.98023e-08 -0.5 0 
  Offset: [1.75021, -23.1035, 9.35744]
  Center: [0, 0, 0]
  Translation: [1.75021, -23.1035, 9.35744]
  Inverse: 
    -2 0 1.19209e-07 
    -1.19209e-07 0 -2 
    0 2 0 
  Singular: 0
spacing: [0.5, 0.5, 0.5]
origin: [1.75021, -23.1035, 9.35744]
direction: -1 -5.96046e-08 0
0 0 1
5.96046e-08 -1 0

done!
Skipping the partial volume segmentation part
Doing right side
meshFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/CurrentMeshCollection30.gz
compressionLookupTableFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/compressionLookupTable.txt
boundingBoxFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/imageDump.mgz
subjectName: HYGLY28_VISIT_2
side: right
inputDirectory: /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED
outputDirectory: /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/tmp/subfieldResults
directory /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/tmp/subfieldResults/HYGLY28_VISIT_2 already exists
mkdir -p /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/tmp/subfieldResults/HYGLY28_VISIT_2/right
cd /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/tmp/subfieldResults/HYGLY28_VISIT_2/right
cp -f /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/mri/nu.mgz .
cp -f /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/mri/aseg.mgz .
cp -f /data/CNDA/build/CCIR_00754/20160926_184458/restlaunch/HYGLY28_VISIT_2/PROCESSED/HYGLY28_VISIT_2/mri/transforms/talairach.xfm .
cp /nrgpackages/tools/freesurfer53-patch/data/GEMS/imageDump.mgz .
kvlApplyTransform imageDump.mgz 1.0932 0.0097 -0.0146 -76.4657 -0.0027 1.0489 0.1291 -121.4683 0.0153 -0.1434 1.1143 -62.7038
transform: Affine3DTransform (0xee5100)
  RTTI typeinfo:   itk::Affine3DTransform<double>
  Reference Count: 2
  Modified Time: 192
  Debug: Off
  Observers: 
    none
  Offset: [-76.4657, -121.468, -62.7038]
  Matrix: 1.0932 0.0097 -0.0146
-0.0027 1.0489 0.1291
0.0153 -0.1434 1.1143


Wrote out imageDump_transformed.mgz
kvlApplyTransform imageDump_transformed.mgz 1.046531 0.043269 -0.017670 -2.095993 -0.059733 0.987705 0.208602 -44.012466 -0.000135 -0.157595 1.075790 12.002991 1
transform: Affine3DTransform (0x24278b0)
  RTTI typeinfo:   itk::Affine3DTransform<double>
  Reference Count: 2
  Modified Time: 193
  Debug: Off
  Observers: 
    none
  Offset: [0.0453077, 45.5114, -4.49029]
  Matrix: 0.953367 -0.0380878 0.0230446
0.0559015 0.979831 -0.189077
0.00830879 0.143533 0.901854


Wrote out imageDump_transformed_transformed.mgz
rm -f imageDump.mgz
mv imageDump_transformed_transformed.mgz imageDump.mgz
kvlBinaryThresholdImage aseg.mgz 53
imageFileName: aseg.mgz
lowerThreshold: 53
upperThreshold: 53
insideValue: 255
outsideValue: 0
Thresholding: 
  0%
  0.999975%
  1.99995%
  2.99993%
  3.9999%
  4.99988%
  5.99985%
  6.99983%
  7.9998%
  8.99978%
  9.99975%
  10.9997%
  11.9997%
  12.9997%
  13.9997%
  14.9996%
  15.9996%
  16.9996%
  17.9996%
  18.9995%
  19.9995%
  20.9995%
  21.9995%
  22.9994%
  23.9994%
  24.9994%
  25.9994%
  26.9993%
  27.9993%
  28.9993%
  29.9993%
  30.9992%
  31.9992%
  32.9992%
  33.9992%
  34.9991%
  35.9991%
  36.9991%
  37.9991%
  38.999%
  39.999%
  40.999%
  41.999%
  42.9989%
  43.9989%
  44.9989%
  45.9989%
  46.9988%
  47.9988%
  48.9988%
  49.9988%
  50.9987%
  51.9987%
  52.9987%
  53.9987%
  54.9986%
  55.9986%
  56.9986%
  57.9986%
  58.9985%
  59.9985%
  60.9985%
  61.9985%
  62.9984%
  63.9984%
  64.9984%
  65.9984%
  66.9983%
  67.9983%
  68.9983%
  69.9983%
  70.9982%
  71.9982%
  72.9982%
  73.9982%
  74.9981%
  75.9981%
  76.9981%
  77.9981%
  78.998%
  79.998%
  80.998%
  81.998%
  82.9979%
  83.9979%
  84.9979%
  85.9979%
  86.9978%
  87.9978%
  88.9978%
  89.9978%
  90.9977%
  91.9977%
  92.9977%
  93.9977%
  94.9976%
  95.9976%
  96.9976%
  97.9976%
  98.9975%
  99.9975%
  100%
  100%
Wrote out aseg_thresholded.mgz
kvlRegister imageDump.mgz aseg_thresholded.mgz 12 2
fixedImageFileName: imageDump.mgz
movingImageFileName: aseg_thresholded.mgz
degreesOfFreedom: 12
numberOfBins: 20
useDefaultSchedule: 1
initialTranslationMode: 2
extraInputImageFileNames: 
Initializing the parameters as follows: [0, -0, 0, -3.13901, 3.13344, -2.05731, 1, 1, 1, 0, 0, 0]
Using fixedShrinkFactors: [3, 3, 2]
Shrinking fixed image: 
  0%
  0.999355%
  1.99871%
  2.99807%
  3.99742%
  4.99678%
  5.99613%
  6.99549%
  7.99484%
  8.9942%
  9.99355%
  10.9929%
  11.9923%
  12.9916%
  13.991%
  14.9903%
  15.9897%
  16.989%
  17.9884%
  18.9878%
  19.9871%
  20.9865%
  21.9858%
  22.9852%
  23.9845%
  24.9839%
  25.9832%
  26.9826%
  27.9819%
  28.9813%
  29.9807%
  30.98%
  31.9794%
  32.9787%
  33.9781%
  34.9774%
  35.9768%
  36.9761%
  37.9755%
  38.9749%
  39.9742%
  40.9736%
  41.9729%
  42.9723%
  43.9716%
  44.971%
  45.9703%
  46.9697%
  47.9691%
  48.9684%
  49.9678%
  50.9671%
  51.9665%
  52.9658%
  53.9652%
  54.9645%
  55.9639%
  56.9633%
  57.9626%
  58.962%
  59.9613%
  60.9607%
  61.96%
  62.9594%
  63.9587%
  64.9581%
  65.9575%
  66.9568%
  67.9562%
  68.9555%
  69.9549%
  70.9542%
  71.9536%
  72.9529%
  73.9523%
  74.9516%
  75.951%
  76.9504%
  77.9497%
  78.9491%
  79.9484%
  80.9478%
  81.9471%
  82.9465%
  83.9458%
  84.9452%
  85.9446%
  86.9439%
  87.9433%
  88.9426%
  89.942%
  90.9413%
  91.9407%
  92.94%
  93.9394%
  94.9388%
  95.9381%
  96.9375%
  97.9368%
  98.9362%
  99.9355%
  100%
  100%
Using movingShrinkFactors: [1, 1, 1]
Shrinking moving image: 
  0%
  0.999975%
  1.99995%
  2.99993%
  3.9999%
  4.99988%
  5.99985%
  6.99983%
  7.9998%
  8.99978%
  9.99975%
  10.9997%
  11.9997%
  12.9997%
  13.9997%
  14.9996%
  15.9996%
  16.9996%
  17.9996%
  18.9995%
  19.9995%
  20.9995%
  21.9995%
  22.9994%
  23.9994%
  24.9994%
  25.9994%
  26.9993%
  27.9993%
  28.9993%
  29.9993%
  30.9992%
  31.9992%
  32.9992%
  33.9992%
  34.9991%
  35.9991%
  36.9991%
  37.9991%
  38.999%
  39.999%
  40.999%
  41.999%
  42.9989%
  43.9989%
  44.9989%
  45.9989%
  46.9988%
  47.9988%
  48.9988%
  49.9988%
  50.9987%
  51.9987%
  52.9987%
  53.9987%
  54.9986%
  55.9986%
  56.9986%
  57.9986%
  58.9985%
  59.9985%
  60.9985%
  61.9985%
  62.9984%
  63.9984%
  64.9984%
  65.9984%
  66.9983%
  67.9983%
  68.9983%
  69.9983%
  70.9982%
  71.9982%
  72.9982%
  73.9982%
  74.9981%
  75.9981%
  76.9981%
  77.9981%
  78.998%
  79.998%
  80.998%
  81.998%
  82.9979%
  83.9979%
  84.9979%
  85.9979%
  86.9978%
  87.9978%
  88.9978%
  89.9978%
  90.9977%
  91.9977%
  92.9977%
  93.9977%
  94.9976%
  95.9976%
  96.9976%
  97.9976%
  98.9975%
  99.9975%
  100%
  100%
Using fixedSchedule: [3, 3, 5]
[1, 1, 1]

Using movingSchedule: [4, 4, 4]
[1, 1, 1]

Using scales: [57.1429, 57.1429, 57.1429, 1, 1, 1, 100, 100, 100, 100, 100, 100]
Using parameterOrder: [4, 5, 6, 1, 2, 3, 7, 8, 9, 10, 11, 12]
Calculating fixed image pyramid: 
  0%
  50%
  100%
Calculating moving image pyramid: 
  0%
  50%
  100%
Doing registration at level 0 of 2
       Iteration 0: value = -0.331105
            Current position: 
                    Rotation: 0.731813  0.63538  -0.030437  
                 Translation: -2.56074  2.74419  -1.71036  
                     Scaling: 1.00279  0.982812  1.0011  
                     Skewing: 0.00188623  0.0072949  -0.00379215  
       Iteration 1: value = -0.344262
            Current position: 
                    Rotation: 1.72779  1.32607  -0.775724  
                 Translation: -2.06647  2.96864  -1.25693  
                     Scaling: 0.997356  0.960797  1.00832  
                     Skewing: 0.00181996  0.0160457  -0.00614236  
       Iteration 2: value = -0.345945
            Current position: 
                    Rotation: 1.68501  1.14143  -0.801548  
                 Translation: -2.07773  2.93838  -1.16932  
                     Scaling: 0.997155  0.963708  1.01317  
                     Skewing: 0.00341477  0.0130434  -0.00187316  
       Iteration 3: value = -0.362328
            Current position: 
                    Rotation: 2.58991  -1.11672  -2.61504  
                 Translation: 0.305049  3.14231  0.632202  
                     Scaling: 0.986426  0.976346  1.10863  
                     Skewing: 0.0261547  -0.0193144  0.0636228  
       Iteration 4: value = -0.363367
            Current position: 
                    Rotation: 2.65629  -1.19065  -2.61029  
                 Translation: 0.391066  3.15727  0.694921  
                     Scaling: 0.985121  0.979585  1.11314  
                     Skewing: 0.0261251  -0.023532  0.0623304  
       Iteration 5: value = -0.365303
            Current position: 
                    Rotation: 2.72116  -1.16473  -2.49282  
                 Translation: 0.387631  3.59779  0.733636  
                     Scaling: 0.978664  0.98645  1.1142  
                     Skewing: 0.0221781  -0.0326349  0.0557323  
       Iteration 6: value = -0.367015
            Current position: 
                    Rotation: 2.95116  -1.36876  -2.12824  
                 Translation: 0.580127  4.03568  1.21998  
                     Scaling: 0.967317  0.993811  1.12539  
                     Skewing: 0.0196951  -0.0489456  0.0556415  
       Iteration 7: value = -0.367619
            Current position: 
                    Rotation: 2.93058  -1.10148  -1.824  
                 Translation: 0.340281  4.05762  1.14462  
                     Scaling: 0.966622  0.992202  1.11876  
                     Skewing: 0.0176996  -0.0490768  0.0509306  
       Iteration 8: value = -0.367985
            Current position: 
                    Rotation: 2.97828  -0.75685  -1.48027  
                 Translation: 0.124046  4.21506  1.16083  
                     Scaling: 0.96438  0.992436  1.11493  
                     Skewing: 0.0170079  -0.054829  0.0454876  
       Iteration 9: value = -0.368656
            Current position: 
                    Rotation: 3.03102  -0.276035  -1.04764  
                 Translation: -0.271278  4.54848  1.21021  
                     Scaling: 0.968748  0.998902  1.11148  
                     Skewing: 0.0228216  -0.0702102  0.0362742  
       Iteration 10: value = -0.369267
            Current position: 
                    Rotation: 3.01486  -0.303581  -1.17616  
                 Translation: -0.30162  4.59619  1.22731  
                     Scaling: 0.97206  1.00335  1.11418  
                     Skewing: 0.0242819  -0.0752816  0.0361757  
PowellOptimizer: Maximum number of iterations exceeded. Number of iterations is 10
Doing registration at level 1 of 2
       Iteration 0: value = -0.198942
            Current position: 
                    Rotation: 3.01486  -0.303581  -1.17616  
                 Translation: -0.30162  4.53041  1.22731  
                     Scaling: 0.97206  1.00335  1.10967  
                     Skewing: 0.0242819  -0.0752816  0.0361757  
PowellOptimizer: Cost function values at the current parameter (-0.198942) and at the local extrema (-0.198942) are within Value Tolerance (0)
Wrote out imageDump_coregistered.mgz
kvlBinaryThresholdImage aseg.mgz 53 53 255 1
imageFileName: aseg.mgz
lowerThreshold: 53
upperThreshold: 53
insideValue: 255
outsideValue: 1
Thresholding: 
  0%
  0.999975%
  1.99995%
  2.99993%
  3.9999%
  4.99988%
  5.99985%
  6.99983%
  7.9998%
  8.99978%
  9.99975%
  10.9997%
  11.9997%
  12.9997%
  13.9997%
  14.9996%
  15.9996%
  16.9996%
  17.9996%
  18.9995%
  19.9995%
  20.9995%
  21.9995%
  22.9994%
  23.9994%
  24.9994%
  25.9994%
  26.9993%
  27.9993%
  28.9993%
  29.9993%
  30.9992%
  31.9992%
  32.9992%
  33.9992%
  34.9991%
  35.9991%
  36.9991%
  37.9991%
  38.999%
  39.999%
  40.999%
  41.999%
  42.9989%
  43.9989%
  44.9989%
  45.9989%
  46.9988%
  47.9988%
  48.9988%
  49.9988%
  50.9987%
  51.9987%
  52.9987%
  53.9987%
  54.9986%
  55.9986%
  56.9986%
  57.9986%
  58.9985%
  59.9985%
  60.9985%
  61.9985%
  62.9984%
  63.9984%
  64.9984%
  65.9984%
  66.9983%
  67.9983%
  68.9983%
  69.9983%
  70.9982%
  71.9982%
  72.9982%
  73.9982%
  74.9981%
  75.9981%
  76.9981%
  77.9981%
  78.998%
  79.998%
  80.998%
  81.998%
  82.9979%
  83.9979%
  84.9979%
  85.9979%
  86.9978%
  87.9978%
  88.9978%
  89.9978%
  90.9977%
  91.9977%
  92.9977%
  93.9977%
  94.9976%
  95.9976%
  96.9976%
  97.9976%
  98.9975%
  99.9975%
  100%
  100%
Wrote out aseg_thresholded.mgz
echo \# Configuration for deforming toward aseg > configurationFileDeformableRegistration.txt
echo logDirectory: deformableRegistrationLog >> configurationFileDeformableRegistration.txt
echo imageFileName: aseg_thresholded.mgz >> configurationFileDeformableRegistration.txt
echo meshCollectionFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/CurrentMeshCollection30.gz >> configurationFileDeformableRegistration.txt
echo K: 0.01 >> configurationFileDeformableRegistration.txt
echo compressionLookupTableFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/compressionLookupTable.txt >> configurationFileDeformableRegistration.txt
echo boundingFileName: imageDump_coregistered.mgz >> configurationFileDeformableRegistration.txt
echo sameGaussianParameters: 53 500 502 503 504 505 506 507 >> configurationFileDeformableRegistration.txt
echo sameGaussianParameters: 24 41 42 >> configurationFileDeformableRegistration.txt
echo imageSmoothingSigmas: 0 >> configurationFileDeformableRegistration.txt
echo meshSmoothingSigmas: 3 >> configurationFileDeformableRegistration.txt
kvlSegmentWithoutGUI configurationFileDeformableRegistration.txt
m_LogDirectory: deformableRegistrationLog
m_ImageFileName: aseg_thresholded.mgz
m_MeshCollectionFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/CurrentMeshCollection30.gz
m_K: 0.01
m_CompressionLookupTableFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/compressionLookupTable.txt
m_BoundingFileName: imageDump_coregistered.mgz
m_SameGaussianParameters[ 0 ]:  53 500 502 503 504 505 506 507
m_SameGaussianParameters[ 1 ]:  24 41 42
m_ImageSmoothingSigmas:  0
m_MeshSmoothingSigmas:  3
Having m_LogDirectorydeformableRegistrationLog/
Having downSamplingFactor of 1
Constructing image-to-world transform from MGH header information (aseg_thresholded.mgz)
Returning the following transform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 224
  Debug: Off
  Observers: 
    none
  Matrix: 
    -1 1.30385e-08 0 
    0 0 1 
    5.96046e-08 -1 0 
  Offset: [127.5, -86.3535, 119.607]
  Center: [0, 0, 0]
  Translation: [127.5, -86.3535, 119.607]
  Inverse: 
    -1 0 5.96046e-08 
    -5.96046e-08 0 -1 
    0 1 0 
  Singular: 0
Constructing image-to-world transform from MGH header information (imageDump_coregistered.mgz)
Returning the following transform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 244
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.384956 -0.00659685 -0.0251382 
    -0.000452849 -0.161151 0.369642 
    -0.00742305 -0.391672 -0.179354 
  Offset: [43.1989, 3.14684, 7.27695]
  Center: [0, 0, 0]
  Translation: [43.1989, 3.14684, 7.27695]
  Inverse: 
    -2.59942 -0.129652 0.0971261 
    0.0422822 -1.03055 -2.12985 
    0.0152496 2.25588 -0.928422 
  Singular: 0
Transform before cropping: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 246
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [84.3013, 112.33, 89.5004]
  Center: [0, 0, 0]
  Translation: [84.3013, 112.33, 89.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
WorldToImageTransform before cropping: 
AffineTransform (0x1741470)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 248
  Debug: Off
  Observers: 
    none
  Matrix: 
    -1 0 5.96046e-08 
    -5.96046e-08 0 -1 
    0 1 0 
  Offset: [127.5, 119.607, 86.3535]
  Center: [0, 0, 0]
  Translation: [127.5, 119.607, 86.3535]
  Inverse: 
    -1 -5.96046e-08 0 
    0 0 1 
    5.96046e-08 -1 0 
  Singular: 0
 m_BoundingBoxSize: [94, 66,144]
 minimalMappedCoordinate: [84.3013, 112.33,78.9834]
 maximalMappedCoordinate: [124.126, 164.127,142.359]
Cropping with min [80  107  72]
          and max [129  170  149]
m_OriginalImageRegion before checking margins: ImageRegion (0x17411a0)
  Dimension: 3
  Index: [80, 107, 72]
  Size: [50, 64, 78]

m_CroppedImageRegion before checking margins: ImageRegion (0x1741168)
  Dimension: 3
  Index: [0, 0, 0]
  Size: [50, 64, 78]


m_OriginalImageRegion after checking margins: ImageRegion (0x17411a0)
  Dimension: 3
  Index: [80, 107, 72]
  Size: [50, 64, 78]

m_CroppedImageRegion after checking margins: ImageRegion (0x1741168)
  Dimension: 3
  Index: [0, 0, 0]
  Size: [50, 64, 78]

Transform after cropping: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
WorldToImageTransform after cropping: 
AffineTransform (0x1741470)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 390
  Debug: Off
  Observers: 
    none
  Matrix: 
    -1 0 5.96046e-08 
    -5.96046e-08 0 -1 
    0 1 0 
  Offset: [47.5002, 12.6074, 14.3535]
  Center: [0, 0, 0]
  Translation: [47.5002, 12.6074, 14.3535]
  Inverse: 
    -1 -5.96046e-08 0 
    0 0 1 
    5.96046e-08 -1 0 
  Singular: 0
Setting K of mesh collection to: 0.01
Applying transform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
Transforming points
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 1
maximum: 255
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
Original class 2 is distributed over 1 classes
Original class 3 is distributed over 1 classes
Original class 4 is distributed over 1 classes
Original class 5 is distributed over 1 classes
Original class 6 is distributed over 1 classes
Original class 7 is distributed over 1 classes
Original class 8 is distributed over 1 classes
Original class 9 is distributed over 1 classes
Original class 10 is distributed over 1 classes
OK
Setting coregisterToPosteriorProbabilities to 0
Setting biasFieldOrder to 0
Building labels...
...done! (m_Labels.size(): 11)
m_InternalToExternalLookupTable: 
    0  -> 2 (CSF)
    1  -> 0 (Right-Cerebral-White-Matter)
    2  -> 1 (Right-Cerebral-Cortex)
    3  -> 3 (Right-Hippocampus)
    4  -> 5 (right_CA2_3)
    5  -> 9 (right_CA1)
    6  -> 4 (right_fimbria)
    7  -> 7 (right_presubiculum)
    8  -> 10 (right_hippocampal_fissure)
    9  -> 6 (right_CA4_DG)
    10  -> 8 (right_subiculum)
m_InternalToReducedLookupTable: 
     0 (CSF) -> 1
     1 (Right-Cerebral-White-Matter) -> 1
     2 (Right-Cerebral-Cortex) -> 1
     3 (Right-Hippocampus) -> 0
     4 (right_CA2_3) -> 0
     5 (right_CA1) -> 0
     6 (right_fimbria) -> 0
     7 (right_presubiculum) -> 0
     8 (right_hippocampal_fissure) -> 0
     9 (right_CA4_DG) -> 0
     10 (right_subiculum) -> 0
original label 0 is distributed over 1 distributed labels
original label 1 is distributed over 1 distributed labels
original label 2 is distributed over 1 distributed labels
original label 3 is distributed over 1 distributed labels
original label 4 is distributed over 1 distributed labels
original label 5 is distributed over 1 distributed labels
original label 6 is distributed over 1 distributed labels
original label 7 is distributed over 1 distributed labels
original label 8 is distributed over 1 distributed labels
original label 9 is distributed over 1 distributed labels
original label 10 is distributed over 1 distributed labels
numberOfReducedLabels: 2
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
OK
Smoothing mesh collection...done!
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 1
maximum: 255
Running for smoothing sigma 3
Starting EM: 
Updating mixture model parameters
Readjusting weight of shared classes
m_Means: [  110.422 13.3448 ]
Splitting shared classes
EM Iteration: 0  ->  298966
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
Setting up m_BiasFieldResidueSmoother
Initalizing
numberOfBasisFunctions: 1
numberOfVoxelsInMask: 249600
indexWhereUnityIsReached [49, 63, 77]
Successfully put up x, y, and z
Constructing basis functions
      (xOrder, yOrder, zOrder): (0, 0, 0)
done!
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  208.155 1.01186 ]
EM Iteration: 1  ->  112139
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  254.61 1 ]
EM Iteration: 2  ->  71514.4
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 3  ->  60589.4
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 4  ->  60589.4
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 4
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 0 was 60589.4
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x57b6a80)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 1318287
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50324
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209134
...done!
maximalDeformation: 4.34801
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 196364 has managed to turn bad (detJ: -0.0823764)
Time taken to rasterize Levenberg-Marquardt: 0.00753999
...done!
=======================
Bad trial move (maximal deformation: 4.34801, lambda: 1)
        Cost going from 60585.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.174039
...done!
maximalDeformation: 2.85682
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 306924 has managed to turn bad (detJ: -0.969924)
Time taken to rasterize Levenberg-Marquardt: 0.013859
...done!
=======================
Bad trial move (maximal deformation: 2.85682, lambda: 2)
        Cost going from 60585.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.171036
...done!
maximalDeformation: 1.71345
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 306924 has managed to turn bad (detJ: -0.189088)
Time taken to rasterize Levenberg-Marquardt: 0.0138841
...done!
=======================
Bad trial move (maximal deformation: 1.71345, lambda: 4)
        Cost going from 60585.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.172655
...done!
maximalDeformation: 0.955338
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 705679 has managed to turn bad (detJ: -0.0850922)
Time taken to rasterize Levenberg-Marquardt: 0.0728579
...done!
=======================
Bad trial move (maximal deformation: 0.955338, lambda: 8)
        Cost going from 60585.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.169585
...done!
maximalDeformation: 0.507931
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.39716
...done!
=======================
Good trial move (maximal deformation: 0.507931, lambda: 16)
        Cost going from 60585.9 to 60384.2
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.181754
...done!
maximalDeformation: 0.500647
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.516
...done!
=======================
Good trial move (maximal deformation: 0.500647, lambda: 14.5455)
        Cost going from 60384.2 to 60290.6
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.189185
...done!
maximalDeformation: 0.272922
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.44927
...done!
=======================
Good trial move (maximal deformation: 0.272922, lambda: 13.2231)
        Cost going from 60290.6 to 60204.5
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196369
...done!
maximalDeformation: 0.25818
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57404
...done!
=======================
Good trial move (maximal deformation: 0.25818, lambda: 12.021)
        Cost going from 60204.5 to 60127.8
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19311
...done!
maximalDeformation: 0.281759
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47687
...done!
=======================
Good trial move (maximal deformation: 0.281759, lambda: 10.9282)
        Cost going from 60127.8 to 60054.1
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211617
...done!
maximalDeformation: 0.317119
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61559
...done!
=======================
Good trial move (maximal deformation: 0.317119, lambda: 9.93474)
        Cost going from 60054.1 to 59983.2
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211929
...done!
maximalDeformation: 0.357895
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51786
...done!
=======================
Good trial move (maximal deformation: 0.357895, lambda: 9.03158)
        Cost going from 59983.2 to 59915.8
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229152
...done!
maximalDeformation: 0.680964
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6463
...done!
=======================
Good trial move (maximal deformation: 0.680964, lambda: 8.21053)
        Cost going from 59915.8 to 59850.1
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.227481
...done!
maximalDeformation: 1.07173
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5569
...done!
=======================
Good trial move (maximal deformation: 1.07173, lambda: 7.46412)
        Cost going from 59850.1 to 59790.7
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246982
...done!
maximalDeformation: 0.366235
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64803
...done!
=======================
Good trial move (maximal deformation: 0.366235, lambda: 6.78556)
        Cost going from 59790.7 to 59731.3
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242286
...done!
maximalDeformation: 0.622865
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5962
...done!
=======================
Good trial move (maximal deformation: 0.622865, lambda: 6.16869)
        Cost going from 59731.3 to 59676.6
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  59437.5
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  59437.5
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 1 was 59680
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xbae3a20)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 3868880
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50598
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201927
...done!
maximalDeformation: 5.07368
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 374944 has managed to turn bad (detJ: -0.00984694)
Time taken to rasterize Levenberg-Marquardt: 0.0230501
...done!
=======================
Bad trial move (maximal deformation: 5.07368, lambda: 1)
        Cost going from 59676.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196452
...done!
maximalDeformation: 2.90254
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1080885 has managed to turn bad (detJ: -0.327168)
Time taken to rasterize Levenberg-Marquardt: 0.184743
...done!
=======================
Bad trial move (maximal deformation: 2.90254, lambda: 2)
        Cost going from 59676.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192252
...done!
maximalDeformation: 1.61642
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1672156 has managed to turn bad (detJ: -0.00159357)
Time taken to rasterize Levenberg-Marquardt: 0.452532
...done!
=======================
Bad trial move (maximal deformation: 1.61642, lambda: 4)
        Cost going from 59676.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189422
...done!
maximalDeformation: 0.871429
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50581
...done!
=======================
Good trial move (maximal deformation: 0.871429, lambda: 8)
        Cost going from 59676.6 to 59634.9
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213367
...done!
maximalDeformation: 0.395437
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54567
...done!
=======================
Good trial move (maximal deformation: 0.395437, lambda: 7.27273)
        Cost going from 59634.9 to 59596.4
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192323
...done!
maximalDeformation: 0.710424
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50392
...done!
=======================
Good trial move (maximal deformation: 0.710424, lambda: 6.61157)
        Cost going from 59596.4 to 59562.4
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206482
...done!
maximalDeformation: 1.27199
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52593
...done!
=======================
Good trial move (maximal deformation: 1.27199, lambda: 6.01052)
        Cost going from 59562.4 to 59530.6
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206022
...done!
maximalDeformation: 1.75499
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1753383 has managed to turn bad (detJ: -0.0972257)
Time taken to rasterize Levenberg-Marquardt: 0.519039
...done!
=======================
Bad trial move (maximal deformation: 1.75499, lambda: 5.46411)
        Cost going from 59530.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 5.46411 to 10.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.201683
...done!
maximalDeformation: 0.990135
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52711
...done!
=======================
Good trial move (maximal deformation: 0.990135, lambda: 10.9282)
        Cost going from 59530.6 to 59503.9
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225217
...done!
maximalDeformation: 1.04225
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56613
...done!
=======================
Good trial move (maximal deformation: 1.04225, lambda: 9.93474)
        Cost going from 59503.9 to 59483.5
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218262
...done!
maximalDeformation: 0.389826
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5678
...done!
=======================
Good trial move (maximal deformation: 0.389826, lambda: 9.03158)
        Cost going from 59483.5 to 59464.5
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237397
...done!
maximalDeformation: 0.39707
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59603
...done!
=======================
Good trial move (maximal deformation: 0.39707, lambda: 8.21053)
        Cost going from 59464.5 to 59445.2
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232644
...done!
maximalDeformation: 0.634742
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59294
...done!
=======================
Good trial move (maximal deformation: 0.634742, lambda: 7.46412)
        Cost going from 59445.2 to 59428.5
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.253881
...done!
maximalDeformation: 1.20619
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60686
...done!
=======================
Good trial move (maximal deformation: 1.20619, lambda: 6.78556)
        Cost going from 59428.5 to 59411.7
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247034
...done!
maximalDeformation: 0.599549
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62437
...done!
=======================
Good trial move (maximal deformation: 0.599549, lambda: 6.16869)
        Cost going from 59411.7 to 59392.7
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  58961.6
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58961.6
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 2 was 59396.1
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa9a5420)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 6419473
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56667
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212124
...done!
maximalDeformation: 1.92256
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 284292 has managed to turn bad (detJ: -0.0410675)
Time taken to rasterize Levenberg-Marquardt: 0.0132232
...done!
=======================
Bad trial move (maximal deformation: 1.92256, lambda: 1)
        Cost going from 59392.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.220407
...done!
maximalDeformation: 1.17667
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 376796 has managed to turn bad (detJ: -0.0907852)
Time taken to rasterize Levenberg-Marquardt: 0.023309
...done!
=======================
Bad trial move (maximal deformation: 1.17667, lambda: 2)
        Cost going from 59392.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.228414
...done!
maximalDeformation: 0.679073
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 761148 has managed to turn bad (detJ: -0.105986)
Time taken to rasterize Levenberg-Marquardt: 0.0954852
...done!
=======================
Bad trial move (maximal deformation: 0.679073, lambda: 4)
        Cost going from 59392.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.226346
...done!
maximalDeformation: 0.373501
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54776
...done!
=======================
Good trial move (maximal deformation: 0.373501, lambda: 8)
        Cost going from 59392.7 to 59372.2
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221278
...done!
maximalDeformation: 0.823039
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54918
...done!
=======================
Good trial move (maximal deformation: 0.823039, lambda: 7.27273)
        Cost going from 59372.2 to 59359.3
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233147
...done!
maximalDeformation: 0.933282
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2178021 has managed to turn bad (detJ: -0.0955263)
Time taken to rasterize Levenberg-Marquardt: 0.865723
...done!
=======================
Bad trial move (maximal deformation: 0.933282, lambda: 6.61157)
        Cost going from 59359.3 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.61157 to 13.2231 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Time taken to solve the Levenberg-Marquardt system of equations: 0.243769
...done!
maximalDeformation: 0.526697
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5848
...done!
=======================
Good trial move (maximal deformation: 0.526697, lambda: 13.2231)
        Cost going from 59359.3 to 59344.7
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233886
...done!
maximalDeformation: 0.406568
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57528
...done!
=======================
Good trial move (maximal deformation: 0.406568, lambda: 12.021)
        Cost going from 59344.7 to 59335.4
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.252268
...done!
maximalDeformation: 0.408597
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60247
...done!
=======================
Good trial move (maximal deformation: 0.408597, lambda: 10.9282)
        Cost going from 59335.4 to 59327.9
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247874
...done!
maximalDeformation: 0.420838
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59532
...done!
=======================
Good trial move (maximal deformation: 0.420838, lambda: 9.93474)
        Cost going from 59327.9 to 59319.7
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2644
...done!
maximalDeformation: 0.516905
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62482
...done!
=======================
Good trial move (maximal deformation: 0.516905, lambda: 9.03158)
        Cost going from 59319.7 to 59312.6
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.257565
...done!
maximalDeformation: 0.495425
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60703
...done!
=======================
Good trial move (maximal deformation: 0.495425, lambda: 8.21053)
        Cost going from 59312.6 to 59302.8
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.271331
...done!
maximalDeformation: 2.11354
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6399
...done!
=======================
Bad trial move (maximal deformation: 2.11354, lambda: 7.46412)
        Cost going from 59302.8 to 59306.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.46412 to 14.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.27168
...done!
maximalDeformation: 1.12748
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59968
...done!
=======================
Good trial move (maximal deformation: 1.12748, lambda: 14.9282)
        Cost going from 59302.8 to 59293.3
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.26306
...done!
maximalDeformation: 0.324794
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60697
...done!
=======================
Good trial move (maximal deformation: 0.324794, lambda: 13.5711)
        Cost going from 59293.3 to 59286.8
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.277792
...done!
maximalDeformation: 0.558431
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61987
...done!
=======================
Good trial move (maximal deformation: 0.558431, lambda: 12.3374)
        Cost going from 59286.8 to 59281.8
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  58785.6
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58785.6
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 3 was 59285.2
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xb172760)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 9162972
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54313
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202764
...done!
maximalDeformation: 3.42598
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 284292 has managed to turn bad (detJ: -0.144967)
Time taken to rasterize Levenberg-Marquardt: 0.0130141
...done!
=======================
Bad trial move (maximal deformation: 3.42598, lambda: 1)
        Cost going from 59281.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.212693
...done!
maximalDeformation: 2.20091
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 898750 has managed to turn bad (detJ: -0.133562)
Time taken to rasterize Levenberg-Marquardt: 0.129844
...done!
=======================
Bad trial move (maximal deformation: 2.20091, lambda: 2)
        Cost going from 59281.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.2196
...done!
maximalDeformation: 1.29945
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1376076 has managed to turn bad (detJ: -0.0953926)
Time taken to rasterize Levenberg-Marquardt: 0.309158
...done!
=======================
Bad trial move (maximal deformation: 1.29945, lambda: 4)
        Cost going from 59281.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.217981
...done!
maximalDeformation: 0.720454
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53266
...done!
=======================
Good trial move (maximal deformation: 0.720454, lambda: 8)
        Cost going from 59281.8 to 59280.6
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218039
...done!
maximalDeformation: 1.99429
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1753383 has managed to turn bad (detJ: -0.115698)
Time taken to rasterize Levenberg-Marquardt: 0.516747
...done!
=======================
Bad trial move (maximal deformation: 1.99429, lambda: 7.27273)
        Cost going from 59280.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.27273 to 14.5455 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Time taken to solve the Levenberg-Marquardt system of equations: 0.222715
...done!
maximalDeformation: 1.0627
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53857
...done!
=======================
Good trial move (maximal deformation: 1.0627, lambda: 14.5455)
        Cost going from 59280.6 to 59269.9
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225416
...done!
maximalDeformation: 0.54632
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5517
...done!
=======================
Good trial move (maximal deformation: 0.54632, lambda: 13.2231)
        Cost going from 59269.9 to 59263
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229625
...done!
maximalDeformation: 0.482408
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56275
...done!
=======================
Good trial move (maximal deformation: 0.482408, lambda: 12.021)
        Cost going from 59263 to 59258.8
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.227413
...done!
maximalDeformation: 0.377799
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58351
...done!
=======================
Good trial move (maximal deformation: 0.377799, lambda: 10.9282)
        Cost going from 59258.8 to 59252.9
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239908
...done!
maximalDeformation: 0.748284
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58003
...done!
=======================
Good trial move (maximal deformation: 0.748284, lambda: 9.93474)
        Cost going from 59252.9 to 59250.5
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238341
...done!
maximalDeformation: 0.614454
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56895
...done!
=======================
Good trial move (maximal deformation: 0.614454, lambda: 9.03158)
        Cost going from 59250.5 to 59243.5
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.254718
...done!
maximalDeformation: 1.10782
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5887
...done!
=======================
Good trial move (maximal deformation: 1.10782, lambda: 8.21053)
        Cost going from 59243.5 to 59242.5
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247807
...done!
maximalDeformation: 1.12516
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 820404 has managed to turn bad (detJ: -0.0014859)
Time taken to rasterize Levenberg-Marquardt: 0.117072
...done!
=======================
Bad trial move (maximal deformation: 1.12516, lambda: 7.46412)
        Cost going from 59242.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.46412 to 14.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.251219
...done!
maximalDeformation: 0.607381
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57459
...done!
=======================
Good trial move (maximal deformation: 0.607381, lambda: 14.9282)
        Cost going from 59242.5 to 59230.4
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.258272
...done!
maximalDeformation: 0.43943
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59997
...done!
=======================
Good trial move (maximal deformation: 0.43943, lambda: 13.5711)
        Cost going from 59230.4 to 59225.3
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.256922
...done!
maximalDeformation: 0.579908
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59452
...done!
=======================
Good trial move (maximal deformation: 0.579908, lambda: 12.3374)
        Cost going from 59225.3 to 59222.3
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  58673.8
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58673.8
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 4 was 59225.7
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x8da50e0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 11906471
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54183
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.1988
...done!
maximalDeformation: 8.31446
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 135764 has managed to turn bad (detJ: -0.00582595)
Time taken to rasterize Levenberg-Marquardt: 0.00690722
...done!
=======================
Bad trial move (maximal deformation: 8.31446, lambda: 1)
        Cost going from 59222.3 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194797
...done!
maximalDeformation: 5.05725
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 187315 has managed to turn bad (detJ: -0.0122738)
Time taken to rasterize Levenberg-Marquardt: 0.00750279
...done!
=======================
Bad trial move (maximal deformation: 5.05725, lambda: 2)
        Cost going from 59222.3 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189792
...done!
maximalDeformation: 2.924
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 820404 has managed to turn bad (detJ: -0.2383)
Time taken to rasterize Levenberg-Marquardt: 0.102146
...done!
=======================
Bad trial move (maximal deformation: 2.924, lambda: 4)
        Cost going from 59222.3 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189471
...done!
maximalDeformation: 1.60837
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47199
...done!
=======================
Bad trial move (maximal deformation: 1.60837, lambda: 8)
        Cost going from 59222.3 to 59234.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185699
...done!
maximalDeformation: 0.852612
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48051
...done!
=======================
Good trial move (maximal deformation: 0.852612, lambda: 16)
        Cost going from 59222.3 to 59218.1
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20414
...done!
maximalDeformation: 0.360005
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52571
...done!
=======================
Good trial move (maximal deformation: 0.360005, lambda: 14.5455)
        Cost going from 59218.1 to 59215.1
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198515
...done!
maximalDeformation: 0.392276
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51184
...done!
=======================
Good trial move (maximal deformation: 0.392276, lambda: 13.2231)
        Cost going from 59215.1 to 59212.4
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210839
...done!
maximalDeformation: 0.435137
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53544
...done!
=======================
Good trial move (maximal deformation: 0.435137, lambda: 12.021)
        Cost going from 59212.4 to 59209.6
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209709
...done!
maximalDeformation: 1.31749
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54545
...done!
=======================
Good trial move (maximal deformation: 1.31749, lambda: 10.9282)
        Cost going from 59209.6 to 59208.3
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225456
...done!
maximalDeformation: 0.581862
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55394
...done!
=======================
Good trial move (maximal deformation: 0.581862, lambda: 9.93474)
        Cost going from 59208.3 to 59205.7
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225583
...done!
maximalDeformation: 0.746012
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56492
...done!
=======================
Good trial move (maximal deformation: 0.746012, lambda: 9.03158)
        Cost going from 59205.7 to 59204.4
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235513
...done!
maximalDeformation: 0.684844
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58251
...done!
=======================
Good trial move (maximal deformation: 0.684844, lambda: 8.21053)
        Cost going from 59204.4 to 59201.5
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237048
...done!
maximalDeformation: 0.686996
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2405446 has managed to turn bad (detJ: -0.06218)
Time taken to rasterize Levenberg-Marquardt: 1.10489
...done!
=======================
Bad trial move (maximal deformation: 0.686996, lambda: 7.46412)
        Cost going from 59201.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.46412 to 14.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.23936
...done!
maximalDeformation: 0.367818
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56177
...done!
=======================
Good trial move (maximal deformation: 0.367818, lambda: 14.9282)
        Cost going from 59201.5 to 59190.2
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246012
...done!
maximalDeformation: 0.61876
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58216
...done!
=======================
Good trial move (maximal deformation: 0.61876, lambda: 13.5711)
        Cost going from 59190.2 to 59186.5
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246018
...done!
maximalDeformation: 0.663608
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59303
...done!
=======================
Good trial move (maximal deformation: 0.663608, lambda: 12.3374)
        Cost going from 59186.5 to 59185.6
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  58599.7
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58599.7
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 5 was 59188.9
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x900acf0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 14649970
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53103
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198781
...done!
maximalDeformation: 6.0847
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 187315 has managed to turn bad (detJ: -0.424058)
Time taken to rasterize Levenberg-Marquardt: 0.00832987
...done!
=======================
Bad trial move (maximal deformation: 6.0847, lambda: 1)
        Cost going from 59185.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194255
...done!
maximalDeformation: 3.60063
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 187315 has managed to turn bad (detJ: -0.0311834)
Time taken to rasterize Levenberg-Marquardt: 0.00763297
...done!
=======================
Bad trial move (maximal deformation: 3.60063, lambda: 2)
        Cost going from 59185.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188126
...done!
maximalDeformation: 2.05469
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1816922 has managed to turn bad (detJ: -0.00128746)
Time taken to rasterize Levenberg-Marquardt: 0.538148
...done!
=======================
Bad trial move (maximal deformation: 2.05469, lambda: 4)
        Cost going from 59185.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185678
...done!
maximalDeformation: 1.12429
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47803
...done!
=======================
Bad trial move (maximal deformation: 1.12429, lambda: 8)
        Cost going from 59185.6 to 59189.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183879
...done!
maximalDeformation: 0.595603
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.4835
...done!
=======================
Good trial move (maximal deformation: 0.595603, lambda: 16)
        Cost going from 59185.6 to 59180.4
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201189
...done!
maximalDeformation: 0.366515
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52923
...done!
=======================
Good trial move (maximal deformation: 0.366515, lambda: 14.5455)
        Cost going from 59180.4 to 59178.4
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197493
...done!
maximalDeformation: 0.507509
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50955
...done!
=======================
Good trial move (maximal deformation: 0.507509, lambda: 13.2231)
        Cost going from 59178.4 to 59177.5
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209188
...done!
maximalDeformation: 0.776691
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53439
...done!
=======================
Good trial move (maximal deformation: 0.776691, lambda: 12.021)
        Cost going from 59177.5 to 59176.3
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211321
...done!
maximalDeformation: 0.709775
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53282
...done!
=======================
Good trial move (maximal deformation: 0.709775, lambda: 10.9282)
        Cost going from 59176.3 to 59174.9
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22368
...done!
maximalDeformation: 0.570233
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2255013 has managed to turn bad (detJ: -0.152793)
Time taken to rasterize Levenberg-Marquardt: 0.921716
...done!
=======================
Bad trial move (maximal deformation: 0.570233, lambda: 9.93474)
        Cost going from 59174.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 9.93474 to 19.8695 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Time taken to solve the Levenberg-Marquardt system of equations: 0.225682
...done!
maximalDeformation: 0.302424
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55327
...done!
=======================
Good trial move (maximal deformation: 0.302424, lambda: 19.8695)
        Cost going from 59174.9 to 59168.7
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223717
...done!
maximalDeformation: 0.353517
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58393
...done!
=======================
Good trial move (maximal deformation: 0.353517, lambda: 18.0632)
        Cost going from 59168.7 to 59166.1
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234258
...done!
maximalDeformation: 0.519674
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57884
...done!
=======================
Good trial move (maximal deformation: 0.519674, lambda: 16.4211)
        Cost going from 59166.1 to 59165.1
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.227484
...done!
maximalDeformation: 1.28525
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58966
...done!
=======================
Good trial move (maximal deformation: 1.28525, lambda: 14.9282)
        Cost going from 59165.1 to 59164.9
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243334
...done!
maximalDeformation: 0.851575
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58996
...done!
=======================
Good trial move (maximal deformation: 0.851575, lambda: 13.5711)
        Cost going from 59164.9 to 59164.8
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23729
...done!
maximalDeformation: 0.507722
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5848
...done!
=======================
Good trial move (maximal deformation: 0.507722, lambda: 12.3374)
        Cost going from 59164.8 to 59162
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  58554.2
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58554.2
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 6 was 59165.3
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xca45bf0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 17393469
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53355
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198501
...done!
maximalDeformation: 4.19577
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 135764 has managed to turn bad (detJ: -0.125866)
Time taken to rasterize Levenberg-Marquardt: 0.00733805
...done!
=======================
Bad trial move (maximal deformation: 4.19577, lambda: 1)
        Cost going from 59162 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192255
...done!
maximalDeformation: 2.65419
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 528521 has managed to turn bad (detJ: -0.145398)
Time taken to rasterize Levenberg-Marquardt: 0.040827
...done!
=======================
Bad trial move (maximal deformation: 2.65419, lambda: 2)
        Cost going from 59162 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187458
...done!
maximalDeformation: 1.56495
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1000534 has managed to turn bad (detJ: -0.132838)
Time taken to rasterize Levenberg-Marquardt: 0.154316
...done!
=======================
Bad trial move (maximal deformation: 1.56495, lambda: 4)
        Cost going from 59162 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186549
...done!
maximalDeformation: 0.869263
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47498
...done!
=======================
Bad trial move (maximal deformation: 0.869263, lambda: 8)
        Cost going from 59162 to 59167.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18378
...done!
maximalDeformation: 0.463084
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48177
...done!
=======================
Good trial move (maximal deformation: 0.463084, lambda: 16)
        Cost going from 59162 to 59157.6
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202558
...done!
maximalDeformation: 0.481843
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53484
...done!
=======================
Good trial move (maximal deformation: 0.481843, lambda: 14.5455)
        Cost going from 59157.6 to 59156.5
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197807
...done!
maximalDeformation: 0.420394
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51403
...done!
=======================
Good trial move (maximal deformation: 0.420394, lambda: 13.2231)
        Cost going from 59156.5 to 59156.1
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210177
...done!
maximalDeformation: 0.773519
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54507
...done!
=======================
Good trial move (maximal deformation: 0.773519, lambda: 12.021)
        Cost going from 59156.1 to 59154.7
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209079
...done!
maximalDeformation: 0.588616
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54375
...done!
=======================
Bad trial move (maximal deformation: 0.588616, lambda: 10.9282)
        Cost going from 59154.7 to 59155.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 10.9282 to 21.8564 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Time taken to solve the Levenberg-Marquardt system of equations: 0.214314
...done!
maximalDeformation: 0.307828
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53779
...done!
=======================
Good trial move (maximal deformation: 0.307828, lambda: 21.8564)
        Cost going from 59154.7 to 59149.7
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223405
...done!
maximalDeformation: 0.670624
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55914
...done!
=======================
Good trial move (maximal deformation: 0.670624, lambda: 19.8695)
        Cost going from 59149.7 to 59148.1
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22449
...done!
maximalDeformation: 0.473807
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56973
...done!
=======================
Good trial move (maximal deformation: 0.473807, lambda: 18.0632)
        Cost going from 59148.1 to 59147.4
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235112
...done!
maximalDeformation: 0.479844
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58476
...done!
=======================
Good trial move (maximal deformation: 0.479844, lambda: 16.4211)
        Cost going from 59147.4 to 59146.1
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236801
...done!
maximalDeformation: 0.453331
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58774
...done!
=======================
Good trial move (maximal deformation: 0.453331, lambda: 14.9282)
        Cost going from 59146.1 to 59145.9
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245734
...done!
maximalDeformation: 0.796156
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58861
...done!
=======================
Good trial move (maximal deformation: 0.796156, lambda: 13.5711)
        Cost going from 59145.9 to 59145.4
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247151
...done!
maximalDeformation: 0.660199
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63823
...done!
=======================
Good trial move (maximal deformation: 0.660199, lambda: 12.3374)
        Cost going from 59145.4 to 59144.7
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  58519.5
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58519.5
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 7 was 59148.1
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa7c3220)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 20136968
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53134
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197909
...done!
maximalDeformation: 3.46351
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 187315 has managed to turn bad (detJ: -0.281773)
Time taken to rasterize Levenberg-Marquardt: 0.00823879
...done!
=======================
Bad trial move (maximal deformation: 3.46351, lambda: 1)
        Cost going from 59144.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192437
...done!
maximalDeformation: 2.14909
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 697719 has managed to turn bad (detJ: -0.320591)
Time taken to rasterize Levenberg-Marquardt: 0.0742409
...done!
=======================
Bad trial move (maximal deformation: 2.14909, lambda: 2)
        Cost going from 59144.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186806
...done!
maximalDeformation: 1.27319
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 858971 has managed to turn bad (detJ: -0.00654225)
Time taken to rasterize Levenberg-Marquardt: 0.112265
...done!
=======================
Bad trial move (maximal deformation: 1.27319, lambda: 4)
        Cost going from 59144.7 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184676
...done!
maximalDeformation: 0.718146
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47314
...done!
=======================
Bad trial move (maximal deformation: 0.718146, lambda: 8)
        Cost going from 59144.7 to 59153.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183112
...done!
maximalDeformation: 0.406917
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47944
...done!
=======================
Good trial move (maximal deformation: 0.406917, lambda: 16)
        Cost going from 59144.7 to 59140.5
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200626
...done!
maximalDeformation: 0.44422
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52832
...done!
=======================
Good trial move (maximal deformation: 0.44422, lambda: 14.5455)
        Cost going from 59140.5 to 59139.7
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196412
...done!
maximalDeformation: 0.595079
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51123
...done!
=======================
Good trial move (maximal deformation: 0.595079, lambda: 13.2231)
        Cost going from 59139.7 to 59139
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208521
...done!
maximalDeformation: 1.09009
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53979
...done!
=======================
Bad trial move (maximal deformation: 1.09009, lambda: 12.021)
        Cost going from 59139 to 59139.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 12.021 to 24.0421 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Time taken to solve the Levenberg-Marquardt system of equations: 0.209903
...done!
maximalDeformation: 0.568156
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53581
...done!
=======================
Good trial move (maximal deformation: 0.568156, lambda: 24.0421)
        Cost going from 59139 to 59134.9
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209031
...done!
maximalDeformation: 0.469806
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51996
...done!
=======================
Good trial move (maximal deformation: 0.469806, lambda: 21.8564)
        Cost going from 59134.9 to 59133.7
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218656
...done!
maximalDeformation: 0.340348
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54732
...done!
=======================
Good trial move (maximal deformation: 0.340348, lambda: 19.8695)
        Cost going from 59133.7 to 59132.8
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207592
...done!
maximalDeformation: 0.44089
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52937
...done!
=======================
Good trial move (maximal deformation: 0.44089, lambda: 18.0632)
        Cost going from 59132.8 to 59131.9
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.227735
...done!
maximalDeformation: 0.787542
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57209
...done!
=======================
Bad trial move (maximal deformation: 0.787542, lambda: 16.4211)
        Cost going from 59131.9 to 59133
Transforming mesh
Done transforming mesh
        Increasing lambda from 16.4211 to 32.8421 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Time taken to solve the Levenberg-Marquardt system of equations: 0.228998
...done!
maximalDeformation: 0.407149
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56793
...done!
=======================
Good trial move (maximal deformation: 0.407149, lambda: 32.8421)
        Cost going from 59131.9 to 59130
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217692
...done!
maximalDeformation: 0.261582
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55269
...done!
=======================
Good trial move (maximal deformation: 0.261582, lambda: 29.8565)
        Cost going from 59130 to 59129.2
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236893
...done!
maximalDeformation: 0.282697
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58284
...done!
=======================
Good trial move (maximal deformation: 0.282697, lambda: 27.1422)
        Cost going from 59129.2 to 59128.8
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229435
...done!
maximalDeformation: 0.276283
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57425
...done!
=======================
Good trial move (maximal deformation: 0.276283, lambda: 24.6748)
        Cost going from 59128.8 to 59128.2
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  58498.2
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58498.2
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 8 was 59131.5
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x5e8f870)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 23073373
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5832
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195146
...done!
maximalDeformation: 8.08105
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 135764 has managed to turn bad (detJ: -0.086655)
Time taken to rasterize Levenberg-Marquardt: 0.00711012
...done!
=======================
Bad trial move (maximal deformation: 8.08105, lambda: 1)
        Cost going from 59128.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190102
...done!
maximalDeformation: 4.8967
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 158952 has managed to turn bad (detJ: -0.118675)
Time taken to rasterize Levenberg-Marquardt: 0.00701904
...done!
=======================
Bad trial move (maximal deformation: 4.8967, lambda: 2)
        Cost going from 59128.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187201
...done!
maximalDeformation: 2.81666
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 840043 has managed to turn bad (detJ: -0.0360331)
Time taken to rasterize Levenberg-Marquardt: 0.108118
...done!
=======================
Bad trial move (maximal deformation: 2.81666, lambda: 4)
        Cost going from 59128.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18436
...done!
maximalDeformation: 1.54714
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47993
...done!
=======================
Bad trial move (maximal deformation: 1.54714, lambda: 8)
        Cost going from 59128.2 to 59149.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181792
...done!
maximalDeformation: 0.820359
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47446
...done!
=======================
Bad trial move (maximal deformation: 0.820359, lambda: 16)
        Cost going from 59128.2 to 59130.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180719
...done!
maximalDeformation: 0.424188
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47432
...done!
=======================
Good trial move (maximal deformation: 0.424188, lambda: 32)
        Cost going from 59128.2 to 59127.2
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199515
...done!
maximalDeformation: 0.373354
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5215
...done!
=======================
Good trial move (maximal deformation: 0.373354, lambda: 29.0909)
        Cost going from 59127.2 to 59126.7
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193854
...done!
maximalDeformation: 0.286629
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5115
...done!
=======================
Good trial move (maximal deformation: 0.286629, lambda: 26.4463)
        Cost going from 59126.7 to 59126.5
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209875
...done!
maximalDeformation: 0.299834
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54144
...done!
=======================
Good trial move (maximal deformation: 0.299834, lambda: 24.0421)
        Cost going from 59126.5 to 59125.8
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209223
...done!
maximalDeformation: 0.541195
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53995
...done!
=======================
Good trial move (maximal deformation: 0.541195, lambda: 21.8564)
        Cost going from 59125.8 to 59125.6
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225289
...done!
maximalDeformation: 0.409118
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57034
...done!
=======================
Good trial move (maximal deformation: 0.409118, lambda: 19.8695)
        Cost going from 59125.6 to 59125.3
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223691
...done!
maximalDeformation: 0.460785
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56374
...done!
=======================
Good trial move (maximal deformation: 0.460785, lambda: 18.0632)
        Cost going from 59125.3 to 59124.7
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236957
...done!
maximalDeformation: 0.514285
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58695
...done!
=======================
Good trial move (maximal deformation: 0.514285, lambda: 16.4211)
        Cost going from 59124.7 to 59124.2
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235151
...done!
maximalDeformation: 0.83092
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57858
...done!
=======================
Bad trial move (maximal deformation: 0.83092, lambda: 14.9282)
        Cost going from 59124.2 to 59125
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.9282 to 29.8565 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Time taken to solve the Levenberg-Marquardt system of equations: 0.238337
...done!
maximalDeformation: 0.431119
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55746
...done!
=======================
Good trial move (maximal deformation: 0.431119, lambda: 29.8565)
        Cost going from 59124.2 to 59121.5
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245178
...done!
maximalDeformation: 0.470566
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59145
...done!
=======================
Good trial move (maximal deformation: 0.470566, lambda: 27.1422)
        Cost going from 59121.5 to 59120.6
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244841
...done!
maximalDeformation: 0.33616
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59243
...done!
=======================
Good trial move (maximal deformation: 0.33616, lambda: 24.6748)
        Cost going from 59120.6 to 59120.5
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  58482.3
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58482.3
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 9 was 59123.9
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x99aacf0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 26009778
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54546
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199114
...done!
maximalDeformation: 3.93536
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 187315 has managed to turn bad (detJ: -0.392166)
Time taken to rasterize Levenberg-Marquardt: 0.00833797
...done!
=======================
Bad trial move (maximal deformation: 3.93536, lambda: 1)
        Cost going from 59120.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194929
...done!
maximalDeformation: 2.53324
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 187315 has managed to turn bad (detJ: -0.0523929)
Time taken to rasterize Levenberg-Marquardt: 0.00763011
...done!
=======================
Bad trial move (maximal deformation: 2.53324, lambda: 2)
        Cost going from 59120.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190847
...done!
maximalDeformation: 1.52127
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.243296)
Time taken to rasterize Levenberg-Marquardt: 0.035578
...done!
=======================
Bad trial move (maximal deformation: 1.52127, lambda: 4)
        Cost going from 59120.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191638
...done!
maximalDeformation: 0.860259
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2255013 has managed to turn bad (detJ: -0.0482954)
Time taken to rasterize Levenberg-Marquardt: 0.881935
...done!
=======================
Bad trial move (maximal deformation: 0.860259, lambda: 8)
        Cost going from 59120.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188024
...done!
maximalDeformation: 0.463577
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49195
...done!
=======================
Bad trial move (maximal deformation: 0.463577, lambda: 16)
        Cost going from 59120.5 to 59121.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185845
...done!
maximalDeformation: 0.241779
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49064
...done!
=======================
Good trial move (maximal deformation: 0.241779, lambda: 32)
        Cost going from 59120.5 to 59119.1
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201985
...done!
maximalDeformation: 0.334088
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53343
...done!
=======================
Good trial move (maximal deformation: 0.334088, lambda: 29.0909)
        Cost going from 59119.1 to 59118.6
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19838
...done!
maximalDeformation: 0.257123
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52008
...done!
=======================
Good trial move (maximal deformation: 0.257123, lambda: 26.4463)
        Cost going from 59118.6 to 59118.3
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211486
...done!
maximalDeformation: 0.47376
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54975
...done!
=======================
Bad trial move (maximal deformation: 0.47376, lambda: 24.0421)
        Cost going from 59118.3 to 59118.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 24.0421 to 48.0841 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Time taken to solve the Levenberg-Marquardt system of equations: 0.213502
...done!
maximalDeformation: 0.248708
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54462
...done!
=======================
Good trial move (maximal deformation: 0.248708, lambda: 48.0841)
        Cost going from 59118.3 to 59117.1
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211101
...done!
maximalDeformation: 0.227402
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54807
...done!
=======================
Good trial move (maximal deformation: 0.227402, lambda: 43.7129)
        Cost going from 59117.1 to 59116.6
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223998
...done!
maximalDeformation: 0.401792
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56971
...done!
=======================
Bad trial move (maximal deformation: 0.401792, lambda: 39.739)
        Cost going from 59116.6 to 59116.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 39.739 to 79.4779 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Time taken to solve the Levenberg-Marquardt system of equations: 0.228442
...done!
maximalDeformation: 0.205771
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57088
...done!
=======================
Good trial move (maximal deformation: 0.205771, lambda: 79.4779)
        Cost going from 59116.6 to 59116.2
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.216001
...done!
maximalDeformation: 0.14248
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55045
...done!
=======================
Good trial move (maximal deformation: 0.14248, lambda: 72.2527)
        Cost going from 59116.2 to 59116
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23434
...done!
maximalDeformation: 0.160516
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59308
...done!
=======================
Good trial move (maximal deformation: 0.160516, lambda: 65.6842)
        Cost going from 59116 to 59115.7
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226937
...done!
maximalDeformation: 0.198802
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57656
...done!
=======================
Good trial move (maximal deformation: 0.198802, lambda: 59.7129)
        Cost going from 59115.7 to 59115.6
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245838
...done!
maximalDeformation: 0.1638
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60735
...done!
=======================
Good trial move (maximal deformation: 0.1638, lambda: 54.2845)
        Cost going from 59115.6 to 59115.3
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23908
...done!
maximalDeformation: 0.200233
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59605
...done!
=======================
Good trial move (maximal deformation: 0.200233, lambda: 49.3495)
        Cost going from 59115.3 to 59115
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  58474.9
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58474.9
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 10 was 59118.3
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x9bbb8b0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 29139089
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56285
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198552
...done!
maximalDeformation: 5.50968
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.335801)
Time taken to rasterize Levenberg-Marquardt: 0.00583601
...done!
=======================
Bad trial move (maximal deformation: 5.50968, lambda: 1)
        Cost going from 59115 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195541
...done!
maximalDeformation: 3.71496
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 464981 has managed to turn bad (detJ: -0.0644681)
Time taken to rasterize Levenberg-Marquardt: 0.0322061
...done!
=======================
Bad trial move (maximal deformation: 3.71496, lambda: 2)
        Cost going from 59115 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190411
...done!
maximalDeformation: 2.3442
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 773394 has managed to turn bad (detJ: -0.0625676)
Time taken to rasterize Levenberg-Marquardt: 0.0924358
...done!
=======================
Bad trial move (maximal deformation: 2.3442, lambda: 4)
        Cost going from 59115 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187061
...done!
maximalDeformation: 1.37676
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1644656 has managed to turn bad (detJ: -0.0182332)
Time taken to rasterize Levenberg-Marquardt: 0.433504
...done!
=======================
Bad trial move (maximal deformation: 1.37676, lambda: 8)
        Cost going from 59115 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188123
...done!
maximalDeformation: 0.758481
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48707
...done!
=======================
Bad trial move (maximal deformation: 0.758481, lambda: 16)
        Cost going from 59115 to 59119.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185179
...done!
maximalDeformation: 0.401547
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48584
...done!
=======================
Bad trial move (maximal deformation: 0.401547, lambda: 32)
        Cost going from 59115 to 59115.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185043
...done!
maximalDeformation: 0.206811
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48878
...done!
=======================
Good trial move (maximal deformation: 0.206811, lambda: 64)
        Cost going from 59115 to 59114.6
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202892
...done!
maximalDeformation: 0.196827
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53698
...done!
=======================
Good trial move (maximal deformation: 0.196827, lambda: 58.1818)
        Cost going from 59114.6 to 59114.4
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197691
...done!
maximalDeformation: 0.233466
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52348
...done!
=======================
Good trial move (maximal deformation: 0.233466, lambda: 52.8926)
        Cost going from 59114.4 to 59114.3
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210218
...done!
maximalDeformation: 0.176963
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55033
...done!
=======================
Good trial move (maximal deformation: 0.176963, lambda: 48.0841)
        Cost going from 59114.3 to 59113.8
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209553
...done!
maximalDeformation: 0.222888
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54808
...done!
=======================
Good trial move (maximal deformation: 0.222888, lambda: 43.7129)
        Cost going from 59113.8 to 59113.8
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222751
...done!
maximalDeformation: 0.266263
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56655
...done!
=======================
Good trial move (maximal deformation: 0.266263, lambda: 39.739)
        Cost going from 59113.8 to 59113.4
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223451
...done!
maximalDeformation: 0.224931
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57228
...done!
=======================
Good trial move (maximal deformation: 0.224931, lambda: 36.1263)
        Cost going from 59113.4 to 59113.1
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235231
...done!
maximalDeformation: 0.299355
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58666
...done!
=======================
Good trial move (maximal deformation: 0.299355, lambda: 32.8421)
        Cost going from 59113.1 to 59112.9
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234589
...done!
maximalDeformation: 0.378973
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59175
...done!
=======================
Good trial move (maximal deformation: 0.378973, lambda: 29.8565)
        Cost going from 59112.9 to 59112.8
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245326
...done!
maximalDeformation: 0.701483
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59967
...done!
=======================
Good trial move (maximal deformation: 0.701483, lambda: 27.1422)
        Cost going from 59112.8 to 59112.2
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244774
...done!
maximalDeformation: 0.314808
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59954
...done!
=======================
Bad trial move (maximal deformation: 0.314808, lambda: 24.6748)
        Cost going from 59112.2 to 59112.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 24.6748 to 49.3495 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Time taken to solve the Levenberg-Marquardt system of equations: 0.249063
...done!
maximalDeformation: 0.160955
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58577
...done!
=======================
Good trial move (maximal deformation: 0.160955, lambda: 49.3495)
        Cost going from 59112.2 to 59111.2
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  58466.9
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58466.9
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 11 was 59114.5
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x9723380)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 32268400
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53477
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.1961
...done!
maximalDeformation: 4.09321
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.540329)
Time taken to rasterize Levenberg-Marquardt: 0.037051
...done!
=======================
Bad trial move (maximal deformation: 4.09321, lambda: 1)
        Cost going from 59111.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191515
...done!
maximalDeformation: 2.61245
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 820404 has managed to turn bad (detJ: -0.316475)
Time taken to rasterize Levenberg-Marquardt: 0.102731
...done!
=======================
Bad trial move (maximal deformation: 2.61245, lambda: 2)
        Cost going from 59111.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186802
...done!
maximalDeformation: 1.60428
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 820404 has managed to turn bad (detJ: -0.00307106)
Time taken to rasterize Levenberg-Marquardt: 0.101594
...done!
=======================
Bad trial move (maximal deformation: 1.60428, lambda: 4)
        Cost going from 59111.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18614
...done!
maximalDeformation: 0.904445
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2634453 has managed to turn bad (detJ: -0.122657)
Time taken to rasterize Levenberg-Marquardt: 1.29957
...done!
=======================
Bad trial move (maximal deformation: 0.904445, lambda: 8)
        Cost going from 59111.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183443
...done!
maximalDeformation: 0.48294
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47696
...done!
=======================
Bad trial move (maximal deformation: 0.48294, lambda: 16)
        Cost going from 59111.2 to 59113.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181295
...done!
maximalDeformation: 0.250332
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47972
...done!
=======================
Good trial move (maximal deformation: 0.250332, lambda: 32)
        Cost going from 59111.2 to 59110.9
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199713
...done!
maximalDeformation: 0.288017
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53393
...done!
=======================
Good trial move (maximal deformation: 0.288017, lambda: 29.0909)
        Cost going from 59110.9 to 59110.8
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195422
...done!
maximalDeformation: 0.279627
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52401
...done!
=======================
Good trial move (maximal deformation: 0.279627, lambda: 26.4463)
        Cost going from 59110.8 to 59110.4
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212554
...done!
maximalDeformation: 0.368855
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54841
...done!
=======================
Good trial move (maximal deformation: 0.368855, lambda: 24.0421)
        Cost going from 59110.4 to 59110.3
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210171
...done!
maximalDeformation: 0.474499
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54486
...done!
=======================
Good trial move (maximal deformation: 0.474499, lambda: 21.8564)
        Cost going from 59110.3 to 59109.7
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226217
...done!
maximalDeformation: 0.388193
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56733
...done!
=======================
Bad trial move (maximal deformation: 0.388193, lambda: 19.8695)
        Cost going from 59109.7 to 59110.1
Transforming mesh
Done transforming mesh
        Increasing lambda from 19.8695 to 39.739 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Time taken to solve the Levenberg-Marquardt system of equations: 0.227417
...done!
maximalDeformation: 0.198042
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56901
...done!
=======================
Good trial move (maximal deformation: 0.198042, lambda: 39.739)
        Cost going from 59109.7 to 59108.2
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223344
...done!
maximalDeformation: 0.223645
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57044
...done!
=======================
Good trial move (maximal deformation: 0.223645, lambda: 36.1263)
        Cost going from 59108.2 to 59107.6
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23647
...done!
maximalDeformation: 0.294284
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58927
...done!
=======================
Good trial move (maximal deformation: 0.294284, lambda: 32.8421)
        Cost going from 59107.6 to 59107.4
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226507
...done!
maximalDeformation: 0.289619
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5752
...done!
=======================
Good trial move (maximal deformation: 0.289619, lambda: 29.8565)
        Cost going from 59107.4 to 59107
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245265
...done!
maximalDeformation: 0.345045
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61007
...done!
=======================
Bad trial move (maximal deformation: 0.345045, lambda: 27.1422)
        Cost going from 59107 to 59107.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 27.1422 to 54.2845 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Time taken to solve the Levenberg-Marquardt system of equations: 0.24796
...done!
maximalDeformation: 0.179652
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59479
...done!
=======================
Good trial move (maximal deformation: 0.179652, lambda: 54.2845)
        Cost going from 59107 to 59106.2
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236042
...done!
maximalDeformation: 0.265363
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59561
...done!
=======================
Good trial move (maximal deformation: 0.265363, lambda: 49.3495)
        Cost going from 59106.2 to 59105.8
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  58456.8
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58456.8
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 12 was 59109.1
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x95c9850)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 35397711
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55414
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199321
...done!
maximalDeformation: 4.50406
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.551422)
Time taken to rasterize Levenberg-Marquardt: 0.00567389
...done!
=======================
Bad trial move (maximal deformation: 4.50406, lambda: 1)
        Cost going from 59105.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193739
...done!
maximalDeformation: 2.98217
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -1.53683)
Time taken to rasterize Levenberg-Marquardt: 0.0360191
...done!
=======================
Bad trial move (maximal deformation: 2.98217, lambda: 2)
        Cost going from 59105.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189084
...done!
maximalDeformation: 1.85706
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.404261)
Time taken to rasterize Levenberg-Marquardt: 0.0356579
...done!
=======================
Bad trial move (maximal deformation: 1.85706, lambda: 4)
        Cost going from 59105.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187407
...done!
maximalDeformation: 1.09838
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2066587 has managed to turn bad (detJ: -0.367003)
Time taken to rasterize Levenberg-Marquardt: 0.720595
...done!
=======================
Bad trial move (maximal deformation: 1.09838, lambda: 8)
        Cost going from 59105.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185112
...done!
maximalDeformation: 0.609074
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49486
...done!
=======================
Bad trial move (maximal deformation: 0.609074, lambda: 16)
        Cost going from 59105.8 to 59110.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185223
...done!
maximalDeformation: 0.32119
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50388
...done!
=======================
Bad trial move (maximal deformation: 0.32119, lambda: 32)
        Cost going from 59105.8 to 59106.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185433
...done!
maximalDeformation: 0.165366
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51014
...done!
=======================
Good trial move (maximal deformation: 0.165366, lambda: 64)
        Cost going from 59105.8 to 59105.5
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202797
...done!
maximalDeformation: 0.129031
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54296
...done!
=======================
Good trial move (maximal deformation: 0.129031, lambda: 58.1818)
        Cost going from 59105.5 to 59105.2
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197537
...done!
maximalDeformation: 0.206154
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52393
...done!
=======================
Good trial move (maximal deformation: 0.206154, lambda: 52.8926)
        Cost going from 59105.2 to 59105.1
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210395
...done!
maximalDeformation: 0.210965
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5489
...done!
=======================
Good trial move (maximal deformation: 0.210965, lambda: 48.0841)
        Cost going from 59105.1 to 59104.8
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209748
...done!
maximalDeformation: 0.276653
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55481
...done!
=======================
Bad trial move (maximal deformation: 0.276653, lambda: 43.7129)
        Cost going from 59104.8 to 59104.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 43.7129 to 87.4257 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Time taken to solve the Levenberg-Marquardt system of equations: 0.215503
...done!
maximalDeformation: 0.141501
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55477
...done!
=======================
Good trial move (maximal deformation: 0.141501, lambda: 87.4257)
        Cost going from 59104.8 to 59104.5
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228564
...done!
maximalDeformation: 0.129639
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57448
...done!
=======================
Good trial move (maximal deformation: 0.129639, lambda: 79.4779)
        Cost going from 59104.5 to 59104.3
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226664
...done!
maximalDeformation: 0.14595
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57781
...done!
=======================
Good trial move (maximal deformation: 0.14595, lambda: 72.2527)
        Cost going from 59104.3 to 59104.1
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235683
...done!
maximalDeformation: 0.162556
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.589
...done!
=======================
Good trial move (maximal deformation: 0.162556, lambda: 65.6842)
        Cost going from 59104.1 to 59103.9
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237563
...done!
maximalDeformation: 0.154015
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59778
...done!
=======================
Good trial move (maximal deformation: 0.154015, lambda: 59.7129)
        Cost going from 59103.9 to 59103.8
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246128
...done!
maximalDeformation: 0.408725
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59842
...done!
=======================
Good trial move (maximal deformation: 0.408725, lambda: 54.2845)
        Cost going from 59103.8 to 59103.6
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247469
...done!
maximalDeformation: 0.364029
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61514
...done!
=======================
Good trial move (maximal deformation: 0.364029, lambda: 49.3495)
        Cost going from 59103.6 to 59103.5
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  58452
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58452
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 13 was 59106.8
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x86049f0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 38527022
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54092
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196386
...done!
maximalDeformation: 3.98763
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -1.3241)
Time taken to rasterize Levenberg-Marquardt: 0.00811911
...done!
=======================
Bad trial move (maximal deformation: 3.98763, lambda: 1)
        Cost going from 59103.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191366
...done!
maximalDeformation: 2.37542
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -0.511195)
Time taken to rasterize Levenberg-Marquardt: 0.00761294
...done!
=======================
Bad trial move (maximal deformation: 2.37542, lambda: 2)
        Cost going from 59103.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186361
...done!
maximalDeformation: 1.48362
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 853114 has managed to turn bad (detJ: -0.0948631)
Time taken to rasterize Levenberg-Marquardt: 0.111431
...done!
=======================
Bad trial move (maximal deformation: 1.48362, lambda: 4)
        Cost going from 59103.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182646
...done!
maximalDeformation: 0.904783
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1519435 has managed to turn bad (detJ: -0.235372)
Time taken to rasterize Levenberg-Marquardt: 0.366183
...done!
=======================
Bad trial move (maximal deformation: 0.904783, lambda: 8)
        Cost going from 59103.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182863
...done!
maximalDeformation: 0.5123
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47882
...done!
=======================
Bad trial move (maximal deformation: 0.5123, lambda: 16)
        Cost going from 59103.5 to 59107.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186448
...done!
maximalDeformation: 0.275598
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49235
...done!
=======================
Bad trial move (maximal deformation: 0.275598, lambda: 32)
        Cost going from 59103.5 to 59103.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18098
...done!
maximalDeformation: 0.143487
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.467
...done!
=======================
Good trial move (maximal deformation: 0.143487, lambda: 64)
        Cost going from 59103.5 to 59103
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19836
...done!
maximalDeformation: 0.12715
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5388
...done!
=======================
Good trial move (maximal deformation: 0.12715, lambda: 58.1818)
        Cost going from 59103 to 59102.8
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195247
...done!
maximalDeformation: 0.252273
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53074
...done!
=======================
Good trial move (maximal deformation: 0.252273, lambda: 52.8926)
        Cost going from 59102.8 to 59102.7
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207614
...done!
maximalDeformation: 0.166041
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54789
...done!
=======================
Good trial move (maximal deformation: 0.166041, lambda: 48.0841)
        Cost going from 59102.7 to 59102.4
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207726
...done!
maximalDeformation: 0.214379
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55128
...done!
=======================
Good trial move (maximal deformation: 0.214379, lambda: 43.7129)
        Cost going from 59102.4 to 59102.2
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221029
...done!
maximalDeformation: 0.256171
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56525
...done!
=======================
Good trial move (maximal deformation: 0.256171, lambda: 39.739)
        Cost going from 59102.2 to 59102
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221904
...done!
maximalDeformation: 0.269992
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57368
...done!
=======================
Good trial move (maximal deformation: 0.269992, lambda: 36.1263)
        Cost going from 59102 to 59101.8
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23274
...done!
maximalDeformation: 0.404495
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58793
...done!
=======================
Good trial move (maximal deformation: 0.404495, lambda: 32.8421)
        Cost going from 59101.8 to 59101.7
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233304
...done!
maximalDeformation: 0.404985
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59015
...done!
=======================
Good trial move (maximal deformation: 0.404985, lambda: 29.8565)
        Cost going from 59101.7 to 59101.5
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243551
...done!
maximalDeformation: 0.334211
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59907
...done!
=======================
Good trial move (maximal deformation: 0.334211, lambda: 27.1422)
        Cost going from 59101.5 to 59101.4
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243786
...done!
maximalDeformation: 0.325361
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60021
...done!
=======================
Good trial move (maximal deformation: 0.325361, lambda: 24.6748)
        Cost going from 59101.4 to 59100.9
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  58444.5
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58444.5
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 14 was 59104.2
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xcafbd60)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 41463427
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53508
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197649
...done!
maximalDeformation: 4.72258
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.511274)
Time taken to rasterize Levenberg-Marquardt: 0.00562811
...done!
=======================
Bad trial move (maximal deformation: 4.72258, lambda: 1)
        Cost going from 59100.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.206034
...done!
maximalDeformation: 3.15295
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -0.717797)
Time taken to rasterize Levenberg-Marquardt: 0.00872898
...done!
=======================
Bad trial move (maximal deformation: 3.15295, lambda: 2)
        Cost going from 59100.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210631
...done!
maximalDeformation: 1.95186
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 840043 has managed to turn bad (detJ: -0.247702)
Time taken to rasterize Levenberg-Marquardt: 0.114517
...done!
=======================
Bad trial move (maximal deformation: 1.95186, lambda: 4)
        Cost going from 59100.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210528
...done!
maximalDeformation: 1.12374
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1358066 has managed to turn bad (detJ: -0.81553)
Time taken to rasterize Levenberg-Marquardt: 0.302305
...done!
=======================
Bad trial move (maximal deformation: 1.12374, lambda: 8)
        Cost going from 59100.9 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210486
...done!
maximalDeformation: 0.608339
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55068
...done!
=======================
Bad trial move (maximal deformation: 0.608339, lambda: 16)
        Cost going from 59100.9 to 59103.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208819
...done!
maximalDeformation: 0.319143
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5281
...done!
=======================
Good trial move (maximal deformation: 0.319143, lambda: 32)
        Cost going from 59100.9 to 59100
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208099
...done!
maximalDeformation: 0.334199
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5337
...done!
=======================
Good trial move (maximal deformation: 0.334199, lambda: 29.0909)
        Cost going from 59100 to 59099.6
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218171
...done!
maximalDeformation: 0.276614
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56238
...done!
=======================
Good trial move (maximal deformation: 0.276614, lambda: 26.4463)
        Cost going from 59099.6 to 59099.4
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219907
...done!
maximalDeformation: 0.461837
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55956
...done!
=======================
Bad trial move (maximal deformation: 0.461837, lambda: 24.0421)
        Cost going from 59099.4 to 59099.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 24.0421 to 48.0841 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210202
...done!
maximalDeformation: 0.243766
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53413
...done!
=======================
Good trial move (maximal deformation: 0.243766, lambda: 48.0841)
        Cost going from 59099.4 to 59098.1
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22752
...done!
maximalDeformation: 0.284886
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57701
...done!
=======================
Good trial move (maximal deformation: 0.284886, lambda: 43.7129)
        Cost going from 59098.1 to 59097.9
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222525
...done!
maximalDeformation: 0.208488
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5603
...done!
=======================
Good trial move (maximal deformation: 0.208488, lambda: 39.739)
        Cost going from 59097.9 to 59097.6
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231596
...done!
maximalDeformation: 0.208617
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58334
...done!
=======================
Good trial move (maximal deformation: 0.208617, lambda: 36.1263)
        Cost going from 59097.6 to 59097.4
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232693
...done!
maximalDeformation: 0.311002
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5872
...done!
=======================
Good trial move (maximal deformation: 0.311002, lambda: 32.8421)
        Cost going from 59097.4 to 59096.5
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2413
...done!
maximalDeformation: 0.361677
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59778
...done!
=======================
Bad trial move (maximal deformation: 0.361677, lambda: 29.8565)
        Cost going from 59096.5 to 59097.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 29.8565 to 59.7129 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Time taken to solve the Levenberg-Marquardt system of equations: 0.244713
...done!
maximalDeformation: 0.187299
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58208
...done!
=======================
Good trial move (maximal deformation: 0.187299, lambda: 59.7129)
        Cost going from 59096.5 to 59095.6
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242963
...done!
maximalDeformation: 0.163492
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59064
...done!
=======================
Good trial move (maximal deformation: 0.163492, lambda: 54.2845)
        Cost going from 59095.6 to 59095.2
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247371
...done!
maximalDeformation: 0.167342
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60297
...done!
=======================
Good trial move (maximal deformation: 0.167342, lambda: 49.3495)
        Cost going from 59095.2 to 59095.1
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  58436.5
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58436.5
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 15 was 59098.4
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xda9b6c0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 44592738
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55598
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195881
...done!
maximalDeformation: 4.1107
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -0.983163)
Time taken to rasterize Levenberg-Marquardt: 0.0229208
...done!
=======================
Bad trial move (maximal deformation: 4.1107, lambda: 1)
        Cost going from 59095.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193274
...done!
maximalDeformation: 2.5386
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 385842 has managed to turn bad (detJ: -0.262611)
Time taken to rasterize Levenberg-Marquardt: 0.0219839
...done!
=======================
Bad trial move (maximal deformation: 2.5386, lambda: 2)
        Cost going from 59095.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188369
...done!
maximalDeformation: 1.49451
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.666242)
Time taken to rasterize Levenberg-Marquardt: 0.0353911
...done!
=======================
Bad trial move (maximal deformation: 1.49451, lambda: 4)
        Cost going from 59095.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19808
...done!
maximalDeformation: 0.83623
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2231637 has managed to turn bad (detJ: -0.379714)
Time taken to rasterize Levenberg-Marquardt: 0.871075
...done!
=======================
Bad trial move (maximal deformation: 0.83623, lambda: 8)
        Cost going from 59095.1 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.209932
...done!
maximalDeformation: 0.445858
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54623
...done!
=======================
Bad trial move (maximal deformation: 0.445858, lambda: 16)
        Cost going from 59095.1 to 59099.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195426
...done!
maximalDeformation: 0.231582
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51302
...done!
=======================
Bad trial move (maximal deformation: 0.231582, lambda: 32)
        Cost going from 59095.1 to 59095.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.197143
...done!
maximalDeformation: 0.118563
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51535
...done!
=======================
Good trial move (maximal deformation: 0.118563, lambda: 64)
        Cost going from 59095.1 to 59094.7
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206103
...done!
maximalDeformation: 0.203165
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5463
...done!
=======================
Good trial move (maximal deformation: 0.203165, lambda: 58.1818)
        Cost going from 59094.7 to 59094.6
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206584
...done!
maximalDeformation: 0.164112
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54343
...done!
=======================
Good trial move (maximal deformation: 0.164112, lambda: 52.8926)
        Cost going from 59094.6 to 59094.5
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214175
...done!
maximalDeformation: 0.227521
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55463
...done!
=======================
Good trial move (maximal deformation: 0.227521, lambda: 48.0841)
        Cost going from 59094.5 to 59094.2
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22031
...done!
maximalDeformation: 0.157417
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56936
...done!
=======================
Good trial move (maximal deformation: 0.157417, lambda: 43.7129)
        Cost going from 59094.2 to 59094.1
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226
...done!
maximalDeformation: 0.246078
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58503
...done!
=======================
Good trial move (maximal deformation: 0.246078, lambda: 39.739)
        Cost going from 59094.1 to 59094
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233464
...done!
maximalDeformation: 0.223738
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59152
...done!
=======================
Good trial move (maximal deformation: 0.223738, lambda: 36.1263)
        Cost going from 59094 to 59093.8
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237056
...done!
maximalDeformation: 0.319168
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59173
...done!
=======================
Bad trial move (maximal deformation: 0.319168, lambda: 32.8421)
        Cost going from 59093.8 to 59094
Transforming mesh
Done transforming mesh
        Increasing lambda from 32.8421 to 65.6842 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Time taken to solve the Levenberg-Marquardt system of equations: 0.225925
...done!
maximalDeformation: 0.162727
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56911
...done!
=======================
Good trial move (maximal deformation: 0.162727, lambda: 65.6842)
        Cost going from 59093.8 to 59093.2
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241473
...done!
maximalDeformation: 0.16959
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59234
...done!
=======================
Bad trial move (maximal deformation: 0.16959, lambda: 59.7129)
        Cost going from 59093.2 to 59093.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 59.7129 to 119.426 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 119.426...
Time taken to solve the Levenberg-Marquardt system of equations: 0.237264
...done!
maximalDeformation: 0.0859055
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58007
...done!
=======================
Bad trial move (maximal deformation: 0.0859055, lambda: 119.426)
        Cost going from 59093.2 to 59093.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 119.426 to 238.852 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 238.852...
Time taken to solve the Levenberg-Marquardt system of equations: 0.236509
...done!
maximalDeformation: 0.0432413
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58507
...done!
=======================
Bad trial move (maximal deformation: 0.0432413, lambda: 238.852)
        Cost going from 59093.2 to 59094
Transforming mesh
Done transforming mesh
        Increasing lambda from 238.852 to 477.703 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 477.703...
Time taken to solve the Levenberg-Marquardt system of equations: 0.23431
...done!
maximalDeformation: 0.0217561
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57658
...done!
=======================
Bad trial move (maximal deformation: 0.0217561, lambda: 477.703)
        Cost going from 59093.2 to 59094
Transforming mesh
Done transforming mesh
        Increasing lambda from 477.703 to 955.407 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 955.407...
Time taken to solve the Levenberg-Marquardt system of equations: 0.234196
...done!
maximalDeformation: 0.0108812
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62394
...done!
=======================
Good trial move (maximal deformation: 0.0108812, lambda: 955.407)
        Cost going from 59093.2 to 59093.2
        Decreasing lambda from 955.407 to 868.552
        maximalDeformation is too small; stopping
Starting EM: 
EM Iteration: 0  ->  58432.8
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58432.8
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 16 was 59096.5
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x9cd87e0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 48216495
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53773
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193539
...done!
maximalDeformation: 6.14751
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -1.87587)
Time taken to rasterize Levenberg-Marquardt: 0.00805998
...done!
=======================
Bad trial move (maximal deformation: 6.14751, lambda: 1)
        Cost going from 59093.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19029
...done!
maximalDeformation: 3.88019
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -0.855184)
Time taken to rasterize Levenberg-Marquardt: 0.007653
...done!
=======================
Bad trial move (maximal deformation: 3.88019, lambda: 2)
        Cost going from 59093.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185053
...done!
maximalDeformation: 2.26996
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -0.012147)
Time taken to rasterize Levenberg-Marquardt: 0.00739098
...done!
=======================
Bad trial move (maximal deformation: 2.26996, lambda: 4)
        Cost going from 59093.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181658
...done!
maximalDeformation: 1.25481
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1358066 has managed to turn bad (detJ: -0.538011)
Time taken to rasterize Levenberg-Marquardt: 0.288677
...done!
=======================
Bad trial move (maximal deformation: 1.25481, lambda: 8)
        Cost going from 59093.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181516
...done!
maximalDeformation: 0.662128
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.4847
...done!
=======================
Bad trial move (maximal deformation: 0.662128, lambda: 16)
        Cost going from 59093.2 to 59097.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180108
...done!
maximalDeformation: 0.341671
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48781
...done!
=======================
Bad trial move (maximal deformation: 0.341671, lambda: 32)
        Cost going from 59093.2 to 59094.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.179944
...done!
maximalDeformation: 0.17348
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48291
...done!
=======================
Good trial move (maximal deformation: 0.17348, lambda: 64)
        Cost going from 59093.2 to 59092.9
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198218
...done!
maximalDeformation: 0.171966
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53694
...done!
=======================
Good trial move (maximal deformation: 0.171966, lambda: 58.1818)
        Cost going from 59092.9 to 59092.7
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193219
...done!
maximalDeformation: 0.159659
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51128
...done!
=======================
Good trial move (maximal deformation: 0.159659, lambda: 52.8926)
        Cost going from 59092.7 to 59092.5
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205382
...done!
maximalDeformation: 0.209605
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53413
...done!
=======================
Good trial move (maximal deformation: 0.209605, lambda: 48.0841)
        Cost going from 59092.5 to 59092.5
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205127
...done!
maximalDeformation: 0.220051
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53835
...done!
=======================
Good trial move (maximal deformation: 0.220051, lambda: 43.7129)
        Cost going from 59092.5 to 59092.2
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218785
...done!
maximalDeformation: 0.312234
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56172
...done!
=======================
Bad trial move (maximal deformation: 0.312234, lambda: 39.739)
        Cost going from 59092.2 to 59092.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 39.739 to 79.4779 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Time taken to solve the Levenberg-Marquardt system of equations: 0.221886
...done!
maximalDeformation: 0.160714
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55944
...done!
=======================
Good trial move (maximal deformation: 0.160714, lambda: 79.4779)
        Cost going from 59092.2 to 59091.8
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219925
...done!
maximalDeformation: 0.150199
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5608
...done!
=======================
Good trial move (maximal deformation: 0.150199, lambda: 72.2527)
        Cost going from 59091.8 to 59091.6
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230975
...done!
maximalDeformation: 0.15044
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57889
...done!
=======================
Bad trial move (maximal deformation: 0.15044, lambda: 65.6842)
        Cost going from 59091.6 to 59092.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 65.6842 to 131.368 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 131.368...
Time taken to solve the Levenberg-Marquardt system of equations: 0.234771
...done!
maximalDeformation: 0.0762732
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57014
...done!
=======================
Bad trial move (maximal deformation: 0.0762732, lambda: 131.368)
        Cost going from 59091.6 to 59092.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 131.368 to 262.737 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 262.737...
Time taken to solve the Levenberg-Marquardt system of equations: 0.232256
...done!
maximalDeformation: 0.0386558
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58007
...done!
=======================
Good trial move (maximal deformation: 0.0386558, lambda: 262.737)
        Cost going from 59091.6 to 59091.5
        Decreasing lambda from 262.737 to 238.852
        maximalDeformation is too small; stopping
Starting EM: 
EM Iteration: 0  ->  58430
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58430
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 17 was 59094.8
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xb492230)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 51320130
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53442
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.189624
...done!
maximalDeformation: 5.06972
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 286608 has managed to turn bad (detJ: -1.76453)
Time taken to rasterize Levenberg-Marquardt: 0.0131521
...done!
=======================
Bad trial move (maximal deformation: 5.06972, lambda: 1)
        Cost going from 59091.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184218
...done!
maximalDeformation: 3.09539
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 286608 has managed to turn bad (detJ: -0.735047)
Time taken to rasterize Levenberg-Marquardt: 0.012917
...done!
=======================
Bad trial move (maximal deformation: 3.09539, lambda: 2)
        Cost going from 59091.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.179221
...done!
maximalDeformation: 1.85464
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 820823 has managed to turn bad (detJ: -0.0193308)
Time taken to rasterize Levenberg-Marquardt: 0.102276
...done!
=======================
Bad trial move (maximal deformation: 1.85464, lambda: 4)
        Cost going from 59091.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.177214
...done!
maximalDeformation: 1.05068
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48268
...done!
=======================
Bad trial move (maximal deformation: 1.05068, lambda: 8)
        Cost going from 59091.5 to 59103.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.175805
...done!
maximalDeformation: 0.569694
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49299
...done!
=======================
Bad trial move (maximal deformation: 0.569694, lambda: 16)
        Cost going from 59091.5 to 59093.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.175617
...done!
maximalDeformation: 0.297171
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49186
...done!
=======================
Bad trial move (maximal deformation: 0.297171, lambda: 32)
        Cost going from 59091.5 to 59092.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.175632
...done!
maximalDeformation: 0.152139
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48787
...done!
=======================
Good trial move (maximal deformation: 0.152139, lambda: 64)
        Cost going from 59091.5 to 59091.4
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196664
...done!
maximalDeformation: 0.253418
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54448
...done!
=======================
Good trial move (maximal deformation: 0.253418, lambda: 58.1818)
        Cost going from 59091.4 to 59091.3
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.177863
...done!
maximalDeformation: 0.167794
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48752
...done!
=======================
Good trial move (maximal deformation: 0.167794, lambda: 52.8926)
        Cost going from 59091.3 to 59091.2
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201013
...done!
maximalDeformation: 0.267171
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54447
...done!
=======================
Good trial move (maximal deformation: 0.267171, lambda: 48.0841)
        Cost going from 59091.2 to 59091.1
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192582
...done!
maximalDeformation: 0.200234
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52196
...done!
=======================
Good trial move (maximal deformation: 0.200234, lambda: 43.7129)
        Cost going from 59091.1 to 59091
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214219
...done!
maximalDeformation: 0.239604
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59587
...done!
=======================
Good trial move (maximal deformation: 0.239604, lambda: 39.739)
        Cost going from 59091 to 59090.7
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206698
...done!
maximalDeformation: 0.29327
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56349
...done!
=======================
Bad trial move (maximal deformation: 0.29327, lambda: 36.1263)
        Cost going from 59090.7 to 59090.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 36.1263 to 72.2527 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Time taken to solve the Levenberg-Marquardt system of equations: 0.201294
...done!
maximalDeformation: 0.14836
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5327
...done!
=======================
Good trial move (maximal deformation: 0.14836, lambda: 72.2527)
        Cost going from 59090.7 to 59090.2
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226593
...done!
maximalDeformation: 0.217027
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58528
...done!
=======================
Good trial move (maximal deformation: 0.217027, lambda: 65.6842)
        Cost going from 59090.2 to 59090
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214651
...done!
maximalDeformation: 0.153155
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56438
...done!
=======================
Good trial move (maximal deformation: 0.153155, lambda: 59.7129)
        Cost going from 59090 to 59089.9
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230712
...done!
maximalDeformation: 0.217568
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58652
...done!
=======================
Good trial move (maximal deformation: 0.217568, lambda: 54.2845)
        Cost going from 59089.9 to 59089.8
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225509
...done!
maximalDeformation: 0.166525
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58681
...done!
=======================
Good trial move (maximal deformation: 0.166525, lambda: 49.3495)
        Cost going from 59089.8 to 59089.6
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  58425.5
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58425.5
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 18 was 59092.9
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xca22870)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 54449441
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54013
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195012
...done!
maximalDeformation: 5.10015
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 248957 has managed to turn bad (detJ: -0.933835)
Time taken to rasterize Levenberg-Marquardt: 0.0113771
...done!
=======================
Bad trial move (maximal deformation: 5.10015, lambda: 1)
        Cost going from 59089.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191362
...done!
maximalDeformation: 3.03327
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 248957 has managed to turn bad (detJ: -0.232592)
Time taken to rasterize Levenberg-Marquardt: 0.010226
...done!
=======================
Bad trial move (maximal deformation: 3.03327, lambda: 2)
        Cost going from 59089.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.198858
...done!
maximalDeformation: 1.78614
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 840043 has managed to turn bad (detJ: -0.295169)
Time taken to rasterize Levenberg-Marquardt: 0.111153
...done!
=======================
Bad trial move (maximal deformation: 1.78614, lambda: 4)
        Cost going from 59089.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.206645
...done!
maximalDeformation: 1.0454
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1182181 has managed to turn bad (detJ: -0.235808)
Time taken to rasterize Levenberg-Marquardt: 0.230537
...done!
=======================
Bad trial move (maximal deformation: 1.0454, lambda: 8)
        Cost going from 59089.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208872
...done!
maximalDeformation: 0.577004
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54309
...done!
=======================
Bad trial move (maximal deformation: 0.577004, lambda: 16)
        Cost going from 59089.6 to 59095
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.207013
...done!
maximalDeformation: 0.305873
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54112
...done!
=======================
Bad trial move (maximal deformation: 0.305873, lambda: 32)
        Cost going from 59089.6 to 59090
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.207012
...done!
maximalDeformation: 0.157753
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52951
...done!
=======================
Good trial move (maximal deformation: 0.157753, lambda: 64)
        Cost going from 59089.6 to 59089.3
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206877
...done!
maximalDeformation: 0.161707
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54378
...done!
=======================
Good trial move (maximal deformation: 0.161707, lambda: 58.1818)
        Cost going from 59089.3 to 59089.1
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215837
...done!
maximalDeformation: 0.144744
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56814
...done!
=======================
Good trial move (maximal deformation: 0.144744, lambda: 52.8926)
        Cost going from 59089.1 to 59089
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219515
...done!
maximalDeformation: 0.223113
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56443
...done!
=======================
Good trial move (maximal deformation: 0.223113, lambda: 48.0841)
        Cost going from 59089 to 59089
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229795
...done!
maximalDeformation: 0.251997
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59302
...done!
=======================
Good trial move (maximal deformation: 0.251997, lambda: 43.7129)
        Cost going from 59089 to 59088.8
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23059
...done!
maximalDeformation: 0.249435
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58909
...done!
=======================
Good trial move (maximal deformation: 0.249435, lambda: 39.739)
        Cost going from 59088.8 to 59088.8
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241296
...done!
maximalDeformation: 0.216848
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59874
...done!
=======================
Good trial move (maximal deformation: 0.216848, lambda: 36.1263)
        Cost going from 59088.8 to 59088.6
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241586
...done!
maximalDeformation: 0.246095
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60159
...done!
=======================
Bad trial move (maximal deformation: 0.246095, lambda: 32.8421)
        Cost going from 59088.6 to 59088.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 32.8421 to 65.6842 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Time taken to solve the Levenberg-Marquardt system of equations: 0.231937
...done!
maximalDeformation: 0.127403
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59788
...done!
=======================
Good trial move (maximal deformation: 0.127403, lambda: 65.6842)
        Cost going from 59088.6 to 59087.9
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249192
...done!
maximalDeformation: 0.144135
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61808
...done!
=======================
Good trial move (maximal deformation: 0.144135, lambda: 59.7129)
        Cost going from 59087.9 to 59087.7
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242287
...done!
maximalDeformation: 0.159679
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60314
...done!
=======================
Good trial move (maximal deformation: 0.159679, lambda: 54.2845)
        Cost going from 59087.7 to 59087.6
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251747
...done!
maximalDeformation: 0.166619
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6108
...done!
=======================
Good trial move (maximal deformation: 0.166619, lambda: 49.3495)
        Cost going from 59087.6 to 59087.4
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  58421
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58421
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 19 was 59090.8
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x8a9c750)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 57578752
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51098
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.187067
...done!
maximalDeformation: 4.12623
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.0786577)
Time taken to rasterize Levenberg-Marquardt: 0.00593901
...done!
=======================
Bad trial move (maximal deformation: 4.12623, lambda: 1)
        Cost going from 59087.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183219
...done!
maximalDeformation: 2.72974
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -1.28035)
Time taken to rasterize Levenberg-Marquardt: 0.00734806
...done!
=======================
Bad trial move (maximal deformation: 2.72974, lambda: 2)
        Cost going from 59087.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.176493
...done!
maximalDeformation: 1.66112
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -0.324429)
Time taken to rasterize Levenberg-Marquardt: 0.00728989
...done!
=======================
Bad trial move (maximal deformation: 1.66112, lambda: 4)
        Cost going from 59087.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.175271
...done!
maximalDeformation: 0.932775
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2583990 has managed to turn bad (detJ: -0.215933)
Time taken to rasterize Levenberg-Marquardt: 1.23772
...done!
=======================
Bad trial move (maximal deformation: 0.932775, lambda: 8)
        Cost going from 59087.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.174485
...done!
maximalDeformation: 0.496051
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47981
...done!
=======================
Bad trial move (maximal deformation: 0.496051, lambda: 16)
        Cost going from 59087.4 to 59092.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.172648
...done!
maximalDeformation: 0.257059
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.46828
...done!
=======================
Bad trial move (maximal deformation: 0.257059, lambda: 32)
        Cost going from 59087.4 to 59088
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.173838
...done!
maximalDeformation: 0.130666
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47579
...done!
=======================
Good trial move (maximal deformation: 0.130666, lambda: 64)
        Cost going from 59087.4 to 59087.2
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192619
...done!
maximalDeformation: 0.163555
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53544
...done!
=======================
Good trial move (maximal deformation: 0.163555, lambda: 58.1818)
        Cost going from 59087.2 to 59087
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.17635
...done!
maximalDeformation: 0.165916
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48021
...done!
=======================
Good trial move (maximal deformation: 0.165916, lambda: 52.8926)
        Cost going from 59087 to 59086.9
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200337
...done!
maximalDeformation: 0.1938
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53748
...done!
=======================
Good trial move (maximal deformation: 0.1938, lambda: 48.0841)
        Cost going from 59086.9 to 59086.8
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192034
...done!
maximalDeformation: 0.236803
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51623
...done!
=======================
Good trial move (maximal deformation: 0.236803, lambda: 43.7129)
        Cost going from 59086.8 to 59086.8
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212827
...done!
maximalDeformation: 0.239571
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55795
...done!
=======================
Good trial move (maximal deformation: 0.239571, lambda: 39.739)
        Cost going from 59086.8 to 59086.6
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20543
...done!
maximalDeformation: 0.323738
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53916
...done!
=======================
Good trial move (maximal deformation: 0.323738, lambda: 36.1263)
        Cost going from 59086.6 to 59086.6
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226971
...done!
maximalDeformation: 0.341334
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58288
...done!
=======================
Good trial move (maximal deformation: 0.341334, lambda: 32.8421)
        Cost going from 59086.6 to 59086.4
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219357
...done!
maximalDeformation: 0.386789
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56892
...done!
=======================
Bad trial move (maximal deformation: 0.386789, lambda: 29.8565)
        Cost going from 59086.4 to 59086.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 29.8565 to 59.7129 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Time taken to solve the Levenberg-Marquardt system of equations: 0.209016
...done!
maximalDeformation: 0.197462
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54243
...done!
=======================
Good trial move (maximal deformation: 0.197462, lambda: 59.7129)
        Cost going from 59086.4 to 59085.6
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235947
...done!
maximalDeformation: 0.164279
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59683
...done!
=======================
Good trial move (maximal deformation: 0.164279, lambda: 54.2845)
        Cost going from 59085.6 to 59085.3
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221691
...done!
maximalDeformation: 0.152309
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56596
...done!
=======================
Good trial move (maximal deformation: 0.152309, lambda: 49.3495)
        Cost going from 59085.3 to 59085.2
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  58416.3
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58416.3
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 20 was 59088.5
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x9c81840)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 60708063
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55187
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197229
...done!
maximalDeformation: 5.31283
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -0.326083)
Time taken to rasterize Levenberg-Marquardt: 0.00810218
...done!
=======================
Bad trial move (maximal deformation: 5.31283, lambda: 1)
        Cost going from 59085.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192448
...done!
maximalDeformation: 3.36129
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 248957 has managed to turn bad (detJ: -0.424459)
Time taken to rasterize Levenberg-Marquardt: 0.010314
...done!
=======================
Bad trial move (maximal deformation: 3.36129, lambda: 2)
        Cost going from 59085.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188709
...done!
maximalDeformation: 1.96566
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 921052 has managed to turn bad (detJ: -0.86446)
Time taken to rasterize Levenberg-Marquardt: 0.13013
...done!
=======================
Bad trial move (maximal deformation: 1.96566, lambda: 4)
        Cost going from 59085.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184612
...done!
maximalDeformation: 1.08161
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2467838 has managed to turn bad (detJ: -0.186405)
Time taken to rasterize Levenberg-Marquardt: 1.10022
...done!
=======================
Bad trial move (maximal deformation: 1.08161, lambda: 8)
        Cost going from 59085.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185307
...done!
maximalDeformation: 0.588772
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48626
...done!
=======================
Bad trial move (maximal deformation: 0.588772, lambda: 16)
        Cost going from 59085.2 to 59090.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182673
...done!
maximalDeformation: 0.31149
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47653
...done!
=======================
Bad trial move (maximal deformation: 0.31149, lambda: 32)
        Cost going from 59085.2 to 59085.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182886
...done!
maximalDeformation: 0.160009
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.47711
...done!
=======================
Good trial move (maximal deformation: 0.160009, lambda: 64)
        Cost going from 59085.2 to 59084.9
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202375
...done!
maximalDeformation: 0.180523
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54636
...done!
=======================
Good trial move (maximal deformation: 0.180523, lambda: 58.1818)
        Cost going from 59084.9 to 59084.8
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196414
...done!
maximalDeformation: 0.137995
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51765
...done!
=======================
Good trial move (maximal deformation: 0.137995, lambda: 52.8926)
        Cost going from 59084.8 to 59084.7
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209323
...done!
maximalDeformation: 0.208991
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55212
...done!
=======================
Good trial move (maximal deformation: 0.208991, lambda: 48.0841)
        Cost going from 59084.7 to 59084.7
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208273
...done!
maximalDeformation: 0.17696
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54106
...done!
=======================
Good trial move (maximal deformation: 0.17696, lambda: 43.7129)
        Cost going from 59084.7 to 59084.6
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221645
...done!
maximalDeformation: 0.293427
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56383
...done!
=======================
Good trial move (maximal deformation: 0.293427, lambda: 39.739)
        Cost going from 59084.6 to 59084.6
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221605
...done!
maximalDeformation: 0.289215
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5698
...done!
=======================
Good trial move (maximal deformation: 0.289215, lambda: 36.1263)
        Cost going from 59084.6 to 59084.3
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233632
...done!
maximalDeformation: 0.393055
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58762
...done!
=======================
Bad trial move (maximal deformation: 0.393055, lambda: 32.8421)
        Cost going from 59084.3 to 59084.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 32.8421 to 65.6842 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Time taken to solve the Levenberg-Marquardt system of equations: 0.236912
...done!
maximalDeformation: 0.200679
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5729
...done!
=======================
Good trial move (maximal deformation: 0.200679, lambda: 65.6842)
        Cost going from 59084.3 to 59083.7
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233421
...done!
maximalDeformation: 0.223477
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5769
...done!
=======================
Good trial move (maximal deformation: 0.223477, lambda: 59.7129)
        Cost going from 59083.7 to 59083.6
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243719
...done!
maximalDeformation: 0.148591
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59642
...done!
=======================
Good trial move (maximal deformation: 0.148591, lambda: 54.2845)
        Cost going from 59083.6 to 59083.3
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235421
...done!
maximalDeformation: 0.175014
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60266
...done!
=======================
Good trial move (maximal deformation: 0.175014, lambda: 49.3495)
        Cost going from 59083.3 to 59083.2
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  58412.1
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58412.1
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 21 was 59086.5
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa8822f0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 63837374
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53547
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196349
...done!
maximalDeformation: 6.26813
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.184895)
Time taken to rasterize Levenberg-Marquardt: 0.00581503
...done!
=======================
Bad trial move (maximal deformation: 6.26813, lambda: 1)
        Cost going from 59083.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19582
...done!
maximalDeformation: 3.87007
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 330248 has managed to turn bad (detJ: -0.0140712)
Time taken to rasterize Levenberg-Marquardt: 0.0163841
...done!
=======================
Bad trial move (maximal deformation: 3.87007, lambda: 2)
        Cost going from 59083.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.199298
...done!
maximalDeformation: 2.22987
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.494434)
Time taken to rasterize Levenberg-Marquardt: 0.0769231
...done!
=======================
Bad trial move (maximal deformation: 2.22987, lambda: 4)
        Cost going from 59083.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.206583
...done!
maximalDeformation: 1.21457
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2231637 has managed to turn bad (detJ: -0.256856)
Time taken to rasterize Levenberg-Marquardt: 0.887707
...done!
=======================
Bad trial move (maximal deformation: 1.21457, lambda: 8)
        Cost going from 59083.2 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.21044
...done!
maximalDeformation: 0.632776
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53532
...done!
=======================
Bad trial move (maximal deformation: 0.632776, lambda: 16)
        Cost going from 59083.2 to 59089
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208997
...done!
maximalDeformation: 0.323879
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5337
...done!
=======================
Bad trial move (maximal deformation: 0.323879, lambda: 32)
        Cost going from 59083.2 to 59083.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208514
...done!
maximalDeformation: 0.16369
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53732
...done!
=======================
Good trial move (maximal deformation: 0.16369, lambda: 64)
        Cost going from 59083.2 to 59083
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209056
...done!
maximalDeformation: 0.262076
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53122
...done!
=======================
Good trial move (maximal deformation: 0.262076, lambda: 58.1818)
        Cost going from 59083 to 59082.9
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2157
...done!
maximalDeformation: 0.366611
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5603
...done!
=======================
Good trial move (maximal deformation: 0.366611, lambda: 52.8926)
        Cost going from 59082.9 to 59082.9
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220664
...done!
maximalDeformation: 0.167229
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56222
...done!
=======================
Good trial move (maximal deformation: 0.167229, lambda: 48.0841)
        Cost going from 59082.9 to 59082.6
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230177
...done!
maximalDeformation: 0.230903
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58171
...done!
=======================
Bad trial move (maximal deformation: 0.230903, lambda: 43.7129)
        Cost going from 59082.6 to 59082.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 43.7129 to 87.4257 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Time taken to solve the Levenberg-Marquardt system of equations: 0.234438
...done!
maximalDeformation: 0.116645
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56121
...done!
=======================
Good trial move (maximal deformation: 0.116645, lambda: 87.4257)
        Cost going from 59082.6 to 59082.3
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232281
...done!
maximalDeformation: 0.227039
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57161
...done!
=======================
Good trial move (maximal deformation: 0.227039, lambda: 79.4779)
        Cost going from 59082.3 to 59082.2
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24121
...done!
maximalDeformation: 0.118013
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59413
...done!
=======================
Good trial move (maximal deformation: 0.118013, lambda: 72.2527)
        Cost going from 59082.2 to 59082.1
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242258
...done!
maximalDeformation: 0.180523
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58767
...done!
=======================
Good trial move (maximal deformation: 0.180523, lambda: 65.6842)
        Cost going from 59082.1 to 59082
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251041
...done!
maximalDeformation: 0.293401
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60497
...done!
=======================
Bad trial move (maximal deformation: 0.293401, lambda: 59.7129)
        Cost going from 59082 to 59082
Transforming mesh
Done transforming mesh
        Increasing lambda from 59.7129 to 119.426 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 119.426...
Time taken to solve the Levenberg-Marquardt system of equations: 0.252597
...done!
maximalDeformation: 0.148466
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58873
...done!
=======================
Good trial move (maximal deformation: 0.148466, lambda: 119.426)
        Cost going from 59082 to 59081.8
        Decreasing lambda from 119.426 to 108.569
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 108.569...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249986
...done!
maximalDeformation: 0.0947613
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60237
...done!
=======================
Good trial move (maximal deformation: 0.0947613, lambda: 108.569)
        Cost going from 59081.8 to 59081.7
        Decreasing lambda from 108.569 to 98.6991
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.261069
...done!
maximalDeformation: 0.100363
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61478
...done!
=======================
Good trial move (maximal deformation: 0.100363, lambda: 98.6991)
        Cost going from 59081.7 to 59081.6
        Decreasing lambda from 98.6991 to 89.7264
Starting EM: 
EM Iteration: 0  ->  58409.3
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58409.3
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 22 was 59085
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x9fef720)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 67159591
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55006
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197745
...done!
maximalDeformation: 6.62765
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -0.754208)
Time taken to rasterize Levenberg-Marquardt: 0.00829005
...done!
=======================
Bad trial move (maximal deformation: 6.62765, lambda: 1)
        Cost going from 59081.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190739
...done!
maximalDeformation: 4.22555
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 184458 has managed to turn bad (detJ: -0.0565447)
Time taken to rasterize Levenberg-Marquardt: 0.00776505
...done!
=======================
Bad trial move (maximal deformation: 4.22555, lambda: 2)
        Cost going from 59081.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186538
...done!
maximalDeformation: 2.52886
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1276717 has managed to turn bad (detJ: -1.11944)
Time taken to rasterize Levenberg-Marquardt: 0.253322
...done!
=======================
Bad trial move (maximal deformation: 2.52886, lambda: 4)
        Cost going from 59081.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184763
...done!
maximalDeformation: 1.42402
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2711552 has managed to turn bad (detJ: -0.0747033)
Time taken to rasterize Levenberg-Marquardt: 1.42553
...done!
=======================
Bad trial move (maximal deformation: 1.42402, lambda: 8)
        Cost going from 59081.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184192
...done!
maximalDeformation: 0.763867
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48605
...done!
=======================
Bad trial move (maximal deformation: 0.763867, lambda: 16)
        Cost going from 59081.6 to 59085.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195911
...done!
maximalDeformation: 0.398186
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5157
...done!
=======================
Bad trial move (maximal deformation: 0.398186, lambda: 32)
        Cost going from 59081.6 to 59082.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.2083
...done!
maximalDeformation: 0.2033
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53823
...done!
=======================
Bad trial move (maximal deformation: 0.2033, lambda: 64)
        Cost going from 59081.6 to 59081.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 64 to 128 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 128...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210329
...done!
maximalDeformation: 0.102779
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5471
...done!
=======================
Good trial move (maximal deformation: 0.102779, lambda: 128)
        Cost going from 59081.6 to 59081.5
        Decreasing lambda from 128 to 116.364
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 116.364...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209528
...done!
maximalDeformation: 0.121117
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54224
...done!
=======================
Good trial move (maximal deformation: 0.121117, lambda: 116.364)
        Cost going from 59081.5 to 59081.5
        Decreasing lambda from 116.364 to 105.785
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217175
...done!
maximalDeformation: 0.115447
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57477
...done!
=======================
Good trial move (maximal deformation: 0.115447, lambda: 105.785)
        Cost going from 59081.5 to 59081.4
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221703
...done!
maximalDeformation: 0.162444
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57087
...done!
=======================
Good trial move (maximal deformation: 0.162444, lambda: 96.1683)
        Cost going from 59081.4 to 59081.3
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23092
...done!
maximalDeformation: 0.122262
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59308
...done!
=======================
Good trial move (maximal deformation: 0.122262, lambda: 87.4257)
        Cost going from 59081.3 to 59081.3
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231809
...done!
maximalDeformation: 0.162329
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59356
...done!
=======================
Good trial move (maximal deformation: 0.162329, lambda: 79.4779)
        Cost going from 59081.3 to 59081.2
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242294
...done!
maximalDeformation: 0.155245
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60883
...done!
=======================
Good trial move (maximal deformation: 0.155245, lambda: 72.2527)
        Cost going from 59081.2 to 59081.1
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242523
...done!
maximalDeformation: 0.204462
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59933
...done!
=======================
Good trial move (maximal deformation: 0.204462, lambda: 65.6842)
        Cost going from 59081.1 to 59081.1
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251975
...done!
maximalDeformation: 0.137026
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61268
...done!
=======================
Good trial move (maximal deformation: 0.137026, lambda: 59.7129)
        Cost going from 59081.1 to 59080.9
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251751
...done!
maximalDeformation: 0.234123
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60645
...done!
=======================
Good trial move (maximal deformation: 0.234123, lambda: 54.2845)
        Cost going from 59080.9 to 59080.9
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.26059
...done!
maximalDeformation: 0.187528
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62732
...done!
=======================
Good trial move (maximal deformation: 0.187528, lambda: 49.3495)
        Cost going from 59080.9 to 59080.8
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  58406.7
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58406.7
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 23 was 59084.1
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xb8eda40)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 70288902
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56122
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19897
...done!
maximalDeformation: 5.61258
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 295220 has managed to turn bad (detJ: -0.0271345)
Time taken to rasterize Levenberg-Marquardt: 0.0144989
...done!
=======================
Bad trial move (maximal deformation: 5.61258, lambda: 1)
        Cost going from 59080.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208643
...done!
maximalDeformation: 3.56546
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 330248 has managed to turn bad (detJ: -0.0351396)
Time taken to rasterize Levenberg-Marquardt: 0.0180261
...done!
=======================
Bad trial move (maximal deformation: 3.56546, lambda: 2)
        Cost going from 59080.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.200393
...done!
maximalDeformation: 2.08154
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.0792897)
Time taken to rasterize Levenberg-Marquardt: 0.0373609
...done!
=======================
Bad trial move (maximal deformation: 2.08154, lambda: 4)
        Cost going from 59080.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186878
...done!
maximalDeformation: 1.14135
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1358066 has managed to turn bad (detJ: -0.537837)
Time taken to rasterize Levenberg-Marquardt: 0.288996
...done!
=======================
Bad trial move (maximal deformation: 1.14135, lambda: 8)
        Cost going from 59080.8 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185768
...done!
maximalDeformation: 0.598021
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49234
...done!
=======================
Bad trial move (maximal deformation: 0.598021, lambda: 16)
        Cost going from 59080.8 to 59086.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184307
...done!
maximalDeformation: 0.307798
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49325
...done!
=======================
Bad trial move (maximal deformation: 0.307798, lambda: 32)
        Cost going from 59080.8 to 59081.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184165
...done!
maximalDeformation: 0.158249
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48879
...done!
=======================
Good trial move (maximal deformation: 0.158249, lambda: 64)
        Cost going from 59080.8 to 59080.5
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20196
...done!
maximalDeformation: 0.181151
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53659
...done!
=======================
Good trial move (maximal deformation: 0.181151, lambda: 58.1818)
        Cost going from 59080.5 to 59080.3
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196464
...done!
maximalDeformation: 0.285492
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52053
...done!
=======================
Bad trial move (maximal deformation: 0.285492, lambda: 52.8926)
        Cost going from 59080.3 to 59080.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 52.8926 to 105.785 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195484
...done!
maximalDeformation: 0.14618
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5187
...done!
=======================
Good trial move (maximal deformation: 0.14618, lambda: 105.785)
        Cost going from 59080.3 to 59080.1
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211274
...done!
maximalDeformation: 0.0861431
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54971
...done!
=======================
Good trial move (maximal deformation: 0.0861431, lambda: 96.1683)
        Cost going from 59080.1 to 59080
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208224
...done!
maximalDeformation: 0.1331
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5428
...done!
=======================
Good trial move (maximal deformation: 0.1331, lambda: 87.4257)
        Cost going from 59080 to 59080
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223177
...done!
maximalDeformation: 0.184471
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57266
...done!
=======================
Good trial move (maximal deformation: 0.184471, lambda: 79.4779)
        Cost going from 59080 to 59079.9
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221463
...done!
maximalDeformation: 0.105907
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56618
...done!
=======================
Good trial move (maximal deformation: 0.105907, lambda: 72.2527)
        Cost going from 59079.9 to 59079.8
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237503
...done!
maximalDeformation: 0.141607
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59117
...done!
=======================
Good trial move (maximal deformation: 0.141607, lambda: 65.6842)
        Cost going from 59079.8 to 59079.7
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233781
...done!
maximalDeformation: 0.266827
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58821
...done!
=======================
Bad trial move (maximal deformation: 0.266827, lambda: 59.7129)
        Cost going from 59079.7 to 59079.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 59.7129 to 119.426 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 119.426...
Time taken to solve the Levenberg-Marquardt system of equations: 0.223851
...done!
maximalDeformation: 0.135327
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56743
...done!
=======================
Good trial move (maximal deformation: 0.135327, lambda: 119.426)
        Cost going from 59079.7 to 59079.5
        Decreasing lambda from 119.426 to 108.569
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 108.569...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244675
...done!
maximalDeformation: 0.0755809
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60387
...done!
=======================
Good trial move (maximal deformation: 0.0755809, lambda: 108.569)
        Cost going from 59079.5 to 59079.4
        Decreasing lambda from 108.569 to 98.6991
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235267
...done!
maximalDeformation: 0.167551
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59033
...done!
=======================
Good trial move (maximal deformation: 0.167551, lambda: 98.6991)
        Cost going from 59079.4 to 59079.4
        Decreasing lambda from 98.6991 to 89.7264
Starting EM: 
EM Iteration: 0  ->  58404.3
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58404.3
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 24 was 59082.7
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x8515ae0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 73611119
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55977
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20178
...done!
maximalDeformation: 3.87661
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 295040 has managed to turn bad (detJ: -0.739219)
Time taken to rasterize Levenberg-Marquardt: 0.01454
...done!
=======================
Bad trial move (maximal deformation: 3.87661, lambda: 1)
        Cost going from 59079.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196457
...done!
maximalDeformation: 2.42667
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 954743 has managed to turn bad (detJ: -0.210458)
Time taken to rasterize Levenberg-Marquardt: 0.142256
...done!
=======================
Bad trial move (maximal deformation: 2.42667, lambda: 2)
        Cost going from 59079.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19257
...done!
maximalDeformation: 1.4646
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1165345 has managed to turn bad (detJ: -0.0134212)
Time taken to rasterize Levenberg-Marquardt: 0.211921
...done!
=======================
Bad trial move (maximal deformation: 1.4646, lambda: 4)
        Cost going from 59079.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188129
...done!
maximalDeformation: 0.843107
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1519435 has managed to turn bad (detJ: -0.359412)
Time taken to rasterize Levenberg-Marquardt: 0.368672
...done!
=======================
Bad trial move (maximal deformation: 0.843107, lambda: 8)
        Cost going from 59079.4 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18672
...done!
maximalDeformation: 0.46195
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.4951
...done!
=======================
Bad trial move (maximal deformation: 0.46195, lambda: 16)
        Cost going from 59079.4 to 59084.1
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18635
...done!
maximalDeformation: 0.242366
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49039
...done!
=======================
Bad trial move (maximal deformation: 0.242366, lambda: 32)
        Cost going from 59079.4 to 59080.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.198854
...done!
maximalDeformation: 0.124504
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5181
...done!
=======================
Bad trial move (maximal deformation: 0.124504, lambda: 64)
        Cost going from 59079.4 to 59079.4
Transforming mesh
Done transforming mesh
        Increasing lambda from 64 to 128 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 128...
Time taken to solve the Levenberg-Marquardt system of equations: 0.234064
...done!
maximalDeformation: 0.0631527
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55817
...done!
=======================
Good trial move (maximal deformation: 0.0631527, lambda: 128)
        Cost going from 59079.4 to 59079.2
        Decreasing lambda from 128 to 116.364
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 116.364...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212859
...done!
maximalDeformation: 0.0963908
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54409
...done!
=======================
Good trial move (maximal deformation: 0.0963908, lambda: 116.364)
        Cost going from 59079.2 to 59079.2
        Decreasing lambda from 116.364 to 105.785
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22014
...done!
maximalDeformation: 0.105288
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57318
...done!
=======================
Good trial move (maximal deformation: 0.105288, lambda: 105.785)
        Cost going from 59079.2 to 59079.1
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224984
...done!
maximalDeformation: 0.126777
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57213
...done!
=======================
Good trial move (maximal deformation: 0.126777, lambda: 96.1683)
        Cost going from 59079.1 to 59079.1
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233519
...done!
maximalDeformation: 0.131992
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62071
...done!
=======================
Good trial move (maximal deformation: 0.131992, lambda: 87.4257)
        Cost going from 59079.1 to 59079
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23554
...done!
maximalDeformation: 0.136069
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58317
...done!
=======================
Good trial move (maximal deformation: 0.136069, lambda: 79.4779)
        Cost going from 59079 to 59078.9
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.285746
...done!
maximalDeformation: 0.157854
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60218
...done!
=======================
Good trial move (maximal deformation: 0.157854, lambda: 72.2527)
        Cost going from 59078.9 to 59078.9
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244738
...done!
maximalDeformation: 0.169401
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60125
...done!
=======================
Bad trial move (maximal deformation: 0.169401, lambda: 65.6842)
        Cost going from 59078.9 to 59078.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 65.6842 to 131.368 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 131.368...
Time taken to solve the Levenberg-Marquardt system of equations: 0.247642
...done!
maximalDeformation: 0.0857584
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58292
...done!
=======================
Good trial move (maximal deformation: 0.0857584, lambda: 131.368)
        Cost going from 59078.9 to 59078.7
        Decreasing lambda from 131.368 to 119.426
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 119.426...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.253349
...done!
maximalDeformation: 0.0682264
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60643
...done!
=======================
Good trial move (maximal deformation: 0.0682264, lambda: 119.426)
        Cost going from 59078.7 to 59078.6
        Decreasing lambda from 119.426 to 108.569
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 108.569...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.253263
...done!
maximalDeformation: 0.117778
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60841
...done!
=======================
Good trial move (maximal deformation: 0.117778, lambda: 108.569)
        Cost going from 59078.6 to 59078.5
        Decreasing lambda from 108.569 to 98.6991
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.255389
...done!
maximalDeformation: 0.0907033
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6111
...done!
=======================
Good trial move (maximal deformation: 0.0907033, lambda: 98.6991)
        Cost going from 59078.5 to 59078.5
        Decreasing lambda from 98.6991 to 89.7264
Starting EM: 
EM Iteration: 0  ->  58402.4
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58402.4
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 25 was 59081.8
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x9157670)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 76933336
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55377
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201135
...done!
maximalDeformation: 5.50241
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 330248 has managed to turn bad (detJ: -0.271778)
Time taken to rasterize Levenberg-Marquardt: 0.017695
...done!
=======================
Bad trial move (maximal deformation: 5.50241, lambda: 1)
        Cost going from 59078.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194434
...done!
maximalDeformation: 3.45437
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 623943 has managed to turn bad (detJ: -0.277459)
Time taken to rasterize Levenberg-Marquardt: 0.059262
...done!
=======================
Bad trial move (maximal deformation: 3.45437, lambda: 2)
        Cost going from 59078.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190885
...done!
maximalDeformation: 2.06496
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1182181 has managed to turn bad (detJ: -1.10577)
Time taken to rasterize Levenberg-Marquardt: 0.217476
...done!
=======================
Bad trial move (maximal deformation: 2.06496, lambda: 4)
        Cost going from 59078.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187449
...done!
maximalDeformation: 1.17199
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1182181 has managed to turn bad (detJ: -0.0885383)
Time taken to rasterize Levenberg-Marquardt: 0.218757
...done!
=======================
Bad trial move (maximal deformation: 1.17199, lambda: 8)
        Cost going from 59078.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187052
...done!
maximalDeformation: 0.632205
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.50284
...done!
=======================
Bad trial move (maximal deformation: 0.632205, lambda: 16)
        Cost going from 59078.5 to 59084.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184544
...done!
maximalDeformation: 0.330673
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49324
...done!
=======================
Bad trial move (maximal deformation: 0.330673, lambda: 32)
        Cost going from 59078.5 to 59079.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185198
...done!
maximalDeformation: 0.169199
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.4909
...done!
=======================
Bad trial move (maximal deformation: 0.169199, lambda: 64)
        Cost going from 59078.5 to 59078.6
Transforming mesh
Done transforming mesh
        Increasing lambda from 64 to 128 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 128...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185088
...done!
maximalDeformation: 0.0856372
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48462
...done!
=======================
Good trial move (maximal deformation: 0.0856372, lambda: 128)
        Cost going from 59078.5 to 59078.4
        Decreasing lambda from 128 to 116.364
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 116.364...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201809
...done!
maximalDeformation: 0.0856135
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5318
...done!
=======================
Good trial move (maximal deformation: 0.0856135, lambda: 116.364)
        Cost going from 59078.4 to 59078.3
        Decreasing lambda from 116.364 to 105.785
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196939
...done!
maximalDeformation: 0.1023
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.51755
...done!
=======================
Good trial move (maximal deformation: 0.1023, lambda: 105.785)
        Cost going from 59078.3 to 59078.3
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213198
...done!
maximalDeformation: 0.145472
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55321
...done!
=======================
Good trial move (maximal deformation: 0.145472, lambda: 96.1683)
        Cost going from 59078.3 to 59078.2
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210917
...done!
maximalDeformation: 0.102011
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55102
...done!
=======================
Good trial move (maximal deformation: 0.102011, lambda: 87.4257)
        Cost going from 59078.2 to 59078.2
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226046
...done!
maximalDeformation: 0.18434
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57591
...done!
=======================
Good trial move (maximal deformation: 0.18434, lambda: 79.4779)
        Cost going from 59078.2 to 59078.1
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224781
...done!
maximalDeformation: 0.132696
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6191
...done!
=======================
Good trial move (maximal deformation: 0.132696, lambda: 72.2527)
        Cost going from 59078.1 to 59078
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237839
...done!
maximalDeformation: 0.181639
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5947
...done!
=======================
Good trial move (maximal deformation: 0.181639, lambda: 65.6842)
        Cost going from 59078 to 59078
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236304
...done!
maximalDeformation: 0.170129
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59171
...done!
=======================
Good trial move (maximal deformation: 0.170129, lambda: 59.7129)
        Cost going from 59078 to 59077.8
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247777
...done!
maximalDeformation: 0.209075
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60392
...done!
=======================
Bad trial move (maximal deformation: 0.209075, lambda: 54.2845)
        Cost going from 59077.8 to 59077.8
Transforming mesh
Done transforming mesh
        Increasing lambda from 54.2845 to 108.569 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 108.569...
Time taken to solve the Levenberg-Marquardt system of equations: 0.24973
...done!
maximalDeformation: 0.105761
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59372
...done!
=======================
Good trial move (maximal deformation: 0.105761, lambda: 108.569)
        Cost going from 59077.8 to 59077.6
        Decreasing lambda from 108.569 to 98.6991
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245313
...done!
maximalDeformation: 0.108486
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59888
...done!
=======================
Good trial move (maximal deformation: 0.108486, lambda: 98.6991)
        Cost going from 59077.6 to 59077.5
        Decreasing lambda from 98.6991 to 89.7264
Starting EM: 
EM Iteration: 0  ->  58400.2
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58400.2
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 26 was 59080.8
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x5f15b70)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 80255553
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5537
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201769
...done!
maximalDeformation: 5.36909
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 295040 has managed to turn bad (detJ: -0.961786)
Time taken to rasterize Levenberg-Marquardt: 0.0146711
...done!
=======================
Bad trial move (maximal deformation: 5.36909, lambda: 1)
        Cost going from 59077.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210563
...done!
maximalDeformation: 3.39965
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 295040 has managed to turn bad (detJ: -0.0125641)
Time taken to rasterize Levenberg-Marquardt: 0.015424
...done!
=======================
Bad trial move (maximal deformation: 3.39965, lambda: 2)
        Cost going from 59077.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.200376
...done!
maximalDeformation: 2.06587
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 695534 has managed to turn bad (detJ: -0.799113)
Time taken to rasterize Levenberg-Marquardt: 0.0759811
...done!
=======================
Bad trial move (maximal deformation: 2.06587, lambda: 4)
        Cost going from 59077.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188311
...done!
maximalDeformation: 1.16872
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1519435 has managed to turn bad (detJ: -0.148109)
Time taken to rasterize Levenberg-Marquardt: 0.368436
...done!
=======================
Bad trial move (maximal deformation: 1.16872, lambda: 8)
        Cost going from 59077.5 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186251
...done!
maximalDeformation: 0.631224
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49978
...done!
=======================
Bad trial move (maximal deformation: 0.631224, lambda: 16)
        Cost going from 59077.5 to 59081.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186418
...done!
maximalDeformation: 0.327868
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.49466
...done!
=======================
Bad trial move (maximal deformation: 0.327868, lambda: 32)
        Cost going from 59077.5 to 59078.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.199687
...done!
maximalDeformation: 0.167427
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.52137
...done!
=======================
Bad trial move (maximal deformation: 0.167427, lambda: 64)
        Cost going from 59077.5 to 59077.5
Transforming mesh
Done transforming mesh
        Increasing lambda from 64 to 128 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 128...
Time taken to solve the Levenberg-Marquardt system of equations: 0.21091
...done!
maximalDeformation: 0.0846495
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54648
...done!
=======================
Good trial move (maximal deformation: 0.0846495, lambda: 128)
        Cost going from 59077.5 to 59077.4
        Decreasing lambda from 128 to 116.364
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 116.364...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211629
...done!
maximalDeformation: 0.0993238
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.54517
...done!
=======================
Good trial move (maximal deformation: 0.0993238, lambda: 116.364)
        Cost going from 59077.4 to 59077.4
        Decreasing lambda from 116.364 to 105.785
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218702
...done!
maximalDeformation: 0.0944042
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5693
...done!
=======================
Good trial move (maximal deformation: 0.0944042, lambda: 105.785)
        Cost going from 59077.4 to 59077.3
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223137
...done!
maximalDeformation: 0.0827438
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56816
...done!
=======================
Good trial move (maximal deformation: 0.0827438, lambda: 96.1683)
        Cost going from 59077.3 to 59077.2
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232316
...done!
maximalDeformation: 0.145383
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61695
...done!
=======================
Good trial move (maximal deformation: 0.145383, lambda: 87.4257)
        Cost going from 59077.2 to 59077.2
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233631
...done!
maximalDeformation: 0.118069
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58627
...done!
=======================
Good trial move (maximal deformation: 0.118069, lambda: 79.4779)
        Cost going from 59077.2 to 59077.1
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244022
...done!
maximalDeformation: 0.16644
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60715
...done!
=======================
Good trial move (maximal deformation: 0.16644, lambda: 72.2527)
        Cost going from 59077.1 to 59077.1
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244714
...done!
maximalDeformation: 0.112673
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59553
...done!
=======================
Good trial move (maximal deformation: 0.112673, lambda: 65.6842)
        Cost going from 59077.1 to 59076.9
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.253568
...done!
maximalDeformation: 0.196674
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61687
...done!
=======================
Bad trial move (maximal deformation: 0.196674, lambda: 59.7129)
        Cost going from 59076.9 to 59076.9
Transforming mesh
Done transforming mesh
        Increasing lambda from 59.7129 to 119.426 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 119.426...
Time taken to solve the Levenberg-Marquardt system of equations: 0.256236
...done!
maximalDeformation: 0.0993989
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60429
...done!
=======================
Good trial move (maximal deformation: 0.0993989, lambda: 119.426)
        Cost going from 59076.9 to 59076.7
        Decreasing lambda from 119.426 to 108.569
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 108.569...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.252854
...done!
maximalDeformation: 0.0931716
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60775
...done!
=======================
Good trial move (maximal deformation: 0.0931716, lambda: 108.569)
        Cost going from 59076.7 to 59076.6
        Decreasing lambda from 108.569 to 98.6991
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.262593
...done!
maximalDeformation: 0.114553
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62729
...done!
=======================
Good trial move (maximal deformation: 0.114553, lambda: 98.6991)
        Cost going from 59076.6 to 59076.6
        Decreasing lambda from 98.6991 to 89.7264
Starting EM: 
EM Iteration: 0  ->  58398.2
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58398.2
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 27 was 59079.9
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1748ad0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 389
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x9c7ad30)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 83577770
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.384956 0.00659683 0.0251382 
    0.00742307 0.391672 0.179354 
    -0.000452849 -0.161151 0.369642 
  Offset: [4.30132, 5.33048, 17.5004]
  Center: [0, 0, 0]
  Translation: [4.30132, 5.33048, 17.5004]
  Inverse: 
    2.59942 -0.0971257 -0.129652 
    -0.0422822 2.12985 -1.03055 
    -0.0152491 0.928421 2.25588 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55639
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198652
...done!
maximalDeformation: 4.62326
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 286608 has managed to turn bad (detJ: -0.0535716)
Time taken to rasterize Levenberg-Marquardt: 0.0138021
...done!
=======================
Bad trial move (maximal deformation: 4.62326, lambda: 1)
        Cost going from 59076.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.207215
...done!
maximalDeformation: 2.70769
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 492897 has managed to turn bad (detJ: -0.0225258)
Time taken to rasterize Levenberg-Marquardt: 0.0381858
...done!
=======================
Bad trial move (maximal deformation: 2.70769, lambda: 2)
        Cost going from 59076.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.21137
...done!
maximalDeformation: 1.50047
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 853114 has managed to turn bad (detJ: -0.653781)
Time taken to rasterize Levenberg-Marquardt: 0.118822
...done!
=======================
Bad trial move (maximal deformation: 1.50047, lambda: 4)
        Cost going from 59076.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.211155
...done!
maximalDeformation: 0.804665
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2489292 has managed to turn bad (detJ: -0.300129)
Time taken to rasterize Levenberg-Marquardt: 1.16973
...done!
=======================
Bad trial move (maximal deformation: 0.804665, lambda: 8)
        Cost going from 59076.6 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.197494
...done!
maximalDeformation: 0.419742
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5123
...done!
=======================
Bad trial move (maximal deformation: 0.419742, lambda: 16)
        Cost going from 59076.6 to 59080
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184091
...done!
maximalDeformation: 0.215328
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48887
...done!
=======================
Bad trial move (maximal deformation: 0.215328, lambda: 32)
        Cost going from 59076.6 to 59077.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184051
...done!
maximalDeformation: 0.109108
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.48721
...done!
=======================
Good trial move (maximal deformation: 0.109108, lambda: 64)
        Cost going from 59076.6 to 59076.6
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2016
...done!
maximalDeformation: 0.217511
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53542
...done!
=======================
Bad trial move (maximal deformation: 0.217511, lambda: 58.1818)
        Cost going from 59076.6 to 59076.7
Transforming mesh
Done transforming mesh
        Increasing lambda from 58.1818 to 116.364 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 116.364...
Time taken to solve the Levenberg-Marquardt system of equations: 0.207852
...done!
maximalDeformation: 0.110543
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5398
...done!
=======================
Bad trial move (maximal deformation: 0.110543, lambda: 116.364)
        Cost going from 59076.6 to 59077.3
Transforming mesh
Done transforming mesh
        Increasing lambda from 116.364 to 232.727 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 232.727...
Time taken to solve the Levenberg-Marquardt system of equations: 0.21678
...done!
maximalDeformation: 0.0557365
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55791
...done!
=======================
Good trial move (maximal deformation: 0.0557365, lambda: 232.727)
        Cost going from 59076.6 to 59076.4
        Decreasing lambda from 232.727 to 211.57
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 211.57...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200049
...done!
maximalDeformation: 0.10456
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.53887
...done!
=======================
Good trial move (maximal deformation: 0.10456, lambda: 211.57)
        Cost going from 59076.4 to 59076.4
        Decreasing lambda from 211.57 to 192.337
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 192.337...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226812
...done!
maximalDeformation: 0.0587346
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58441
...done!
=======================
Bad trial move (maximal deformation: 0.0587346, lambda: 192.337)
        Cost going from 59076.4 to 59077.2
Transforming mesh
Done transforming mesh
        Increasing lambda from 192.337 to 384.673 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 384.673...
Time taken to solve the Levenberg-Marquardt system of equations: 0.217917
...done!
maximalDeformation: 0.0293854
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56274
...done!
=======================
Good trial move (maximal deformation: 0.0293854, lambda: 384.673)
        Cost going from 59076.4 to 59076.3
        Decreasing lambda from 384.673 to 349.703
        maximalDeformation is too small; stopping
Starting EM: 
EM Iteration: 0  ->  58397.8
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  255 1 ]
EM Iteration: 1  ->  58397.8
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 28 was 59079.6
============================================
Converged!
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
numberOfBasisFunctions: 1
numberOfVoxelsInMask: 249600
indexWhereUnityIsReached [49, 63, 77]
Successfully put up x, y, and z
Constructing basis functions
      (xOrder, yOrder, zOrder): (0, 0, 0)
Transforming points
Transforming points
Mapping warped mesh back to original space
Transforming points
Abusing EM segmenter now...
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
Original class 2 is distributed over 1 classes
Original class 3 is distributed over 1 classes
Original class 4 is distributed over 1 classes
Original class 5 is distributed over 1 classes
Original class 6 is distributed over 1 classes
Original class 7 is distributed over 1 classes
Original class 8 is distributed over 1 classes
Original class 9 is distributed over 1 classes
Original class 10 is distributed over 1 classes
OK
myAbusedEMSegmenter->GetMeans(): [ 1 1 1 255 255 255 255 255 255 255 255]
myAbusedEMSegmenter->GetVariances(): [ 1 1 1 1 1 1 1 1 1 1 1]
myAbusedEMSegmenter->GetPriorWeights(): [ 1 1 1 1 1 1 1 1 1 1 1]
-- Starting
-- Initializing
-- Doing the rest
-- Starting to update posteriors
-- done
Still here...
Splitting affine matrix up into spacing, origin, and direction components
AffineTransform (0x8c95790)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 86426473
  Debug: Off
  Observers: 
    none
  Matrix: 
    -1 -5.96046e-08 0 
    0 0 1 
    5.96046e-08 -1 0 
  Offset: [47.5002, -14.3535, 12.6074]
  Center: [0, 0, 0]
  Translation: [47.5002, -14.3535, 12.6074]
  Inverse: 
    -1 0 5.96046e-08 
    -5.96046e-08 0 -1 
    0 1 0 
  Singular: 0
spacing: [1, 1, 1]
origin: [47.5002, -14.3535, 12.6074]
direction: -1 -5.96046e-08 0
0 0 1
5.96046e-08 -1 0

done!
kvlBinaryThresholdImage aseg.mgz 53
imageFileName: aseg.mgz
lowerThreshold: 53
upperThreshold: 53
insideValue: 255
outsideValue: 0
Thresholding: 
  0%
  0.999975%
  1.99995%
  2.99993%
  3.9999%
  4.99988%
  5.99985%
  6.99983%
  7.9998%
  8.99978%
  9.99975%
  10.9997%
  11.9997%
  12.9997%
  13.9997%
  14.9996%
  15.9996%
  16.9996%
  17.9996%
  18.9995%
  19.9995%
  20.9995%
  21.9995%
  22.9994%
  23.9994%
  24.9994%
  25.9994%
  26.9993%
  27.9993%
  28.9993%
  29.9993%
  30.9992%
  31.9992%
  32.9992%
  33.9992%
  34.9991%
  35.9991%
  36.9991%
  37.9991%
  38.999%
  39.999%
  40.999%
  41.999%
  42.9989%
  43.9989%
  44.9989%
  45.9989%
  46.9988%
  47.9988%
  48.9988%
  49.9988%
  50.9987%
  51.9987%
  52.9987%
  53.9987%
  54.9986%
  55.9986%
  56.9986%
  57.9986%
  58.9985%
  59.9985%
  60.9985%
  61.9985%
  62.9984%
  63.9984%
  64.9984%
  65.9984%
  66.9983%
  67.9983%
  68.9983%
  69.9983%
  70.9982%
  71.9982%
  72.9982%
  73.9982%
  74.9981%
  75.9981%
  76.9981%
  77.9981%
  78.998%
  79.998%
  80.998%
  81.998%
  82.9979%
  83.9979%
  84.9979%
  85.9979%
  86.9978%
  87.9978%
  88.9978%
  89.9978%
  90.9977%
  91.9977%
  92.9977%
  93.9977%
  94.9976%
  95.9976%
  96.9976%
  97.9976%
  98.9975%
  99.9975%
  100%
  100%
Wrote out aseg_thresholded.mgz
kvlMathematicalMorphology aseg_thresholded.mgz dilate 3
imageFileName: aseg_thresholded.mgz
radius: 3
Using dilating filter
dilate: 
  0%
  0.999999%
  2%
  3%
  4%
  5%
  5.99999%
  6.99999%
  7.99999%
  8.99999%
  9.99999%
  11%
  12%
  13%
  14%
  15%
  16%
  17%
  18%
  19%
  20%
  21%
  22%
  23%
  24%
  25%
  26%
  27%
  28%
  29%
  30%
  31%
  32%
  33%
  34%
  35%
  36%
  37%
  38%
  39%
  40%
  41%
  42%
  43%
  44%
  45%
  46%
  47%
  48%
  49%
  50%
  51%
  52%
  53%
  53.9999%
  55%
  56%
  57%
  58%
  59%
  60%
  60.9999%
  61.9999%
  62.9999%
  63.9999%
  64.9999%
  65.9999%
  66.9999%
  67.9999%
  68.9999%
  69.9999%
  70.9999%
  71.9999%
  72.9999%
  73.9999%
  74.9999%
  75.9999%
  76.9999%
  77.9999%
  78.9999%
  79.9999%
  80.9999%
  81.9999%
  82.9999%
  83.9999%
  84.9999%
  85.9999%
  86.9999%
  87.9999%
  88.9999%
  89.9999%
  90.9999%
  91.9999%
  92.9999%
  93.9999%
  94.9999%
  95.9999%
  96.9999%
  97.9999%
  98.9999%
  99.9999%
  100%

Wrote output to aseg_thresholded_dilate_radius3.mgz
kvlMaskImage nu.mgz aseg_thresholded_dilate_radius3.mgz
Masking: 
  0%
  0.999975%
  1.99995%
  2.99993%
  3.9999%
  4.99988%
  5.99985%
  6.99983%
  7.9998%
  8.99978%
  9.99975%
  10.9997%
  11.9997%
  12.9997%
  13.9997%
  14.9996%
  15.9996%
  16.9996%
  17.9996%
  18.9995%
  19.9995%
  20.9995%
  21.9995%
  22.9994%
  23.9994%
  24.9994%
  25.9994%
  26.9993%
  27.9993%
  28.9993%
  29.9993%
  30.9992%
  31.9992%
  32.9992%
  33.9992%
  34.9991%
  35.9991%
  36.9991%
  37.9991%
  38.999%
  39.999%
  40.999%
  41.999%
  42.9989%
  43.9989%
  44.9989%
  45.9989%
  46.9988%
  47.9988%
  48.9988%
  49.9988%
  50.9987%
  51.9987%
  52.9987%
  53.9987%
  54.9986%
  55.9986%
  56.9986%
  57.9986%
  58.9985%
  59.9985%
  60.9985%
  61.9985%
  62.9984%
  63.9984%
  64.9984%
  65.9984%
  66.9983%
  67.9983%
  68.9983%
  69.9983%
  70.9982%
  71.9982%
  72.9982%
  73.9982%
  74.9981%
  75.9981%
  76.9981%
  77.9981%
  78.998%
  79.998%
  80.998%
  81.998%
  82.9979%
  83.9979%
  84.9979%
  85.9979%
  86.9978%
  87.9978%
  88.9978%
  89.9978%
  90.9977%
  91.9977%
  92.9977%
  93.9977%
  94.9976%
  95.9976%
  96.9976%
  97.9976%
  98.9975%
  99.9975%
  100%
  100%
Wrote masked image to file nu_masked.mgz
Using nu_masked.mgz
kvlUpsample nu_masked.mgz 2 2 2
inputImage: nu_masked.mgz
upsamplingFactorX: 2
upsamplingFactorY: 2
upsamplingFactorZ: 2
Resampling: 
  0%
  0.999999%
  2%
  3%
  4%
  5%
  5.99999%
  6.99999%
  7.99999%
  8.99999%
  9.99999%
  11%
  12%
  13%
  14%
  15%
  16%
  17%
  18%
  19%
  20%
  21%
  22%
  23%
  24%
  25%
  26%
  27%
  28%
  29%
  30%
  31%
  32%
  33%
  34%
  35%
  36%
  37%
  38%
  39%
  40%
  41%
  42%
  43%
  44%
  45%
  46%
  47%
  48%
  49%
  50%
  51%
  52%
  53%
  53.9999%
  54.9999%
  55.9999%
  56.9999%
  57.9999%
  58.9999%
  59.9999%
  60.9999%
  61.9999%
  62.9999%
  63.9999%
  64.9999%
  65.9999%
  66.9999%
  67.9999%
  68.9999%
  69.9999%
  70.9999%
  71.9999%
  72.9999%
  73.9999%
  74.9999%
  75.9999%
  76.9999%
  77.9999%
  78.9999%
  79.9999%
  80.9999%
  81.9999%
  82.9999%
  83.9999%
  84.9999%
  85.9999%
  86.9999%
  87.9999%
  88.9999%
  89.9999%
  90.9999%
  91.9999%
  92.9999%
  93.9999%
  94.9999%
  95.9999%
  96.9999%
  97.9999%
  98.9999%
  99.9999%
  100%
  100%
Wrote to file nu_masked_upsampled_2_2_2.mgz
echo \# Configuration without partial voluming > configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo logDirectory: segmentationWithoutPartialVolumingLog >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo imageFileName: nu_masked_upsampled_2_2_2.mgz >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo meshCollectionFileName: deformableRegistrationLog/warpedOriginalMesh.txt.gz >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo startingMeshNumber: 0 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo K: 0.01 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo compressionLookupTableFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/compressionLookupTable.txt >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo boundingFileName: imageDump_coregistered.mgz >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo sameGaussianParameters: 41 503 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo sameGaussianParameters: 42 53 500 502 504 506 507 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo sameGaussianParameters: 24 505 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo imageSmoothingSigmas: 0 0 0 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
echo meshSmoothingSigmas: 1 0.5 0 >> configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
kvlSegmentWithoutGUI configurationFileSegmentationWithoutPartialVolumingButAfterUpsampling.txt
m_LogDirectory: segmentationWithoutPartialVolumingLog
m_ImageFileName: nu_masked_upsampled_2_2_2.mgz
m_MeshCollectionFileName: deformableRegistrationLog/warpedOriginalMesh.txt.gz
m_StartingMeshNumber: 0
m_K: 0.01
m_CompressionLookupTableFileName: /nrgpackages/tools/freesurfer53-patch/data/GEMS/compressionLookupTable.txt
m_BoundingFileName: imageDump_coregistered.mgz
m_SameGaussianParameters[ 0 ]:  41 503
m_SameGaussianParameters[ 1 ]:  42 53 500 502 504 506 507
m_SameGaussianParameters[ 2 ]:  24 505
m_ImageSmoothingSigmas:  0 0 0
m_MeshSmoothingSigmas:  1 0.5 0
Having m_LogDirectorysegmentationWithoutPartialVolumingLog/
Having downSamplingFactor of 1
Constructing image-to-world transform from MGH header information (nu_masked_upsampled_2_2_2.mgz)
Returning the following transform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 226
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.5 6.51926e-09 0 
    0 0 0.5 
    2.98023e-08 -0.5 0 
  Offset: [127.75, -86.6035, 119.857]
  Center: [0, 0, 0]
  Translation: [127.75, -86.6035, 119.857]
  Inverse: 
    -2 0 1.19209e-07 
    -1.19209e-07 0 -2 
    0 2 0 
  Singular: 0
Constructing image-to-world transform from MGH header information (imageDump_coregistered.mgz)
Returning the following transform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 246
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.384956 -0.00659685 -0.0251382 
    -0.000452849 -0.161151 0.369642 
    -0.00742305 -0.391672 -0.179354 
  Offset: [43.1989, 3.14684, 7.27695]
  Center: [0, 0, 0]
  Translation: [43.1989, 3.14684, 7.27695]
  Inverse: 
    -2.59942 -0.129652 0.0971261 
    0.0422822 -1.03055 -2.12985 
    0.0152496 2.25588 -0.928422 
  Singular: 0
Transform before cropping: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 248
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [169.103, 225.161, 179.501]
  Center: [0, 0, 0]
  Translation: [169.103, 225.161, 179.501]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
WorldToImageTransform before cropping: 
AffineTransform (0x1c85570)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 250
  Debug: Off
  Observers: 
    none
  Matrix: 
    -2 0 1.19209e-07 
    -1.19209e-07 0 -2 
    0 2 0 
  Offset: [255.5, 239.715, 173.207]
  Center: [0, 0, 0]
  Translation: [255.5, 239.715, 173.207]
  Inverse: 
    -0.5 -2.98023e-08 0 
    0 0 0.5 
    2.98023e-08 -0.5 0 
  Singular: 0
 m_BoundingBoxSize: [94, 66,144]
 minimalMappedCoordinate: [169.103, 225.161,158.467]
 maximalMappedCoordinate: [248.752, 328.754,285.218]
Cropping with min [161  215  146]
          and max [257  339  298]
m_OriginalImageRegion before checking margins: ImageRegion (0x1c851c0)
  Dimension: 3
  Index: [161, 215, 146]
  Size: [97, 125, 153]

m_CroppedImageRegion before checking margins: ImageRegion (0x1c85188)
  Dimension: 3
  Index: [0, 0, 0]
  Size: [97, 125, 153]


m_OriginalImageRegion after checking margins: ImageRegion (0x1c851c0)
  Dimension: 3
  Index: [161, 215, 146]
  Size: [97, 125, 153]

m_CroppedImageRegion after checking margins: ImageRegion (0x1c85188)
  Dimension: 3
  Index: [0, 0, 0]
  Size: [97, 125, 153]

Transform after cropping: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
WorldToImageTransform after cropping: 
AffineTransform (0x1c85570)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 392
  Debug: Off
  Observers: 
    none
  Matrix: 
    -2 0 1.19209e-07 
    -1.19209e-07 0 -2 
    0 2 0 
  Offset: [94.5004, 24.7149, 27.207]
  Center: [0, 0, 0]
  Translation: [94.5004, 24.7149, 27.207]
  Inverse: 
    -0.5 -2.98023e-08 0 
    0 0 0.5 
    2.98023e-08 -0.5 0 
  Singular: 0
Setting K of mesh collection to: 0.01
Applying transform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Transforming points
Transforming points
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 0
maximum: 182
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
Original class 2 is distributed over 1 classes
Original class 3 is distributed over 1 classes
Original class 4 is distributed over 1 classes
Original class 5 is distributed over 1 classes
Original class 6 is distributed over 1 classes
Original class 7 is distributed over 1 classes
Original class 8 is distributed over 1 classes
Original class 9 is distributed over 1 classes
Original class 10 is distributed over 1 classes
OK
Setting coregisterToPosteriorProbabilities to 0
Setting biasFieldOrder to 0
Building labels...
...done! (m_Labels.size(): 11)
m_InternalToExternalLookupTable: 
    0  -> 2 (CSF)
    1  -> 0 (Right-Cerebral-White-Matter)
    2  -> 1 (Right-Cerebral-Cortex)
    3  -> 3 (Right-Hippocampus)
    4  -> 5 (right_CA2_3)
    5  -> 9 (right_CA1)
    6  -> 4 (right_fimbria)
    7  -> 7 (right_presubiculum)
    8  -> 10 (right_hippocampal_fissure)
    9  -> 6 (right_CA4_DG)
    10  -> 8 (right_subiculum)
m_InternalToReducedLookupTable: 
     0 (CSF) -> 2
     1 (Right-Cerebral-White-Matter) -> 0
     2 (Right-Cerebral-Cortex) -> 1
     3 (Right-Hippocampus) -> 1
     4 (right_CA2_3) -> 1
     5 (right_CA1) -> 1
     6 (right_fimbria) -> 0
     7 (right_presubiculum) -> 1
     8 (right_hippocampal_fissure) -> 2
     9 (right_CA4_DG) -> 1
     10 (right_subiculum) -> 1
original label 0 is distributed over 1 distributed labels
original label 1 is distributed over 1 distributed labels
original label 2 is distributed over 1 distributed labels
original label 3 is distributed over 1 distributed labels
original label 4 is distributed over 1 distributed labels
original label 5 is distributed over 1 distributed labels
original label 6 is distributed over 1 distributed labels
original label 7 is distributed over 1 distributed labels
original label 8 is distributed over 1 distributed labels
original label 9 is distributed over 1 distributed labels
original label 10 is distributed over 1 distributed labels
numberOfReducedLabels: 3
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
Original class 2 is distributed over 1 classes
OK
Smoothing mesh collection...done!
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 0
maximum: 182
Running for smoothing sigma 1
Starting EM: 
Updating mixture model parameters
Readjusting weight of shared classes
m_Means: [  100.314 81.2737 63.2245 ]
Splitting shared classes
EM Iteration: 0  ->  578793
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
Setting up m_BiasFieldResidueSmoother
Initalizing
numberOfBasisFunctions: 1
numberOfVoxelsInMask: 132880
indexWhereUnityIsReached [96, 124, 152]
Successfully put up x, y, and z
Constructing basis functions
      (xOrder, yOrder, zOrder): (0, 0, 0)
done!
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  104.675 81.3039 56.3545 ]
EM Iteration: 1  ->  567103
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  106.515 81.1399 53.8098 ]
EM Iteration: 2  ->  562937
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.465 81.0584 52.7689 ]
EM Iteration: 3  ->  561721
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  107.948 81.0702 52.2719 ]
EM Iteration: 4  ->  561389
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.19 81.1064 52.0191 ]
EM Iteration: 5  ->  561299
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.314 81.1379 51.8837 ]
EM Iteration: 6  ->  561275
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.38 81.1598 51.8096 ]
EM Iteration: 7  ->  561269
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.413 81.1729 51.7682 ]
EM Iteration: 8  ->  561267
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.429 81.1807 51.7453 ]
EM Iteration: 9  ->  561267
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.439 81.1862 51.7338 ]
EM Iteration: 10  ->  561267
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 10
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 0 was 566722
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x7d5a820)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 1241397
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61751
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214914
...done!
maximalDeformation: 14.8327
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 160560 has managed to turn bad (detJ: -0.900542)
Time taken to rasterize Levenberg-Marquardt: 0.00681305
...done!
=======================
Bad trial move (maximal deformation: 14.8327, lambda: 1)
        Cost going from 565490 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181381
...done!
maximalDeformation: 9.68772
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 160560 has managed to turn bad (detJ: -0.176637)
Time taken to rasterize Levenberg-Marquardt: 0.00670385
...done!
=======================
Bad trial move (maximal deformation: 9.68772, lambda: 2)
        Cost going from 565490 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.176178
...done!
maximalDeformation: 5.83704
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 381015 has managed to turn bad (detJ: -0.153932)
Time taken to rasterize Levenberg-Marquardt: 0.022018
...done!
=======================
Bad trial move (maximal deformation: 5.83704, lambda: 4)
        Cost going from 565490 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.173744
...done!
maximalDeformation: 3.29816
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1468842 has managed to turn bad (detJ: -0.66172)
Time taken to rasterize Levenberg-Marquardt: 0.367497
...done!
=======================
Bad trial move (maximal deformation: 3.29816, lambda: 8)
        Cost going from 565490 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.173369
...done!
maximalDeformation: 1.77908
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62765
...done!
=======================
Good trial move (maximal deformation: 1.77908, lambda: 16)
        Cost going from 565490 to 562800
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.174438
...done!
maximalDeformation: 0.814204
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62207
...done!
=======================
Good trial move (maximal deformation: 0.814204, lambda: 14.5455)
        Cost going from 562800 to 560401
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193225
...done!
maximalDeformation: 0.773304
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66715
...done!
=======================
Good trial move (maximal deformation: 0.773304, lambda: 13.2231)
        Cost going from 560401 to 558212
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195117
...done!
maximalDeformation: 0.851627
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67
...done!
=======================
Good trial move (maximal deformation: 0.851627, lambda: 12.021)
        Cost going from 558212 to 556174
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212741
...done!
maximalDeformation: 1.86689
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68099
...done!
=======================
Good trial move (maximal deformation: 1.86689, lambda: 10.9282)
        Cost going from 556174 to 554260
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209283
...done!
maximalDeformation: 1.3433
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69493
...done!
=======================
Good trial move (maximal deformation: 1.3433, lambda: 9.93474)
        Cost going from 554260 to 552445
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21767
...done!
maximalDeformation: 1.20639
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.689
...done!
=======================
Good trial move (maximal deformation: 1.20639, lambda: 9.03158)
        Cost going from 552445 to 550723
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219432
...done!
maximalDeformation: 1.07556
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72162
...done!
=======================
Good trial move (maximal deformation: 1.07556, lambda: 8.21053)
        Cost going from 550723 to 549111
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222319
...done!
maximalDeformation: 1.25051
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72347
...done!
=======================
Good trial move (maximal deformation: 1.25051, lambda: 7.46412)
        Cost going from 549111 to 547604
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228014
...done!
maximalDeformation: 1.08764
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.729
...done!
=======================
Good trial move (maximal deformation: 1.08764, lambda: 6.78556)
        Cost going from 547604 to 546180
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239544
...done!
maximalDeformation: 1.24541
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77599
...done!
=======================
Good trial move (maximal deformation: 1.24541, lambda: 6.16869)
        Cost going from 546180 to 544847
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  541115
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.54 80.6661 50.1512 ]
EM Iteration: 1  ->  539814
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.612 80.6285 49.4401 ]
EM Iteration: 2  ->  539611
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.645 80.6441 49.1387 ]
EM Iteration: 3  ->  539579
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.661 80.6587 49.0019 ]
EM Iteration: 4  ->  539574
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.669 80.6677 48.9375 ]
EM Iteration: 5  ->  539573
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.672 80.6722 48.9082 ]
EM Iteration: 6  ->  539573
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 6
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 1 was 544189
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x115509c0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 3792102
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64583
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194088
...done!
maximalDeformation: 2.71707
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 728557 has managed to turn bad (detJ: -0.0949045)
Time taken to rasterize Levenberg-Marquardt: 0.0879359
...done!
=======================
Bad trial move (maximal deformation: 2.71707, lambda: 1)
        Cost going from 542984 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190181
...done!
maximalDeformation: 1.78404
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 761148 has managed to turn bad (detJ: -0.295031)
Time taken to rasterize Levenberg-Marquardt: 0.095104
...done!
=======================
Bad trial move (maximal deformation: 1.78404, lambda: 2)
        Cost going from 542984 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183641
...done!
maximalDeformation: 1.23002
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1159999 has managed to turn bad (detJ: -0.120955)
Time taken to rasterize Levenberg-Marquardt: 0.224321
...done!
=======================
Bad trial move (maximal deformation: 1.23002, lambda: 4)
        Cost going from 542984 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182056
...done!
maximalDeformation: 0.773703
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62092
...done!
=======================
Good trial move (maximal deformation: 0.773703, lambda: 8)
        Cost going from 542984 to 541850
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200266
...done!
maximalDeformation: 1.28487
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67601
...done!
=======================
Good trial move (maximal deformation: 1.28487, lambda: 7.27273)
        Cost going from 541850 to 540827
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199476
...done!
maximalDeformation: 1.32241
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67568
...done!
=======================
Good trial move (maximal deformation: 1.32241, lambda: 6.61157)
        Cost going from 540827 to 539840
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215312
...done!
maximalDeformation: 1.21339
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71645
...done!
=======================
Good trial move (maximal deformation: 1.21339, lambda: 6.01052)
        Cost going from 539840 to 538890
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214506
...done!
maximalDeformation: 1.38039
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1197453 has managed to turn bad (detJ: -0.0729912)
Time taken to rasterize Levenberg-Marquardt: 0.256755
...done!
=======================
Bad trial move (maximal deformation: 1.38039, lambda: 5.46411)
        Cost going from 538890 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 5.46411 to 10.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.200961
...done!
maximalDeformation: 0.767324
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67383
...done!
=======================
Good trial move (maximal deformation: 0.767324, lambda: 10.9282)
        Cost going from 538890 to 538305
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228126
...done!
maximalDeformation: 1.14331
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71979
...done!
=======================
Good trial move (maximal deformation: 1.14331, lambda: 9.93474)
        Cost going from 538305 to 537765
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214949
...done!
maximalDeformation: 0.940185
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71103
...done!
=======================
Good trial move (maximal deformation: 0.940185, lambda: 9.03158)
        Cost going from 537765 to 537231
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243108
...done!
maximalDeformation: 0.878121
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74892
...done!
=======================
Good trial move (maximal deformation: 0.878121, lambda: 8.21053)
        Cost going from 537231 to 536680
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229245
...done!
maximalDeformation: 1.11201
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74127
...done!
=======================
Good trial move (maximal deformation: 1.11201, lambda: 7.46412)
        Cost going from 536680 to 536150
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.259623
...done!
maximalDeformation: 1.6991
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76921
...done!
=======================
Good trial move (maximal deformation: 1.6991, lambda: 6.78556)
        Cost going from 536150 to 535603
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245301
...done!
maximalDeformation: 1.06171
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77195
...done!
=======================
Good trial move (maximal deformation: 1.06171, lambda: 6.16869)
        Cost going from 535603 to 535051
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  531273
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.621 80.5332 48.5576 ]
EM Iteration: 1  ->  531111
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.601 80.5125 48.39 ]
EM Iteration: 2  ->  531093
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.591 80.5086 48.3145 ]
EM Iteration: 3  ->  531091
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.587 80.5066 48.2782 ]
EM Iteration: 4  ->  531091
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.587 80.5062 48.2589 ]
EM Iteration: 5  ->  531091
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 5
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 2 was 535906
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc5c7470)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 6342787
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68395
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201373
...done!
maximalDeformation: 4.23938
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 394905 has managed to turn bad (detJ: -0.176646)
Time taken to rasterize Levenberg-Marquardt: 0.02529
...done!
=======================
Bad trial move (maximal deformation: 4.23938, lambda: 1)
        Cost going from 534753 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.197076
...done!
maximalDeformation: 3.13207
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 753110 has managed to turn bad (detJ: -0.00112415)
Time taken to rasterize Levenberg-Marquardt: 0.09445
...done!
=======================
Bad trial move (maximal deformation: 3.13207, lambda: 2)
        Cost going from 534753 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.205892
...done!
maximalDeformation: 2.11092
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66783
...done!
=======================
Good trial move (maximal deformation: 2.11092, lambda: 4)
        Cost going from 534753 to 534166
        Decreasing lambda from 4 to 3.63636
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 3.63636...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217337
...done!
maximalDeformation: 2.02152
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1057157 has managed to turn bad (detJ: -0.0311734)
Time taken to rasterize Levenberg-Marquardt: 0.197151
...done!
=======================
Bad trial move (maximal deformation: 2.02152, lambda: 3.63636)
        Cost going from 534166 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 3.63636 to 7.27273 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Time taken to solve the Levenberg-Marquardt system of equations: 0.217459
...done!
maximalDeformation: 1.14082
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68273
...done!
=======================
Good trial move (maximal deformation: 1.14082, lambda: 7.27273)
        Cost going from 534166 to 533610
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219159
...done!
maximalDeformation: 1.19785
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7023
...done!
=======================
Good trial move (maximal deformation: 1.19785, lambda: 6.61157)
        Cost going from 533610 to 533145
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231205
...done!
maximalDeformation: 0.80812
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71639
...done!
=======================
Good trial move (maximal deformation: 0.80812, lambda: 6.01052)
        Cost going from 533145 to 532746
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224897
...done!
maximalDeformation: 1.28099
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 745736 has managed to turn bad (detJ: -0.0302515)
Time taken to rasterize Levenberg-Marquardt: 0.098994
...done!
=======================
Bad trial move (maximal deformation: 1.28099, lambda: 5.46411)
        Cost going from 532746 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 5.46411 to 10.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.209203
...done!
maximalDeformation: 0.689766
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67581
...done!
=======================
Good trial move (maximal deformation: 0.689766, lambda: 10.9282)
        Cost going from 532746 to 532451
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237724
...done!
maximalDeformation: 0.848421
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73972
...done!
=======================
Good trial move (maximal deformation: 0.848421, lambda: 9.93474)
        Cost going from 532451 to 532202
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224339
...done!
maximalDeformation: 0.979668
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70873
...done!
=======================
Good trial move (maximal deformation: 0.979668, lambda: 9.03158)
        Cost going from 532202 to 531949
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.270188
...done!
maximalDeformation: 1.04584
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74649
...done!
=======================
Good trial move (maximal deformation: 1.04584, lambda: 8.21053)
        Cost going from 531949 to 531703
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23374
...done!
maximalDeformation: 0.903766
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73793
...done!
=======================
Good trial move (maximal deformation: 0.903766, lambda: 7.46412)
        Cost going from 531703 to 531437
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251595
...done!
maximalDeformation: 0.929423
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7701
...done!
=======================
Good trial move (maximal deformation: 0.929423, lambda: 6.78556)
        Cost going from 531437 to 531175
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249917
...done!
maximalDeformation: 1.53943
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76477
...done!
=======================
Good trial move (maximal deformation: 1.53943, lambda: 6.16869)
        Cost going from 531175 to 530916
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  527124
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.531 80.4678 48.2 ]
EM Iteration: 1  ->  527085
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.506 80.459 48.1565 ]
EM Iteration: 2  ->  527081
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.501 80.4568 48.1276 ]
EM Iteration: 3  ->  527081
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 3 was 531961
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xe6c23a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 8893432
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71155
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209066
...done!
maximalDeformation: 3.3379
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 394905 has managed to turn bad (detJ: -0.735844)
Time taken to rasterize Levenberg-Marquardt: 0.025372
...done!
=======================
Bad trial move (maximal deformation: 3.3379, lambda: 1)
        Cost going from 530826 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.21967
...done!
maximalDeformation: 2.04003
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 394905 has managed to turn bad (detJ: -0.258171)
Time taken to rasterize Levenberg-Marquardt: 0.026711
...done!
=======================
Bad trial move (maximal deformation: 2.04003, lambda: 2)
        Cost going from 530826 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.227781
...done!
maximalDeformation: 1.23958
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69724
...done!
=======================
Good trial move (maximal deformation: 1.23958, lambda: 4)
        Cost going from 530826 to 530554
        Decreasing lambda from 4 to 3.63636
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 3.63636...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22579
...done!
maximalDeformation: 1.25248
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 532690 has managed to turn bad (detJ: -0.040158)
Time taken to rasterize Levenberg-Marquardt: 0.0481369
...done!
=======================
Bad trial move (maximal deformation: 1.25248, lambda: 3.63636)
        Cost going from 530554 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 3.63636 to 7.27273 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Time taken to solve the Levenberg-Marquardt system of equations: 0.229642
...done!
maximalDeformation: 0.770744
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70881
...done!
=======================
Good trial move (maximal deformation: 0.770744, lambda: 7.27273)
        Cost going from 530554 to 530220
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237726
...done!
maximalDeformation: 1.18086
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7217
...done!
=======================
Good trial move (maximal deformation: 1.18086, lambda: 6.61157)
        Cost going from 530220 to 529964
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243638
...done!
maximalDeformation: 1.28201
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73727
...done!
=======================
Good trial move (maximal deformation: 1.28201, lambda: 6.01052)
        Cost going from 529964 to 529753
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241288
...done!
maximalDeformation: 1.84377
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73362
...done!
=======================
Good trial move (maximal deformation: 1.84377, lambda: 5.46411)
        Cost going from 529753 to 529533
        Decreasing lambda from 5.46411 to 4.96737
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.96737...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.255679
...done!
maximalDeformation: 1.60639
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76084
...done!
=======================
Good trial move (maximal deformation: 1.60639, lambda: 4.96737)
        Cost going from 529533 to 529358
        Decreasing lambda from 4.96737 to 4.51579
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.51579...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.252299
...done!
maximalDeformation: 1.18937
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76482
...done!
=======================
Good trial move (maximal deformation: 1.18937, lambda: 4.51579)
        Cost going from 529358 to 529136
        Decreasing lambda from 4.51579 to 4.10526
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.10526...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.271969
...done!
maximalDeformation: 1.28019
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1770112 has managed to turn bad (detJ: -0.166302)
Time taken to rasterize Levenberg-Marquardt: 0.613045
...done!
=======================
Bad trial move (maximal deformation: 1.28019, lambda: 4.10526)
        Cost going from 529136 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4.10526 to 8.21053 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Time taken to solve the Levenberg-Marquardt system of equations: 0.269711
...done!
maximalDeformation: 0.743743
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7621
...done!
=======================
Good trial move (maximal deformation: 0.743743, lambda: 8.21053)
        Cost going from 529136 to 528923
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.261544
...done!
maximalDeformation: 0.849296
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77481
...done!
=======================
Good trial move (maximal deformation: 0.849296, lambda: 7.46412)
        Cost going from 528923 to 528777
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.274251
...done!
maximalDeformation: 1.13246
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79194
...done!
=======================
Good trial move (maximal deformation: 1.13246, lambda: 6.78556)
        Cost going from 528777 to 528660
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.272886
...done!
maximalDeformation: 1.07318
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7882
...done!
=======================
Good trial move (maximal deformation: 1.07318, lambda: 6.16869)
        Cost going from 528660 to 528515
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  524719
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.452 80.4517 48.1637 ]
EM Iteration: 1  ->  524700
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.433 80.4505 48.1562 ]
EM Iteration: 2  ->  524699
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.428 80.451 48.1422 ]
EM Iteration: 3  ->  524699
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.424 80.4502 48.1317 ]
EM Iteration: 4  ->  524699
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 4
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 4 was 529583
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xb422b50)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 11444097
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72196
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213552
...done!
maximalDeformation: 3.04597
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 538681 has managed to turn bad (detJ: -0.146488)
Time taken to rasterize Levenberg-Marquardt: 0.0474498
...done!
=======================
Bad trial move (maximal deformation: 3.04597, lambda: 1)
        Cost going from 528466 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.22226
...done!
maximalDeformation: 2.04317
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 697719 has managed to turn bad (detJ: -0.023557)
Time taken to rasterize Levenberg-Marquardt: 0.0856271
...done!
=======================
Bad trial move (maximal deformation: 2.04317, lambda: 2)
        Cost going from 528466 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.229029
...done!
maximalDeformation: 1.27206
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1644656 has managed to turn bad (detJ: -0.062906)
Time taken to rasterize Levenberg-Marquardt: 0.497105
...done!
=======================
Bad trial move (maximal deformation: 1.27206, lambda: 4)
        Cost going from 528466 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.227597
...done!
maximalDeformation: 0.736184
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69419
...done!
=======================
Good trial move (maximal deformation: 0.736184, lambda: 8)
        Cost going from 528466 to 528341
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228655
...done!
maximalDeformation: 0.971799
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69461
...done!
=======================
Good trial move (maximal deformation: 0.971799, lambda: 7.27273)
        Cost going from 528341 to 528229
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236715
...done!
maximalDeformation: 0.753455
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72879
...done!
=======================
Good trial move (maximal deformation: 0.753455, lambda: 6.61157)
        Cost going from 528229 to 528130
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237941
...done!
maximalDeformation: 1.12
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73262
...done!
=======================
Good trial move (maximal deformation: 1.12, lambda: 6.01052)
        Cost going from 528130 to 528036
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.250035
...done!
maximalDeformation: 1.0043
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75537
...done!
=======================
Good trial move (maximal deformation: 1.0043, lambda: 5.46411)
        Cost going from 528036 to 527985
        Decreasing lambda from 5.46411 to 4.96737
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.96737...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247847
...done!
maximalDeformation: 1.13695
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2564928 has managed to turn bad (detJ: -0.0989314)
Time taken to rasterize Levenberg-Marquardt: 1.43808
...done!
=======================
Bad trial move (maximal deformation: 1.13695, lambda: 4.96737)
        Cost going from 527985 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4.96737 to 9.93474 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Time taken to solve the Levenberg-Marquardt system of equations: 0.255344
...done!
maximalDeformation: 0.643081
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72926
...done!
=======================
Good trial move (maximal deformation: 0.643081, lambda: 9.93474)
        Cost going from 527985 to 527839
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.259313
...done!
maximalDeformation: 0.610788
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76448
...done!
=======================
Good trial move (maximal deformation: 0.610788, lambda: 9.03158)
        Cost going from 527839 to 527759
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.263366
...done!
maximalDeformation: 1.23881
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76774
...done!
=======================
Good trial move (maximal deformation: 1.23881, lambda: 8.21053)
        Cost going from 527759 to 527704
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.265771
...done!
maximalDeformation: 1.59953
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77576
...done!
=======================
Good trial move (maximal deformation: 1.59953, lambda: 7.46412)
        Cost going from 527704 to 527645
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.276888
...done!
maximalDeformation: 1.20096
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79225
...done!
=======================
Good trial move (maximal deformation: 1.20096, lambda: 6.78556)
        Cost going from 527645 to 527602
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.273212
...done!
maximalDeformation: 0.856153
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.78215
...done!
=======================
Good trial move (maximal deformation: 0.856153, lambda: 6.16869)
        Cost going from 527602 to 527541
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  523696
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.403 80.4594 48.1706 ]
EM Iteration: 1  ->  523693
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.395 80.4626 48.1752 ]
EM Iteration: 2  ->  523692
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.391 80.4624 48.171 ]
EM Iteration: 3  ->  523692
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 5 was 528626
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xb7f15d0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 13994742
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71753
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214476
...done!
maximalDeformation: 3.65617
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 809403 has managed to turn bad (detJ: -0.0476531)
Time taken to rasterize Levenberg-Marquardt: 0.110556
...done!
=======================
Bad trial move (maximal deformation: 3.65617, lambda: 1)
        Cost going from 527527 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.222824
...done!
maximalDeformation: 2.34016
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 844132 has managed to turn bad (detJ: -0.162607)
Time taken to rasterize Levenberg-Marquardt: 0.123718
...done!
=======================
Bad trial move (maximal deformation: 2.34016, lambda: 2)
        Cost going from 527527 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.229494
...done!
maximalDeformation: 1.40309
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2564928 has managed to turn bad (detJ: -0.395419)
Time taken to rasterize Levenberg-Marquardt: 1.38669
...done!
=======================
Bad trial move (maximal deformation: 1.40309, lambda: 4)
        Cost going from 527527 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.228882
...done!
maximalDeformation: 0.795354
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68141
...done!
=======================
Good trial move (maximal deformation: 0.795354, lambda: 8)
        Cost going from 527527 to 527457
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229985
...done!
maximalDeformation: 0.912835
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68802
...done!
=======================
Good trial move (maximal deformation: 0.912835, lambda: 7.27273)
        Cost going from 527457 to 527406
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235678
...done!
maximalDeformation: 0.73764
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7279
...done!
=======================
Good trial move (maximal deformation: 0.73764, lambda: 6.61157)
        Cost going from 527406 to 527380
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240124
...done!
maximalDeformation: 1.58998
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72556
...done!
=======================
Good trial move (maximal deformation: 1.58998, lambda: 6.01052)
        Cost going from 527380 to 527345
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.25074
...done!
maximalDeformation: 1.14772
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75388
...done!
=======================
Good trial move (maximal deformation: 1.14772, lambda: 5.46411)
        Cost going from 527345 to 527330
        Decreasing lambda from 5.46411 to 4.96737
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.96737...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251166
...done!
maximalDeformation: 0.976859
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74712
...done!
=======================
Good trial move (maximal deformation: 0.976859, lambda: 4.96737)
        Cost going from 527330 to 527291
        Decreasing lambda from 4.96737 to 4.51579
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.51579...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.263695
...done!
maximalDeformation: 1.76859
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1463650 has managed to turn bad (detJ: -0.0291877)
Time taken to rasterize Levenberg-Marquardt: 0.409568
...done!
=======================
Bad trial move (maximal deformation: 1.76859, lambda: 4.51579)
        Cost going from 527291 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4.51579 to 9.03158 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Time taken to solve the Levenberg-Marquardt system of equations: 0.269465
...done!
maximalDeformation: 1.01843
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75617
...done!
=======================
Good trial move (maximal deformation: 1.01843, lambda: 9.03158)
        Cost going from 527291 to 527186
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.260824
...done!
maximalDeformation: 0.706729
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75919
...done!
=======================
Good trial move (maximal deformation: 0.706729, lambda: 8.21053)
        Cost going from 527186 to 527144
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.275325
...done!
maximalDeformation: 0.95918
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.78444
...done!
=======================
Good trial move (maximal deformation: 0.95918, lambda: 7.46412)
        Cost going from 527144 to 527134
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.270365
...done!
maximalDeformation: 1.05433
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77467
...done!
=======================
Good trial move (maximal deformation: 1.05433, lambda: 6.78556)
        Cost going from 527134 to 527115
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.286189
...done!
maximalDeformation: 1.27064
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79866
...done!
=======================
Good trial move (maximal deformation: 1.27064, lambda: 6.16869)
        Cost going from 527115 to 527108
        Decreasing lambda from 6.16869 to 5.6079
Starting EM: 
EM Iteration: 0  ->  523239
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.381 80.4721 48.2007 ]
EM Iteration: 1  ->  523239
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.377 80.4751 48.2062 ]
EM Iteration: 2  ->  523239
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.375 80.4751 48.2054 ]
EM Iteration: 3  ->  523239
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 6 was 528194
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xd9f5d30)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 16545387
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71871
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21331
...done!
maximalDeformation: 3.16906
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 255676 has managed to turn bad (detJ: -0.0290626)
Time taken to rasterize Levenberg-Marquardt: 0.012007
...done!
=======================
Bad trial move (maximal deformation: 3.16906, lambda: 1)
        Cost going from 527103 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210221
...done!
maximalDeformation: 2.08371
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 398548 has managed to turn bad (detJ: -0.162729)
Time taken to rasterize Levenberg-Marquardt: 0.0253272
...done!
=======================
Bad trial move (maximal deformation: 2.08371, lambda: 2)
        Cost going from 527103 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.203214
...done!
maximalDeformation: 1.25395
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62862
...done!
=======================
Bad trial move (maximal deformation: 1.25395, lambda: 4)
        Cost going from 527103 to 527132
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.201507
...done!
maximalDeformation: 0.704849
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6188
...done!
=======================
Good trial move (maximal deformation: 0.704849, lambda: 8)
        Cost going from 527103 to 527035
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222643
...done!
maximalDeformation: 0.975421
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68605
...done!
=======================
Good trial move (maximal deformation: 0.975421, lambda: 7.27273)
        Cost going from 527035 to 527017
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212462
...done!
maximalDeformation: 0.753458
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66676
...done!
=======================
Good trial move (maximal deformation: 0.753458, lambda: 6.61157)
        Cost going from 527017 to 527008
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23382
...done!
maximalDeformation: 1.33343
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70526
...done!
=======================
Bad trial move (maximal deformation: 1.33343, lambda: 6.01052)
        Cost going from 527008 to 527010
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.01052 to 12.021 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Time taken to solve the Levenberg-Marquardt system of equations: 0.233897
...done!
maximalDeformation: 0.716563
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69668
...done!
=======================
Good trial move (maximal deformation: 0.716563, lambda: 12.021)
        Cost going from 527008 to 526955
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225465
...done!
maximalDeformation: 0.594245
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70089
...done!
=======================
Good trial move (maximal deformation: 0.594245, lambda: 10.9282)
        Cost going from 526955 to 526929
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24119
...done!
maximalDeformation: 0.853831
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73018
...done!
=======================
Good trial move (maximal deformation: 0.853831, lambda: 9.93474)
        Cost going from 526929 to 526921
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.227771
...done!
maximalDeformation: 0.857233
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70388
...done!
=======================
Good trial move (maximal deformation: 0.857233, lambda: 9.03158)
        Cost going from 526921 to 526909
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.253962
...done!
maximalDeformation: 1.00108
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75567
...done!
=======================
Good trial move (maximal deformation: 1.00108, lambda: 8.21053)
        Cost going from 526909 to 526904
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241437
...done!
maximalDeformation: 1.28324
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73299
...done!
=======================
Good trial move (maximal deformation: 1.28324, lambda: 7.46412)
        Cost going from 526904 to 526891
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.265851
...done!
maximalDeformation: 1.08989
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76759
...done!
=======================
Bad trial move (maximal deformation: 1.08989, lambda: 6.78556)
        Cost going from 526891 to 526893
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.78556 to 13.5711 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Time taken to solve the Levenberg-Marquardt system of equations: 0.267398
...done!
maximalDeformation: 0.58572
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75453
...done!
=======================
Good trial move (maximal deformation: 0.58572, lambda: 13.5711)
        Cost going from 526891 to 526853
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.250335
...done!
maximalDeformation: 0.541461
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75412
...done!
=======================
Good trial move (maximal deformation: 0.541461, lambda: 12.3374)
        Cost going from 526853 to 526835
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  523011
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.368 80.4762 48.2155 ]
EM Iteration: 1  ->  523011
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 7 was 527923
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xd1c1b90)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 19288898
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71557
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208988
...done!
maximalDeformation: 4.22659
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 594812 has managed to turn bad (detJ: -0.163114)
Time taken to rasterize Levenberg-Marquardt: 0.0588641
...done!
=======================
Bad trial move (maximal deformation: 4.22659, lambda: 1)
        Cost going from 526834 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.205829
...done!
maximalDeformation: 2.76454
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 887505 has managed to turn bad (detJ: -0.328405)
Time taken to rasterize Levenberg-Marquardt: 0.131516
...done!
=======================
Bad trial move (maximal deformation: 2.76454, lambda: 2)
        Cost going from 526834 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.213787
...done!
maximalDeformation: 1.66815
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65885
...done!
=======================
Bad trial move (maximal deformation: 1.66815, lambda: 4)
        Cost going from 526834 to 526920
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.224843
...done!
maximalDeformation: 0.948577
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68927
...done!
=======================
Bad trial move (maximal deformation: 0.948577, lambda: 8)
        Cost going from 526834 to 526839
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210898
...done!
maximalDeformation: 0.512656
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65989
...done!
=======================
Good trial move (maximal deformation: 0.512656, lambda: 16)
        Cost going from 526834 to 526821
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223754
...done!
maximalDeformation: 0.738
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68955
...done!
=======================
Good trial move (maximal deformation: 0.738, lambda: 14.5455)
        Cost going from 526821 to 526812
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223122
...done!
maximalDeformation: 0.735887
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69814
...done!
=======================
Good trial move (maximal deformation: 0.735887, lambda: 13.2231)
        Cost going from 526812 to 526807
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236094
...done!
maximalDeformation: 0.482829
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72139
...done!
=======================
Good trial move (maximal deformation: 0.482829, lambda: 12.021)
        Cost going from 526807 to 526794
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236586
...done!
maximalDeformation: 0.515448
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72931
...done!
=======================
Good trial move (maximal deformation: 0.515448, lambda: 10.9282)
        Cost going from 526794 to 526787
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247959
...done!
maximalDeformation: 0.729571
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74549
...done!
=======================
Good trial move (maximal deformation: 0.729571, lambda: 9.93474)
        Cost going from 526787 to 526775
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249964
...done!
maximalDeformation: 0.805452
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75469
...done!
=======================
Good trial move (maximal deformation: 0.805452, lambda: 9.03158)
        Cost going from 526775 to 526774
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.262838
...done!
maximalDeformation: 0.860094
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74413
...done!
=======================
Good trial move (maximal deformation: 0.860094, lambda: 8.21053)
        Cost going from 526774 to 526762
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.262588
...done!
maximalDeformation: 0.777409
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7551
...done!
=======================
Good trial move (maximal deformation: 0.777409, lambda: 7.46412)
        Cost going from 526762 to 526758
        Decreasing lambda from 7.46412 to 6.78556
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.78556...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.27107
...done!
maximalDeformation: 1.02408
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76692
...done!
=======================
Good trial move (maximal deformation: 1.02408, lambda: 6.78556)
        Cost going from 526758 to 526751
        Decreasing lambda from 6.78556 to 6.16869
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.16869...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.275545
...done!
maximalDeformation: 1.01073
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7712
...done!
=======================
Bad trial move (maximal deformation: 1.01073, lambda: 6.16869)
        Cost going from 526751 to 526752
Transforming mesh
Done transforming mesh
        Increasing lambda from 6.16869 to 12.3374 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Time taken to solve the Levenberg-Marquardt system of equations: 0.275345
...done!
maximalDeformation: 0.603999
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75055
...done!
=======================
Good trial move (maximal deformation: 0.603999, lambda: 12.3374)
        Cost going from 526751 to 526706
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  522869
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.362 80.4734 48.2177 ]
EM Iteration: 1  ->  522868
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 8 was 527794
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xf4a6aa0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 22032409
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70524
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213642
...done!
maximalDeformation: 3.62329
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 812592 has managed to turn bad (detJ: -0.209828)
Time taken to rasterize Levenberg-Marquardt: 0.112172
...done!
=======================
Bad trial move (maximal deformation: 3.62329, lambda: 1)
        Cost going from 526705 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.223286
...done!
maximalDeformation: 2.31046
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1376076 has managed to turn bad (detJ: -0.650684)
Time taken to rasterize Levenberg-Marquardt: 0.334943
...done!
=======================
Bad trial move (maximal deformation: 2.31046, lambda: 2)
        Cost going from 526705 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.215628
...done!
maximalDeformation: 1.362
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65468
...done!
=======================
Bad trial move (maximal deformation: 1.362, lambda: 4)
        Cost going from 526705 to 526763
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.202107
...done!
maximalDeformation: 0.759074
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62325
...done!
=======================
Good trial move (maximal deformation: 0.759074, lambda: 8)
        Cost going from 526705 to 526697
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222567
...done!
maximalDeformation: 1.20568
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68514
...done!
=======================
Bad trial move (maximal deformation: 1.20568, lambda: 7.27273)
        Cost going from 526697 to 526710
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.27273 to 14.5455 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208282
...done!
maximalDeformation: 0.676458
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65081
...done!
=======================
Good trial move (maximal deformation: 0.676458, lambda: 14.5455)
        Cost going from 526697 to 526676
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212041
...done!
maximalDeformation: 0.546503
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67122
...done!
=======================
Good trial move (maximal deformation: 0.546503, lambda: 13.2231)
        Cost going from 526676 to 526665
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22412
...done!
maximalDeformation: 0.622055
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68685
...done!
=======================
Good trial move (maximal deformation: 0.622055, lambda: 12.021)
        Cost going from 526665 to 526662
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217543
...done!
maximalDeformation: 0.999276
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67952
...done!
=======================
Good trial move (maximal deformation: 0.999276, lambda: 10.9282)
        Cost going from 526662 to 526654
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235628
...done!
maximalDeformation: 0.526123
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7149
...done!
=======================
Bad trial move (maximal deformation: 0.526123, lambda: 9.93474)
        Cost going from 526654 to 526655
Transforming mesh
Done transforming mesh
        Increasing lambda from 9.93474 to 19.8695 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Time taken to solve the Levenberg-Marquardt system of equations: 0.240042
...done!
maximalDeformation: 0.278448
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71343
...done!
=======================
Good trial move (maximal deformation: 0.278448, lambda: 19.8695)
        Cost going from 526654 to 526639
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231351
...done!
maximalDeformation: 0.352922
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70719
...done!
=======================
Good trial move (maximal deformation: 0.352922, lambda: 18.0632)
        Cost going from 526639 to 526630
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249421
...done!
maximalDeformation: 0.503022
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74783
...done!
=======================
Good trial move (maximal deformation: 0.503022, lambda: 16.4211)
        Cost going from 526630 to 526623
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241986
...done!
maximalDeformation: 0.533983
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73063
...done!
=======================
Good trial move (maximal deformation: 0.533983, lambda: 14.9282)
        Cost going from 526623 to 526616
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.264647
...done!
maximalDeformation: 0.693125
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75596
...done!
=======================
Good trial move (maximal deformation: 0.693125, lambda: 13.5711)
        Cost going from 526616 to 526611
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.252849
...done!
maximalDeformation: 0.64011
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73646
...done!
=======================
Good trial move (maximal deformation: 0.64011, lambda: 12.3374)
        Cost going from 526611 to 526604
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  522770
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.358 80.4715 48.2111 ]
EM Iteration: 1  ->  522771
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 9 was 527689
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xae96f20)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 24775920
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69264
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212542
...done!
maximalDeformation: 3.78986
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 571496 has managed to turn bad (detJ: -0.0702937)
Time taken to rasterize Levenberg-Marquardt: 0.053144
...done!
=======================
Bad trial move (maximal deformation: 3.78986, lambda: 1)
        Cost going from 526601 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.209613
...done!
maximalDeformation: 2.37357
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 887505 has managed to turn bad (detJ: -0.0360156)
Time taken to rasterize Levenberg-Marquardt: 0.131046
...done!
=======================
Bad trial move (maximal deformation: 2.37357, lambda: 2)
        Cost going from 526601 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.201225
...done!
maximalDeformation: 1.41534
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2380685 has managed to turn bad (detJ: -0.0144742)
Time taken to rasterize Levenberg-Marquardt: 1.08993
...done!
=======================
Bad trial move (maximal deformation: 1.41534, lambda: 4)
        Cost going from 526601 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.198233
...done!
maximalDeformation: 0.797323
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61791
...done!
=======================
Bad trial move (maximal deformation: 0.797323, lambda: 8)
        Cost going from 526601 to 526614
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.198413
...done!
maximalDeformation: 0.430362
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61962
...done!
=======================
Good trial move (maximal deformation: 0.430362, lambda: 16)
        Cost going from 526601 to 526590
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221806
...done!
maximalDeformation: 0.358248
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68106
...done!
=======================
Good trial move (maximal deformation: 0.358248, lambda: 14.5455)
        Cost going from 526590 to 526582
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211574
...done!
maximalDeformation: 0.687995
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6461
...done!
=======================
Good trial move (maximal deformation: 0.687995, lambda: 13.2231)
        Cost going from 526582 to 526579
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22548
...done!
maximalDeformation: 0.555251
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6768
...done!
=======================
Good trial move (maximal deformation: 0.555251, lambda: 12.021)
        Cost going from 526579 to 526570
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222426
...done!
maximalDeformation: 0.63107
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67991
...done!
=======================
Good trial move (maximal deformation: 0.63107, lambda: 10.9282)
        Cost going from 526570 to 526566
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236906
...done!
maximalDeformation: 1.03662
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70048
...done!
=======================
Good trial move (maximal deformation: 1.03662, lambda: 9.93474)
        Cost going from 526566 to 526556
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235894
...done!
maximalDeformation: 0.67459
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70777
...done!
=======================
Good trial move (maximal deformation: 0.67459, lambda: 9.03158)
        Cost going from 526556 to 526552
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.248047
...done!
maximalDeformation: 0.804878
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70286
...done!
=======================
Good trial move (maximal deformation: 0.804878, lambda: 8.21053)
        Cost going from 526552 to 526543
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247029
...done!
maximalDeformation: 1.09145
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70258
...done!
=======================
Bad trial move (maximal deformation: 1.09145, lambda: 7.46412)
        Cost going from 526543 to 526544
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.46412 to 14.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.248336
...done!
maximalDeformation: 0.602929
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69147
...done!
=======================
Good trial move (maximal deformation: 0.602929, lambda: 14.9282)
        Cost going from 526543 to 526513
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.256107
...done!
maximalDeformation: 0.42833
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70754
...done!
=======================
Good trial move (maximal deformation: 0.42833, lambda: 13.5711)
        Cost going from 526513 to 526500
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.254266
...done!
maximalDeformation: 0.39819
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71273
...done!
=======================
Good trial move (maximal deformation: 0.39819, lambda: 12.3374)
        Cost going from 526500 to 526497
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  522669
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.356 80.47 48.2064 ]
EM Iteration: 1  ->  522669
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.354 80.4685 48.2024 ]
EM Iteration: 2  ->  522669
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 10 was 527582
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x10ea8930)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 27519451
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64626
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.201047
...done!
maximalDeformation: 4.45488
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 255894 has managed to turn bad (detJ: -0.998414)
Time taken to rasterize Levenberg-Marquardt: 0.011452
...done!
=======================
Bad trial move (maximal deformation: 4.45488, lambda: 1)
        Cost going from 526496 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196391
...done!
maximalDeformation: 2.93297
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1379893 has managed to turn bad (detJ: -0.503235)
Time taken to rasterize Levenberg-Marquardt: 0.319779
...done!
=======================
Bad trial move (maximal deformation: 2.93297, lambda: 2)
        Cost going from 526496 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193409
...done!
maximalDeformation: 1.74287
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2380685 has managed to turn bad (detJ: -0.166315)
Time taken to rasterize Levenberg-Marquardt: 1.0753
...done!
=======================
Bad trial move (maximal deformation: 1.74287, lambda: 4)
        Cost going from 526496 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190984
...done!
maximalDeformation: 0.969478
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58995
...done!
=======================
Bad trial move (maximal deformation: 0.969478, lambda: 8)
        Cost going from 526496 to 526504
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191134
...done!
maximalDeformation: 0.514696
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57902
...done!
=======================
Good trial move (maximal deformation: 0.514696, lambda: 16)
        Cost going from 526496 to 526483
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209243
...done!
maximalDeformation: 0.570652
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66396
...done!
=======================
Good trial move (maximal deformation: 0.570652, lambda: 14.5455)
        Cost going from 526483 to 526479
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.227988
...done!
maximalDeformation: 0.36207
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.85169
...done!
=======================
Good trial move (maximal deformation: 0.36207, lambda: 13.2231)
        Cost going from 526479 to 526472
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215862
...done!
maximalDeformation: 0.652372
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63733
...done!
=======================
Good trial move (maximal deformation: 0.652372, lambda: 12.021)
        Cost going from 526472 to 526466
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213083
...done!
maximalDeformation: 0.485458
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63194
...done!
=======================
Good trial move (maximal deformation: 0.485458, lambda: 10.9282)
        Cost going from 526466 to 526461
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226112
...done!
maximalDeformation: 0.641867
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65292
...done!
=======================
Good trial move (maximal deformation: 0.641867, lambda: 9.93474)
        Cost going from 526461 to 526454
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226882
...done!
maximalDeformation: 0.95527
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66651
...done!
=======================
Good trial move (maximal deformation: 0.95527, lambda: 9.03158)
        Cost going from 526454 to 526450
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239551
...done!
maximalDeformation: 0.875425
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6718
...done!
=======================
Bad trial move (maximal deformation: 0.875425, lambda: 8.21053)
        Cost going from 526450 to 526451
Transforming mesh
Done transforming mesh
        Increasing lambda from 8.21053 to 16.4211 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Time taken to solve the Levenberg-Marquardt system of equations: 0.245087
...done!
maximalDeformation: 0.473705
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67365
...done!
=======================
Good trial move (maximal deformation: 0.473705, lambda: 16.4211)
        Cost going from 526450 to 526426
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.262875
...done!
maximalDeformation: 0.380571
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79167
...done!
=======================
Good trial move (maximal deformation: 0.380571, lambda: 14.9282)
        Cost going from 526426 to 526414
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.258621
...done!
maximalDeformation: 0.57279
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.90453
...done!
=======================
Good trial move (maximal deformation: 0.57279, lambda: 13.5711)
        Cost going from 526414 to 526410
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.272911
...done!
maximalDeformation: 0.479089
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76461
...done!
=======================
Good trial move (maximal deformation: 0.479089, lambda: 12.3374)
        Cost going from 526410 to 526403
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  522574
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.354 80.4678 48.198 ]
EM Iteration: 1  ->  522575
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 11 was 527488
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x11318730)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 30262962
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7122
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204306
...done!
maximalDeformation: 2.86281
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 571496 has managed to turn bad (detJ: -0.15888)
Time taken to rasterize Levenberg-Marquardt: 0.0552349
...done!
=======================
Bad trial move (maximal deformation: 2.86281, lambda: 1)
        Cost going from 526402 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.200004
...done!
maximalDeformation: 1.72692
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 956172 has managed to turn bad (detJ: -0.620888)
Time taken to rasterize Levenberg-Marquardt: 0.158815
...done!
=======================
Bad trial move (maximal deformation: 1.72692, lambda: 2)
        Cost going from 526402 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193609
...done!
maximalDeformation: 0.978733
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65121
...done!
=======================
Bad trial move (maximal deformation: 0.978733, lambda: 4)
        Cost going from 526402 to 526540
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191903
...done!
maximalDeformation: 0.541607
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66233
...done!
=======================
Bad trial move (maximal deformation: 0.541607, lambda: 8)
        Cost going from 526402 to 526416
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195846
...done!
maximalDeformation: 0.295602
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70178
...done!
=======================
Good trial move (maximal deformation: 0.295602, lambda: 16)
        Cost going from 526402 to 526392
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221637
...done!
maximalDeformation: 0.328613
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.8505
...done!
=======================
Good trial move (maximal deformation: 0.328613, lambda: 14.5455)
        Cost going from 526392 to 526386
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207526
...done!
maximalDeformation: 0.672265
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.80472
...done!
=======================
Good trial move (maximal deformation: 0.672265, lambda: 13.2231)
        Cost going from 526386 to 526385
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235696
...done!
maximalDeformation: 0.611879
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.85579
...done!
=======================
Good trial move (maximal deformation: 0.611879, lambda: 12.021)
        Cost going from 526385 to 526377
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217272
...done!
maximalDeformation: 0.566309
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.82138
...done!
=======================
Bad trial move (maximal deformation: 0.566309, lambda: 10.9282)
        Cost going from 526377 to 526378
Transforming mesh
Done transforming mesh
        Increasing lambda from 10.9282 to 21.8564 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Time taken to solve the Levenberg-Marquardt system of equations: 0.227351
...done!
maximalDeformation: 0.302772
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.81873
...done!
=======================
Good trial move (maximal deformation: 0.302772, lambda: 21.8564)
        Cost going from 526377 to 526365
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243341
...done!
maximalDeformation: 0.248921
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.88514
...done!
=======================
Good trial move (maximal deformation: 0.248921, lambda: 19.8695)
        Cost going from 526365 to 526360
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238412
...done!
maximalDeformation: 0.360917
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76462
...done!
=======================
Good trial move (maximal deformation: 0.360917, lambda: 18.0632)
        Cost going from 526360 to 526357
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.256215
...done!
maximalDeformation: 0.355818
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.88142
...done!
=======================
Good trial move (maximal deformation: 0.355818, lambda: 16.4211)
        Cost going from 526357 to 526353
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242232
...done!
maximalDeformation: 0.65257
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.82531
...done!
=======================
Good trial move (maximal deformation: 0.65257, lambda: 14.9282)
        Cost going from 526353 to 526352
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.274422
...done!
maximalDeformation: 0.444263
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.8596
...done!
=======================
Good trial move (maximal deformation: 0.444263, lambda: 13.5711)
        Cost going from 526352 to 526346
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245631
...done!
maximalDeformation: 0.633579
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.81018
...done!
=======================
Bad trial move (maximal deformation: 0.633579, lambda: 12.3374)
        Cost going from 526346 to 526346
Transforming mesh
Done transforming mesh
        Increasing lambda from 12.3374 to 24.6748 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Time taken to solve the Levenberg-Marquardt system of equations: 0.238785
...done!
maximalDeformation: 0.334111
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.81765
...done!
=======================
Good trial move (maximal deformation: 0.334111, lambda: 24.6748)
        Cost going from 526346 to 526337
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522516
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.353 80.468 48.1948 ]
EM Iteration: 1  ->  522516
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.352 80.4677 48.1931 ]
EM Iteration: 2  ->  522516
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 12 was 527422
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x104fb230)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 33199399
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77241
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199888
...done!
maximalDeformation: 4.18005
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 557215 has managed to turn bad (detJ: -0.00798511)
Time taken to rasterize Levenberg-Marquardt: 0.0536699
...done!
=======================
Bad trial move (maximal deformation: 4.18005, lambda: 1)
        Cost going from 526336 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.199564
...done!
maximalDeformation: 2.53304
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1426688 has managed to turn bad (detJ: -0.594918)
Time taken to rasterize Levenberg-Marquardt: 0.366609
...done!
=======================
Bad trial move (maximal deformation: 2.53304, lambda: 2)
        Cost going from 526336 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.201945
...done!
maximalDeformation: 1.44047
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72167
...done!
=======================
Bad trial move (maximal deformation: 1.44047, lambda: 4)
        Cost going from 526336 to 526396
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.201415
...done!
maximalDeformation: 0.780062
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72048
...done!
=======================
Bad trial move (maximal deformation: 0.780062, lambda: 8)
        Cost going from 526336 to 526347
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195639
...done!
maximalDeformation: 0.407689
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6999
...done!
=======================
Good trial move (maximal deformation: 0.407689, lambda: 16)
        Cost going from 526336 to 526333
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225938
...done!
maximalDeformation: 0.608064
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74771
...done!
=======================
Bad trial move (maximal deformation: 0.608064, lambda: 14.5455)
        Cost going from 526333 to 526335
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.5455 to 29.0909 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Time taken to solve the Levenberg-Marquardt system of equations: 0.215427
...done!
maximalDeformation: 0.312763
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75835
...done!
=======================
Good trial move (maximal deformation: 0.312763, lambda: 29.0909)
        Cost going from 526333 to 526328
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202438
...done!
maximalDeformation: 0.187122
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75181
...done!
=======================
Good trial move (maximal deformation: 0.187122, lambda: 26.4463)
        Cost going from 526328 to 526324
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222615
...done!
maximalDeformation: 0.271172
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.81732
...done!
=======================
Good trial move (maximal deformation: 0.271172, lambda: 24.0421)
        Cost going from 526324 to 526322
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209014
...done!
maximalDeformation: 0.283719
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.80484
...done!
=======================
Good trial move (maximal deformation: 0.283719, lambda: 21.8564)
        Cost going from 526322 to 526319
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.250652
...done!
maximalDeformation: 0.403077
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.86529
...done!
=======================
Good trial move (maximal deformation: 0.403077, lambda: 19.8695)
        Cost going from 526319 to 526319
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233464
...done!
maximalDeformation: 0.29994
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.84164
...done!
=======================
Good trial move (maximal deformation: 0.29994, lambda: 18.0632)
        Cost going from 526319 to 526315
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24889
...done!
maximalDeformation: 0.376192
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.8499
...done!
=======================
Good trial move (maximal deformation: 0.376192, lambda: 16.4211)
        Cost going from 526315 to 526315
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251672
...done!
maximalDeformation: 0.533999
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.86631
...done!
=======================
Good trial move (maximal deformation: 0.533999, lambda: 14.9282)
        Cost going from 526315 to 526311
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.272148
...done!
maximalDeformation: 0.480974
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.87541
...done!
=======================
Good trial move (maximal deformation: 0.480974, lambda: 13.5711)
        Cost going from 526311 to 526310
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246828
...done!
maximalDeformation: 0.750734
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.85107
...done!
=======================
Good trial move (maximal deformation: 0.750734, lambda: 12.3374)
        Cost going from 526310 to 526306
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  522477
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.35 80.466 48.192 ]
EM Iteration: 1  ->  522476
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.348 80.4642 48.1898 ]
EM Iteration: 2  ->  522476
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 13 was 527391
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x11579410)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 35942930
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.78359
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.203349
...done!
maximalDeformation: 2.83561
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.263315)
Time taken to rasterize Levenberg-Marquardt: 0.0970402
...done!
=======================
Bad trial move (maximal deformation: 2.83561, lambda: 1)
        Cost going from 526305 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195292
...done!
maximalDeformation: 1.79865
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 765910 has managed to turn bad (detJ: -0.0347231)
Time taken to rasterize Levenberg-Marquardt: 0.104193
...done!
=======================
Bad trial move (maximal deformation: 1.79865, lambda: 2)
        Cost going from 526305 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192529
...done!
maximalDeformation: 1.10805
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71274
...done!
=======================
Bad trial move (maximal deformation: 1.10805, lambda: 4)
        Cost going from 526305 to 526421
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.202471
...done!
maximalDeformation: 0.642816
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69734
...done!
=======================
Bad trial move (maximal deformation: 0.642816, lambda: 8)
        Cost going from 526305 to 526323
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.203294
...done!
maximalDeformation: 0.35141
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74327
...done!
=======================
Good trial move (maximal deformation: 0.35141, lambda: 16)
        Cost going from 526305 to 526296
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217708
...done!
maximalDeformation: 0.550629
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7629
...done!
=======================
Good trial move (maximal deformation: 0.550629, lambda: 14.5455)
        Cost going from 526296 to 526291
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222773
...done!
maximalDeformation: 0.678286
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.83103
...done!
=======================
Good trial move (maximal deformation: 0.678286, lambda: 13.2231)
        Cost going from 526291 to 526290
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238407
...done!
maximalDeformation: 0.811137
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.83606
...done!
=======================
Good trial move (maximal deformation: 0.811137, lambda: 12.021)
        Cost going from 526290 to 526286
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24385
...done!
maximalDeformation: 0.58397
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.82093
...done!
=======================
Bad trial move (maximal deformation: 0.58397, lambda: 10.9282)
        Cost going from 526286 to 526289
Transforming mesh
Done transforming mesh
        Increasing lambda from 10.9282 to 21.8564 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Time taken to solve the Levenberg-Marquardt system of equations: 0.223302
...done!
maximalDeformation: 0.309986
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79713
...done!
=======================
Good trial move (maximal deformation: 0.309986, lambda: 21.8564)
        Cost going from 526286 to 526275
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233882
...done!
maximalDeformation: 0.378767
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.78819
...done!
=======================
Good trial move (maximal deformation: 0.378767, lambda: 19.8695)
        Cost going from 526275 to 526270
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237716
...done!
maximalDeformation: 0.265059
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.82849
...done!
=======================
Good trial move (maximal deformation: 0.265059, lambda: 18.0632)
        Cost going from 526270 to 526269
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.261229
...done!
maximalDeformation: 0.49704
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.80302
...done!
=======================
Good trial move (maximal deformation: 0.49704, lambda: 16.4211)
        Cost going from 526269 to 526267
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244363
...done!
maximalDeformation: 0.655493
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.80688
...done!
=======================
Bad trial move (maximal deformation: 0.655493, lambda: 14.9282)
        Cost going from 526267 to 526267
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.9282 to 29.8565 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Time taken to solve the Levenberg-Marquardt system of equations: 0.264691
...done!
maximalDeformation: 0.338547
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.81942
...done!
=======================
Good trial move (maximal deformation: 0.338547, lambda: 29.8565)
        Cost going from 526267 to 526261
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.266267
...done!
maximalDeformation: 0.213805
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.89168
...done!
=======================
Good trial move (maximal deformation: 0.213805, lambda: 27.1422)
        Cost going from 526261 to 526259
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.265662
...done!
maximalDeformation: 0.27873
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.90225
...done!
=======================
Good trial move (maximal deformation: 0.27873, lambda: 24.6748)
        Cost going from 526259 to 526258
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522437
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.347 80.4628 48.1868 ]
EM Iteration: 1  ->  522437
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 14 was 527343
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc3df7a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 38879347
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76927
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206688
...done!
maximalDeformation: 3.2741
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.987406)
Time taken to rasterize Levenberg-Marquardt: 0.0876939
...done!
=======================
Bad trial move (maximal deformation: 3.2741, lambda: 1)
        Cost going from 526257 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.198647
...done!
maximalDeformation: 2.0336
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.0496868)
Time taken to rasterize Levenberg-Marquardt: 0.0863612
...done!
=======================
Bad trial move (maximal deformation: 2.0336, lambda: 2)
        Cost going from 526257 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196794
...done!
maximalDeformation: 1.21339
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70008
...done!
=======================
Bad trial move (maximal deformation: 1.21339, lambda: 4)
        Cost going from 526257 to 526344
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.203622
...done!
maximalDeformation: 0.68222
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71994
...done!
=======================
Bad trial move (maximal deformation: 0.68222, lambda: 8)
        Cost going from 526257 to 526279
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.203189
...done!
maximalDeformation: 0.364621
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75779
...done!
=======================
Bad trial move (maximal deformation: 0.364621, lambda: 16)
        Cost going from 526257 to 526259
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.202561
...done!
maximalDeformation: 0.189247
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74191
...done!
=======================
Good trial move (maximal deformation: 0.189247, lambda: 32)
        Cost going from 526257 to 526254
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205812
...done!
maximalDeformation: 0.153792
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76907
...done!
=======================
Good trial move (maximal deformation: 0.153792, lambda: 29.0909)
        Cost going from 526254 to 526253
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218763
...done!
maximalDeformation: 0.275089
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73465
...done!
=======================
Good trial move (maximal deformation: 0.275089, lambda: 26.4463)
        Cost going from 526253 to 526252
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226282
...done!
maximalDeformation: 0.344765
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79161
...done!
=======================
Good trial move (maximal deformation: 0.344765, lambda: 24.0421)
        Cost going from 526252 to 526251
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215516
...done!
maximalDeformation: 0.282349
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.80331
...done!
=======================
Good trial move (maximal deformation: 0.282349, lambda: 21.8564)
        Cost going from 526251 to 526250
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246822
...done!
maximalDeformation: 0.362218
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.83917
...done!
=======================
Good trial move (maximal deformation: 0.362218, lambda: 19.8695)
        Cost going from 526250 to 526249
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231304
...done!
maximalDeformation: 0.30279
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.84082
...done!
=======================
Good trial move (maximal deformation: 0.30279, lambda: 18.0632)
        Cost going from 526249 to 526247
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24717
...done!
maximalDeformation: 0.587178
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.91207
...done!
=======================
Good trial move (maximal deformation: 0.587178, lambda: 16.4211)
        Cost going from 526247 to 526247
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.261951
...done!
maximalDeformation: 0.491777
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.91018
...done!
=======================
Good trial move (maximal deformation: 0.491777, lambda: 14.9282)
        Cost going from 526247 to 526247
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.264941
...done!
maximalDeformation: 0.556653
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.9077
...done!
=======================
Bad trial move (maximal deformation: 0.556653, lambda: 13.5711)
        Cost going from 526247 to 526247
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.5711 to 27.1422 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Time taken to solve the Levenberg-Marquardt system of equations: 0.276557
...done!
maximalDeformation: 0.291189
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.86648
...done!
=======================
Good trial move (maximal deformation: 0.291189, lambda: 27.1422)
        Cost going from 526247 to 526239
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.254759
...done!
maximalDeformation: 0.203878
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.86296
...done!
=======================
Good trial move (maximal deformation: 0.203878, lambda: 24.6748)
        Cost going from 526239 to 526236
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522415
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.347 80.4626 48.1862 ]
EM Iteration: 1  ->  522415
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 15 was 527323
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xd45baf0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 41815764
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.85612
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217989
...done!
maximalDeformation: 3.81654
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 594812 has managed to turn bad (detJ: -0.0257732)
Time taken to rasterize Levenberg-Marquardt: 0.0678411
...done!
=======================
Bad trial move (maximal deformation: 3.81654, lambda: 1)
        Cost going from 526236 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.200735
...done!
maximalDeformation: 2.42925
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.0996374)
Time taken to rasterize Levenberg-Marquardt: 0.086045
...done!
=======================
Bad trial move (maximal deformation: 2.42925, lambda: 2)
        Cost going from 526236 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194898
...done!
maximalDeformation: 1.42994
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70937
...done!
=======================
Bad trial move (maximal deformation: 1.42994, lambda: 4)
        Cost going from 526236 to 526314
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.205918
...done!
maximalDeformation: 0.790539
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73526
...done!
=======================
Bad trial move (maximal deformation: 0.790539, lambda: 8)
        Cost going from 526236 to 526257
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.220794
...done!
maximalDeformation: 0.417635
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.81092
...done!
=======================
Bad trial move (maximal deformation: 0.417635, lambda: 16)
        Cost going from 526236 to 526239
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.203003
...done!
maximalDeformation: 0.21524
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7035
...done!
=======================
Good trial move (maximal deformation: 0.21524, lambda: 32)
        Cost going from 526236 to 526234
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222685
...done!
maximalDeformation: 0.262341
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79415
...done!
=======================
Good trial move (maximal deformation: 0.262341, lambda: 29.0909)
        Cost going from 526234 to 526233
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220702
...done!
maximalDeformation: 0.208443
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.83113
...done!
=======================
Good trial move (maximal deformation: 0.208443, lambda: 26.4463)
        Cost going from 526233 to 526232
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22038
...done!
maximalDeformation: 0.308662
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.88764
...done!
=======================
Good trial move (maximal deformation: 0.308662, lambda: 24.0421)
        Cost going from 526232 to 526231
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234193
...done!
maximalDeformation: 0.42643
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75754
...done!
=======================
Good trial move (maximal deformation: 0.42643, lambda: 21.8564)
        Cost going from 526231 to 526231
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236618
...done!
maximalDeformation: 0.284455
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.86198
...done!
=======================
Good trial move (maximal deformation: 0.284455, lambda: 19.8695)
        Cost going from 526231 to 526229
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233118
...done!
maximalDeformation: 0.308618
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.82379
...done!
=======================
Bad trial move (maximal deformation: 0.308618, lambda: 18.0632)
        Cost going from 526229 to 526230
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.228786
...done!
maximalDeformation: 0.161669
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.83172
...done!
=======================
Good trial move (maximal deformation: 0.161669, lambda: 36.1263)
        Cost going from 526229 to 526225
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.251174
...done!
maximalDeformation: 0.165733
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.83187
...done!
=======================
Good trial move (maximal deformation: 0.165733, lambda: 32.8421)
        Cost going from 526225 to 526224
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246144
...done!
maximalDeformation: 0.208843
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.81088
...done!
=======================
Good trial move (maximal deformation: 0.208843, lambda: 29.8565)
        Cost going from 526224 to 526223
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.254225
...done!
maximalDeformation: 0.244981
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.85932
...done!
=======================
Good trial move (maximal deformation: 0.244981, lambda: 27.1422)
        Cost going from 526223 to 526221
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.260129
...done!
maximalDeformation: 0.293869
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.85205
...done!
=======================
Good trial move (maximal deformation: 0.293869, lambda: 24.6748)
        Cost going from 526221 to 526220
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522398
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.347 80.4631 48.187 ]
EM Iteration: 1  ->  522397
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.346 80.4627 48.1864 ]
EM Iteration: 2  ->  522397
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 16 was 527307
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xfb178a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 44752201
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75368
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.203107
...done!
maximalDeformation: 4.76644
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 812592 has managed to turn bad (detJ: -0.31934)
Time taken to rasterize Levenberg-Marquardt: 0.126684
...done!
=======================
Bad trial move (maximal deformation: 4.76644, lambda: 1)
        Cost going from 526220 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.196483
...done!
maximalDeformation: 3.04155
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 812592 has managed to turn bad (detJ: -0.0630212)
Time taken to rasterize Levenberg-Marquardt: 0.115575
...done!
=======================
Bad trial move (maximal deformation: 3.04155, lambda: 2)
        Cost going from 526220 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190831
...done!
maximalDeformation: 1.8135
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70955
...done!
=======================
Bad trial move (maximal deformation: 1.8135, lambda: 4)
        Cost going from 526220 to 526305
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195571
...done!
maximalDeformation: 1.01752
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72317
...done!
=======================
Bad trial move (maximal deformation: 1.01752, lambda: 8)
        Cost going from 526220 to 526242
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189694
...done!
maximalDeformation: 0.544318
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7598
...done!
=======================
Bad trial move (maximal deformation: 0.544318, lambda: 16)
        Cost going from 526220 to 526222
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.201465
...done!
maximalDeformation: 0.282443
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.78049
...done!
=======================
Good trial move (maximal deformation: 0.282443, lambda: 32)
        Cost going from 526220 to 526217
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.203417
...done!
maximalDeformation: 0.202974
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.80627
...done!
=======================
Good trial move (maximal deformation: 0.202974, lambda: 29.0909)
        Cost going from 526217 to 526214
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.189337
...done!
maximalDeformation: 0.224512
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72816
...done!
=======================
Good trial move (maximal deformation: 0.224512, lambda: 26.4463)
        Cost going from 526214 to 526212
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22271
...done!
maximalDeformation: 0.283052
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.74161
...done!
=======================
Good trial move (maximal deformation: 0.283052, lambda: 24.0421)
        Cost going from 526212 to 526210
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219186
...done!
maximalDeformation: 0.387415
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73151
...done!
=======================
Good trial move (maximal deformation: 0.387415, lambda: 21.8564)
        Cost going from 526210 to 526209
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238503
...done!
maximalDeformation: 0.383631
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.78396
...done!
=======================
Good trial move (maximal deformation: 0.383631, lambda: 19.8695)
        Cost going from 526209 to 526207
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21846
...done!
maximalDeformation: 0.289463
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.78764
...done!
=======================
Good trial move (maximal deformation: 0.289463, lambda: 18.0632)
        Cost going from 526207 to 526203
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.250124
...done!
maximalDeformation: 0.366014
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.92529
...done!
=======================
Good trial move (maximal deformation: 0.366014, lambda: 16.4211)
        Cost going from 526203 to 526202
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2409
...done!
maximalDeformation: 0.619339
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79161
...done!
=======================
Good trial move (maximal deformation: 0.619339, lambda: 14.9282)
        Cost going from 526202 to 526200
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.250797
...done!
maximalDeformation: 0.537233
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.84263
...done!
=======================
Good trial move (maximal deformation: 0.537233, lambda: 13.5711)
        Cost going from 526200 to 526200
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243713
...done!
maximalDeformation: 0.808225
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.80097
...done!
=======================
Good trial move (maximal deformation: 0.808225, lambda: 12.3374)
        Cost going from 526200 to 526198
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  522368
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.347 80.4639 48.1871 ]
EM Iteration: 1  ->  522368
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 17 was 527283
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x117f52b0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 47495712
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.84984
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213521
...done!
maximalDeformation: 4.36511
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.902083)
Time taken to rasterize Levenberg-Marquardt: 0.0874569
...done!
=======================
Bad trial move (maximal deformation: 4.36511, lambda: 1)
        Cost going from 526198 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.214076
...done!
maximalDeformation: 2.71907
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.26252)
Time taken to rasterize Levenberg-Marquardt: 0.0915492
...done!
=======================
Bad trial move (maximal deformation: 2.71907, lambda: 2)
        Cost going from 526198 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.203769
...done!
maximalDeformation: 1.60411
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77828
...done!
=======================
Bad trial move (maximal deformation: 1.60411, lambda: 4)
        Cost going from 526198 to 526329
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194174
...done!
maximalDeformation: 0.899497
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77515
...done!
=======================
Bad trial move (maximal deformation: 0.899497, lambda: 8)
        Cost going from 526198 to 526217
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194128
...done!
maximalDeformation: 0.491667
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.80459
...done!
=======================
Good trial move (maximal deformation: 0.491667, lambda: 16)
        Cost going from 526198 to 526189
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226947
...done!
maximalDeformation: 0.392424
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.84734
...done!
=======================
Good trial move (maximal deformation: 0.392424, lambda: 14.5455)
        Cost going from 526189 to 526182
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219606
...done!
maximalDeformation: 0.749885
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.78199
...done!
=======================
Bad trial move (maximal deformation: 0.749885, lambda: 13.2231)
        Cost going from 526182 to 526183
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.2231 to 26.4463 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Time taken to solve the Levenberg-Marquardt system of equations: 0.219957
...done!
maximalDeformation: 0.391686
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73629
...done!
=======================
Good trial move (maximal deformation: 0.391686, lambda: 26.4463)
        Cost going from 526182 to 526176
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215807
...done!
maximalDeformation: 0.208321
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77102
...done!
=======================
Good trial move (maximal deformation: 0.208321, lambda: 24.0421)
        Cost going from 526176 to 526172
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226017
...done!
maximalDeformation: 0.266719
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75466
...done!
=======================
Good trial move (maximal deformation: 0.266719, lambda: 21.8564)
        Cost going from 526172 to 526172
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238567
...done!
maximalDeformation: 0.516616
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.8296
...done!
=======================
Good trial move (maximal deformation: 0.516616, lambda: 19.8695)
        Cost going from 526172 to 526170
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231828
...done!
maximalDeformation: 0.361541
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.85541
...done!
=======================
Good trial move (maximal deformation: 0.361541, lambda: 18.0632)
        Cost going from 526170 to 526169
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.262448
...done!
maximalDeformation: 0.375235
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.92869
...done!
=======================
Good trial move (maximal deformation: 0.375235, lambda: 16.4211)
        Cost going from 526169 to 526167
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241865
...done!
maximalDeformation: 0.588501
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.8414
...done!
=======================
Good trial move (maximal deformation: 0.588501, lambda: 14.9282)
        Cost going from 526167 to 526167
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.257936
...done!
maximalDeformation: 0.438555
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.91106
...done!
=======================
Good trial move (maximal deformation: 0.438555, lambda: 13.5711)
        Cost going from 526167 to 526164
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.273152
...done!
maximalDeformation: 0.574854
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.82973
...done!
=======================
Bad trial move (maximal deformation: 0.574854, lambda: 12.3374)
        Cost going from 526164 to 526165
Transforming mesh
Done transforming mesh
        Increasing lambda from 12.3374 to 24.6748 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Time taken to solve the Levenberg-Marquardt system of equations: 0.251944
...done!
maximalDeformation: 0.301808
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71606
...done!
=======================
Good trial move (maximal deformation: 0.301808, lambda: 24.6748)
        Cost going from 526164 to 526156
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522328
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.346 80.4641 48.1879 ]
EM Iteration: 1  ->  522328
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.345 80.4638 48.1877 ]
EM Iteration: 2  ->  522328
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 18 was 527239
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x114f4190)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 50432149
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67365
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.203328
...done!
maximalDeformation: 6.06538
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.66397)
Time taken to rasterize Levenberg-Marquardt: 0.0869598
...done!
=======================
Bad trial move (maximal deformation: 6.06538, lambda: 1)
        Cost going from 526156 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.216651
...done!
maximalDeformation: 3.72906
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.732
...done!
=======================
Bad trial move (maximal deformation: 3.72906, lambda: 2)
        Cost going from 526156 to 526360
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.206725
...done!
maximalDeformation: 2.12693
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70612
...done!
=======================
Bad trial move (maximal deformation: 2.12693, lambda: 4)
        Cost going from 526156 to 526218
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.197351
...done!
maximalDeformation: 1.15007
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70369
...done!
=======================
Bad trial move (maximal deformation: 1.15007, lambda: 8)
        Cost going from 526156 to 526169
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19372
...done!
maximalDeformation: 0.600645
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70253
...done!
=======================
Good trial move (maximal deformation: 0.600645, lambda: 16)
        Cost going from 526156 to 526154
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.216074
...done!
maximalDeformation: 0.393396
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68535
...done!
=======================
Bad trial move (maximal deformation: 0.393396, lambda: 14.5455)
        Cost going from 526154 to 526156
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.5455 to 29.0909 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210362
...done!
maximalDeformation: 0.209302
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72824
...done!
=======================
Good trial move (maximal deformation: 0.209302, lambda: 29.0909)
        Cost going from 526154 to 526149
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200753
...done!
maximalDeformation: 0.23571
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70039
...done!
=======================
Good trial move (maximal deformation: 0.23571, lambda: 26.4463)
        Cost going from 526149 to 526146
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22367
...done!
maximalDeformation: 0.244623
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.78271
...done!
=======================
Good trial move (maximal deformation: 0.244623, lambda: 24.0421)
        Cost going from 526146 to 526145
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21011
...done!
maximalDeformation: 0.291113
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73823
...done!
=======================
Good trial move (maximal deformation: 0.291113, lambda: 21.8564)
        Cost going from 526145 to 526142
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236781
...done!
maximalDeformation: 0.344811
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.77625
...done!
=======================
Good trial move (maximal deformation: 0.344811, lambda: 19.8695)
        Cost going from 526142 to 526141
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213116
...done!
maximalDeformation: 0.530143
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.75491
...done!
=======================
Good trial move (maximal deformation: 0.530143, lambda: 18.0632)
        Cost going from 526141 to 526138
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24956
...done!
maximalDeformation: 0.377314
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.84987
...done!
=======================
Good trial move (maximal deformation: 0.377314, lambda: 16.4211)
        Cost going from 526138 to 526135
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239354
...done!
maximalDeformation: 0.37042
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.82327
...done!
=======================
Good trial move (maximal deformation: 0.37042, lambda: 14.9282)
        Cost going from 526135 to 526133
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.263059
...done!
maximalDeformation: 0.788289
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.80982
...done!
=======================
Bad trial move (maximal deformation: 0.788289, lambda: 13.5711)
        Cost going from 526133 to 526133
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.5711 to 27.1422 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Time taken to solve the Levenberg-Marquardt system of equations: 0.260926
...done!
maximalDeformation: 0.416875
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.86237
...done!
=======================
Good trial move (maximal deformation: 0.416875, lambda: 27.1422)
        Cost going from 526133 to 526125
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.256674
...done!
maximalDeformation: 0.233337
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79627
...done!
=======================
Good trial move (maximal deformation: 0.233337, lambda: 24.6748)
        Cost going from 526125 to 526121
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522294
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.346 80.464 48.1874 ]
EM Iteration: 1  ->  522295
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 19 was 527205
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa162a20)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 53368566
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.79725
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209095
...done!
maximalDeformation: 2.46958
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 812592 has managed to turn bad (detJ: -0.283015)
Time taken to rasterize Levenberg-Marquardt: 0.117976
...done!
=======================
Bad trial move (maximal deformation: 2.46958, lambda: 1)
        Cost going from 526121 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.21643
...done!
maximalDeformation: 1.59416
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 812592 has managed to turn bad (detJ: -0.0237155)
Time taken to rasterize Levenberg-Marquardt: 0.123488
...done!
=======================
Bad trial move (maximal deformation: 1.59416, lambda: 2)
        Cost going from 526121 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208969
...done!
maximalDeformation: 0.964881
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76857
...done!
=======================
Bad trial move (maximal deformation: 0.964881, lambda: 4)
        Cost going from 526121 to 526206
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208197
...done!
maximalDeformation: 0.54857
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.72447
...done!
=======================
Bad trial move (maximal deformation: 0.54857, lambda: 8)
        Cost going from 526121 to 526142
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.202792
...done!
maximalDeformation: 0.296133
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71221
...done!
=======================
Bad trial move (maximal deformation: 0.296133, lambda: 16)
        Cost going from 526121 to 526123
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192513
...done!
maximalDeformation: 0.154338
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71833
...done!
=======================
Good trial move (maximal deformation: 0.154338, lambda: 32)
        Cost going from 526121 to 526118
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213349
...done!
maximalDeformation: 0.205094
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.73288
...done!
=======================
Good trial move (maximal deformation: 0.205094, lambda: 29.0909)
        Cost going from 526118 to 526116
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19528
...done!
maximalDeformation: 0.263878
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61514
...done!
=======================
Good trial move (maximal deformation: 0.263878, lambda: 26.4463)
        Cost going from 526116 to 526115
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208164
...done!
maximalDeformation: 0.24254
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66988
...done!
=======================
Good trial move (maximal deformation: 0.24254, lambda: 24.0421)
        Cost going from 526115 to 526113
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207186
...done!
maximalDeformation: 0.463427
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62994
...done!
=======================
Good trial move (maximal deformation: 0.463427, lambda: 21.8564)
        Cost going from 526113 to 526112
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219154
...done!
maximalDeformation: 0.399245
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65461
...done!
=======================
Good trial move (maximal deformation: 0.399245, lambda: 19.8695)
        Cost going from 526112 to 526110
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222051
...done!
maximalDeformation: 0.600216
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66207
...done!
=======================
Bad trial move (maximal deformation: 0.600216, lambda: 18.0632)
        Cost going from 526110 to 526110
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.218689
...done!
maximalDeformation: 0.310267
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64685
...done!
=======================
Good trial move (maximal deformation: 0.310267, lambda: 36.1263)
        Cost going from 526110 to 526106
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232162
...done!
maximalDeformation: 0.197151
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66928
...done!
=======================
Good trial move (maximal deformation: 0.197151, lambda: 32.8421)
        Cost going from 526106 to 526103
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22948
...done!
maximalDeformation: 0.237118
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66604
...done!
=======================
Good trial move (maximal deformation: 0.237118, lambda: 29.8565)
        Cost going from 526103 to 526102
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241072
...done!
maximalDeformation: 0.183886
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68317
...done!
=======================
Good trial move (maximal deformation: 0.183886, lambda: 27.1422)
        Cost going from 526102 to 526101
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239042
...done!
maximalDeformation: 0.352102
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6847
...done!
=======================
Good trial move (maximal deformation: 0.352102, lambda: 24.6748)
        Cost going from 526101 to 526100
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522275
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.348 80.4657 48.189 ]
EM Iteration: 1  ->  522274
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.347 80.4656 48.1896 ]
EM Iteration: 2  ->  522275
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 20 was 527184
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xf187940)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 56305003
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61152
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193859
...done!
maximalDeformation: 3.25224
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1296790 has managed to turn bad (detJ: -0.57637)
Time taken to rasterize Levenberg-Marquardt: 0.280429
...done!
=======================
Bad trial move (maximal deformation: 3.25224, lambda: 1)
        Cost going from 526100 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189301
...done!
maximalDeformation: 2.13347
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1296790 has managed to turn bad (detJ: -0.0712667)
Time taken to rasterize Levenberg-Marquardt: 0.278304
...done!
=======================
Bad trial move (maximal deformation: 2.13347, lambda: 2)
        Cost going from 526100 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184365
...done!
maximalDeformation: 1.2968
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5669
...done!
=======================
Bad trial move (maximal deformation: 1.2968, lambda: 4)
        Cost going from 526100 to 526178
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180384
...done!
maximalDeformation: 0.736324
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57196
...done!
=======================
Bad trial move (maximal deformation: 0.736324, lambda: 8)
        Cost going from 526100 to 526121
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180789
...done!
maximalDeformation: 0.396275
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57252
...done!
=======================
Bad trial move (maximal deformation: 0.396275, lambda: 16)
        Cost going from 526100 to 526101
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.179022
...done!
maximalDeformation: 0.206332
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57111
...done!
=======================
Good trial move (maximal deformation: 0.206332, lambda: 32)
        Cost going from 526100 to 526097
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194461
...done!
maximalDeformation: 0.280543
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62107
...done!
=======================
Good trial move (maximal deformation: 0.280543, lambda: 29.0909)
        Cost going from 526097 to 526096
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.179806
...done!
maximalDeformation: 0.287134
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58073
...done!
=======================
Good trial move (maximal deformation: 0.287134, lambda: 26.4463)
        Cost going from 526096 to 526095
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200523
...done!
maximalDeformation: 0.242883
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62189
...done!
=======================
Good trial move (maximal deformation: 0.242883, lambda: 24.0421)
        Cost going from 526095 to 526094
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195851
...done!
maximalDeformation: 0.460396
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61711
...done!
=======================
Good trial move (maximal deformation: 0.460396, lambda: 21.8564)
        Cost going from 526094 to 526093
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215475
...done!
maximalDeformation: 0.365488
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6448
...done!
=======================
Good trial move (maximal deformation: 0.365488, lambda: 19.8695)
        Cost going from 526093 to 526092
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210241
...done!
maximalDeformation: 0.388282
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6317
...done!
=======================
Good trial move (maximal deformation: 0.388282, lambda: 18.0632)
        Cost going from 526092 to 526090
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228887
...done!
maximalDeformation: 0.63426
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66886
...done!
=======================
Bad trial move (maximal deformation: 0.63426, lambda: 16.4211)
        Cost going from 526090 to 526091
Transforming mesh
Done transforming mesh
        Increasing lambda from 16.4211 to 32.8421 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Time taken to solve the Levenberg-Marquardt system of equations: 0.229974
...done!
maximalDeformation: 0.329847
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65894
...done!
=======================
Good trial move (maximal deformation: 0.329847, lambda: 32.8421)
        Cost going from 526090 to 526085
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220337
...done!
maximalDeformation: 0.191227
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65799
...done!
=======================
Good trial move (maximal deformation: 0.191227, lambda: 29.8565)
        Cost going from 526085 to 526083
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237733
...done!
maximalDeformation: 0.251402
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67969
...done!
=======================
Good trial move (maximal deformation: 0.251402, lambda: 27.1422)
        Cost going from 526083 to 526082
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232626
...done!
maximalDeformation: 0.238519
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67294
...done!
=======================
Good trial move (maximal deformation: 0.238519, lambda: 24.6748)
        Cost going from 526082 to 526081
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522258
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.346 80.4664 48.191 ]
EM Iteration: 1  ->  522258
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.345 80.4656 48.1919 ]
EM Iteration: 2  ->  522258
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 21 was 527164
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xd420a50)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 59241440
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62619
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195453
...done!
maximalDeformation: 5.23432
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 354235 has managed to turn bad (detJ: -0.0174044)
Time taken to rasterize Levenberg-Marquardt: 0.020443
...done!
=======================
Bad trial move (maximal deformation: 5.23432, lambda: 1)
        Cost going from 526081 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189425
...done!
maximalDeformation: 3.46862
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 812592 has managed to turn bad (detJ: -0.138335)
Time taken to rasterize Levenberg-Marquardt: 0.106918
...done!
=======================
Bad trial move (maximal deformation: 3.46862, lambda: 2)
        Cost going from 526081 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185257
...done!
maximalDeformation: 2.07483
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5733
...done!
=======================
Bad trial move (maximal deformation: 2.07483, lambda: 4)
        Cost going from 526081 to 533172
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183384
...done!
maximalDeformation: 1.15524
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57041
...done!
=======================
Bad trial move (maximal deformation: 1.15524, lambda: 8)
        Cost going from 526081 to 526109
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18345
...done!
maximalDeformation: 0.613036
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57286
...done!
=======================
Bad trial move (maximal deformation: 0.613036, lambda: 16)
        Cost going from 526081 to 526085
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181424
...done!
maximalDeformation: 0.316169
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57046
...done!
=======================
Good trial move (maximal deformation: 0.316169, lambda: 32)
        Cost going from 526081 to 526079
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200155
...done!
maximalDeformation: 0.295806
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61317
...done!
=======================
Good trial move (maximal deformation: 0.295806, lambda: 29.0909)
        Cost going from 526079 to 526077
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194918
...done!
maximalDeformation: 0.201416
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60092
...done!
=======================
Good trial move (maximal deformation: 0.201416, lambda: 26.4463)
        Cost going from 526077 to 526076
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209998
...done!
maximalDeformation: 0.247903
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63511
...done!
=======================
Good trial move (maximal deformation: 0.247903, lambda: 24.0421)
        Cost going from 526076 to 526075
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207242
...done!
maximalDeformation: 0.389728
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63363
...done!
=======================
Good trial move (maximal deformation: 0.389728, lambda: 21.8564)
        Cost going from 526075 to 526074
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223013
...done!
maximalDeformation: 0.315577
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65244
...done!
=======================
Good trial move (maximal deformation: 0.315577, lambda: 19.8695)
        Cost going from 526074 to 526072
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222995
...done!
maximalDeformation: 0.335828
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65857
...done!
=======================
Good trial move (maximal deformation: 0.335828, lambda: 18.0632)
        Cost going from 526072 to 526071
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234936
...done!
maximalDeformation: 0.371507
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67314
...done!
=======================
Good trial move (maximal deformation: 0.371507, lambda: 16.4211)
        Cost going from 526071 to 526068
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234398
...done!
maximalDeformation: 0.778187
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67511
...done!
=======================
Bad trial move (maximal deformation: 0.778187, lambda: 14.9282)
        Cost going from 526068 to 526068
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.9282 to 29.8565 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Time taken to solve the Levenberg-Marquardt system of equations: 0.236149
...done!
maximalDeformation: 0.407097
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66157
...done!
=======================
Good trial move (maximal deformation: 0.407097, lambda: 29.8565)
        Cost going from 526068 to 526061
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244106
...done!
maximalDeformation: 0.306829
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67668
...done!
=======================
Good trial move (maximal deformation: 0.306829, lambda: 27.1422)
        Cost going from 526061 to 526058
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241209
...done!
maximalDeformation: 0.229401
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68674
...done!
=======================
Good trial move (maximal deformation: 0.229401, lambda: 24.6748)
        Cost going from 526058 to 526056
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522235
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.345 80.4656 48.1931 ]
EM Iteration: 1  ->  522235
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.344 80.4658 48.1932 ]
EM Iteration: 2  ->  522235
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 22 was 527139
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xdf27fd0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 62177877
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63803
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198244
...done!
maximalDeformation: 3.18232
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.611288)
Time taken to rasterize Levenberg-Marquardt: 0.00555301
...done!
=======================
Bad trial move (maximal deformation: 3.18232, lambda: 1)
        Cost going from 526056 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19262
...done!
maximalDeformation: 2.02427
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.0941798)
Time taken to rasterize Levenberg-Marquardt: 0.00509
...done!
=======================
Bad trial move (maximal deformation: 2.02427, lambda: 2)
        Cost going from 526056 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188809
...done!
maximalDeformation: 1.19505
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1810720 has managed to turn bad (detJ: -0.0316082)
Time taken to rasterize Levenberg-Marquardt: 0.569348
...done!
=======================
Bad trial move (maximal deformation: 1.19505, lambda: 4)
        Cost going from 526056 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186524
...done!
maximalDeformation: 0.663945
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57243
...done!
=======================
Bad trial move (maximal deformation: 0.663945, lambda: 8)
        Cost going from 526056 to 526073
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184594
...done!
maximalDeformation: 0.351579
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57858
...done!
=======================
Good trial move (maximal deformation: 0.351579, lambda: 16)
        Cost going from 526056 to 526056
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200281
...done!
maximalDeformation: 0.516173
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67015
...done!
=======================
Bad trial move (maximal deformation: 0.516173, lambda: 14.5455)
        Cost going from 526056 to 526057
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.5455 to 29.0909 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Time taken to solve the Levenberg-Marquardt system of equations: 0.203285
...done!
maximalDeformation: 0.267521
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61913
...done!
=======================
Good trial move (maximal deformation: 0.267521, lambda: 29.0909)
        Cost going from 526056 to 526050
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197126
...done!
maximalDeformation: 0.24529
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61759
...done!
=======================
Good trial move (maximal deformation: 0.24529, lambda: 26.4463)
        Cost going from 526050 to 526048
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.213994
...done!
maximalDeformation: 0.288661
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64773
...done!
=======================
Good trial move (maximal deformation: 0.288661, lambda: 24.0421)
        Cost going from 526048 to 526047
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204435
...done!
maximalDeformation: 0.321086
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6168
...done!
=======================
Good trial move (maximal deformation: 0.321086, lambda: 21.8564)
        Cost going from 526047 to 526044
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224821
...done!
maximalDeformation: 0.518414
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66133
...done!
=======================
Good trial move (maximal deformation: 0.518414, lambda: 19.8695)
        Cost going from 526044 to 526044
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217025
...done!
maximalDeformation: 0.40684
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65016
...done!
=======================
Good trial move (maximal deformation: 0.40684, lambda: 18.0632)
        Cost going from 526044 to 526042
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23801
...done!
maximalDeformation: 0.424076
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67987
...done!
=======================
Good trial move (maximal deformation: 0.424076, lambda: 16.4211)
        Cost going from 526042 to 526040
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228869
...done!
maximalDeformation: 0.558818
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67472
...done!
=======================
Good trial move (maximal deformation: 0.558818, lambda: 14.9282)
        Cost going from 526040 to 526039
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249459
...done!
maximalDeformation: 0.525095
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69572
...done!
=======================
Bad trial move (maximal deformation: 0.525095, lambda: 13.5711)
        Cost going from 526039 to 526040
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.5711 to 27.1422 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Time taken to solve the Levenberg-Marquardt system of equations: 0.249161
...done!
maximalDeformation: 0.273971
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69117
...done!
=======================
Good trial move (maximal deformation: 0.273971, lambda: 27.1422)
        Cost going from 526039 to 526032
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238102
...done!
maximalDeformation: 0.222179
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68878
...done!
=======================
Good trial move (maximal deformation: 0.222179, lambda: 24.6748)
        Cost going from 526032 to 526029
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522211
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.343 80.4655 48.1927 ]
EM Iteration: 1  ->  522210
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.341 80.464 48.1923 ]
EM Iteration: 2  ->  522211
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 23 was 527111
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc260fd0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 65114314
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6324
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195215
...done!
maximalDeformation: 3.03082
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.757284)
Time taken to rasterize Levenberg-Marquardt: 0.0812731
...done!
=======================
Bad trial move (maximal deformation: 3.03082, lambda: 1)
        Cost going from 526029 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189031
...done!
maximalDeformation: 1.96815
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.0918344)
Time taken to rasterize Levenberg-Marquardt: 0.0799129
...done!
=======================
Bad trial move (maximal deformation: 1.96815, lambda: 2)
        Cost going from 526029 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184847
...done!
maximalDeformation: 1.17295
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58302
...done!
=======================
Bad trial move (maximal deformation: 1.17295, lambda: 4)
        Cost going from 526029 to 526100
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18304
...done!
maximalDeformation: 0.654259
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57149
...done!
=======================
Bad trial move (maximal deformation: 0.654259, lambda: 8)
        Cost going from 526029 to 526048
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182056
...done!
maximalDeformation: 0.348251
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56716
...done!
=======================
Bad trial move (maximal deformation: 0.348251, lambda: 16)
        Cost going from 526029 to 526031
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180027
...done!
maximalDeformation: 0.180065
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57107
...done!
=======================
Good trial move (maximal deformation: 0.180065, lambda: 32)
        Cost going from 526029 to 526027
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199013
...done!
maximalDeformation: 0.221817
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61092
...done!
=======================
Good trial move (maximal deformation: 0.221817, lambda: 29.0909)
        Cost going from 526027 to 526026
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193681
...done!
maximalDeformation: 0.220105
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60402
...done!
=======================
Good trial move (maximal deformation: 0.220105, lambda: 26.4463)
        Cost going from 526026 to 526025
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209223
...done!
maximalDeformation: 0.369617
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63536
...done!
=======================
Good trial move (maximal deformation: 0.369617, lambda: 24.0421)
        Cost going from 526025 to 526024
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206809
...done!
maximalDeformation: 0.322921
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63352
...done!
=======================
Good trial move (maximal deformation: 0.322921, lambda: 21.8564)
        Cost going from 526024 to 526024
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223005
...done!
maximalDeformation: 0.334718
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65361
...done!
=======================
Good trial move (maximal deformation: 0.334718, lambda: 19.8695)
        Cost going from 526024 to 526022
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222357
...done!
maximalDeformation: 0.405837
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65643
...done!
=======================
Bad trial move (maximal deformation: 0.405837, lambda: 18.0632)
        Cost going from 526022 to 526023
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.229987
...done!
maximalDeformation: 0.20982
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65831
...done!
=======================
Good trial move (maximal deformation: 0.20982, lambda: 36.1263)
        Cost going from 526022 to 526018
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236494
...done!
maximalDeformation: 0.167129
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67889
...done!
=======================
Good trial move (maximal deformation: 0.167129, lambda: 32.8421)
        Cost going from 526018 to 526016
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238069
...done!
maximalDeformation: 0.166295
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68869
...done!
=======================
Good trial move (maximal deformation: 0.166295, lambda: 29.8565)
        Cost going from 526016 to 526016
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246093
...done!
maximalDeformation: 0.266774
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68448
...done!
=======================
Good trial move (maximal deformation: 0.266774, lambda: 27.1422)
        Cost going from 526016 to 526016
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.247549
...done!
maximalDeformation: 0.284452
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6896
...done!
=======================
Good trial move (maximal deformation: 0.284452, lambda: 24.6748)
        Cost going from 526016 to 526015
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522197
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.341 80.4642 48.1918 ]
EM Iteration: 1  ->  522196
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.339 80.4635 48.1912 ]
EM Iteration: 2  ->  522196
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 24 was 527097
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x8b59440)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 68050751
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66864
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199315
...done!
maximalDeformation: 2.70432
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1082088 has managed to turn bad (detJ: -0.162431)
Time taken to rasterize Levenberg-Marquardt: 0.194509
...done!
=======================
Bad trial move (maximal deformation: 2.70432, lambda: 1)
        Cost going from 526016 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195922
...done!
maximalDeformation: 1.74685
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1810720 has managed to turn bad (detJ: -0.377712)
Time taken to rasterize Levenberg-Marquardt: 0.569658
...done!
=======================
Bad trial move (maximal deformation: 1.74685, lambda: 2)
        Cost going from 526016 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190957
...done!
maximalDeformation: 1.04642
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57567
...done!
=======================
Bad trial move (maximal deformation: 1.04642, lambda: 4)
        Cost going from 526016 to 529702
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187109
...done!
maximalDeformation: 0.587428
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56935
...done!
=======================
Bad trial move (maximal deformation: 0.587428, lambda: 8)
        Cost going from 526016 to 526038
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187187
...done!
maximalDeformation: 0.326709
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56577
...done!
=======================
Bad trial move (maximal deformation: 0.326709, lambda: 16)
        Cost going from 526016 to 526018
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185575
...done!
maximalDeformation: 0.175658
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57956
...done!
=======================
Good trial move (maximal deformation: 0.175658, lambda: 32)
        Cost going from 526016 to 526012
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20132
...done!
maximalDeformation: 0.174968
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61475
...done!
=======================
Good trial move (maximal deformation: 0.174968, lambda: 29.0909)
        Cost going from 526012 to 526011
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196877
...done!
maximalDeformation: 0.21743
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61655
...done!
=======================
Bad trial move (maximal deformation: 0.21743, lambda: 26.4463)
        Cost going from 526011 to 526011
Transforming mesh
Done transforming mesh
        Increasing lambda from 26.4463 to 52.8926 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19531
...done!
maximalDeformation: 0.112453
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59864
...done!
=======================
Good trial move (maximal deformation: 0.112453, lambda: 52.8926)
        Cost going from 526011 to 526010
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210808
...done!
maximalDeformation: 0.136385
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63621
...done!
=======================
Good trial move (maximal deformation: 0.136385, lambda: 48.0841)
        Cost going from 526010 to 526009
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208506
...done!
maximalDeformation: 0.136438
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63435
...done!
=======================
Good trial move (maximal deformation: 0.136438, lambda: 43.7129)
        Cost going from 526009 to 526008
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223229
...done!
maximalDeformation: 0.147802
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66665
...done!
=======================
Good trial move (maximal deformation: 0.147802, lambda: 39.739)
        Cost going from 526008 to 526008
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221807
...done!
maximalDeformation: 0.151892
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65403
...done!
=======================
Good trial move (maximal deformation: 0.151892, lambda: 36.1263)
        Cost going from 526008 to 526007
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235742
...done!
maximalDeformation: 0.164283
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67251
...done!
=======================
Good trial move (maximal deformation: 0.164283, lambda: 32.8421)
        Cost going from 526007 to 526006
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234377
...done!
maximalDeformation: 0.185911
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67701
...done!
=======================
Bad trial move (maximal deformation: 0.185911, lambda: 29.8565)
        Cost going from 526006 to 526006
Transforming mesh
Done transforming mesh
        Increasing lambda from 29.8565 to 59.7129 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Time taken to solve the Levenberg-Marquardt system of equations: 0.236258
...done!
maximalDeformation: 0.09608
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66612
...done!
=======================
Good trial move (maximal deformation: 0.09608, lambda: 59.7129)
        Cost going from 526006 to 526005
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245171
...done!
maximalDeformation: 0.157802
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68751
...done!
=======================
Good trial move (maximal deformation: 0.157802, lambda: 54.2845)
        Cost going from 526005 to 526004
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242389
...done!
maximalDeformation: 0.158972
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68875
...done!
=======================
Good trial move (maximal deformation: 0.158972, lambda: 49.3495)
        Cost going from 526004 to 526004
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  522185
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.34 80.463 48.1898 ]
EM Iteration: 1  ->  522185
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 25 was 527086
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa9ca6b0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 71180074
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64253
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199453
...done!
maximalDeformation: 3.36327
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 855676 has managed to turn bad (detJ: -0.20479)
Time taken to rasterize Levenberg-Marquardt: 0.121243
...done!
=======================
Bad trial move (maximal deformation: 3.36327, lambda: 1)
        Cost going from 526003 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19419
...done!
maximalDeformation: 2.29768
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1296790 has managed to turn bad (detJ: -0.0241081)
Time taken to rasterize Levenberg-Marquardt: 0.279816
...done!
=======================
Bad trial move (maximal deformation: 2.29768, lambda: 2)
        Cost going from 526003 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190247
...done!
maximalDeformation: 1.45541
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57164
...done!
=======================
Bad trial move (maximal deformation: 1.45541, lambda: 4)
        Cost going from 526003 to 526055
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186308
...done!
maximalDeformation: 0.854024
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56172
...done!
=======================
Bad trial move (maximal deformation: 0.854024, lambda: 8)
        Cost going from 526003 to 526021
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186139
...done!
maximalDeformation: 0.470498
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56685
...done!
=======================
Bad trial move (maximal deformation: 0.470498, lambda: 16)
        Cost going from 526003 to 526008
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184654
...done!
maximalDeformation: 0.24833
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58434
...done!
=======================
Bad trial move (maximal deformation: 0.24833, lambda: 32)
        Cost going from 526003 to 526004
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185796
...done!
maximalDeformation: 0.12783
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57129
...done!
=======================
Good trial move (maximal deformation: 0.12783, lambda: 64)
        Cost going from 526003 to 526003
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200965
...done!
maximalDeformation: 0.134584
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62377
...done!
=======================
Good trial move (maximal deformation: 0.134584, lambda: 58.1818)
        Cost going from 526003 to 526002
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196923
...done!
maximalDeformation: 0.123705
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60581
...done!
=======================
Good trial move (maximal deformation: 0.123705, lambda: 52.8926)
        Cost going from 526002 to 526002
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20828
...done!
maximalDeformation: 0.118098
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63616
...done!
=======================
Good trial move (maximal deformation: 0.118098, lambda: 48.0841)
        Cost going from 526002 to 526001
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208291
...done!
maximalDeformation: 0.160871
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63765
...done!
=======================
Good trial move (maximal deformation: 0.160871, lambda: 43.7129)
        Cost going from 526001 to 526001
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220352
...done!
maximalDeformation: 0.11755
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64837
...done!
=======================
Good trial move (maximal deformation: 0.11755, lambda: 39.739)
        Cost going from 526001 to 526000
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221132
...done!
maximalDeformation: 0.190531
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65667
...done!
=======================
Good trial move (maximal deformation: 0.190531, lambda: 36.1263)
        Cost going from 526000 to 526000
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231312
...done!
maximalDeformation: 0.167551
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66649
...done!
=======================
Good trial move (maximal deformation: 0.167551, lambda: 32.8421)
        Cost going from 526000 to 525999
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23219
...done!
maximalDeformation: 0.333479
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67513
...done!
=======================
Good trial move (maximal deformation: 0.333479, lambda: 29.8565)
        Cost going from 525999 to 525998
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241466
...done!
maximalDeformation: 0.244608
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68378
...done!
=======================
Good trial move (maximal deformation: 0.244608, lambda: 27.1422)
        Cost going from 525998 to 525998
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242655
...done!
maximalDeformation: 0.333919
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68625
...done!
=======================
Good trial move (maximal deformation: 0.333919, lambda: 24.6748)
        Cost going from 525998 to 525997
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522179
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.34 80.4631 48.1887 ]
EM Iteration: 1  ->  522179
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.339 80.4629 48.188 ]
EM Iteration: 2  ->  522178
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.339 80.4628 48.1874 ]
EM Iteration: 3  ->  522178
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 3
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 26 was 527078
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xf61dfa0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 74116531
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62479
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194012
...done!
maximalDeformation: 2.92867
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 48989 has managed to turn bad (detJ: -0.177579)
Time taken to rasterize Levenberg-Marquardt: 0.0055182
...done!
=======================
Bad trial move (maximal deformation: 2.92867, lambda: 1)
        Cost going from 525997 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189552
...done!
maximalDeformation: 1.8968
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1098605 has managed to turn bad (detJ: -0.256483)
Time taken to rasterize Levenberg-Marquardt: 0.199249
...done!
=======================
Bad trial move (maximal deformation: 1.8968, lambda: 2)
        Cost going from 525997 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18533
...done!
maximalDeformation: 1.13012
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56881
...done!
=======================
Bad trial move (maximal deformation: 1.13012, lambda: 4)
        Cost going from 525997 to 526094
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182458
...done!
maximalDeformation: 0.629808
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56034
...done!
=======================
Bad trial move (maximal deformation: 0.629808, lambda: 8)
        Cost going from 525997 to 526022
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182775
...done!
maximalDeformation: 0.334739
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.55656
...done!
=======================
Bad trial move (maximal deformation: 0.334739, lambda: 16)
        Cost going from 525997 to 526000
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.179069
...done!
maximalDeformation: 0.17372
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56901
...done!
=======================
Good trial move (maximal deformation: 0.17372, lambda: 32)
        Cost going from 525997 to 525994
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.197172
...done!
maximalDeformation: 0.219809
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62391
...done!
=======================
Good trial move (maximal deformation: 0.219809, lambda: 29.0909)
        Cost going from 525994 to 525993
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192744
...done!
maximalDeformation: 0.271074
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60222
...done!
=======================
Good trial move (maximal deformation: 0.271074, lambda: 26.4463)
        Cost going from 525993 to 525992
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208051
...done!
maximalDeformation: 0.252129
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63203
...done!
=======================
Good trial move (maximal deformation: 0.252129, lambda: 24.0421)
        Cost going from 525992 to 525991
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205663
...done!
maximalDeformation: 0.420305
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63032
...done!
=======================
Good trial move (maximal deformation: 0.420305, lambda: 21.8564)
        Cost going from 525991 to 525991
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221376
...done!
maximalDeformation: 0.30323
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6522
...done!
=======================
Good trial move (maximal deformation: 0.30323, lambda: 19.8695)
        Cost going from 525991 to 525990
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221786
...done!
maximalDeformation: 0.38332
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65499
...done!
=======================
Bad trial move (maximal deformation: 0.38332, lambda: 18.0632)
        Cost going from 525990 to 525991
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.228674
...done!
maximalDeformation: 0.197225
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64232
...done!
=======================
Good trial move (maximal deformation: 0.197225, lambda: 36.1263)
        Cost going from 525990 to 525986
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234813
...done!
maximalDeformation: 0.220543
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6734
...done!
=======================
Good trial move (maximal deformation: 0.220543, lambda: 32.8421)
        Cost going from 525986 to 525985
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236066
...done!
maximalDeformation: 0.184867
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67248
...done!
=======================
Good trial move (maximal deformation: 0.184867, lambda: 29.8565)
        Cost going from 525985 to 525984
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244297
...done!
maximalDeformation: 0.255135
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68143
...done!
=======================
Good trial move (maximal deformation: 0.255135, lambda: 27.1422)
        Cost going from 525984 to 525983
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245653
...done!
maximalDeformation: 0.23765
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68568
...done!
=======================
Good trial move (maximal deformation: 0.23765, lambda: 24.6748)
        Cost going from 525983 to 525983
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522166
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.339 80.4616 48.1881 ]
EM Iteration: 1  ->  522167
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 27 was 527065
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x1141e500)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 77052948
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63772
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196793
...done!
maximalDeformation: 4.84206
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.863526)
Time taken to rasterize Levenberg-Marquardt: 0.0809579
...done!
=======================
Bad trial move (maximal deformation: 4.84206, lambda: 1)
        Cost going from 525983 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193805
...done!
maximalDeformation: 2.95599
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.0661894)
Time taken to rasterize Levenberg-Marquardt: 0.0795209
...done!
=======================
Bad trial move (maximal deformation: 2.95599, lambda: 2)
        Cost going from 525983 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18983
...done!
maximalDeformation: 1.69563
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1426688 has managed to turn bad (detJ: -0.047955)
Time taken to rasterize Levenberg-Marquardt: 0.337894
...done!
=======================
Bad trial move (maximal deformation: 1.69563, lambda: 4)
        Cost going from 525983 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18571
...done!
maximalDeformation: 0.924717
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58241
...done!
=======================
Bad trial move (maximal deformation: 0.924717, lambda: 8)
        Cost going from 525983 to 526004
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185398
...done!
maximalDeformation: 0.487193
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56631
...done!
=======================
Bad trial move (maximal deformation: 0.487193, lambda: 16)
        Cost going from 525983 to 525985
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183637
...done!
maximalDeformation: 0.250345
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56195
...done!
=======================
Good trial move (maximal deformation: 0.250345, lambda: 32)
        Cost going from 525983 to 525980
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200224
...done!
maximalDeformation: 0.222679
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61219
...done!
=======================
Good trial move (maximal deformation: 0.222679, lambda: 29.0909)
        Cost going from 525980 to 525979
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195571
...done!
maximalDeformation: 0.275085
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60437
...done!
=======================
Good trial move (maximal deformation: 0.275085, lambda: 26.4463)
        Cost going from 525979 to 525978
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210207
...done!
maximalDeformation: 0.288382
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64114
...done!
=======================
Good trial move (maximal deformation: 0.288382, lambda: 24.0421)
        Cost going from 525978 to 525977
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208177
...done!
maximalDeformation: 0.444134
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63507
...done!
=======================
Good trial move (maximal deformation: 0.444134, lambda: 21.8564)
        Cost going from 525977 to 525977
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222879
...done!
maximalDeformation: 0.322391
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.654
...done!
=======================
Good trial move (maximal deformation: 0.322391, lambda: 19.8695)
        Cost going from 525977 to 525977
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223778
...done!
maximalDeformation: 0.298639
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66289
...done!
=======================
Good trial move (maximal deformation: 0.298639, lambda: 18.0632)
        Cost going from 525977 to 525976
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236314
...done!
maximalDeformation: 0.600113
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67282
...done!
=======================
Bad trial move (maximal deformation: 0.600113, lambda: 16.4211)
        Cost going from 525976 to 525977
Transforming mesh
Done transforming mesh
        Increasing lambda from 16.4211 to 32.8421 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Time taken to solve the Levenberg-Marquardt system of equations: 0.238728
...done!
maximalDeformation: 0.309421
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65238
...done!
=======================
Good trial move (maximal deformation: 0.309421, lambda: 32.8421)
        Cost going from 525976 to 525971
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233832
...done!
maximalDeformation: 0.205493
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66913
...done!
=======================
Good trial move (maximal deformation: 0.205493, lambda: 29.8565)
        Cost going from 525971 to 525969
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244493
...done!
maximalDeformation: 0.239369
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70169
...done!
=======================
Good trial move (maximal deformation: 0.239369, lambda: 27.1422)
        Cost going from 525969 to 525969
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23559
...done!
maximalDeformation: 0.285028
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68105
...done!
=======================
Good trial move (maximal deformation: 0.285028, lambda: 24.6748)
        Cost going from 525969 to 525969
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522153
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.34 80.4614 48.1861 ]
EM Iteration: 1  ->  522153
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.34 80.4613 48.1853 ]
EM Iteration: 2  ->  522153
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 28 was 527050
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x8f1dc60)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 79989385
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6405
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19662
...done!
maximalDeformation: 3.76234
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 672565 has managed to turn bad (detJ: -0.202823)
Time taken to rasterize Levenberg-Marquardt: 0.0739388
...done!
=======================
Bad trial move (maximal deformation: 3.76234, lambda: 1)
        Cost going from 525969 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192758
...done!
maximalDeformation: 2.37439
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.592571)
Time taken to rasterize Levenberg-Marquardt: 0.0804679
...done!
=======================
Bad trial move (maximal deformation: 2.37439, lambda: 2)
        Cost going from 525969 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189099
...done!
maximalDeformation: 1.39159
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57188
...done!
=======================
Bad trial move (maximal deformation: 1.39159, lambda: 4)
        Cost going from 525969 to 526076
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186449
...done!
maximalDeformation: 0.768005
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57776
...done!
=======================
Bad trial move (maximal deformation: 0.768005, lambda: 8)
        Cost going from 525969 to 525997
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186115
...done!
maximalDeformation: 0.410077
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57356
...done!
=======================
Bad trial move (maximal deformation: 0.410077, lambda: 16)
        Cost going from 525969 to 525973
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185063
...done!
maximalDeformation: 0.216519
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57503
...done!
=======================
Good trial move (maximal deformation: 0.216519, lambda: 32)
        Cost going from 525969 to 525967
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200884
...done!
maximalDeformation: 0.278085
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6107
...done!
=======================
Good trial move (maximal deformation: 0.278085, lambda: 29.0909)
        Cost going from 525967 to 525966
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194842
...done!
maximalDeformation: 0.338358
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60033
...done!
=======================
Bad trial move (maximal deformation: 0.338358, lambda: 26.4463)
        Cost going from 525966 to 525966
Transforming mesh
Done transforming mesh
        Increasing lambda from 26.4463 to 52.8926 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193949
...done!
maximalDeformation: 0.174254
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60152
...done!
=======================
Good trial move (maximal deformation: 0.174254, lambda: 52.8926)
        Cost going from 525966 to 525964
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210613
...done!
maximalDeformation: 0.150285
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62988
...done!
=======================
Good trial move (maximal deformation: 0.150285, lambda: 48.0841)
        Cost going from 525964 to 525964
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207356
...done!
maximalDeformation: 0.224061
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63411
...done!
=======================
Good trial move (maximal deformation: 0.224061, lambda: 43.7129)
        Cost going from 525964 to 525963
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224086
...done!
maximalDeformation: 0.178245
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65872
...done!
=======================
Good trial move (maximal deformation: 0.178245, lambda: 39.739)
        Cost going from 525963 to 525963
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22035
...done!
maximalDeformation: 0.178786
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.652
...done!
=======================
Good trial move (maximal deformation: 0.178786, lambda: 36.1263)
        Cost going from 525963 to 525962
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235121
...done!
maximalDeformation: 0.171848
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67737
...done!
=======================
Good trial move (maximal deformation: 0.171848, lambda: 32.8421)
        Cost going from 525962 to 525962
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231922
...done!
maximalDeformation: 0.199299
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67309
...done!
=======================
Good trial move (maximal deformation: 0.199299, lambda: 29.8565)
        Cost going from 525962 to 525962
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24516
...done!
maximalDeformation: 0.274261
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69021
...done!
=======================
Good trial move (maximal deformation: 0.274261, lambda: 27.1422)
        Cost going from 525962 to 525961
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241873
...done!
maximalDeformation: 0.214073
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68493
...done!
=======================
Good trial move (maximal deformation: 0.214073, lambda: 24.6748)
        Cost going from 525961 to 525961
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  522143
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.341 80.461 48.184 ]
EM Iteration: 1  ->  522143
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 29 was 527043
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xbc76730)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 82925802
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63721
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19505
...done!
maximalDeformation: 2.8826
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 812592 has managed to turn bad (detJ: -0.423106)
Time taken to rasterize Levenberg-Marquardt: 0.108307
...done!
=======================
Bad trial move (maximal deformation: 2.8826, lambda: 1)
        Cost going from 525961 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191391
...done!
maximalDeformation: 1.84464
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 812592 has managed to turn bad (detJ: -0.123576)
Time taken to rasterize Levenberg-Marquardt: 0.106888
...done!
=======================
Bad trial move (maximal deformation: 1.84464, lambda: 2)
        Cost going from 525961 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18856
...done!
maximalDeformation: 1.11515
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57329
...done!
=======================
Bad trial move (maximal deformation: 1.11515, lambda: 4)
        Cost going from 525961 to 526044
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184695
...done!
maximalDeformation: 0.635135
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57158
...done!
=======================
Bad trial move (maximal deformation: 0.635135, lambda: 8)
        Cost going from 525961 to 525985
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184959
...done!
maximalDeformation: 0.344096
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57011
...done!
=======================
Bad trial move (maximal deformation: 0.344096, lambda: 16)
        Cost going from 525961 to 525964
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182974
...done!
maximalDeformation: 0.179881
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56642
...done!
=======================
Good trial move (maximal deformation: 0.179881, lambda: 32)
        Cost going from 525961 to 525958
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196982
...done!
maximalDeformation: 0.212016
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61289
...done!
=======================
Good trial move (maximal deformation: 0.212016, lambda: 29.0909)
        Cost going from 525958 to 525958
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.193684
...done!
maximalDeformation: 0.269993
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60543
...done!
=======================
Good trial move (maximal deformation: 0.269993, lambda: 26.4463)
        Cost going from 525958 to 525958
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20655
...done!
maximalDeformation: 0.228446
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62775
...done!
=======================
Good trial move (maximal deformation: 0.228446, lambda: 24.0421)
        Cost going from 525958 to 525958
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206392
...done!
maximalDeformation: 0.267378
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63237
...done!
=======================
Good trial move (maximal deformation: 0.267378, lambda: 21.8564)
        Cost going from 525958 to 525957
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221908
...done!
maximalDeformation: 0.415262
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65553
...done!
=======================
Bad trial move (maximal deformation: 0.415262, lambda: 19.8695)
        Cost going from 525957 to 525958
Transforming mesh
Done transforming mesh
        Increasing lambda from 19.8695 to 39.739 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Time taken to solve the Levenberg-Marquardt system of equations: 0.223683
...done!
maximalDeformation: 0.216342
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63905
...done!
=======================
Good trial move (maximal deformation: 0.216342, lambda: 39.739)
        Cost going from 525957 to 525954
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221825
...done!
maximalDeformation: 0.143171
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6543
...done!
=======================
Good trial move (maximal deformation: 0.143171, lambda: 36.1263)
        Cost going from 525954 to 525953
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231397
...done!
maximalDeformation: 0.233583
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67715
...done!
=======================
Good trial move (maximal deformation: 0.233583, lambda: 32.8421)
        Cost going from 525953 to 525953
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22603
...done!
maximalDeformation: 0.202262
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65836
...done!
=======================
Good trial move (maximal deformation: 0.202262, lambda: 29.8565)
        Cost going from 525953 to 525952
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24019
...done!
maximalDeformation: 0.272249
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68843
...done!
=======================
Bad trial move (maximal deformation: 0.272249, lambda: 27.1422)
        Cost going from 525952 to 525953
Transforming mesh
Done transforming mesh
        Increasing lambda from 27.1422 to 54.2845 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Time taken to solve the Levenberg-Marquardt system of equations: 0.24215
...done!
maximalDeformation: 0.139088
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67832
...done!
=======================
Good trial move (maximal deformation: 0.139088, lambda: 54.2845)
        Cost going from 525952 to 525951
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233111
...done!
maximalDeformation: 0.157166
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67499
...done!
=======================
Good trial move (maximal deformation: 0.157166, lambda: 49.3495)
        Cost going from 525951 to 525950
        Decreasing lambda from 49.3495 to 44.8632
Smoothing mesh collection...done!
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 0
maximum: 182
Running for smoothing sigma 0.5
Starting EM: 
EM Iteration: 0  ->  518707
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.266 80.4499 48.4664 ]
EM Iteration: 1  ->  518686
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.25 80.4433 48.5792 ]
EM Iteration: 2  ->  518680
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.245 80.4393 48.6369 ]
EM Iteration: 3  ->  518678
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.243 80.4384 48.6673 ]
EM Iteration: 4  ->  518677
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.242 80.4379 48.6826 ]
EM Iteration: 5  ->  518676
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.24 80.437 48.6891 ]
EM Iteration: 6  ->  518676
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.238 80.4363 48.692 ]
EM Iteration: 7  ->  518676
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 7
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 0 was 523576
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x10dc1c40)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 86072409
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64986
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198379
...done!
maximalDeformation: 2.84608
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.664279)
Time taken to rasterize Levenberg-Marquardt: 0.0824039
...done!
=======================
Bad trial move (maximal deformation: 2.84608, lambda: 1)
        Cost going from 522505 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193457
...done!
maximalDeformation: 1.71288
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.0510775)
Time taken to rasterize Levenberg-Marquardt: 0.0815959
...done!
=======================
Bad trial move (maximal deformation: 1.71288, lambda: 2)
        Cost going from 522505 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18934
...done!
maximalDeformation: 0.984664
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1989105 has managed to turn bad (detJ: -0.147544)
Time taken to rasterize Levenberg-Marquardt: 0.700066
...done!
=======================
Bad trial move (maximal deformation: 0.984664, lambda: 4)
        Cost going from 522505 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187413
...done!
maximalDeformation: 0.541774
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58695
...done!
=======================
Good trial move (maximal deformation: 0.541774, lambda: 8)
        Cost going from 522505 to 522394
        Decreasing lambda from 8 to 7.27273
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.27273...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207122
...done!
maximalDeformation: 1.00403
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63232
...done!
=======================
Good trial move (maximal deformation: 1.00403, lambda: 7.27273)
        Cost going from 522394 to 522330
        Decreasing lambda from 7.27273 to 6.61157
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.61157...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200614
...done!
maximalDeformation: 0.803849
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62534
...done!
=======================
Good trial move (maximal deformation: 0.803849, lambda: 6.61157)
        Cost going from 522330 to 522307
        Decreasing lambda from 6.61157 to 6.01052
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 6.01052...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217293
...done!
maximalDeformation: 0.655624
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6593
...done!
=======================
Good trial move (maximal deformation: 0.655624, lambda: 6.01052)
        Cost going from 522307 to 522267
        Decreasing lambda from 6.01052 to 5.46411
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 5.46411...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.214715
...done!
maximalDeformation: 1.37497
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64849
...done!
=======================
Good trial move (maximal deformation: 1.37497, lambda: 5.46411)
        Cost going from 522267 to 522259
        Decreasing lambda from 5.46411 to 4.96737
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.96737...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233547
...done!
maximalDeformation: 0.883547
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67433
...done!
=======================
Good trial move (maximal deformation: 0.883547, lambda: 4.96737)
        Cost going from 522259 to 522238
        Decreasing lambda from 4.96737 to 4.51579
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4.51579...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230677
...done!
maximalDeformation: 1.31568
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67414
...done!
=======================
Bad trial move (maximal deformation: 1.31568, lambda: 4.51579)
        Cost going from 522238 to 522244
Transforming mesh
Done transforming mesh
        Increasing lambda from 4.51579 to 9.03158 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Time taken to solve the Levenberg-Marquardt system of equations: 0.224439
...done!
maximalDeformation: 0.724844
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65336
...done!
=======================
Good trial move (maximal deformation: 0.724844, lambda: 9.03158)
        Cost going from 522238 to 522155
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240899
...done!
maximalDeformation: 0.815061
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68996
...done!
=======================
Good trial move (maximal deformation: 0.815061, lambda: 8.21053)
        Cost going from 522155 to 522132
        Decreasing lambda from 8.21053 to 7.46412
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 7.46412...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235928
...done!
maximalDeformation: 0.904742
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68544
...done!
=======================
Bad trial move (maximal deformation: 0.904742, lambda: 7.46412)
        Cost going from 522132 to 522137
Transforming mesh
Done transforming mesh
        Increasing lambda from 7.46412 to 14.9282 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Time taken to solve the Levenberg-Marquardt system of equations: 0.223768
...done!
maximalDeformation: 0.492573
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66344
...done!
=======================
Good trial move (maximal deformation: 0.492573, lambda: 14.9282)
        Cost going from 522132 to 522110
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246696
...done!
maximalDeformation: 0.692012
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71065
...done!
=======================
Good trial move (maximal deformation: 0.692012, lambda: 13.5711)
        Cost going from 522110 to 522098
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234201
...done!
maximalDeformation: 0.58232
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68699
...done!
=======================
Good trial move (maximal deformation: 0.58232, lambda: 12.3374)
        Cost going from 522098 to 522095
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  518134
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.257 80.4577 48.6534 ]
EM Iteration: 1  ->  518134
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.263 80.4657 48.6398 ]
EM Iteration: 2  ->  518134
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 1 was 523162
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xd278b60)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 88815940
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66527
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205457
...done!
maximalDeformation: 3.36028
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 737092 has managed to turn bad (detJ: -0.163747)
Time taken to rasterize Levenberg-Marquardt: 0.092016
...done!
=======================
Bad trial move (maximal deformation: 3.36028, lambda: 1)
        Cost going from 522082 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.198219
...done!
maximalDeformation: 2.20971
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1842361 has managed to turn bad (detJ: -0.0724696)
Time taken to rasterize Levenberg-Marquardt: 0.599218
...done!
=======================
Bad trial move (maximal deformation: 2.20971, lambda: 2)
        Cost going from 522082 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194613
...done!
maximalDeformation: 1.33598
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2659604 has managed to turn bad (detJ: -0.625747)
Time taken to rasterize Levenberg-Marquardt: 1.44369
...done!
=======================
Bad trial move (maximal deformation: 1.33598, lambda: 4)
        Cost going from 522082 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190761
...done!
maximalDeformation: 0.753821
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59928
...done!
=======================
Bad trial move (maximal deformation: 0.753821, lambda: 8)
        Cost going from 522082 to 522093
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19063
...done!
maximalDeformation: 0.404493
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59451
...done!
=======================
Good trial move (maximal deformation: 0.404493, lambda: 16)
        Cost going from 522082 to 522069
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.208537
...done!
maximalDeformation: 0.502402
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65026
...done!
=======================
Good trial move (maximal deformation: 0.502402, lambda: 14.5455)
        Cost going from 522069 to 522064
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202782
...done!
maximalDeformation: 0.838705
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62451
...done!
=======================
Good trial move (maximal deformation: 0.838705, lambda: 13.2231)
        Cost going from 522064 to 522061
        Decreasing lambda from 13.2231 to 12.021
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.021...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215662
...done!
maximalDeformation: 0.451746
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65679
...done!
=======================
Good trial move (maximal deformation: 0.451746, lambda: 12.021)
        Cost going from 522061 to 522058
        Decreasing lambda from 12.021 to 10.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 10.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.2153
...done!
maximalDeformation: 0.69515
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65493
...done!
=======================
Good trial move (maximal deformation: 0.69515, lambda: 10.9282)
        Cost going from 522058 to 522056
        Decreasing lambda from 10.9282 to 9.93474
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.93474...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226917
...done!
maximalDeformation: 0.549427
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67177
...done!
=======================
Good trial move (maximal deformation: 0.549427, lambda: 9.93474)
        Cost going from 522056 to 522054
        Decreasing lambda from 9.93474 to 9.03158
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 9.03158...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228525
...done!
maximalDeformation: 0.766186
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67934
...done!
=======================
Good trial move (maximal deformation: 0.766186, lambda: 9.03158)
        Cost going from 522054 to 522051
        Decreasing lambda from 9.03158 to 8.21053
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8.21053...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240041
...done!
maximalDeformation: 0.849266
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69312
...done!
=======================
Bad trial move (maximal deformation: 0.849266, lambda: 8.21053)
        Cost going from 522051 to 522055
Transforming mesh
Done transforming mesh
        Increasing lambda from 8.21053 to 16.4211 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Time taken to solve the Levenberg-Marquardt system of equations: 0.241612
...done!
maximalDeformation: 0.481752
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6828
...done!
=======================
Good trial move (maximal deformation: 0.481752, lambda: 16.4211)
        Cost going from 522051 to 522030
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.237989
...done!
maximalDeformation: 0.43406
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68649
...done!
=======================
Good trial move (maximal deformation: 0.43406, lambda: 14.9282)
        Cost going from 522030 to 522023
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.248642
...done!
maximalDeformation: 0.831523
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70604
...done!
=======================
Bad trial move (maximal deformation: 0.831523, lambda: 13.5711)
        Cost going from 522023 to 522024
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.5711 to 27.1422 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Time taken to solve the Levenberg-Marquardt system of equations: 0.250242
...done!
maximalDeformation: 0.43882
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67788
...done!
=======================
Good trial move (maximal deformation: 0.43882, lambda: 27.1422)
        Cost going from 522023 to 522017
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239043
...done!
maximalDeformation: 0.229683
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69345
...done!
=======================
Good trial move (maximal deformation: 0.229683, lambda: 24.6748)
        Cost going from 522017 to 522014
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  518042
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.27 80.4744 48.6273 ]
EM Iteration: 1  ->  518042
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 2 was 523093
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x119af070)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 91752357
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64463
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.199965
...done!
maximalDeformation: 4.62585
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 812592 has managed to turn bad (detJ: -0.600419)
Time taken to rasterize Levenberg-Marquardt: 0.110458
...done!
=======================
Bad trial move (maximal deformation: 4.62585, lambda: 1)
        Cost going from 522011 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194808
...done!
maximalDeformation: 2.90854
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 812592 has managed to turn bad (detJ: -0.241817)
Time taken to rasterize Levenberg-Marquardt: 0.108819
...done!
=======================
Bad trial move (maximal deformation: 2.90854, lambda: 2)
        Cost going from 522011 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192864
...done!
maximalDeformation: 1.71516
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2699192 has managed to turn bad (detJ: -0.332068)
Time taken to rasterize Levenberg-Marquardt: 1.52101
...done!
=======================
Bad trial move (maximal deformation: 1.71516, lambda: 4)
        Cost going from 522011 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188999
...done!
maximalDeformation: 0.952571
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59619
...done!
=======================
Bad trial move (maximal deformation: 0.952571, lambda: 8)
        Cost going from 522011 to 522035
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.198895
...done!
maximalDeformation: 0.506441
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61652
...done!
=======================
Bad trial move (maximal deformation: 0.506441, lambda: 16)
        Cost going from 522011 to 522014
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208312
...done!
maximalDeformation: 0.26111
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64573
...done!
=======================
Good trial move (maximal deformation: 0.26111, lambda: 32)
        Cost going from 522011 to 522008
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215751
...done!
maximalDeformation: 0.243518
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64288
...done!
=======================
Good trial move (maximal deformation: 0.243518, lambda: 29.0909)
        Cost going from 522008 to 522006
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21871
...done!
maximalDeformation: 0.192418
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66814
...done!
=======================
Good trial move (maximal deformation: 0.192418, lambda: 26.4463)
        Cost going from 522006 to 522005
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224545
...done!
maximalDeformation: 0.261249
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67478
...done!
=======================
Good trial move (maximal deformation: 0.261249, lambda: 24.0421)
        Cost going from 522005 to 522003
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236032
...done!
maximalDeformation: 0.520947
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69526
...done!
=======================
Good trial move (maximal deformation: 0.520947, lambda: 21.8564)
        Cost going from 522003 to 522003
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235816
...done!
maximalDeformation: 0.36276
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69183
...done!
=======================
Good trial move (maximal deformation: 0.36276, lambda: 19.8695)
        Cost going from 522003 to 522001
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242869
...done!
maximalDeformation: 0.300989
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69909
...done!
=======================
Good trial move (maximal deformation: 0.300989, lambda: 18.0632)
        Cost going from 522001 to 522001
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244649
...done!
maximalDeformation: 0.439704
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70019
...done!
=======================
Good trial move (maximal deformation: 0.439704, lambda: 16.4211)
        Cost going from 522001 to 521999
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.252062
...done!
maximalDeformation: 0.438796
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71239
...done!
=======================
Bad trial move (maximal deformation: 0.438796, lambda: 14.9282)
        Cost going from 521999 to 521999
Transforming mesh
Done transforming mesh
        Increasing lambda from 14.9282 to 29.8565 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Time taken to solve the Levenberg-Marquardt system of equations: 0.254096
...done!
maximalDeformation: 0.232339
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70107
...done!
=======================
Good trial move (maximal deformation: 0.232339, lambda: 29.8565)
        Cost going from 521999 to 521992
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.25097
...done!
maximalDeformation: 0.207288
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70396
...done!
=======================
Good trial move (maximal deformation: 0.207288, lambda: 27.1422)
        Cost going from 521992 to 521990
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.257762
...done!
maximalDeformation: 0.316038
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71987
...done!
=======================
Good trial move (maximal deformation: 0.316038, lambda: 24.6748)
        Cost going from 521990 to 521989
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  518007
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.274 80.4777 48.6172 ]
EM Iteration: 1  ->  518007
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.275 80.4788 48.6117 ]
EM Iteration: 2  ->  518007
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 3 was 523070
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x8c29940)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 94688794
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6181
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.191219
...done!
maximalDeformation: 5.35812
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1707501 has managed to turn bad (detJ: -0.630364)
Time taken to rasterize Levenberg-Marquardt: 0.507256
...done!
=======================
Bad trial move (maximal deformation: 5.35812, lambda: 1)
        Cost going from 521985 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186478
...done!
maximalDeformation: 3.38113
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1707501 has managed to turn bad (detJ: -0.171958)
Time taken to rasterize Levenberg-Marquardt: 0.504073
...done!
=======================
Bad trial move (maximal deformation: 3.38113, lambda: 2)
        Cost going from 521985 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195276
...done!
maximalDeformation: 1.97453
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61035
...done!
=======================
Bad trial move (maximal deformation: 1.97453, lambda: 4)
        Cost going from 521985 to 522069
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.204821
...done!
maximalDeformation: 1.08358
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64405
...done!
=======================
Bad trial move (maximal deformation: 1.08358, lambda: 8)
        Cost going from 521985 to 522010
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.204909
...done!
maximalDeformation: 0.571247
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63811
...done!
=======================
Bad trial move (maximal deformation: 0.571247, lambda: 16)
        Cost going from 521985 to 521988
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189355
...done!
maximalDeformation: 0.292922
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6134
...done!
=======================
Good trial move (maximal deformation: 0.292922, lambda: 32)
        Cost going from 521985 to 521982
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202152
...done!
maximalDeformation: 0.253836
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64015
...done!
=======================
Good trial move (maximal deformation: 0.253836, lambda: 29.0909)
        Cost going from 521982 to 521981
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.190832
...done!
maximalDeformation: 0.213876
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61946
...done!
=======================
Good trial move (maximal deformation: 0.213876, lambda: 26.4463)
        Cost going from 521981 to 521980
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212782
...done!
maximalDeformation: 0.32528
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66142
...done!
=======================
Good trial move (maximal deformation: 0.32528, lambda: 24.0421)
        Cost going from 521980 to 521980
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.209804
...done!
maximalDeformation: 0.496565
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64577
...done!
=======================
Good trial move (maximal deformation: 0.496565, lambda: 21.8564)
        Cost going from 521980 to 521979
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.227868
...done!
maximalDeformation: 0.413078
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6837
...done!
=======================
Good trial move (maximal deformation: 0.413078, lambda: 19.8695)
        Cost going from 521979 to 521978
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.221699
...done!
maximalDeformation: 0.42332
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66647
...done!
=======================
Bad trial move (maximal deformation: 0.42332, lambda: 18.0632)
        Cost going from 521978 to 521978
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.226907
...done!
maximalDeformation: 0.218282
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65869
...done!
=======================
Good trial move (maximal deformation: 0.218282, lambda: 36.1263)
        Cost going from 521978 to 521973
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238652
...done!
maximalDeformation: 0.134323
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6948
...done!
=======================
Good trial move (maximal deformation: 0.134323, lambda: 32.8421)
        Cost going from 521973 to 521971
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235377
...done!
maximalDeformation: 0.219588
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68904
...done!
=======================
Good trial move (maximal deformation: 0.219588, lambda: 29.8565)
        Cost going from 521971 to 521971
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240535
...done!
maximalDeformation: 0.222617
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6996
...done!
=======================
Good trial move (maximal deformation: 0.222617, lambda: 27.1422)
        Cost going from 521971 to 521969
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242701
...done!
maximalDeformation: 0.313754
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70055
...done!
=======================
Bad trial move (maximal deformation: 0.313754, lambda: 24.6748)
        Cost going from 521969 to 521970
Transforming mesh
Done transforming mesh
        Increasing lambda from 24.6748 to 49.3495 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Time taken to solve the Levenberg-Marquardt system of equations: 0.245603
...done!
maximalDeformation: 0.161641
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68158
...done!
=======================
Good trial move (maximal deformation: 0.161641, lambda: 49.3495)
        Cost going from 521969 to 521968
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  517982
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.278 80.4793 48.6066 ]
EM Iteration: 1  ->  517982
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 4 was 523053
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc9da7a0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 97818117
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62103
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.189627
...done!
maximalDeformation: 4.22348
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 594812 has managed to turn bad (detJ: -0.0341854)
Time taken to rasterize Levenberg-Marquardt: 0.0575309
...done!
=======================
Bad trial move (maximal deformation: 4.22348, lambda: 1)
        Cost going from 521966 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187331
...done!
maximalDeformation: 2.54062
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2166254 has managed to turn bad (detJ: -0.16476)
Time taken to rasterize Levenberg-Marquardt: 0.857447
...done!
=======================
Bad trial move (maximal deformation: 2.54062, lambda: 2)
        Cost going from 521966 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182875
...done!
maximalDeformation: 1.52915
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58372
...done!
=======================
Bad trial move (maximal deformation: 1.52915, lambda: 4)
        Cost going from 521966 to 522031
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191918
...done!
maximalDeformation: 0.864096
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60401
...done!
=======================
Bad trial move (maximal deformation: 0.864096, lambda: 8)
        Cost going from 521966 to 521988
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.203857
...done!
maximalDeformation: 0.464717
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64165
...done!
=======================
Bad trial move (maximal deformation: 0.464717, lambda: 16)
        Cost going from 521966 to 521972
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.203936
...done!
maximalDeformation: 0.241775
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63796
...done!
=======================
Bad trial move (maximal deformation: 0.241775, lambda: 32)
        Cost going from 521966 to 521966
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18971
...done!
maximalDeformation: 0.123592
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61516
...done!
=======================
Good trial move (maximal deformation: 0.123592, lambda: 64)
        Cost going from 521966 to 521965
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.203649
...done!
maximalDeformation: 0.0828858
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63415
...done!
=======================
Good trial move (maximal deformation: 0.0828858, lambda: 58.1818)
        Cost going from 521965 to 521965
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204023
...done!
maximalDeformation: 0.0920577
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64376
...done!
=======================
Good trial move (maximal deformation: 0.0920577, lambda: 52.8926)
        Cost going from 521965 to 521964
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218505
...done!
maximalDeformation: 0.151112
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66508
...done!
=======================
Good trial move (maximal deformation: 0.151112, lambda: 48.0841)
        Cost going from 521964 to 521964
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.218646
...done!
maximalDeformation: 0.198335
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66967
...done!
=======================
Good trial move (maximal deformation: 0.198335, lambda: 43.7129)
        Cost going from 521964 to 521963
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229754
...done!
maximalDeformation: 0.181621
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68002
...done!
=======================
Good trial move (maximal deformation: 0.181621, lambda: 39.739)
        Cost going from 521963 to 521963
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.230888
...done!
maximalDeformation: 0.185804
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68852
...done!
=======================
Good trial move (maximal deformation: 0.185804, lambda: 36.1263)
        Cost going from 521963 to 521962
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240642
...done!
maximalDeformation: 0.20048
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69455
...done!
=======================
Good trial move (maximal deformation: 0.20048, lambda: 32.8421)
        Cost going from 521962 to 521962
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.240337
...done!
maximalDeformation: 0.237764
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70266
...done!
=======================
Good trial move (maximal deformation: 0.237764, lambda: 29.8565)
        Cost going from 521962 to 521961
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249101
...done!
maximalDeformation: 0.259006
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70765
...done!
=======================
Good trial move (maximal deformation: 0.259006, lambda: 27.1422)
        Cost going from 521961 to 521961
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249947
...done!
maximalDeformation: 0.345158
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70815
...done!
=======================
Good trial move (maximal deformation: 0.345158, lambda: 24.6748)
        Cost going from 521961 to 521961
        Decreasing lambda from 24.6748 to 22.4316
Starting EM: 
EM Iteration: 0  ->  517970
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.281 80.4805 48.6004 ]
EM Iteration: 1  ->  517970
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.281 80.4808 48.5976 ]
EM Iteration: 2  ->  517971
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 5 was 523047
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc85bca0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 100754554
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65712
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205593
...done!
maximalDeformation: 3.54703
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 195354 has managed to turn bad (detJ: -0.0489428)
Time taken to rasterize Levenberg-Marquardt: 0.00944901
...done!
=======================
Bad trial move (maximal deformation: 3.54703, lambda: 1)
        Cost going from 521959 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.200083
...done!
maximalDeformation: 2.33433
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 572105 has managed to turn bad (detJ: -0.241979)
Time taken to rasterize Levenberg-Marquardt: 0.053004
...done!
=======================
Bad trial move (maximal deformation: 2.33433, lambda: 2)
        Cost going from 521959 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.19539
...done!
maximalDeformation: 1.41432
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2699192 has managed to turn bad (detJ: -0.148953)
Time taken to rasterize Levenberg-Marquardt: 1.51499
...done!
=======================
Bad trial move (maximal deformation: 1.41432, lambda: 4)
        Cost going from 521959 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.193682
...done!
maximalDeformation: 0.799984
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58678
...done!
=======================
Bad trial move (maximal deformation: 0.799984, lambda: 8)
        Cost going from 521959 to 521991
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.192278
...done!
maximalDeformation: 0.430499
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59885
...done!
=======================
Bad trial move (maximal deformation: 0.430499, lambda: 16)
        Cost going from 521959 to 521964
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.202263
...done!
maximalDeformation: 0.223807
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61257
...done!
=======================
Good trial move (maximal deformation: 0.223807, lambda: 32)
        Cost going from 521959 to 521956
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210339
...done!
maximalDeformation: 0.248769
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64248
...done!
=======================
Good trial move (maximal deformation: 0.248769, lambda: 29.0909)
        Cost going from 521956 to 521955
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.211185
...done!
maximalDeformation: 0.247556
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65036
...done!
=======================
Bad trial move (maximal deformation: 0.247556, lambda: 26.4463)
        Cost going from 521955 to 521955
Transforming mesh
Done transforming mesh
        Increasing lambda from 26.4463 to 52.8926 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Time taken to solve the Levenberg-Marquardt system of equations: 0.20997
...done!
maximalDeformation: 0.126921
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64947
...done!
=======================
Good trial move (maximal deformation: 0.126921, lambda: 52.8926)
        Cost going from 521955 to 521953
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219761
...done!
maximalDeformation: 0.12143
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66647
...done!
=======================
Good trial move (maximal deformation: 0.12143, lambda: 48.0841)
        Cost going from 521953 to 521952
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.22294
...done!
maximalDeformation: 0.155656
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67374
...done!
=======================
Good trial move (maximal deformation: 0.155656, lambda: 43.7129)
        Cost going from 521952 to 521952
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.23183
...done!
maximalDeformation: 0.176341
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68288
...done!
=======================
Good trial move (maximal deformation: 0.176341, lambda: 39.739)
        Cost going from 521952 to 521951
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233637
...done!
maximalDeformation: 0.166182
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69541
...done!
=======================
Bad trial move (maximal deformation: 0.166182, lambda: 36.1263)
        Cost going from 521951 to 521952
Transforming mesh
Done transforming mesh
        Increasing lambda from 36.1263 to 72.2527 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Time taken to solve the Levenberg-Marquardt system of equations: 0.224109
...done!
maximalDeformation: 0.0848347
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68408
...done!
=======================
Good trial move (maximal deformation: 0.0848347, lambda: 72.2527)
        Cost going from 521951 to 521950
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.238779
...done!
maximalDeformation: 0.12127
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70039
...done!
=======================
Good trial move (maximal deformation: 0.12127, lambda: 65.6842)
        Cost going from 521950 to 521949
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235074
...done!
maximalDeformation: 0.100218
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69386
...done!
=======================
Good trial move (maximal deformation: 0.100218, lambda: 59.7129)
        Cost going from 521949 to 521949
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.246616
...done!
maximalDeformation: 0.141273
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70069
...done!
=======================
Good trial move (maximal deformation: 0.141273, lambda: 54.2845)
        Cost going from 521949 to 521948
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244275
...done!
maximalDeformation: 0.132136
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69787
...done!
=======================
Good trial move (maximal deformation: 0.132136, lambda: 49.3495)
        Cost going from 521948 to 521948
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  517955
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.283 80.4817 48.5936 ]
EM Iteration: 1  ->  517955
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 6 was 523036
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x106a7020)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 103883877
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66038
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.204676
...done!
maximalDeformation: 2.30033
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1292113 has managed to turn bad (detJ: -0.257708)
Time taken to rasterize Levenberg-Marquardt: 0.284643
...done!
=======================
Bad trial move (maximal deformation: 2.30033, lambda: 1)
        Cost going from 521948 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.198438
...done!
maximalDeformation: 1.44996
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1292113 has managed to turn bad (detJ: -0.0631408)
Time taken to rasterize Levenberg-Marquardt: 0.281247
...done!
=======================
Bad trial move (maximal deformation: 1.44996, lambda: 2)
        Cost going from 521948 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195392
...done!
maximalDeformation: 0.856603
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59041
...done!
=======================
Bad trial move (maximal deformation: 0.856603, lambda: 4)
        Cost going from 521948 to 522013
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191247
...done!
maximalDeformation: 0.47691
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59765
...done!
=======================
Bad trial move (maximal deformation: 0.47691, lambda: 8)
        Cost going from 521948 to 521972
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191513
...done!
maximalDeformation: 0.254265
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59534
...done!
=======================
Bad trial move (maximal deformation: 0.254265, lambda: 16)
        Cost going from 521948 to 521955
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189498
...done!
maximalDeformation: 0.131525
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61049
...done!
=======================
Bad trial move (maximal deformation: 0.131525, lambda: 32)
        Cost going from 521948 to 521948
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189581
...done!
maximalDeformation: 0.0671261
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59649
...done!
=======================
Good trial move (maximal deformation: 0.0671261, lambda: 64)
        Cost going from 521948 to 521946
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.205712
...done!
maximalDeformation: 0.126082
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64416
...done!
=======================
Good trial move (maximal deformation: 0.126082, lambda: 58.1818)
        Cost going from 521946 to 521946
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200517
...done!
maximalDeformation: 0.0959757
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6256
...done!
=======================
Good trial move (maximal deformation: 0.0959757, lambda: 52.8926)
        Cost going from 521946 to 521946
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21322
...done!
maximalDeformation: 0.132296
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65506
...done!
=======================
Good trial move (maximal deformation: 0.132296, lambda: 48.0841)
        Cost going from 521946 to 521945
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212297
...done!
maximalDeformation: 0.135894
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64994
...done!
=======================
Good trial move (maximal deformation: 0.135894, lambda: 43.7129)
        Cost going from 521945 to 521945
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.225181
...done!
maximalDeformation: 0.132349
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67197
...done!
=======================
Good trial move (maximal deformation: 0.132349, lambda: 39.739)
        Cost going from 521945 to 521945
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.224588
...done!
maximalDeformation: 0.142986
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67351
...done!
=======================
Good trial move (maximal deformation: 0.142986, lambda: 36.1263)
        Cost going from 521945 to 521945
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235535
...done!
maximalDeformation: 0.209324
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69334
...done!
=======================
Good trial move (maximal deformation: 0.209324, lambda: 32.8421)
        Cost going from 521945 to 521944
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235227
...done!
maximalDeformation: 0.173373
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69338
...done!
=======================
Good trial move (maximal deformation: 0.173373, lambda: 29.8565)
        Cost going from 521944 to 521944
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24548
...done!
maximalDeformation: 0.307847
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69683
...done!
=======================
Bad trial move (maximal deformation: 0.307847, lambda: 27.1422)
        Cost going from 521944 to 521944
Transforming mesh
Done transforming mesh
        Increasing lambda from 27.1422 to 54.2845 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Time taken to solve the Levenberg-Marquardt system of equations: 0.247248
...done!
maximalDeformation: 0.156771
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69119
...done!
=======================
Good trial move (maximal deformation: 0.156771, lambda: 54.2845)
        Cost going from 521944 to 521941
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245042
...done!
maximalDeformation: 0.115906
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69754
...done!
=======================
Good trial move (maximal deformation: 0.115906, lambda: 49.3495)
        Cost going from 521941 to 521941
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  517945
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.284 80.4827 48.591 ]
EM Iteration: 1  ->  517945
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 7 was 523029
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xb4bfe10)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 107013200
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64921
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198574
...done!
maximalDeformation: 3.06202
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -1.04595)
Time taken to rasterize Levenberg-Marquardt: 0.082751
...done!
=======================
Bad trial move (maximal deformation: 3.06202, lambda: 1)
        Cost going from 521940 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.195294
...done!
maximalDeformation: 1.88561
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 703430 has managed to turn bad (detJ: -0.106956)
Time taken to rasterize Levenberg-Marquardt: 0.081265
...done!
=======================
Bad trial move (maximal deformation: 1.88561, lambda: 2)
        Cost going from 521940 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190532
...done!
maximalDeformation: 1.13003
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59131
...done!
=======================
Bad trial move (maximal deformation: 1.13003, lambda: 4)
        Cost going from 521940 to 522004
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.187162
...done!
maximalDeformation: 0.638958
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59465
...done!
=======================
Bad trial move (maximal deformation: 0.638958, lambda: 8)
        Cost going from 521940 to 521964
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.198898
...done!
maximalDeformation: 0.344662
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61873
...done!
=======================
Bad trial move (maximal deformation: 0.344662, lambda: 16)
        Cost going from 521940 to 521948
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.208447
...done!
maximalDeformation: 0.179547
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65018
...done!
=======================
Bad trial move (maximal deformation: 0.179547, lambda: 32)
        Cost going from 521940 to 521942
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.210145
...done!
maximalDeformation: 0.0918863
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64465
...done!
=======================
Good trial move (maximal deformation: 0.0918863, lambda: 64)
        Cost going from 521940 to 521940
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.212436
...done!
maximalDeformation: 0.0867533
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64419
...done!
=======================
Good trial move (maximal deformation: 0.0867533, lambda: 58.1818)
        Cost going from 521940 to 521939
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217957
...done!
maximalDeformation: 0.162087
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66989
...done!
=======================
Bad trial move (maximal deformation: 0.162087, lambda: 52.8926)
        Cost going from 521939 to 521939
Transforming mesh
Done transforming mesh
        Increasing lambda from 52.8926 to 105.785 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 105.785...
Time taken to solve the Levenberg-Marquardt system of equations: 0.216873
...done!
maximalDeformation: 0.0818328
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66233
...done!
=======================
Good trial move (maximal deformation: 0.0818328, lambda: 105.785)
        Cost going from 521939 to 521938
        Decreasing lambda from 105.785 to 96.1683
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 96.1683...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.223889
...done!
maximalDeformation: 0.0500924
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67495
...done!
=======================
Good trial move (maximal deformation: 0.0500924, lambda: 96.1683)
        Cost going from 521938 to 521938
        Decreasing lambda from 96.1683 to 87.4257
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 87.4257...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229495
...done!
maximalDeformation: 0.0781776
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68734
...done!
=======================
Good trial move (maximal deformation: 0.0781776, lambda: 87.4257)
        Cost going from 521938 to 521938
        Decreasing lambda from 87.4257 to 79.4779
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 79.4779...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236043
...done!
maximalDeformation: 0.0885639
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6876
...done!
=======================
Good trial move (maximal deformation: 0.0885639, lambda: 79.4779)
        Cost going from 521938 to 521938
        Decreasing lambda from 79.4779 to 72.2527
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241204
...done!
maximalDeformation: 0.111065
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.7103
...done!
=======================
Good trial move (maximal deformation: 0.111065, lambda: 72.2527)
        Cost going from 521938 to 521938
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.244713
...done!
maximalDeformation: 0.0845297
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71128
...done!
=======================
Good trial move (maximal deformation: 0.0845297, lambda: 65.6842)
        Cost going from 521938 to 521937
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249352
...done!
maximalDeformation: 0.112582
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70763
...done!
=======================
Good trial move (maximal deformation: 0.112582, lambda: 59.7129)
        Cost going from 521937 to 521937
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.252715
...done!
maximalDeformation: 0.122514
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71223
...done!
=======================
Good trial move (maximal deformation: 0.122514, lambda: 54.2845)
        Cost going from 521937 to 521937
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.257909
...done!
maximalDeformation: 0.0885854
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.71393
...done!
=======================
Good trial move (maximal deformation: 0.0885854, lambda: 49.3495)
        Cost going from 521937 to 521937
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  517940
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.285 80.4838 48.5904 ]
EM Iteration: 1  ->  517940
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 8 was 523026
============================================
Converged!
TODO: we're using internally an image of unsigned char pixel type to calculate the position gradients
minimum: 0
maximum: 182
Running for smoothing sigma 0
Starting EM: 
EM Iteration: 0  ->  517894
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.266 80.4817 48.6878 ]
EM Iteration: 1  ->  517891
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.267 80.4819 48.7474 ]
EM Iteration: 2  ->  517889
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.267 80.4812 48.7751 ]
EM Iteration: 3  ->  517888
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.266 80.4807 48.7863 ]
EM Iteration: 4  ->  517889
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 4
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 0 was 522974
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xc6fd6e0)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 110351356
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63118
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195868
...done!
maximalDeformation: 3.72965
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1296790 has managed to turn bad (detJ: -0.225661)
Time taken to rasterize Levenberg-Marquardt: 0.281788
...done!
=======================
Bad trial move (maximal deformation: 3.72965, lambda: 1)
        Cost going from 521867 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.191202
...done!
maximalDeformation: 2.53471
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2166254 has managed to turn bad (detJ: -0.204132)
Time taken to rasterize Levenberg-Marquardt: 0.84909
...done!
=======================
Bad trial move (maximal deformation: 2.53471, lambda: 2)
        Cost going from 521867 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.199106
...done!
maximalDeformation: 1.5373
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60744
...done!
=======================
Bad trial move (maximal deformation: 1.5373, lambda: 4)
        Cost going from 521867 to 521930
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.209243
...done!
maximalDeformation: 0.861395
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62761
...done!
=======================
Bad trial move (maximal deformation: 0.861395, lambda: 8)
        Cost going from 521867 to 521886
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.194558
...done!
maximalDeformation: 0.459101
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.59738
...done!
=======================
Bad trial move (maximal deformation: 0.459101, lambda: 16)
        Cost going from 521867 to 521870
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182064
...done!
maximalDeformation: 0.236847
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57919
...done!
=======================
Good trial move (maximal deformation: 0.236847, lambda: 32)
        Cost going from 521867 to 521865
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198698
...done!
maximalDeformation: 0.198995
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66451
...done!
=======================
Good trial move (maximal deformation: 0.198995, lambda: 29.0909)
        Cost going from 521865 to 521863
        Decreasing lambda from 29.0909 to 26.4463
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194474
...done!
maximalDeformation: 0.166306
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6102
...done!
=======================
Good trial move (maximal deformation: 0.166306, lambda: 26.4463)
        Cost going from 521863 to 521860
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207317
...done!
maximalDeformation: 0.265322
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63131
...done!
=======================
Good trial move (maximal deformation: 0.265322, lambda: 24.0421)
        Cost going from 521860 to 521859
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207012
...done!
maximalDeformation: 0.30118
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63705
...done!
=======================
Good trial move (maximal deformation: 0.30118, lambda: 21.8564)
        Cost going from 521859 to 521857
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219596
...done!
maximalDeformation: 0.355882
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65195
...done!
=======================
Good trial move (maximal deformation: 0.355882, lambda: 19.8695)
        Cost going from 521857 to 521855
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222877
...done!
maximalDeformation: 0.504558
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6601
...done!
=======================
Good trial move (maximal deformation: 0.504558, lambda: 18.0632)
        Cost going from 521855 to 521855
        Decreasing lambda from 18.0632 to 16.4211
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16.4211...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232519
...done!
maximalDeformation: 0.550798
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67425
...done!
=======================
Good trial move (maximal deformation: 0.550798, lambda: 16.4211)
        Cost going from 521855 to 521854
        Decreasing lambda from 16.4211 to 14.9282
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.9282...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.233711
...done!
maximalDeformation: 0.431044
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67601
...done!
=======================
Good trial move (maximal deformation: 0.431044, lambda: 14.9282)
        Cost going from 521854 to 521852
        Decreasing lambda from 14.9282 to 13.5711
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.5711...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.242138
...done!
maximalDeformation: 0.538954
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68786
...done!
=======================
Good trial move (maximal deformation: 0.538954, lambda: 13.5711)
        Cost going from 521852 to 521852
        Decreasing lambda from 13.5711 to 12.3374
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 12.3374...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243057
...done!
maximalDeformation: 0.505363
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69054
...done!
=======================
Good trial move (maximal deformation: 0.505363, lambda: 12.3374)
        Cost going from 521852 to 521850
        Decreasing lambda from 12.3374 to 11.2158
Starting EM: 
EM Iteration: 0  ->  517860
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.269 80.4838 48.7988 ]
EM Iteration: 1  ->  517860
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.269 80.4843 48.8031 ]
EM Iteration: 2  ->  517860
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 2
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 1 was 522958
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xa91ca70)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 113094887
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62189
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.192271
...done!
maximalDeformation: 3.78883
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 443412 has managed to turn bad (detJ: -0.0262649)
Time taken to rasterize Levenberg-Marquardt: 0.03107
...done!
=======================
Bad trial move (maximal deformation: 3.78883, lambda: 1)
        Cost going from 521853 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.189605
...done!
maximalDeformation: 2.42121
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1527364 has managed to turn bad (detJ: -0.00299855)
Time taken to rasterize Levenberg-Marquardt: 0.394127
...done!
=======================
Bad trial move (maximal deformation: 2.42121, lambda: 2)
        Cost going from 521853 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184521
...done!
maximalDeformation: 1.44787
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57353
...done!
=======================
Bad trial move (maximal deformation: 1.44787, lambda: 4)
        Cost going from 521853 to 521969
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182998
...done!
maximalDeformation: 0.816449
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57341
...done!
=======================
Bad trial move (maximal deformation: 0.816449, lambda: 8)
        Cost going from 521853 to 521874
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181792
...done!
maximalDeformation: 0.439173
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57805
...done!
=======================
Good trial move (maximal deformation: 0.439173, lambda: 16)
        Cost going from 521853 to 521845
        Decreasing lambda from 16 to 14.5455
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 14.5455...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.200069
...done!
maximalDeformation: 0.552711
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61974
...done!
=======================
Good trial move (maximal deformation: 0.552711, lambda: 14.5455)
        Cost going from 521845 to 521841
        Decreasing lambda from 14.5455 to 13.2231
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 13.2231...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194922
...done!
maximalDeformation: 0.712172
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6065
...done!
=======================
Bad trial move (maximal deformation: 0.712172, lambda: 13.2231)
        Cost going from 521841 to 521843
Transforming mesh
Done transforming mesh
        Increasing lambda from 13.2231 to 26.4463 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 26.4463...
Time taken to solve the Levenberg-Marquardt system of equations: 0.207593
...done!
maximalDeformation: 0.377851
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62685
...done!
=======================
Good trial move (maximal deformation: 0.377851, lambda: 26.4463)
        Cost going from 521841 to 521834
        Decreasing lambda from 26.4463 to 24.0421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.0421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.210813
...done!
maximalDeformation: 0.278355
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63252
...done!
=======================
Good trial move (maximal deformation: 0.278355, lambda: 24.0421)
        Cost going from 521834 to 521832
        Decreasing lambda from 24.0421 to 21.8564
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 21.8564...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21704
...done!
maximalDeformation: 0.29361
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64847
...done!
=======================
Good trial move (maximal deformation: 0.29361, lambda: 21.8564)
        Cost going from 521832 to 521831
        Decreasing lambda from 21.8564 to 19.8695
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 19.8695...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.222826
...done!
maximalDeformation: 0.384671
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65818
...done!
=======================
Good trial move (maximal deformation: 0.384671, lambda: 19.8695)
        Cost going from 521831 to 521829
        Decreasing lambda from 19.8695 to 18.0632
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 18.0632...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.229804
...done!
maximalDeformation: 0.623232
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67495
...done!
=======================
Bad trial move (maximal deformation: 0.623232, lambda: 18.0632)
        Cost going from 521829 to 521830
Transforming mesh
Done transforming mesh
        Increasing lambda from 18.0632 to 36.1263 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Time taken to solve the Levenberg-Marquardt system of equations: 0.233099
...done!
maximalDeformation: 0.325067
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65951
...done!
=======================
Good trial move (maximal deformation: 0.325067, lambda: 36.1263)
        Cost going from 521829 to 521825
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.234485
...done!
maximalDeformation: 0.19729
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67602
...done!
=======================
Good trial move (maximal deformation: 0.19729, lambda: 32.8421)
        Cost going from 521825 to 521823
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.24099
...done!
maximalDeformation: 0.215987
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68177
...done!
=======================
Good trial move (maximal deformation: 0.215987, lambda: 29.8565)
        Cost going from 521823 to 521823
        Decreasing lambda from 29.8565 to 27.1422
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 27.1422...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.243999
...done!
maximalDeformation: 0.240243
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68555
...done!
=======================
Good trial move (maximal deformation: 0.240243, lambda: 27.1422)
        Cost going from 521823 to 521822
        Decreasing lambda from 27.1422 to 24.6748
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 24.6748...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.249995
...done!
maximalDeformation: 0.346776
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68968
...done!
=======================
Bad trial move (maximal deformation: 0.346776, lambda: 24.6748)
        Cost going from 521822 to 521822
Transforming mesh
Done transforming mesh
        Increasing lambda from 24.6748 to 49.3495 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Time taken to solve the Levenberg-Marquardt system of equations: 0.250351
...done!
maximalDeformation: 0.177538
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67989
...done!
=======================
Good trial move (maximal deformation: 0.177538, lambda: 49.3495)
        Cost going from 521822 to 521819
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  517826
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.273 80.4873 48.8055 ]
EM Iteration: 1  ->  517827
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 2 was 522925
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0x9fe4340)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 116224210
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63743
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196559
...done!
maximalDeformation: 2.19986
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1098605 has managed to turn bad (detJ: -0.0599282)
Time taken to rasterize Levenberg-Marquardt: 0.201343
...done!
=======================
Bad trial move (maximal deformation: 2.19986, lambda: 1)
        Cost going from 521819 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190125
...done!
maximalDeformation: 1.48451
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2402914 has managed to turn bad (detJ: -0.0643329)
Time taken to rasterize Levenberg-Marquardt: 1.09184
...done!
=======================
Bad trial move (maximal deformation: 1.48451, lambda: 2)
        Cost going from 521819 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18845
...done!
maximalDeformation: 0.937239
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57468
...done!
=======================
Bad trial move (maximal deformation: 0.937239, lambda: 4)
        Cost going from 521819 to 521872
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.186285
...done!
maximalDeformation: 0.549178
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57374
...done!
=======================
Bad trial move (maximal deformation: 0.549178, lambda: 8)
        Cost going from 521819 to 521838
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184703
...done!
maximalDeformation: 0.30305
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58229
...done!
=======================
Bad trial move (maximal deformation: 0.30305, lambda: 16)
        Cost going from 521819 to 521823
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.184973
...done!
maximalDeformation: 0.160049
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57871
...done!
=======================
Good trial move (maximal deformation: 0.160049, lambda: 32)
        Cost going from 521819 to 521819
        Decreasing lambda from 32 to 29.0909
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.0909...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.202569
...done!
maximalDeformation: 0.188126
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61461
...done!
=======================
Bad trial move (maximal deformation: 0.188126, lambda: 29.0909)
        Cost going from 521819 to 521819
Transforming mesh
Done transforming mesh
        Increasing lambda from 29.0909 to 58.1818 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Time taken to solve the Levenberg-Marquardt system of equations: 0.207639
...done!
maximalDeformation: 0.0959385
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6251
...done!
=======================
Good trial move (maximal deformation: 0.0959385, lambda: 58.1818)
        Cost going from 521819 to 521817
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196641
...done!
maximalDeformation: 0.126803
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61134
...done!
=======================
Good trial move (maximal deformation: 0.126803, lambda: 52.8926)
        Cost going from 521817 to 521816
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.217881
...done!
maximalDeformation: 0.173575
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64805
...done!
=======================
Good trial move (maximal deformation: 0.173575, lambda: 48.0841)
        Cost going from 521816 to 521816
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.203902
...done!
maximalDeformation: 0.145017
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6221
...done!
=======================
Good trial move (maximal deformation: 0.145017, lambda: 43.7129)
        Cost going from 521816 to 521815
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.228341
...done!
maximalDeformation: 0.141858
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.6648
...done!
=======================
Good trial move (maximal deformation: 0.141858, lambda: 39.739)
        Cost going from 521815 to 521815
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.215112
...done!
maximalDeformation: 0.113567
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65071
...done!
=======================
Good trial move (maximal deformation: 0.113567, lambda: 36.1263)
        Cost going from 521815 to 521814
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239414
...done!
maximalDeformation: 0.189089
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68659
...done!
=======================
Bad trial move (maximal deformation: 0.189089, lambda: 32.8421)
        Cost going from 521814 to 521814
Transforming mesh
Done transforming mesh
        Increasing lambda from 32.8421 to 65.6842 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Time taken to solve the Levenberg-Marquardt system of equations: 0.241999
...done!
maximalDeformation: 0.0969142
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67132
...done!
=======================
Good trial move (maximal deformation: 0.0969142, lambda: 65.6842)
        Cost going from 521814 to 521813
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.226528
...done!
maximalDeformation: 0.110544
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66813
...done!
=======================
Good trial move (maximal deformation: 0.110544, lambda: 59.7129)
        Cost going from 521813 to 521812
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.248898
...done!
maximalDeformation: 0.133121
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.70017
...done!
=======================
Good trial move (maximal deformation: 0.133121, lambda: 54.2845)
        Cost going from 521812 to 521812
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.236861
...done!
maximalDeformation: 0.117516
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67936
...done!
=======================
Good trial move (maximal deformation: 0.117516, lambda: 49.3495)
        Cost going from 521812 to 521811
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  517815
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.276 80.4908 48.8066 ]
EM Iteration: 1  ->  517815
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.276 80.4919 48.8075 ]
EM Iteration: 2  ->  517815
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.276 80.4919 48.808 ]
EM Iteration: 3  ->  517814
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.274 80.4909 48.8079 ]
EM Iteration: 4  ->  517814
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 4
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 3 was 522916
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xcf4ec30)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 119353593
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64511
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.196194
...done!
maximalDeformation: 2.1463
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 672565 has managed to turn bad (detJ: -0.134723)
Time taken to rasterize Levenberg-Marquardt: 0.07392
...done!
=======================
Bad trial move (maximal deformation: 2.1463, lambda: 1)
        Cost going from 521811 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.190476
...done!
maximalDeformation: 1.35181
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1480055 has managed to turn bad (detJ: -0.00385397)
Time taken to rasterize Levenberg-Marquardt: 0.368494
...done!
=======================
Bad trial move (maximal deformation: 1.35181, lambda: 2)
        Cost going from 521811 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.188948
...done!
maximalDeformation: 0.839032
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5745
...done!
=======================
Bad trial move (maximal deformation: 0.839032, lambda: 4)
        Cost going from 521811 to 521878
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185299
...done!
maximalDeformation: 0.490326
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57716
...done!
=======================
Bad trial move (maximal deformation: 0.490326, lambda: 8)
        Cost going from 521811 to 521838
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.1846
...done!
maximalDeformation: 0.268667
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58345
...done!
=======================
Bad trial move (maximal deformation: 0.268667, lambda: 16)
        Cost going from 521811 to 521820
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182534
...done!
maximalDeformation: 0.141249
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58035
...done!
=======================
Bad trial move (maximal deformation: 0.141249, lambda: 32)
        Cost going from 521811 to 521813
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.182691
...done!
maximalDeformation: 0.0725756
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57629
...done!
=======================
Good trial move (maximal deformation: 0.0725756, lambda: 64)
        Cost going from 521811 to 521810
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.20001
...done!
maximalDeformation: 0.161113
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62869
...done!
=======================
Good trial move (maximal deformation: 0.161113, lambda: 58.1818)
        Cost going from 521810 to 521810
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.194643
...done!
maximalDeformation: 0.120876
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60429
...done!
=======================
Good trial move (maximal deformation: 0.120876, lambda: 52.8926)
        Cost going from 521810 to 521810
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.207483
...done!
maximalDeformation: 0.148526
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64188
...done!
=======================
Good trial move (maximal deformation: 0.148526, lambda: 48.0841)
        Cost going from 521810 to 521810
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206227
...done!
maximalDeformation: 0.108401
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63261
...done!
=======================
Good trial move (maximal deformation: 0.108401, lambda: 43.7129)
        Cost going from 521810 to 521809
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220888
...done!
maximalDeformation: 0.227506
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65124
...done!
=======================
Good trial move (maximal deformation: 0.227506, lambda: 39.739)
        Cost going from 521809 to 521809
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.220997
...done!
maximalDeformation: 0.192021
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66548
...done!
=======================
Good trial move (maximal deformation: 0.192021, lambda: 36.1263)
        Cost going from 521809 to 521809
        Decreasing lambda from 36.1263 to 32.8421
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32.8421...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232947
...done!
maximalDeformation: 0.132678
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67061
...done!
=======================
Good trial move (maximal deformation: 0.132678, lambda: 32.8421)
        Cost going from 521809 to 521808
        Decreasing lambda from 32.8421 to 29.8565
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 29.8565...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231812
...done!
maximalDeformation: 0.169732
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67966
...done!
=======================
Bad trial move (maximal deformation: 0.169732, lambda: 29.8565)
        Cost going from 521808 to 521809
Transforming mesh
Done transforming mesh
        Increasing lambda from 29.8565 to 59.7129 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Time taken to solve the Levenberg-Marquardt system of equations: 0.22171
...done!
maximalDeformation: 0.0871005
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65429
...done!
=======================
Good trial move (maximal deformation: 0.0871005, lambda: 59.7129)
        Cost going from 521808 to 521806
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.239874
...done!
maximalDeformation: 0.0825162
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67845
...done!
=======================
Good trial move (maximal deformation: 0.0825162, lambda: 54.2845)
        Cost going from 521806 to 521806
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.232363
...done!
maximalDeformation: 0.114977
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67553
...done!
=======================
Good trial move (maximal deformation: 0.114977, lambda: 49.3495)
        Cost going from 521806 to 521806
        Decreasing lambda from 49.3495 to 44.8632
Starting EM: 
EM Iteration: 0  ->  517807
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.275 80.4907 48.8072 ]
EM Iteration: 1  ->  517807
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 4 was 522910
============================================
m_PositionUpdatingMaximumNumberOfIterations: 11
Transforming mesh
Done transforming mesh
m_MeshToImageTransform: 
AffineTransform (0x1c8d010)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 391
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
meshToImageTransform: 
AffineTransform (0xb11a610)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 122482916
  Debug: Off
  Observers: 
    none
  Matrix: 
    0.769913 0.0131937 0.0502764 
    0.0148461 0.783345 0.358708 
    -0.000905699 -0.322302 0.739285 
  Offset: [8.10265, 10.161, 33.5007]
  Center: [0, 0, 0]
  Translation: [8.10265, 10.161, 33.5007]
  Inverse: 
    1.29971 -0.0485629 -0.064826 
    -0.0211411 1.06493 -0.515275 
    -0.00762454 0.464211 1.12794 
  Singular: 0
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.62646
...done!
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 1...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.195982
...done!
maximalDeformation: 2.28842
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 1480055 has managed to turn bad (detJ: -0.421278)
Time taken to rasterize Levenberg-Marquardt: 0.370063
...done!
=======================
Bad trial move (maximal deformation: 2.28842, lambda: 1)
        Cost going from 521806 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 1 to 2 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 2...
Time taken to solve the Levenberg-Marquardt system of equations: 0.18957
...done!
maximalDeformation: 1.40463
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Oooooops: tetrahedron 2402914 has managed to turn bad (detJ: -0.0623742)
Time taken to rasterize Levenberg-Marquardt: 1.08909
...done!
=======================
Bad trial move (maximal deformation: 1.40463, lambda: 2)
        Cost going from 521806 to 1.79769e+308
Transforming mesh
Done transforming mesh
        Increasing lambda from 2 to 4 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 4...
Time taken to solve the Levenberg-Marquardt system of equations: 0.185534
...done!
maximalDeformation: 0.809968
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.58099
...done!
=======================
Bad trial move (maximal deformation: 0.809968, lambda: 4)
        Cost going from 521806 to 521871
Transforming mesh
Done transforming mesh
        Increasing lambda from 4 to 8 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 8...
Time taken to solve the Levenberg-Marquardt system of equations: 0.183377
...done!
maximalDeformation: 0.442891
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56513
...done!
=======================
Bad trial move (maximal deformation: 0.442891, lambda: 8)
        Cost going from 521806 to 521832
Transforming mesh
Done transforming mesh
        Increasing lambda from 8 to 16 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 16...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181886
...done!
maximalDeformation: 0.233284
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.5633
...done!
=======================
Bad trial move (maximal deformation: 0.233284, lambda: 16)
        Cost going from 521806 to 521814
Transforming mesh
Done transforming mesh
        Increasing lambda from 16 to 32 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 32...
Time taken to solve the Levenberg-Marquardt system of equations: 0.180097
...done!
maximalDeformation: 0.119803
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.57633
...done!
=======================
Bad trial move (maximal deformation: 0.119803, lambda: 32)
        Cost going from 521806 to 521807
Transforming mesh
Done transforming mesh
        Increasing lambda from 32 to 64 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 64...
Time taken to solve the Levenberg-Marquardt system of equations: 0.181455
...done!
maximalDeformation: 0.0608528
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.56412
...done!
=======================
Good trial move (maximal deformation: 0.0608528, lambda: 64)
        Cost going from 521806 to 521805
        Decreasing lambda from 64 to 58.1818
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 58.1818...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.198418
...done!
maximalDeformation: 0.121576
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.61637
...done!
=======================
Good trial move (maximal deformation: 0.121576, lambda: 58.1818)
        Cost going from 521805 to 521805
        Decreasing lambda from 58.1818 to 52.8926
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 52.8926...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.19479
...done!
maximalDeformation: 0.127633
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.60823
...done!
=======================
Good trial move (maximal deformation: 0.127633, lambda: 52.8926)
        Cost going from 521805 to 521804
        Decreasing lambda from 52.8926 to 48.0841
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 48.0841...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206318
...done!
maximalDeformation: 0.0906332
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63229
...done!
=======================
Good trial move (maximal deformation: 0.0906332, lambda: 48.0841)
        Cost going from 521804 to 521804
        Decreasing lambda from 48.0841 to 43.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 43.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.206186
...done!
maximalDeformation: 0.137953
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.63299
...done!
=======================
Good trial move (maximal deformation: 0.137953, lambda: 43.7129)
        Cost going from 521804 to 521804
        Decreasing lambda from 43.7129 to 39.739
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 39.739...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.21883
...done!
maximalDeformation: 0.114551
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.64506
...done!
=======================
Good trial move (maximal deformation: 0.114551, lambda: 39.739)
        Cost going from 521804 to 521804
        Decreasing lambda from 39.739 to 36.1263
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 36.1263...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.219865
...done!
maximalDeformation: 0.136203
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.65953
...done!
=======================
Bad trial move (maximal deformation: 0.136203, lambda: 36.1263)
        Cost going from 521804 to 521804
Transforming mesh
Done transforming mesh
        Increasing lambda from 36.1263 to 72.2527 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 72.2527...
Time taken to solve the Levenberg-Marquardt system of equations: 0.22796
...done!
maximalDeformation: 0.0698101
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.66285
...done!
=======================
Good trial move (maximal deformation: 0.0698101, lambda: 72.2527)
        Cost going from 521804 to 521802
        Decreasing lambda from 72.2527 to 65.6842
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 65.6842...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.231895
...done!
maximalDeformation: 0.0622064
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.76286
...done!
=======================
Good trial move (maximal deformation: 0.0622064, lambda: 65.6842)
        Cost going from 521802 to 521802
        Decreasing lambda from 65.6842 to 59.7129
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 59.7129...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.235573
...done!
maximalDeformation: 0.141545
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.67865
...done!
=======================
Good trial move (maximal deformation: 0.141545, lambda: 59.7129)
        Cost going from 521802 to 521802
        Decreasing lambda from 59.7129 to 54.2845
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 54.2845...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.241733
...done!
maximalDeformation: 0.114002
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68944
...done!
=======================
Good trial move (maximal deformation: 0.114002, lambda: 54.2845)
        Cost going from 521802 to 521802
        Decreasing lambda from 54.2845 to 49.3495
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 49.3495...
Set m_ContributionsFromLastTetrahdronFlushedOut to true: 1
Time taken to solve the Levenberg-Marquardt system of equations: 0.245754
...done!
maximalDeformation: 0.13212
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.69616
...done!
=======================
Bad trial move (maximal deformation: 0.13212, lambda: 49.3495)
        Cost going from 521802 to 521802
Transforming mesh
Done transforming mesh
        Increasing lambda from 49.3495 to 98.6991 and trying again.
Transforming mesh
Done transforming mesh
Calculating Levenberg-Marquardt step with lambda 98.6991...
Time taken to solve the Levenberg-Marquardt system of equations: 0.249116
...done!
maximalDeformation: 0.0670676
Transforming mesh
Done transforming mesh
Rasterizing Levenberg-Marquardt...
numberOfEntries: 24131
Time taken to rasterize Levenberg-Marquardt: 1.68322
...done!
=======================
Good trial move (maximal deformation: 0.0670676, lambda: 98.6991)
        Cost going from 521802 to 521801
        Decreasing lambda from 98.6991 to 89.7264
Starting EM: 
EM Iteration: 0  ->  517801
Updating mixture model parameters
Readjusting weight of shared classes
Updating bias field model parameters
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
m_Means: [  108.276 80.4921 48.8065 ]
EM Iteration: 1  ->  517801
EM converged
Maximal bias field order already reached; EM finished
Stopped EM
         m_IterationNumber: 1
         m_MaximumNumberOfIterations: 100
============================================
Cost for iteration 5 was 522905
============================================
Converged!
estimating polynomial parameters up to order 0
       numberOfBasisFunctionsUsed: 1
numberOfBasisFunctions: 1
numberOfVoxelsInMask: 132880
indexWhereUnityIsReached [96, 124, 152]
Successfully put up x, y, and z
Constructing basis functions
      (xOrder, yOrder, zOrder): (0, 0, 0)
Transforming points
Transforming points
Mapping warped mesh back to original space
Transforming points
Abusing EM segmenter now...
Original class 0 is distributed over 1 classes
Original class 1 is distributed over 1 classes
Original class 2 is distributed over 1 classes
Original class 3 is distributed over 1 classes
Original class 4 is distributed over 1 classes
Original class 5 is distributed over 1 classes
Original class 6 is distributed over 1 classes
Original class 7 is distributed over 1 classes
Original class 8 is distributed over 1 classes
Original class 9 is distributed over 1 classes
Original class 10 is distributed over 1 classes
OK
myAbusedEMSegmenter->GetMeans(): [ 48.8065 108.276 80.4921 80.4921 80.4921 80.4921 108.276 80.4921 48.8065 80.4921 80.4921]
myAbusedEMSegmenter->GetVariances(): [ 304.197 72.98 101.729 101.729 101.729 101.729 72.98 101.729 304.197 101.729 101.729]
myAbusedEMSegmenter->GetPriorWeights(): [ 1 1 1 1 1 1 1 1 1 1 1]
-- Starting
-- Initializing
-- Doing the rest
-- Starting to update posteriors
-- done
Still here...
Splitting affine matrix up into spacing, origin, and direction components
AffineTransform (0xfa5e260)
  RTTI typeinfo:   itk::AffineTransform<float, 3u>
  Reference Count: 1
  Modified Time: 126010431
  Debug: Off
  Observers: 
    none
  Matrix: 
    -0.5 -2.98023e-08 0 
    0 0 0.5 
    2.98023e-08 -0.5 0 
  Offset: [47.2502, -13.6035, 12.3574]
  Center: [0, 0, 0]
  Translation: [47.2502, -13.6035, 12.3574]
  Inverse: 
    -2 0 1.19209e-07 
    -1.19209e-07 0 -2 
    0 2 0 
  Singular: 0
spacing: [0.5, 0.5, 0.5]
origin: [47.2502, -13.6035, 12.3574]
direction: -1 -5.96046e-08 0
0 0 1
5.96046e-08 -1 0

done!
Skipping the partial volume segmentation part
