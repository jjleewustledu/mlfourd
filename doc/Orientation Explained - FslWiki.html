<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="index,nofollow">

<title>Orientation Explained - FslWiki</title>
<script type="text/javascript" src="/fsl/wiki_static/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/fsl/wiki_static/fsl/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="/fsl/wiki_static/fsl/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="/fsl/wiki_static/fsl/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="/fsl/wiki_static/fsl/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/fsl/wiki_static/fsl/css/msie.css">
<![endif]-->


<link rel="alternate" title="FslWiki: Orientation Explained" href="/fsl/fslwiki/Orientation%20Explained?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Orientation+Explained&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="/fsl/fslwiki/FSL">
<link rel="Alternate" title="Wiki Markup" href="/fsl/fslwiki/Orientation%20Explained?action=raw">
<link rel="Alternate" media="print" title="Print View" href="/fsl/fslwiki/Orientation%20Explained?action=print">
<link rel="Search" href="/fsl/fslwiki/FindPage">
<link rel="Index" href="/fsl/fslwiki/TitleIndex">
<link rel="Glossary" href="/fsl/fslwiki/WordIndex">
<link rel="Help" href="/fsl/fslwiki/HelpOnFormatting">
</head>

<body  lang="en" dir="ltr">

<div id="header">
<div id="logo"><a href="/fsl/fslwiki/FSL"><img src="/fsl/wiki_static/fsl/img/fsl-logo-x2.png" width="108px" height="80px" alt="FSL Logo"></a></div>

<form id="searchform" method="get" action="/fsl/fslwiki/Orientation%20Explained">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<!-- <input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles"> -->
<input id="fullsearch" name="fullsearch" type="submit"
    value="Search" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="/fsl/fslwiki/FslHelpForUsers">Help</a></li><li><a href="/fsl/fslwiki/Orientation%20Explained?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">


<ul id="pagelocation">
<li><a href="/fsl/fslwiki/Orientation%20Explained">Orientation Explained</a></li>
</ul>

</div>

<div id="pageline"><hr style="display:none;"></div>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867">
<h1 id="Introduction">Introduction</h1>
<span class="anchor" id="line-4"></span><p class="line862">Orientation, labelling and getting left and right correct are important but often confusing issues. You should always look at your data and check if the labels in FSLView are correct. <strong><em>No further analysis should ever be done if the labels in FSLView are incorrect or missing</em>.</strong> If your labels are fine then you are very unlikely to ever need any other these tools, except <tt class="backtick">fslreorient2std</tt>, which is more generally useful. Please note that there is a risk of left-right swaps occuring if you use make any mistakes when using <tt class="backtick">fslswapdim</tt> or <tt class="backtick">fslorient</tt>, and so we <em>strongly recommend against using these tools unless you have incorrect labels</em>.  It is <em>never</em> necessary to use these tools otherwise, since FSL works perfectly well with LAS, RAS or any other storage order for images. All the visualisation tools and the analysis tools take care of everything behind the scene and any combination of such orders can be used, so please don't try and change these things unless the labels are wrong, as that is the only case where we recommend such changes. <span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><p class="line862">If your labels <em>are</em> wrong then you will need to read on, otherwise you don't have to worry about the information below. We have tried to simplify the usage of the tools for common tasks involving orientation issues, although still providing flexible and powerful tools for the expert user. <span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span><p class="line867">
<h1 id="Common_problems">Common problems</h1>
<span class="anchor" id="line-9"></span><p class="line874">We describe here the most common problems and how to solve them. If you have a different problem then you will need to work with the advanced tools described later (and read the information on NIfTI orientation). <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><p class="line867">
<h2 id="A1._The_labels_in_FSLView_are_wrong_or_missing">1. The labels in FSLView are wrong or missing</h2>
<span class="anchor" id="line-12"></span><p class="line874">This is very serious and needs to be fixed before doing any analysis at all. Ideally it should be fixed by using a tool that creates a correct NIfTI file. There are numerous converters from DICOM to NIfTI -- for recommendations, see the FSL FAQ. A correct converter should store the correct information in the NIfTI file so that the labels are correct when viewed in FSLView. If you have tried many converters and still cannot get the images converted correctly then you will need to use the advanced tools, fslswapdim and fslorient, to fix the problem (more info below). <span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><p class="line867">
<h2 id="A2._The_labels_in_FSLView_are_correct_but_the_image_is_oriented_.22wrongly.22">2. The labels in FSLView are correct but the image is oriented &quot;wrongly&quot;</h2>
<span class="anchor" id="line-15"></span><p class="line874">By default FSLView shows the image in the way that the scanner acquired it, so that sagittal, coronal and axial scans look very different. Hence this is not really &quot;wrong&quot; - just how FSLView chooses to display the images. If you do not want this but want to see the image in the same orientation as the standard templates (MNI152) then you can run the tool fslreorient2std which is designed for just this task. However, make sure that the labels are correct in FSLView to start with, as this tool only works if they are correct. <span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><p class="line867">
<h1 id="Tools">Tools</h1>
<span class="anchor" id="line-18"></span><ul><li><p class="line891"><tt class="backtick">fslreorient2std</tt> - this is a simple tool designed to reorient an image to match the orientation of the standard template images (MNI152) so that they appear &quot;the same way around&quot; in FSLView. It requires that the image labels are correct in FSLView before this is run. It is also not a registration tool, so it will not align the image to standard space, it will only apply 90, 180 or 270 degree rotations about the different axes as necessary to get the labels in the same position as the standard template. <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslorient</tt> - this is an advanced tool that reports or sets the orientation information in a file. Note that only in NIfTI files can the orientation be changed - Analyze files are <em>always treated as &quot;radiological&quot;</em> (meaning that they could be simply rotated into the same alignment as the MNI152 standard images - equivalent to the appropriate <em>sform</em> or <em>qform</em> in a NIfTI file having a negative determinant). <span class="anchor" id="line-21"></span>In nifti files it is possible to independently report or modify the <em>qform</em> or <em>sform</em> fields (see below for background information on NIfTI orientation). However, the FSL4.1 output routines will try to keep <em>qform and sform matrices the same</em> whenever one would otherwise be unset. Therefore it is not possible, for instance, to delete only the qform, as if the sform is set then doing this will result in the qform being set equal (as close as possible) to the sform. This is currently done to aid interoperability with other packages. However, if both qform and sform are given different values then these are preserved by the output routines. This command does not change the data storage at all - only the orientation information in the header and so should be used with great caution. Only modify header information if you understand the information about the NIfTI orientation given below or are following (exactly) a set of steps prescribed by someone who does. <span class="anchor" id="line-22"></span>The option <tt class="backtick">-deleteorient</tt> is useful for the first stage of correcting orientation/label information in images where the conversion to NIfTI does not provide the correction information. Note that the first, and by far the best, solution to this problem is to find a method of converting the images to NIfTI in a way that correctly stores the information (see above) but if this really is not possible then a combination of <tt class="backtick">fslorient</tt> and <tt class="backtick">fslswapdim</tt> can be used to fix it (see below). <span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslswapdim</tt> - this is an advanced tool that re-orders the data storage to permit changes between axial, sagittal and coronal slicing. When used in this mode the same left-right convention (also called coordinate handedness or radiological/neurological convention) will be maintained as long <em>as no warning is printed</em>. <span class="anchor" id="line-25"></span>The new orientation of the data is specified by selecting what the new axes should represent. This can either be done in terms of the old axes (x y z -x -y -z) or in terms of anatomical labels <em>when this information is available</em> (in a nifti image where either the sform or qform code is non-zero). The anatomical labels are RL LR AP PA SI IS. Note that the anatomical label version will not allow the left-right convention to be changed. <span class="anchor" id="line-26"></span>Ordinarily <tt class="backtick">fslswapdim</tt> will change the orientation information in the header as well as reordering the data. This is so that the anatomical labels stay attached to the same parts of the image and not fixed to the voxel coordinates. Hence, reordering a coronal image to axial slicing should keep the labels correctly attached to the relevant parts of the image, as long as they were correct initially. If the initial labels are incorrect (see the labels in <tt class="backtick">fslview</tt>) then <tt class="backtick">fslorient</tt> needs to be used in conjunction with <tt class="backtick">fslswapdim</tt> in order to correct this. <span class="anchor" id="line-27"></span>When <tt class="backtick">fslswapdim</tt> is given arguments that will change the left-right orientation it will issue a warning that the left-right orientation is being flipped. It will also try to modify the orientation information in the header (only when either the sform or qform code is non-zero), but not in a way that swaps this left-right orientation in the header. Hence there is a net change in orientation as the data is swapped while the header is not. If the swap occurs on the x-axis then nothing is done to the header at all. Otherwise, the axis which is being swapped, together with the x-axis, have their orientation changed. In this way the handedness of the header is preserved, the labels associated with the y-axis and z-axis follow the image change, but the x-axis labels do not. It is recommended that if a left-right swap in storage is desired (and this should only be done if the reconstruction is initially incorrect, and cannot be fixed by finding any better conversion method) then the arguments <tt class="backtick">-x&nbsp;y&nbsp;z</tt> should be used as this is the simplest form of swapping since it only affects the x-axis data and no labels or header information is changed. <span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span></li></ul><p class="line867">
<h1 id="Serious_.28uncommon.29_problems">Serious (uncommon) problems</h1>
<span class="anchor" id="line-30"></span><p class="line867">
<h2 id="A1._The_labels_in_FSLView_are_wrong_or_missing_and_no_conversion_to_NIfTI_can_fix_this">1. The labels in FSLView are wrong or missing and no conversion to NIfTI can fix this</h2>
<span class="anchor" id="line-31"></span><p class="line862">If this really cannot be fixed at the conversion stage, then it is possible to fix by the follow (only to be attempted after reading the following section on background information on NIfTI orientation):  <tt class="backtick">fslorient&nbsp;-deleteorient&nbsp;imagename&nbsp;;</tt> <tt class="backtick">fslswapdim&nbsp;imagename&nbsp;a&nbsp;b&nbsp;c&nbsp;imagename</tt> ; <tt class="backtick">fslorient&nbsp;-setqformcode&nbsp;1&nbsp;imagename</tt> ; where a b c need to be chosen, usually by trial and error, so that the image after this is in the same orientation (as viewed in FSLView) as the MNI152 images. However, unless you have some way of telling left from right in the image (e.g. by a vitamin capsule or clearly known structural asymmetry) this method can easily result in an incorrect left-right labelling and so should not be attempted. <span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><p class="line867">
<h2 id="Background_information_on_NIfTI_Orientation">Background information on NIfTI Orientation</h2>
<span class="anchor" id="line-34"></span><p class="line874">This section is purely optional but is extremely useful to understand if you are working with any of the advanced tools, have unusual problems, or are just plain interested. <span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><p class="line874">The NIfTI standard is confusing for many people on the issue of orientation, largely because it is intrinsically a confusing issue. It is complicated because the intensity data is stored on disk as a list of numbers - there is no concept of spatial or anatomical location with these numbers, and so information and standard conventions are used to associate spatial and anatomical location information with these numbers. <span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><p class="line874">To start with, voxel coordinates are associated with the numbers (intensity values), such that the first number is at coordinate (0,0,0) the second at (1,0,0), the third at (2,0,0), etc. So, for example, say the image was 64 by 64 by 20 in size, then the coordinates would go as (0,0,0) then (1,0,0) ... then (63,0,0) then (0,1,0) then (1,1,0) then (2,1,0) ... then (63,1,0) then (0,2,0) ... then (63,63,0) then (0,0,1) then (1,0,1) ... until (63,63,19). Note that all coordinates start at 0, not 1, and that the first coordinate (i) here is the one that increases the fastest as you go through the list, followed by second (j) and then the third (k). These voxel coordinates - (i,j,k) - give spatial information (using information about how many voxels are in the three spatial directions) but do not attribute any anatomical information at all. <span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><p class="line862">To go from voxel coordinates to more anatomically meaningful coordinates is the job of the <tt class="backtick">qform</tt> and <tt class="backtick">sform</tt> matrices that are stored in the NIfTI file. Note that these matrices only provide useful information if they have a non-zero <tt class="backtick">code</tt>, since a zero <tt class="backtick">code</tt> indicates that the matrix is &quot;Unknown&quot; and hence cannot be used. Having two matrices here is a common source of confusion. They were originally proposed so that two different coordinates could be kept track of - one representing the scanner coordinate system (the real space inside the scanner bore) and the other one relating to standard space coordinates (e.g. MNI152). However, in practice, it is rare that both contain different information as they are often set to be the same, or one of them is &quot;Unknown&quot; in which case the other contains all the useful information. <span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><p class="line874">Either matrix (qform or sform) is used to convert the voxel coordinates into &quot;real world&quot; coordinates (also called continuous coordinates, or mm coordinates, or other names). These new coordinates - called (x,y,z) here - have units of mm, and can take any values, not just positive whole numbers like the (i,j,k) voxel coordinates. Note that FSLView displays both voxel and mm coordinates. [Aside: the conversion is done by multiplying the matrix with the voxel coordinate, reshaped as a 4x1 vector with the last element equal to 1 - although this detail is not important for any of the discussion or understanding.] <span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><p class="line862">If the <tt class="backtick">qform</tt> (or <tt class="backtick">sform</tt>) is set so that it gives information about scanner coordinates (as indicated by the <tt class="backtick">code</tt>), then a standard convention is used to relate the coordinate values to the anatomy. The convention is: +x = Right; +y = Anterior; +z = Superior. That is, moving in the positive x-direction (so that the x-coordinate increases) will be moving to the right, etc. This now allows left and right to be distinguished, which is usually not possible just by looking at brain images. Hence this information is absolutely crucial and getting this right for the conversion of the image to NIfTI format is extremely important. If it is incorrect then it would be easy for left and right to be assigned incorrectly and all analysis results to be on the wrong side. The information from the <tt class="backtick">qform</tt> and <tt class="backtick">sform</tt> is what is used by FSLView to determine the labels that are shown on the image. <span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><p class="line862">If the <tt class="backtick">sform</tt> is set so that it gives information about standard space coordinates then the situation is the same as above, since the standard convention used above was chosen to be the same as the convention chosen for the standard space coordinate systems (MNI152 and Talairach). The main difference between the two situations is that the transformation to standard space (represented by the <tt class="backtick">sform</tt> matrix) also involves scaling and shearing of the coordinate axes to make the brain &quot;fit&quot; the standard templates, whereas the transformation to scanner space coordinates is normally just a rotation and translation. <span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><p class="line862">An aside on left-right conventions: it is possible to store an image in many different ways that are totally and completely equivalent in terms of the intensities and the (x,y,z) coordinates. What can be different is the voxel coordinates (and hence the order of the intensities stored in the file) but if only the images are being used in the analysis then these conventions are unimportant for all analysis purposes - they are purely related to the storage format, in this case NIfTI - only the (x,y,z) coordinates and the intensity values count with respect to the analysis. The one exception to this is when voxel coordinates are required for the commands (either on the command-line or in the GUI - for example fslroi, FDT GUI, etc.) and only in these cases is it important that the voxel coordinates are known. That being said, one common confusion arises when the left-right order of the storage is changed (but the mm coordinates and intensities are unchanged). For instance, imagine taking an image where the first voxel is on the left and then swapping the left-right order so that the new image is stored such that the first voxel is now the rightmost one, but modifying the <tt class="backtick">qform</tt> and <tt class="backtick">sform</tt> matrices appropriately so that this rightmost voxel still has the same (x,y,z) coordinate as it had before - just a different voxel coordinate. This kind of change will not affect any analysis in FSL or any programs that are fully NIfTI compliant. However, some programs are only happy with one sort of ordering (sometimes called left-handed/right-handed, or radiological/neurological, or RAS/LAS, etc.) This used to be the case for old versions of FSL, but is no longer true. But if only the order of the intensities in the file is swapped, <em>without</em> compensating for this in the <tt class="backtick">sform</tt> and <tt class="backtick">qform</tt> matrices, then the swapped version is no longer equivalent to the original. This is why both the data order and header information need to be kept in sync, and why running either <tt class="backtick">fslswapdim</tt> or <tt class="backtick">fslorient</tt> alone to change the orientation information is dangerous and usually incorrect. <span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><p class="line862">An aside on display orientation: everything that has been said above about the NIfTI format refers to coordinates and data storage and has <em>nothing</em> to do with what way the images can be <em>displayed</em> in different viewing programs. Although the storage can be referred to as &quot;radiological&quot; or &quot;neurological&quot; this does not mean anything with respect to the displayed orientation. A valid NIfTI image can be displayed in any orientation that the viewing tool chooses, with the left side of the brain shown on the right side of the screen (so called radiological convention) or the other way around (neurological convention). It is also possible to display the inferior side of the brain at the top of the image, or any other configuration. It is entirely up to the display software how it chooses to show the image on the screen. What the NIfTI format does do is provide information to determine how to label the different parts of the image (with mm coordinates or anatomical labels such as left, right, anterior, posterior, superior and inferior). As long as the display tool correctly interprets this information and keeps it consistent with its choice of display orientation, there is no conflict between any type of NIfTI image and any displayed orientation. <span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-53"></span><a class="nonexistent" href="/fsl/fslwiki/CategoryFAQ">CategoryFAQ</a> <span class="anchor" id="line-54"></span><span class="anchor" id="bottom"></span></div><div id="contentend">&nbsp;</div>
<p id="pageinfo" class="info" lang="en" dir="ltr">Orientation Explained  (last edited 05:39:35 18-04-2020 by <span title="MarkJenkinson @ b018902e.bb.sky.com[176.24.144.46]"><a class="nonexistent" href="/fsl/fslwiki/MarkJenkinson" title="MarkJenkinson @ b018902e.bb.sky.com[176.24.144.46]">MarkJenkinson</a></span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">
<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>
</html>

